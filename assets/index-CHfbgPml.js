import{j as S,p as ji,r as hn,c as V7,g as U7,u as Z7,a as $7,b as G7,f as q7,l as Th}from"./index-XRI2Zuhs.js";import{G as X0,u as q0}from"./useRequest-DPXUNwp8.js";import"./index-7y6Rwc6-.js";const W7=({className:Xe})=>S.jsxs("svg",{className:Xe,width:"400",height:"400",viewBox:"0 0 400 400",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[S.jsxs("g",{clipPath:"url(#clip0_1779_162055)",children:[S.jsx("path",{d:"M38.6718 77.612C38.6795 77.612 38.687 77.6089 38.6924 77.6033C38.6979 77.5977 38.701 77.5902 38.701 77.5823C38.701 77.5785 38.7002 77.5747 38.6988 77.5713C38.6973 77.5678 38.6951 77.5646 38.6923 77.562C38.6896 77.5595 38.6863 77.5575 38.6828 77.5562C38.6793 77.555 38.6755 77.5545 38.6718 77.5548C38.6646 77.5548 38.6577 77.5577 38.6526 77.5628C38.6475 77.568 38.6446 77.575 38.6446 77.5823C38.6443 77.5861 38.6448 77.5899 38.646 77.5935C38.6473 77.5971 38.6492 77.6004 38.6518 77.6032C38.6543 77.606 38.6574 77.6082 38.6609 77.6097C38.6643 77.6112 38.668 77.612 38.6718 77.612Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M33.6779 93.1481C33.7003 93.1481 33.7222 93.1414 33.7409 93.1287C33.7595 93.1161 33.774 93.0981 33.7826 93.0771C33.7912 93.0561 33.7935 93.0329 33.7891 93.0106C33.7847 92.9883 33.7739 92.9678 33.758 92.9517C33.7422 92.9356 33.722 92.9246 33.7 92.9202C33.678 92.9157 33.6552 92.918 33.6345 92.9267C33.6137 92.9354 33.596 92.9502 33.5836 92.9691C33.5711 92.988 33.5645 93.0103 33.5645 93.0331C33.5645 93.0636 33.5764 93.0928 33.5977 93.1144C33.6189 93.136 33.6478 93.1481 33.6779 93.1481Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M28.5162 108.652C28.5612 108.652 28.6052 108.639 28.6428 108.614C28.6804 108.589 28.7097 108.553 28.7272 108.511C28.7447 108.469 28.7495 108.423 28.741 108.378C28.7325 108.333 28.7111 108.292 28.6794 108.26C28.6478 108.227 28.6074 108.205 28.5633 108.196C28.5193 108.187 28.4736 108.191 28.432 108.209C28.3904 108.226 28.3549 108.256 28.3299 108.293C28.3049 108.331 28.2915 108.376 28.2915 108.422C28.2915 108.482 28.3151 108.54 28.3572 108.584C28.3993 108.627 28.4564 108.651 28.5162 108.652Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M23.1653 124.032C23.2215 124.032 23.2764 124.016 23.3231 123.984C23.3697 123.952 23.4061 123.907 23.4275 123.854C23.4489 123.802 23.4543 123.744 23.4432 123.688C23.4321 123.632 23.4049 123.581 23.3651 123.541C23.3252 123.5 23.2745 123.473 23.2194 123.462C23.1642 123.451 23.1072 123.457 23.0554 123.48C23.0036 123.502 22.9595 123.539 22.9286 123.586C22.8977 123.634 22.8814 123.69 22.8818 123.747C22.8818 123.785 22.8892 123.822 22.9035 123.857C22.9177 123.891 22.9387 123.923 22.965 123.95C22.9914 123.976 23.0226 123.997 23.057 124.011C23.0914 124.026 23.1282 124.033 23.1653 124.032Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M17.6463 139.298C17.7025 139.298 17.7574 139.281 17.804 139.249C17.8507 139.218 17.887 139.173 17.9084 139.12C17.9298 139.067 17.9353 139.009 17.9242 138.953C17.9131 138.898 17.8859 138.846 17.846 138.806C17.8062 138.766 17.7554 138.739 17.7003 138.728C17.6452 138.717 17.5881 138.723 17.5363 138.745C17.4846 138.767 17.4405 138.804 17.4096 138.852C17.3787 138.9 17.3624 138.956 17.3628 139.012C17.3634 139.088 17.3935 139.161 17.4466 139.215C17.4997 139.268 17.5715 139.298 17.6463 139.298Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M11.9553 154.465C12.0055 154.465 12.0547 154.45 12.0964 154.422C12.1382 154.393 12.1708 154.353 12.19 154.306C12.2093 154.259 12.2143 154.207 12.2045 154.157C12.1947 154.107 12.1705 154.061 12.135 154.025C12.0994 153.989 12.0541 153.964 12.0048 153.954C11.9556 153.944 11.9045 153.949 11.858 153.969C11.8116 153.988 11.7719 154.021 11.744 154.064C11.7161 154.106 11.7012 154.156 11.7012 154.207C11.7012 154.275 11.7279 154.341 11.7756 154.389C11.8232 154.438 11.8879 154.465 11.9553 154.465Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M6.09198 169.513C6.12562 169.513 6.15851 169.503 6.18648 169.484C6.21445 169.465 6.23625 169.438 6.24913 169.407C6.262 169.375 6.26537 169.34 6.25881 169.307C6.25225 169.273 6.23604 169.243 6.21226 169.219C6.18847 169.194 6.15816 169.178 6.12516 169.171C6.09217 169.165 6.05796 169.168 6.02688 169.181C5.9958 169.194 5.96923 169.216 5.95054 169.245C5.93185 169.273 5.92188 169.306 5.92188 169.341C5.92188 169.386 5.9398 169.43 5.9717 169.463C6.0036 169.495 6.04686 169.513 6.09198 169.513Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M0.0563863 184.454C0.0713409 184.454 0.0856832 184.448 0.0962576 184.438C0.106832 184.427 0.112773 184.412 0.112773 184.397C0.112773 184.382 0.106832 184.367 0.0962576 184.357C0.0856832 184.346 0.0713409 184.34 0.0563863 184.34C0.0414318 184.34 0.0270899 184.346 0.0165154 184.357C0.00594095 184.367 0 184.382 0 184.397C0 184.412 0.00594095 184.427 0.0165154 184.438C0.0270899 184.448 0.0414318 184.454 0.0563863 184.454Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M56.7945 62.2782C56.8067 62.2801 56.8192 62.2794 56.8311 62.276C56.843 62.2726 56.854 62.2666 56.8634 62.2584C56.8728 62.2502 56.8804 62.2401 56.8856 62.2287C56.8907 62.2173 56.8934 62.2049 56.8934 62.1924C56.8934 62.1798 56.8907 62.1674 56.8856 62.156C56.8804 62.1446 56.8728 62.1345 56.8634 62.1263C56.854 62.1182 56.843 62.1122 56.8311 62.1087C56.8192 62.1053 56.8067 62.1046 56.7945 62.1065C56.7743 62.1098 56.756 62.1202 56.7427 62.1359C56.7294 62.1516 56.7222 62.1717 56.7222 62.1924C56.7222 62.2131 56.7294 62.2331 56.7427 62.2488C56.756 62.2645 56.7743 62.275 56.7945 62.2782Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M52.0194 77.9973C52.0754 77.9973 52.1302 77.9804 52.1769 77.9488C52.2235 77.9172 52.2598 77.8722 52.2813 77.8197C52.3027 77.7671 52.3083 77.7093 52.2974 77.6534C52.2865 77.5976 52.2595 77.5464 52.2198 77.5061C52.1802 77.4659 52.1297 77.4385 52.0747 77.4274C52.0197 77.4163 51.9627 77.422 51.9109 77.4438C51.8591 77.4655 51.8148 77.5024 51.7836 77.5497C51.7525 77.5971 51.7358 77.6527 51.7358 77.7096C51.7356 77.7474 51.7427 77.785 51.7569 77.82C51.771 77.855 51.7919 77.8869 51.8183 77.9137C51.8446 77.9404 51.876 77.9616 51.9105 77.976C51.945 77.9903 51.982 77.9976 52.0194 77.9973Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M47.0678 93.6636C47.1629 93.6636 47.2559 93.6349 47.335 93.5813C47.4141 93.5277 47.4757 93.4515 47.5121 93.3623C47.5485 93.2731 47.558 93.175 47.5395 93.0803C47.5209 92.9857 47.4751 92.8987 47.4079 92.8304C47.3406 92.7622 47.2549 92.7157 47.1616 92.6969C47.0684 92.678 46.9717 92.6877 46.8838 92.7246C46.7959 92.7616 46.7208 92.8241 46.668 92.9044C46.6151 92.9846 46.5869 93.079 46.5869 93.1755C46.5869 93.305 46.6376 93.4291 46.7278 93.5206C46.818 93.6121 46.9403 93.6636 47.0678 93.6636Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M41.9434 109.179C42.0611 109.179 42.176 109.143 42.2738 109.077C42.3716 109.011 42.4478 108.916 42.4927 108.806C42.5376 108.696 42.5493 108.574 42.5262 108.457C42.5031 108.34 42.4462 108.233 42.3629 108.149C42.2796 108.064 42.1735 108.007 42.0581 107.984C41.9427 107.961 41.8231 107.973 41.7145 108.019C41.606 108.065 41.5133 108.143 41.4483 108.242C41.3832 108.342 41.3487 108.459 41.3491 108.578C41.3497 108.737 41.4125 108.89 41.5239 109.003C41.6353 109.116 41.7862 109.179 41.9434 109.179Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M36.6472 124.64C36.7871 124.64 36.924 124.597 37.0403 124.518C37.1567 124.44 37.2474 124.327 37.301 124.196C37.3546 124.065 37.3686 123.921 37.3413 123.781C37.314 123.642 37.2466 123.514 37.1476 123.413C37.0486 123.313 36.9225 123.245 36.7852 123.217C36.6479 123.189 36.5056 123.203 36.3763 123.258C36.247 123.312 36.1365 123.404 36.0587 123.522C35.981 123.64 35.9395 123.779 35.9395 123.921C35.9392 124.016 35.9573 124.109 35.9928 124.196C36.0282 124.284 36.0803 124.363 36.1461 124.43C36.2119 124.497 36.29 124.549 36.376 124.585C36.462 124.621 36.5541 124.64 36.6472 124.64Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M31.1769 139.949C31.3229 139.95 31.4657 139.906 31.5872 139.824C31.7087 139.742 31.8035 139.625 31.8596 139.488C31.9156 139.352 31.9304 139.201 31.902 139.056C31.8737 138.91 31.8034 138.777 31.7002 138.672C31.597 138.567 31.4655 138.496 31.3223 138.467C31.1791 138.439 31.0307 138.454 30.896 138.51C30.7612 138.567 30.6461 138.664 30.5652 138.787C30.4844 138.91 30.4415 139.055 30.4419 139.203C30.4419 139.401 30.5193 139.591 30.6572 139.731C30.795 139.871 30.982 139.949 31.1769 139.949Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M25.5364 155.107C25.6704 155.107 25.8014 155.066 25.9126 154.99C26.0239 154.914 26.1105 154.807 26.1615 154.681C26.2125 154.555 26.2257 154.417 26.1993 154.283C26.1729 154.15 26.1081 154.027 26.0132 153.931C25.9182 153.835 25.7973 153.77 25.6658 153.744C25.5343 153.717 25.398 153.731 25.2742 153.783C25.1504 153.835 25.0446 153.923 24.9701 154.037C24.8957 154.15 24.856 154.283 24.856 154.419C24.856 154.509 24.8736 154.599 24.9078 154.683C24.942 154.766 24.9922 154.842 25.0554 154.906C25.1186 154.97 25.1936 155.021 25.2761 155.055C25.3587 155.09 25.4471 155.107 25.5364 155.107Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M19.7233 170.201C19.8479 170.201 19.9697 170.163 20.0733 170.093C20.1769 170.023 20.2576 169.923 20.3053 169.806C20.353 169.689 20.3655 169.561 20.3412 169.436C20.3169 169.312 20.2569 169.199 20.1687 169.109C20.0806 169.02 19.9684 168.959 19.8462 168.934C19.724 168.909 19.5973 168.922 19.4822 168.971C19.3671 169.019 19.2687 169.101 19.1994 169.206C19.1302 169.311 19.0933 169.435 19.0933 169.561C19.0933 169.731 19.1596 169.893 19.2778 170.013C19.3959 170.133 19.5562 170.201 19.7233 170.201Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M13.7402 185.14C13.835 185.14 13.9276 185.112 14.0065 185.058C14.0854 185.005 14.147 184.929 14.1837 184.841C14.2203 184.752 14.2303 184.654 14.2124 184.56C14.1945 184.466 14.1495 184.379 14.0831 184.31C14.0167 184.241 13.9318 184.194 13.8391 184.175C13.7464 184.155 13.6499 184.163 13.5619 184.199C13.4739 184.234 13.3983 184.296 13.3444 184.375C13.2906 184.454 13.261 184.547 13.2593 184.644C13.2585 184.708 13.2703 184.773 13.2941 184.833C13.3178 184.893 13.3531 184.947 13.3978 184.994C13.4425 185.04 13.4958 185.076 13.5546 185.102C13.6133 185.127 13.6764 185.14 13.7402 185.14Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M7.58718 199.987C7.64924 199.987 7.71002 199.969 7.7618 199.934C7.81358 199.899 7.85401 199.85 7.87795 199.792C7.90189 199.733 7.90827 199.669 7.89626 199.608C7.88425 199.546 7.85441 199.489 7.81052 199.445C7.76664 199.4 7.71069 199.37 7.6498 199.358C7.58891 199.345 7.52582 199.352 7.46856 199.376C7.4113 199.4 7.36245 199.441 7.32823 199.494C7.29401 199.547 7.27596 199.608 7.27637 199.671C7.27692 199.755 7.30985 199.835 7.36801 199.894C7.42618 199.953 7.50492 199.986 7.58718 199.987Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M1.26821 214.715C1.29072 214.715 1.31273 214.708 1.33142 214.695C1.35011 214.682 1.36464 214.664 1.37316 214.643C1.38168 214.622 1.3838 214.599 1.37925 214.576C1.3747 214.554 1.36369 214.533 1.34762 214.517C1.33155 214.501 1.31115 214.491 1.28901 214.486C1.26688 214.482 1.24402 214.485 1.22333 214.494C1.20265 214.503 1.18509 214.518 1.17289 214.537C1.16068 214.556 1.15439 214.579 1.1548 214.602C1.15535 214.632 1.16755 214.66 1.18875 214.682C1.20996 214.703 1.23849 214.715 1.26821 214.715Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M74.6494 46.8317C74.6719 46.8321 74.694 46.8257 74.713 46.8134C74.7319 46.801 74.7467 46.7832 74.7556 46.7622C74.7645 46.7412 74.7671 46.718 74.763 46.6955C74.7588 46.673 74.7482 46.6523 74.7324 46.636C74.7166 46.6197 74.6964 46.6086 74.6744 46.6039C74.6523 46.5993 74.6294 46.6015 74.6086 46.6101C74.5877 46.6188 74.5699 46.6335 74.5574 46.6525C74.5448 46.6714 74.5381 46.6938 74.5381 46.7166C74.5381 46.7468 74.5497 46.7757 74.5706 46.7973C74.5914 46.8188 74.6197 46.8312 74.6494 46.8317Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M70.0962 62.6756C70.1688 62.6752 70.2396 62.6529 70.2998 62.6117C70.3599 62.5705 70.4067 62.5121 70.4342 62.4439C70.4617 62.3757 70.4687 62.3008 70.4542 62.2286C70.4398 62.1564 70.4047 62.0901 70.3532 62.0382C70.3017 61.9862 70.2362 61.9509 70.165 61.9367C70.0938 61.9225 70.02 61.93 69.953 61.9583C69.8859 61.9866 69.8286 62.0344 69.7884 62.0957C69.7481 62.1569 69.7266 62.229 69.7266 62.3026C69.7266 62.3518 69.7361 62.4005 69.7547 62.4458C69.7733 62.4912 69.8006 62.5324 69.8349 62.5671C69.8693 62.6018 69.9101 62.6292 69.9549 62.6478C69.9997 62.6664 70.0477 62.6759 70.0962 62.6756Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M65.3546 78.4932C65.4834 78.4932 65.6092 78.4544 65.7163 78.3818C65.8234 78.3093 65.9068 78.2061 65.9561 78.0854C66.0053 77.9646 66.0182 77.8318 65.9931 77.7036C65.968 77.5755 65.906 77.4578 65.8149 77.3654C65.7239 77.273 65.6079 77.2101 65.4816 77.1846C65.3553 77.1591 65.2244 77.1722 65.1055 77.2222C64.9865 77.2722 64.8849 77.3568 64.8133 77.4655C64.7418 77.5741 64.7036 77.7019 64.7036 77.8325C64.7036 78.0078 64.7722 78.1758 64.8943 78.2997C65.0164 78.4236 65.182 78.4932 65.3546 78.4932Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M60.4469 94.1698C60.6131 94.1698 60.7755 94.1198 60.9136 94.0261C61.0518 93.9324 61.1594 93.7993 61.223 93.6435C61.2866 93.4878 61.3032 93.3164 61.2708 93.151C61.2384 92.9856 61.1584 92.8337 61.0409 92.7145C60.9234 92.5953 60.7738 92.5141 60.6108 92.4812C60.4479 92.4483 60.279 92.4652 60.1255 92.5297C59.972 92.5943 59.8408 92.7035 59.7485 92.8437C59.6562 92.9839 59.6069 93.1487 59.6069 93.3173C59.6069 93.5434 59.6954 93.7602 59.853 93.9201C60.0105 94.08 60.2242 94.1698 60.4469 94.1698Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M55.3669 109.791C55.5746 109.791 55.7776 109.729 55.9503 109.612C56.1229 109.495 56.2575 109.328 56.337 109.134C56.4165 108.939 56.4372 108.725 56.3967 108.518C56.3562 108.311 56.2562 108.121 56.1094 107.972C55.9625 107.823 55.7754 107.722 55.5717 107.681C55.3681 107.64 55.157 107.661 54.9651 107.741C54.7732 107.822 54.6092 107.958 54.4939 108.134C54.3785 108.309 54.3169 108.515 54.3169 108.726C54.3169 109.008 54.4275 109.279 54.6244 109.479C54.8214 109.679 55.0884 109.791 55.3669 109.791Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M50.1169 125.267C50.3466 125.267 50.5713 125.198 50.7623 125.068C50.9533 124.939 51.1022 124.755 51.19 124.539C51.2778 124.324 51.3007 124.087 51.2557 123.858C51.2107 123.629 51.0999 123.419 50.9373 123.255C50.7747 123.09 50.5676 122.978 50.3421 122.933C50.1167 122.887 49.8832 122.911 49.671 123C49.4588 123.09 49.2776 123.241 49.1503 123.435C49.0229 123.63 48.9552 123.858 48.9556 124.091C48.9556 124.245 48.9856 124.399 49.044 124.541C49.1024 124.684 49.188 124.814 49.2958 124.923C49.4037 125.033 49.5317 125.119 49.6726 125.178C49.8135 125.237 49.9645 125.267 50.1169 125.267Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M44.6861 140.62C44.9266 140.62 45.1617 140.548 45.3616 140.412C45.5616 140.277 45.7174 140.084 45.8095 139.858C45.9015 139.633 45.9256 139.385 45.8787 139.146C45.8317 138.906 45.7159 138.686 45.5459 138.514C45.3758 138.341 45.1592 138.224 44.9233 138.176C44.6875 138.128 44.443 138.153 44.2208 138.246C43.9986 138.34 43.8087 138.498 43.6751 138.701C43.5415 138.904 43.4702 139.142 43.4702 139.386C43.4708 139.713 43.5991 140.027 43.827 140.258C44.0549 140.489 44.3638 140.62 44.6861 140.62Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M39.1001 155.83C39.3353 155.831 39.5653 155.76 39.761 155.628C39.9567 155.496 40.1094 155.308 40.1997 155.087C40.29 154.867 40.3138 154.624 40.2682 154.39C40.2226 154.156 40.1095 153.941 39.9434 153.772C39.7773 153.603 39.5655 153.488 39.3348 153.441C39.1042 153.395 38.8651 153.418 38.6478 153.51C38.4305 153.601 38.2447 153.755 38.114 153.954C37.9833 154.152 37.9136 154.386 37.9136 154.624C37.9136 154.944 38.0385 155.25 38.261 155.476C38.4834 155.703 38.7852 155.83 39.1001 155.83Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M33.3463 170.942C33.5701 170.942 33.789 170.875 33.9751 170.748C34.1613 170.622 34.3063 170.443 34.392 170.233C34.4777 170.023 34.5001 169.792 34.4564 169.569C34.4127 169.346 34.3049 169.142 34.1466 168.981C33.9883 168.82 33.7867 168.711 33.5671 168.667C33.3475 168.622 33.1199 168.645 32.9131 168.732C32.7063 168.819 32.5295 168.966 32.4051 169.155C32.2807 169.344 32.2144 169.566 32.2144 169.793C32.2144 170.098 32.3336 170.39 32.5459 170.605C32.7582 170.821 33.0461 170.942 33.3463 170.942Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M27.4071 185.874C27.5973 185.874 27.7833 185.817 27.9415 185.71C28.0996 185.602 28.2229 185.45 28.2957 185.271C28.3685 185.093 28.3876 184.897 28.3504 184.708C28.3133 184.518 28.2217 184.344 28.0872 184.208C27.9527 184.071 27.7813 183.978 27.5948 183.941C27.4082 183.903 27.2148 183.922 27.0391 183.996C26.8633 184.07 26.7131 184.195 26.6074 184.356C26.5017 184.516 26.4453 184.705 26.4453 184.898C26.4453 185.157 26.5466 185.405 26.727 185.588C26.9074 185.771 27.152 185.874 27.4071 185.874Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M21.3067 200.704C21.458 200.704 21.606 200.659 21.732 200.574C21.858 200.489 21.9563 200.368 22.0145 200.226C22.0726 200.085 22.0881 199.929 22.0588 199.778C22.0296 199.627 21.9569 199.489 21.8501 199.38C21.7433 199.272 21.6071 199.198 21.4587 199.167C21.3104 199.137 21.1566 199.153 21.0168 199.211C20.877 199.27 20.7575 199.369 20.6734 199.497C20.5893 199.624 20.5444 199.775 20.5444 199.928C20.5444 200.133 20.6247 200.33 20.7676 200.476C20.9105 200.621 21.1044 200.703 21.3067 200.704Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M15.0405 215.439C15.1469 215.439 15.2508 215.407 15.3392 215.347C15.4276 215.287 15.4965 215.202 15.5372 215.102C15.5779 215.002 15.5886 214.893 15.5678 214.787C15.5471 214.681 15.4959 214.584 15.4207 214.507C15.3455 214.431 15.2497 214.379 15.1454 214.358C15.0411 214.337 14.933 214.348 14.8348 214.389C14.7366 214.43 14.6526 214.5 14.5935 214.59C14.5345 214.68 14.5029 214.785 14.5029 214.893C14.5029 215.038 14.5596 215.177 14.6604 215.279C14.7612 215.381 14.898 215.439 15.0405 215.439Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M8.60773 230.068C8.66389 230.068 8.71878 230.051 8.76545 230.019C8.81212 229.987 8.84845 229.942 8.86985 229.89C8.89124 229.837 8.89673 229.779 8.88562 229.723C8.87451 229.667 8.8473 229.616 8.80744 229.576C8.76758 229.536 8.71687 229.508 8.66174 229.497C8.60661 229.487 8.54954 229.493 8.49777 229.515C8.44601 229.537 8.40188 229.574 8.37098 229.622C8.34008 229.669 8.32381 229.725 8.32423 229.782C8.32423 229.82 8.33157 229.857 8.34585 229.892C8.36012 229.927 8.38103 229.958 8.40739 229.985C8.43374 230.011 8.46501 230.032 8.4994 230.046C8.53378 230.061 8.5706 230.068 8.60773 230.068Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M2.0077 244.628C2.01545 244.628 2.02289 244.624 2.02837 244.619C2.03386 244.613 2.03694 244.606 2.03694 244.598C2.03695 244.594 2.03618 244.59 2.03469 244.587C2.0332 244.583 2.03101 244.58 2.02826 244.578C2.02551 244.575 2.02227 244.573 2.01873 244.572C2.01519 244.571 2.01144 244.57 2.0077 244.57C2.0005 244.57 1.99359 244.573 1.9885 244.578C1.98341 244.584 1.98055 244.591 1.98055 244.598C1.98026 244.602 1.98075 244.606 1.98198 244.609C1.98322 244.613 1.98517 244.616 1.98772 244.619C1.99027 244.622 1.99336 244.624 1.9968 244.625C2.00024 244.627 2.00395 244.628 2.0077 244.628Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M92.2427 31.2519C92.2598 31.2523 92.2767 31.2475 92.2911 31.2381C92.3055 31.2287 92.3168 31.2152 92.3235 31.1992C92.3302 31.1833 92.3321 31.1656 92.3289 31.1486C92.3256 31.1315 92.3174 31.1159 92.3053 31.1036C92.2933 31.0913 92.2778 31.083 92.261 31.0797C92.2442 31.0764 92.2268 31.0783 92.2111 31.0851C92.1954 31.092 92.182 31.1034 92.1728 31.1181C92.1635 31.1327 92.1588 31.1497 92.1592 31.1671C92.1592 31.1896 92.168 31.2111 92.1837 31.227C92.1993 31.2429 92.2206 31.2519 92.2427 31.2519Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M87.8939 47.1834C87.9666 47.1834 88.0376 47.1615 88.098 47.1206C88.1585 47.0796 88.2056 47.0213 88.2334 46.9532C88.2612 46.885 88.2685 46.81 88.2543 46.7377C88.2401 46.6653 88.2051 46.5989 88.1537 46.5467C88.1023 46.4946 88.0369 46.4591 87.9656 46.4447C87.8943 46.4303 87.8204 46.4377 87.7532 46.4659C87.6861 46.4941 87.6287 46.5419 87.5883 46.6032C87.5479 46.6646 87.5264 46.7367 87.5264 46.8105C87.5264 46.9094 87.5651 47.0042 87.634 47.0742C87.7029 47.1441 87.7964 47.1834 87.8939 47.1834Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M83.3726 63.0994C83.7473 63.0994 84.0509 62.7912 84.0509 62.411C84.0509 62.0308 83.7473 61.7227 83.3726 61.7227C82.998 61.7227 82.6943 62.0308 82.6943 62.411C82.6943 62.7912 82.998 63.0994 83.3726 63.0994Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M78.679 78.961C78.8753 78.9614 79.0672 78.9028 79.2305 78.7924C79.3939 78.682 79.5212 78.5249 79.5965 78.341C79.6718 78.1572 79.6916 77.9547 79.6534 77.7594C79.6152 77.5641 79.5208 77.3847 79.382 77.2438C79.2433 77.103 79.0665 77.0072 78.874 76.9684C78.6815 76.9297 78.4821 76.9498 78.3009 77.0262C78.1197 77.1026 77.9649 77.2319 77.8561 77.3976C77.7474 77.5633 77.6895 77.7581 77.6899 77.9573C77.6899 78.2235 77.7942 78.4788 77.9796 78.667C78.1651 78.8553 78.4167 78.961 78.679 78.961Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M73.8156 94.7353C74.0673 94.7353 74.3133 94.6596 74.5226 94.5176C74.7319 94.3757 74.895 94.174 74.9913 93.9381C75.0876 93.7021 75.1128 93.4424 75.0637 93.1919C75.0146 92.9413 74.8934 92.7112 74.7154 92.5306C74.5375 92.35 74.3107 92.227 74.0639 92.1772C73.817 92.1273 73.5611 92.1529 73.3286 92.2507C73.096 92.3484 72.8973 92.5139 72.7574 92.7263C72.6176 92.9387 72.543 93.1884 72.543 93.4438C72.543 93.7863 72.677 94.1148 72.9157 94.357C73.1544 94.5992 73.4781 94.7353 73.8156 94.7353Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M68.7797 110.399C69.0762 110.399 69.3661 110.31 69.6127 110.142C69.8593 109.975 70.0515 109.737 70.165 109.459C70.2784 109.181 70.3081 108.875 70.2503 108.58C70.1924 108.285 70.0496 108.014 69.8399 107.801C69.6302 107.588 69.3631 107.443 69.0722 107.385C68.7813 107.326 68.4799 107.356 68.2059 107.471C67.9319 107.586 67.6977 107.782 67.533 108.032C67.3682 108.282 67.2803 108.576 67.2803 108.877C67.2803 109.281 67.4382 109.668 67.7194 109.953C68.0006 110.238 68.382 110.399 68.7797 110.399Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M63.5718 125.919C63.8961 125.919 64.2132 125.821 64.483 125.638C64.7527 125.455 64.9629 125.195 65.087 124.891C65.2112 124.587 65.2436 124.252 65.1803 123.93C65.1171 123.607 64.9609 123.31 64.7315 123.077C64.5021 122.845 64.2099 122.686 63.8917 122.622C63.5736 122.558 63.2438 122.591 62.9441 122.717C62.6444 122.843 62.3883 123.056 62.208 123.33C62.0278 123.603 61.9316 123.925 61.9316 124.254C61.9322 124.696 62.1052 125.119 62.4126 125.431C62.7201 125.743 63.1369 125.918 63.5718 125.919Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M58.1979 141.32C58.5393 141.32 58.8731 141.217 59.1569 141.025C59.4408 140.832 59.6621 140.559 59.7927 140.239C59.9234 139.918 59.9575 139.566 59.8909 139.226C59.8243 138.887 59.6599 138.574 59.4185 138.329C59.1771 138.085 58.8695 137.918 58.5347 137.85C58.1998 137.782 57.8527 137.817 57.5373 137.95C57.2219 138.082 56.9523 138.307 56.7626 138.595C56.5729 138.883 56.4717 139.222 56.4717 139.568C56.4717 140.033 56.6536 140.478 56.9773 140.807C57.301 141.135 57.7401 141.32 58.1979 141.32Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M52.6514 156.574C52.9929 156.574 53.327 156.472 53.6112 156.28C53.8954 156.087 54.117 155.814 54.2479 155.493C54.3788 155.173 54.4131 154.821 54.3466 154.481C54.2801 154.141 54.1156 153.829 53.8741 153.583C53.6325 153.338 53.3248 153.171 52.9897 153.104C52.6547 153.036 52.3074 153.071 51.9919 153.204C51.6764 153.337 51.4068 153.562 51.2173 153.85C51.0278 154.139 50.9268 154.478 50.9272 154.824C50.9278 155.288 51.1096 155.733 51.4328 156.061C51.7561 156.389 52.1943 156.573 52.6514 156.574Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M46.9374 171.705C47.2678 171.705 47.5909 171.606 47.8658 171.42C48.1406 171.234 48.3549 170.97 48.4816 170.66C48.6082 170.35 48.6414 170.01 48.5771 169.681C48.5127 169.352 48.3537 169.05 48.1201 168.813C47.8864 168.576 47.5888 168.414 47.2647 168.349C46.9407 168.284 46.6048 168.317 46.2997 168.446C45.9945 168.574 45.7338 168.792 45.5505 169.071C45.3672 169.35 45.2696 169.678 45.27 170.013C45.27 170.235 45.3132 170.455 45.3969 170.66C45.4807 170.866 45.6036 171.052 45.7584 171.209C45.9132 171.366 46.097 171.491 46.2993 171.576C46.5016 171.661 46.7185 171.705 46.9374 171.705Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M41.0575 186.685C41.3594 186.685 41.6546 186.594 41.9057 186.424C42.1567 186.253 42.3524 186.011 42.468 185.728C42.5835 185.445 42.6138 185.134 42.5548 184.833C42.4959 184.532 42.3505 184.256 42.137 184.04C41.9235 183.823 41.6515 183.675 41.3553 183.616C41.0592 183.556 40.7522 183.587 40.4732 183.704C40.1943 183.821 39.9558 184.02 39.7881 184.275C39.6203 184.529 39.5308 184.829 39.5308 185.135C39.5305 185.339 39.5698 185.54 39.6464 185.729C39.723 185.917 39.8355 186.088 39.9773 186.231C40.1191 186.375 40.2875 186.49 40.4729 186.567C40.6583 186.645 40.8569 186.685 41.0575 186.685Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M35.0094 201.51C35.267 201.51 35.5189 201.433 35.7333 201.288C35.9477 201.143 36.1149 200.937 36.2138 200.696C36.3126 200.454 36.3387 200.188 36.2887 199.932C36.2387 199.676 36.1149 199.44 35.9329 199.255C35.7509 199.07 35.5189 198.944 35.2663 198.893C35.0136 198.842 34.7517 198.868 34.5137 198.968C34.2757 199.068 34.0722 199.237 33.929 199.454C33.7859 199.672 33.7095 199.927 33.7095 200.189C33.7095 200.539 33.8464 200.874 34.0901 201.122C34.3338 201.37 34.6644 201.509 35.0094 201.51Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M28.7956 216.237C29.0033 216.237 29.2063 216.174 29.379 216.057C29.5516 215.94 29.6862 215.774 29.7657 215.579C29.8452 215.384 29.866 215.17 29.8254 214.963C29.7849 214.756 29.6849 214.567 29.5381 214.418C29.3912 214.269 29.2041 214.167 29.0005 214.126C28.7968 214.085 28.5857 214.106 28.3938 214.187C28.2019 214.267 28.0379 214.404 27.9226 214.579C27.8072 214.754 27.7456 214.96 27.7456 215.171C27.7456 215.454 27.8562 215.725 28.0531 215.925C28.2501 216.124 28.5171 216.237 28.7956 216.237Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M22.4259 230.836C22.5713 230.836 22.7134 230.792 22.8343 230.71C22.9551 230.628 23.0493 230.511 23.105 230.375C23.1606 230.239 23.1752 230.089 23.1468 229.944C23.1184 229.799 23.0484 229.667 22.9456 229.562C22.8429 229.458 22.7119 229.387 22.5693 229.358C22.4267 229.329 22.279 229.344 22.1446 229.401C22.0103 229.457 21.8956 229.553 21.8148 229.675C21.734 229.798 21.6909 229.942 21.6909 230.09C21.6909 230.287 21.7684 230.477 21.9062 230.617C22.044 230.757 22.231 230.836 22.4259 230.836Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M15.8741 245.36C15.9572 245.36 16.0384 245.335 16.1074 245.288C16.1765 245.242 16.2303 245.175 16.2621 245.097C16.2939 245.019 16.3022 244.934 16.286 244.851C16.2698 244.768 16.2298 244.692 16.1711 244.633C16.1124 244.573 16.0375 244.532 15.956 244.516C15.8746 244.5 15.7901 244.508 15.7134 244.54C15.6366 244.573 15.571 244.627 15.5249 244.697C15.4787 244.767 15.4541 244.85 15.4541 244.934C15.4541 245.047 15.4984 245.155 15.5771 245.235C15.6559 245.315 15.7627 245.36 15.8741 245.36Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M9.16662 259.808C9.18905 259.808 9.21098 259.802 9.22963 259.789C9.24827 259.776 9.26281 259.758 9.27139 259.737C9.27997 259.716 9.28222 259.693 9.27785 259.671C9.27347 259.648 9.26267 259.628 9.24681 259.612C9.23095 259.596 9.21074 259.585 9.18875 259.58C9.16675 259.576 9.14395 259.578 9.12323 259.587C9.10251 259.596 9.08479 259.61 9.07233 259.629C9.05987 259.648 9.05322 259.67 9.05322 259.693C9.05322 259.724 9.06517 259.753 9.08644 259.775C9.1077 259.796 9.13655 259.808 9.16662 259.808Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M105.442 31.504C105.492 31.504 105.541 31.4889 105.583 31.4606C105.625 31.4322 105.657 31.392 105.676 31.3448C105.696 31.2977 105.701 31.2459 105.691 31.1958C105.681 31.1458 105.657 31.0999 105.621 31.0638C105.586 31.0277 105.54 31.0032 105.491 30.9932C105.442 30.9833 105.391 30.9884 105.344 31.0079C105.298 31.0274 105.258 31.0605 105.23 31.1029C105.202 31.1453 105.188 31.1951 105.188 31.2462C105.188 31.3144 105.215 31.3796 105.263 31.4279C105.31 31.4761 105.374 31.5035 105.442 31.504Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M101.13 47.5365C101.255 47.5365 101.377 47.499 101.481 47.4288C101.584 47.3585 101.665 47.2586 101.713 47.1418C101.76 47.025 101.773 46.8964 101.748 46.7724C101.724 46.6484 101.664 46.5345 101.576 46.4451C101.488 46.3557 101.376 46.2948 101.253 46.2701C101.131 46.2454 101.005 46.2581 100.889 46.3065C100.774 46.3549 100.676 46.4368 100.607 46.542C100.537 46.6471 100.5 46.7707 100.5 46.8972C100.5 47.0667 100.567 47.2293 100.685 47.3492C100.803 47.4691 100.963 47.5365 101.13 47.5365Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M96.6488 63.5196C96.845 63.52 97.0369 63.4613 97.2002 63.351C97.3636 63.2406 97.4909 63.0835 97.5662 62.8996C97.6415 62.7157 97.6613 62.5133 97.6231 62.318C97.585 62.1227 97.4905 61.9432 97.3518 61.8024C97.213 61.6616 97.0362 61.5658 96.8437 61.527C96.6513 61.4883 96.4518 61.5084 96.2706 61.5848C96.0894 61.6612 95.9346 61.7904 95.8258 61.9562C95.7171 62.1219 95.6593 62.3167 95.6597 62.5158C95.6597 62.7821 95.7639 63.0374 95.9494 63.2256C96.1349 63.4139 96.3864 63.5196 96.6488 63.5196Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M91.9953 79.4491C92.2642 79.4495 92.5272 79.369 92.7509 79.2176C92.9747 79.0663 93.1492 78.851 93.2523 78.5989C93.3554 78.3469 93.3824 78.0695 93.3301 77.8018C93.2777 77.5341 93.1483 77.2882 92.9581 77.0953C92.768 76.9023 92.5257 76.7709 92.2619 76.7178C91.9982 76.6647 91.7248 76.6921 91.4765 76.7968C91.2281 76.9014 91.0159 77.0785 90.8668 77.3055C90.7176 77.5326 90.6383 77.7995 90.6387 78.0724C90.6392 78.4374 90.7823 78.7872 91.0366 79.0453C91.2909 79.3033 91.6357 79.4486 91.9953 79.4491Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M87.1714 95.2998C87.5075 95.3002 87.8362 95.1994 88.1159 95.0102C88.3955 94.821 88.6136 94.5519 88.7425 94.2369C88.8714 93.9219 88.9054 93.5752 88.84 93.2406C88.7747 92.906 88.6131 92.5986 88.3756 92.3573C88.1381 92.116 87.8353 91.9515 87.5057 91.8848C87.1761 91.8181 86.8344 91.8522 86.5239 91.9826C86.2133 92.113 85.9478 92.334 85.7611 92.6176C85.5743 92.9012 85.4746 93.2346 85.4746 93.5757C85.4743 93.802 85.518 94.0261 85.6032 94.2353C85.6883 94.4445 85.8133 94.6345 85.9709 94.7947C86.1284 94.9548 86.3156 95.0818 86.5216 95.1685C86.7276 95.2552 86.9484 95.2998 87.1714 95.2998Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M82.1796 111.007C82.5658 111.007 82.9434 110.891 83.2646 110.673C83.5858 110.455 83.8361 110.146 83.9839 109.783C84.1317 109.421 84.1704 109.023 84.0951 108.638C84.0197 108.254 83.8337 107.901 83.5606 107.623C83.2874 107.346 82.9394 107.158 82.5606 107.081C82.1817 107.005 81.7891 107.044 81.4322 107.194C81.0753 107.344 80.7703 107.598 80.5557 107.924C80.3411 108.25 80.2266 108.633 80.2266 109.025C80.2263 109.285 80.2766 109.543 80.3747 109.784C80.4727 110.024 80.6166 110.243 80.798 110.427C80.9794 110.611 81.1948 110.757 81.4319 110.857C81.6689 110.956 81.923 111.007 82.1796 111.007Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M77.0264 126.595C77.4517 126.595 77.8675 126.467 78.2211 126.227C78.5747 125.987 78.8504 125.647 79.0131 125.248C79.1759 124.849 79.2185 124.41 79.1355 123.987C79.0525 123.564 78.8477 123.175 78.547 122.87C78.2462 122.564 77.8631 122.357 77.4459 122.272C77.0288 122.188 76.5964 122.231 76.2035 122.397C75.8105 122.562 75.4747 122.841 75.2384 123.2C75.0021 123.559 74.876 123.981 74.876 124.413C74.8757 124.699 74.9311 124.983 75.0391 125.248C75.1471 125.513 75.3055 125.754 75.5052 125.957C75.7049 126.159 75.9421 126.32 76.2031 126.43C76.4642 126.539 76.7439 126.595 77.0264 126.595Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M71.686 142.044C72.1339 142.044 72.5718 141.91 72.9443 141.658C73.3169 141.406 73.6074 141.047 73.779 140.627C73.9507 140.207 73.9958 139.746 73.9087 139.3C73.8216 138.854 73.6062 138.444 73.2896 138.123C72.9731 137.801 72.5698 137.582 72.1306 137.494C71.6914 137.405 71.2361 137.45 70.8223 137.624C70.4085 137.798 70.0548 138.092 69.806 138.47C69.5571 138.848 69.4243 139.292 69.4243 139.747C69.4243 140.356 69.6625 140.94 70.0866 141.37C70.5107 141.801 71.086 142.043 71.686 142.044Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M66.1884 157.342C66.6418 157.342 67.085 157.206 67.4621 156.951C67.8392 156.695 68.1332 156.332 68.3068 155.907C68.4805 155.482 68.5261 155.015 68.4377 154.563C68.3494 154.112 68.1311 153.698 67.8106 153.372C67.49 153.047 67.0816 152.826 66.637 152.736C66.1924 152.646 65.7315 152.693 65.3128 152.869C64.8941 153.045 64.5363 153.343 64.2847 153.726C64.0331 154.109 63.899 154.559 63.8994 155.019C63.9 155.635 64.1413 156.225 64.5705 156.661C64.9996 157.096 65.5815 157.341 66.1884 157.342Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M60.5245 172.496C60.9664 172.496 61.3984 172.363 61.7658 172.114C62.1333 171.865 62.4197 171.511 62.5888 171.096C62.7579 170.682 62.8021 170.226 62.7159 169.786C62.6297 169.346 62.4169 168.942 62.1044 168.625C61.7919 168.308 61.3938 168.092 60.9604 168.005C60.5269 167.917 60.0777 167.962 59.6694 168.134C59.2611 168.305 58.9121 168.596 58.6666 168.969C58.4211 169.342 58.29 169.78 58.29 170.228C58.2906 170.83 58.5262 171.406 58.9451 171.831C59.364 172.256 59.932 172.495 60.5245 172.496Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M55.035 187.464C56.1763 187.276 56.9514 186.184 56.7662 185.026C56.5809 183.867 55.5054 183.081 54.364 183.269C53.2226 183.457 52.4476 184.548 52.6328 185.707C52.8181 186.865 53.8936 187.652 55.035 187.464Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M48.695 202.368C49.7411 202.368 50.5892 201.507 50.5892 200.446C50.5892 199.384 49.7411 198.523 48.695 198.523C47.6488 198.523 46.8008 199.384 46.8008 200.446C46.8008 201.507 47.6488 202.368 48.695 202.368Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M42.5336 217.086C42.8526 217.086 43.1647 216.991 43.4302 216.811C43.6957 216.632 43.9027 216.376 44.0251 216.077C44.1475 215.778 44.1797 215.449 44.1177 215.131C44.0557 214.814 43.9023 214.522 43.6768 214.293C43.4514 214.064 43.164 213.907 42.8511 213.844C42.5382 213.781 42.2138 213.813 41.919 213.937C41.6241 214.061 41.3721 214.27 41.1948 214.54C41.0175 214.809 40.9229 215.125 40.9229 215.449C40.9229 215.883 41.0925 216.299 41.3945 216.606C41.6965 216.913 42.1062 217.085 42.5336 217.086Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M36.2086 231.681C36.4603 231.681 36.7064 231.605 36.9157 231.463C37.1249 231.321 37.2881 231.119 37.3844 230.883C37.4807 230.647 37.5059 230.388 37.4568 230.137C37.4077 229.887 37.2865 229.657 37.1085 229.476C36.9305 229.295 36.7038 229.172 36.4569 229.122C36.2101 229.073 35.9542 229.098 35.7216 229.196C35.4891 229.294 35.2903 229.459 35.1505 229.672C35.0107 229.884 34.936 230.134 34.936 230.389C34.936 230.732 35.0701 231.06 35.3088 231.302C35.5474 231.545 35.8711 231.681 36.2086 231.681Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M29.7196 246.173C29.8986 246.173 30.0736 246.119 30.2224 246.018C30.3713 245.917 30.4873 245.774 30.5558 245.606C30.6243 245.438 30.6422 245.253 30.6073 245.075C30.5723 244.897 30.4861 244.733 30.3596 244.605C30.233 244.477 30.0717 244.389 29.8961 244.354C29.7206 244.318 29.5386 244.336 29.3732 244.406C29.2078 244.475 29.0664 244.593 28.967 244.744C28.8675 244.895 28.8145 245.073 28.8145 245.254C28.8145 245.498 28.9098 245.732 29.0796 245.904C29.2493 246.076 29.4795 246.173 29.7196 246.173Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M23.0684 260.559C23.1694 260.559 23.2682 260.529 23.3521 260.472C23.4361 260.415 23.5015 260.334 23.5401 260.239C23.5786 260.144 23.5886 260.04 23.5688 259.939C23.5489 259.839 23.5001 259.747 23.4285 259.674C23.3569 259.602 23.2658 259.553 23.1667 259.533C23.0675 259.513 22.9649 259.524 22.8717 259.563C22.7785 259.603 22.6989 259.67 22.6431 259.755C22.5873 259.841 22.5577 259.941 22.5581 260.043C22.5581 260.111 22.5713 260.179 22.597 260.241C22.6227 260.304 22.6603 260.361 22.7077 260.409C22.7551 260.457 22.8114 260.495 22.8733 260.521C22.9352 260.546 23.0015 260.559 23.0684 260.559Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M16.2539 274.931C16.2877 274.932 16.3208 274.922 16.349 274.903C16.3773 274.884 16.3994 274.858 16.4126 274.826C16.4258 274.795 16.4294 274.76 16.4231 274.726C16.4168 274.693 16.4008 274.662 16.3771 274.637C16.3534 274.613 16.3231 274.596 16.29 274.589C16.257 274.583 16.2226 274.586 16.1914 274.599C16.1602 274.612 16.1335 274.634 16.1148 274.662C16.096 274.691 16.0859 274.724 16.0859 274.759C16.0859 274.804 16.1036 274.848 16.135 274.88C16.1665 274.912 16.2092 274.931 16.2539 274.931Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M122.737 15.6962C122.757 15.6929 122.775 15.6825 122.788 15.6668C122.802 15.651 122.809 15.631 122.809 15.6103C122.809 15.5896 122.802 15.5696 122.788 15.5539C122.775 15.5381 122.757 15.5277 122.737 15.5245C122.724 15.5225 122.712 15.5233 122.7 15.5267C122.688 15.5301 122.677 15.5361 122.668 15.5443C122.658 15.5524 122.651 15.5626 122.646 15.574C122.64 15.5854 122.638 15.5978 122.638 15.6103C122.638 15.6229 122.64 15.6353 122.646 15.6467C122.651 15.6581 122.658 15.6682 122.668 15.6764C122.677 15.6845 122.688 15.6905 122.7 15.6939C122.712 15.6973 122.724 15.6981 122.737 15.6962Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M118.634 31.7875C118.723 31.7883 118.811 31.7622 118.886 31.7123C118.961 31.6625 119.019 31.5912 119.054 31.5076C119.089 31.4239 119.098 31.3317 119.081 31.2425C119.064 31.1534 119.022 31.0713 118.959 31.0068C118.896 30.9423 118.815 30.8982 118.728 30.8802C118.64 30.8622 118.549 30.871 118.466 30.9056C118.383 30.9401 118.313 30.9988 118.263 31.0743C118.213 31.1497 118.187 31.2385 118.187 31.3293C118.187 31.4501 118.234 31.566 118.317 31.6518C118.401 31.7376 118.515 31.7863 118.634 31.7875Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M114.358 47.8871C114.532 47.8875 114.702 47.8356 114.846 47.738C114.991 47.6404 115.104 47.5014 115.171 47.3387C115.237 47.1759 115.255 46.9968 115.221 46.8238C115.188 46.6509 115.104 46.4919 114.982 46.3671C114.859 46.2423 114.703 46.1573 114.532 46.1227C114.362 46.0882 114.185 46.1057 114.025 46.1731C113.864 46.2404 113.727 46.3546 113.631 46.5012C113.534 46.6477 113.482 46.82 113.482 46.9963C113.482 47.2322 113.575 47.4584 113.739 47.6254C113.903 47.7924 114.126 47.8865 114.358 47.8871Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M109.915 63.9356C110.172 63.936 110.424 63.8588 110.639 63.7138C110.853 63.5688 111.02 63.3624 111.119 63.1209C111.218 62.8794 111.244 62.6135 111.194 62.357C111.144 62.1005 111.02 61.8649 110.837 61.68C110.655 61.4951 110.423 61.3692 110.17 61.3183C109.917 61.2673 109.656 61.2937 109.418 61.394C109.18 61.4942 108.976 61.6639 108.833 61.8815C108.69 62.0991 108.614 62.3549 108.615 62.6164C108.615 62.9661 108.752 63.3013 108.996 63.5486C109.24 63.7959 109.57 63.935 109.915 63.9356Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M105.301 79.9372C105.642 79.9376 105.976 79.8352 106.26 79.643C106.545 79.4508 106.766 79.1773 106.897 78.8573C107.028 78.5372 107.063 78.1849 106.996 77.8449C106.93 77.505 106.766 77.1926 106.524 76.9474C106.283 76.7022 105.975 76.5352 105.64 76.4674C105.306 76.3996 104.958 76.4342 104.643 76.5667C104.327 76.6993 104.058 76.9238 103.868 77.2119C103.678 77.5001 103.577 77.8388 103.577 78.1854C103.577 78.6496 103.758 79.0949 104.082 79.4234C104.405 79.7518 104.843 79.9366 105.301 79.9372Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M100.517 95.8276C101.673 95.8276 102.611 94.8764 102.611 93.7029C102.611 92.5294 101.673 91.5781 100.517 91.5781C99.3607 91.5781 98.4233 92.5294 98.4233 93.7029C98.4233 94.8764 99.3607 95.8276 100.517 95.8276Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M95.5675 111.603C96.0432 111.603 96.5084 111.461 96.9041 111.193C97.2999 110.925 97.6084 110.544 97.7906 110.098C97.9729 109.652 98.0207 109.161 97.928 108.687C97.8353 108.214 97.6062 107.779 97.2698 107.437C96.9334 107.096 96.5048 106.864 96.0381 106.769C95.5715 106.675 95.0879 106.724 94.6484 106.909C94.209 107.094 93.8335 107.407 93.5694 107.808C93.3053 108.21 93.1646 108.682 93.165 109.165C93.165 109.485 93.2272 109.802 93.3479 110.098C93.4686 110.394 93.6456 110.663 93.8687 110.889C94.0918 111.115 94.3566 111.295 94.6481 111.417C94.9396 111.54 95.252 111.603 95.5675 111.603Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M90.4496 127.271C90.9755 127.271 91.4895 127.113 91.9267 126.816C92.3639 126.52 92.7046 126.099 92.9059 125.606C93.1071 125.113 93.1597 124.57 93.0572 124.047C92.9546 123.523 92.7014 123.043 92.3296 122.665C91.9577 122.288 91.484 122.031 90.9683 121.927C90.4526 121.823 89.918 121.876 89.4322 122.08C88.9464 122.285 88.5312 122.63 88.2391 123.074C87.9469 123.518 87.791 124.039 87.791 124.573C87.791 125.289 88.0711 125.975 88.5697 126.481C89.0683 126.987 89.7445 127.271 90.4496 127.271Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M85.1641 142.76C85.7182 142.761 86.2601 142.594 86.721 142.282C87.182 141.97 87.5414 141.526 87.7537 141.007C87.9661 140.487 88.0219 139.915 87.914 139.364C87.8061 138.812 87.5395 138.305 87.1478 137.908C86.7561 137.51 86.2569 137.239 85.7135 137.129C85.17 137.019 84.6066 137.075 84.0946 137.29C83.5826 137.506 83.1449 137.87 82.837 138.337C82.5291 138.805 82.3647 139.355 82.3647 139.917C82.3647 140.671 82.6596 141.394 83.1845 141.927C83.7094 142.46 84.4214 142.76 85.1641 142.76Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M79.7124 158.134C80.2833 158.134 80.8414 157.963 81.3163 157.641C81.7911 157.32 82.1612 156.862 82.3799 156.327C82.5985 155.792 82.6559 155.203 82.5446 154.635C82.4333 154.067 82.1585 153.545 81.7548 153.135C81.3512 152.725 80.8368 152.446 80.2769 152.334C79.717 152.221 79.1367 152.279 78.6094 152.501C78.082 152.723 77.6314 153.098 77.3145 153.58C76.9976 154.062 76.8287 154.628 76.8291 155.208C76.8297 155.984 77.1336 156.727 77.6742 157.276C78.2148 157.825 78.9479 158.133 79.7124 158.134Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M74.0864 173.304C74.6459 173.304 75.1931 173.136 75.6585 172.821C76.124 172.506 76.4869 172.058 76.7013 171.533C76.9157 171.009 76.972 170.431 76.8631 169.874C76.7542 169.317 76.4849 168.806 76.0894 168.404C75.6939 168.002 75.1899 167.729 74.6411 167.618C74.0923 167.507 73.5235 167.564 73.0065 167.781C72.4895 167.998 72.0475 168.366 71.7366 168.838C71.4257 169.31 71.2598 169.865 71.2598 170.433C71.2598 171.194 71.5575 171.924 72.0875 172.462C72.6176 173.001 73.3365 173.303 74.0864 173.304Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M68.3135 188.351C68.8505 188.351 69.3755 188.189 69.822 187.887C70.2685 187.584 70.6166 187.153 70.8221 186.65C71.0276 186.146 71.0814 185.592 70.9766 185.058C70.8718 184.523 70.6132 184.032 70.2335 183.647C69.8537 183.262 69.3699 182.999 68.8432 182.893C68.3165 182.786 67.7705 182.841 67.2744 183.05C66.7782 183.258 66.3541 183.611 66.0558 184.065C65.7574 184.518 65.5981 185.05 65.5981 185.595C65.5981 186.326 65.8842 187.027 66.3934 187.544C66.9027 188.061 67.5933 188.351 68.3135 188.351Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M62.366 203.219C62.8587 203.22 63.3406 203.072 63.7505 202.794C64.1604 202.517 64.4799 202.122 64.6687 201.66C64.8575 201.198 64.907 200.69 64.8109 200.199C64.7149 199.709 64.4776 199.258 64.1292 198.904C63.7807 198.551 63.3368 198.31 62.8534 198.213C62.3701 198.115 61.8692 198.165 61.414 198.357C60.9588 198.548 60.5698 198.873 60.2963 199.289C60.0228 199.705 59.877 200.194 59.8774 200.694C59.8774 201.025 59.9418 201.354 60.0669 201.66C60.1919 201.967 60.3752 202.245 60.6063 202.479C60.8374 202.714 61.1117 202.9 61.4136 203.027C61.7156 203.154 62.0392 203.219 62.366 203.219Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M56.2553 217.932C56.6861 217.932 57.1071 217.802 57.4652 217.559C57.8233 217.316 58.1025 216.971 58.2673 216.567C58.4321 216.164 58.4752 215.719 58.3912 215.291C58.3072 214.862 58.0998 214.468 57.7952 214.159C57.4907 213.85 57.1026 213.639 56.6802 213.554C56.2578 213.469 55.8199 213.513 55.422 213.68C55.0241 213.847 54.6839 214.13 54.4446 214.494C54.2054 214.857 54.0776 215.285 54.0776 215.722C54.0776 216.308 54.3071 216.87 54.7155 217.284C55.1239 217.699 55.6778 217.932 56.2553 217.932Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M49.9825 232.546C50.3465 232.547 50.7023 232.438 51.0051 232.233C51.3079 232.028 51.544 231.736 51.6836 231.395C51.8232 231.054 51.8599 230.679 51.7892 230.316C51.7184 229.954 51.5434 229.621 51.2862 229.36C51.029 229.099 50.7012 228.921 50.3443 228.849C49.9874 228.776 49.6174 228.813 49.2811 228.954C48.9449 229.096 48.6574 229.335 48.4552 229.642C48.253 229.949 48.145 230.31 48.145 230.679C48.145 231.174 48.3385 231.649 48.6831 231.999C49.0276 232.349 49.495 232.546 49.9825 232.546Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M43.5482 247.034C43.8335 247.034 44.1125 246.948 44.3497 246.787C44.587 246.626 44.7719 246.397 44.8811 246.13C44.9903 245.862 45.0188 245.568 44.9632 245.284C44.9075 245 44.7701 244.739 44.5683 244.534C44.3666 244.33 44.1095 244.19 43.8296 244.134C43.5498 244.077 43.2597 244.106 42.9961 244.217C42.7325 244.328 42.5071 244.515 42.3486 244.756C42.1901 244.997 42.1055 245.28 42.1055 245.57C42.1055 245.958 42.2575 246.33 42.528 246.605C42.7986 246.879 43.1655 247.034 43.5482 247.034Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M36.9496 261.391C37.1458 261.391 37.3377 261.332 37.501 261.222C37.6644 261.112 37.7917 260.955 37.867 260.771C37.9423 260.587 37.9621 260.384 37.9239 260.189C37.8857 259.994 37.7913 259.814 37.6525 259.674C37.5138 259.533 37.337 259.437 37.1445 259.398C36.952 259.359 36.7526 259.379 36.5714 259.456C36.3902 259.532 36.2354 259.662 36.1266 259.827C36.0179 259.993 35.96 260.188 35.9605 260.387C35.9605 260.519 35.986 260.649 36.0357 260.771C36.0855 260.893 36.1583 261.003 36.2502 261.097C36.342 261.19 36.451 261.264 36.571 261.314C36.691 261.365 36.8197 261.391 36.9496 261.391Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M30.1959 275.702C30.3081 275.702 30.4177 275.668 30.5109 275.605C30.6042 275.541 30.6768 275.452 30.7198 275.346C30.7627 275.241 30.7739 275.126 30.752 275.014C30.7301 274.902 30.6761 274.8 30.5968 274.719C30.5175 274.639 30.4165 274.584 30.3065 274.562C30.1965 274.54 30.0825 274.551 29.9789 274.595C29.8753 274.638 29.7868 274.712 29.7245 274.807C29.6622 274.901 29.6289 275.012 29.6289 275.126C29.6289 275.279 29.6886 275.425 29.795 275.533C29.9013 275.641 30.0455 275.702 30.1959 275.702Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M23.2766 289.962C23.3103 289.962 23.3433 289.952 23.3713 289.933C23.3993 289.914 23.4211 289.887 23.4339 289.855C23.4467 289.824 23.45 289.789 23.4432 289.755C23.4365 289.722 23.4201 289.691 23.3961 289.667C23.3721 289.643 23.3416 289.627 23.3084 289.62C23.2753 289.614 23.241 289.618 23.21 289.631C23.179 289.644 23.1525 289.667 23.1341 289.695C23.1157 289.724 23.106 289.758 23.1065 289.792C23.1065 289.815 23.1109 289.837 23.1194 289.858C23.128 289.879 23.1406 289.897 23.1564 289.913C23.1722 289.929 23.191 289.942 23.2116 289.95C23.2322 289.959 23.2543 289.963 23.2766 289.962Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M135.885 15.8811C135.924 15.8811 135.963 15.8694 135.995 15.8474C136.028 15.8254 136.053 15.7941 136.068 15.7575C136.083 15.7209 136.087 15.6806 136.079 15.6417C136.071 15.6029 136.053 15.5672 136.025 15.5391C135.997 15.5111 135.962 15.492 135.924 15.4843C135.886 15.4766 135.846 15.4806 135.81 15.4957C135.774 15.5109 135.743 15.5366 135.721 15.5695C135.7 15.6024 135.688 15.6412 135.688 15.6808C135.688 15.7071 135.693 15.7332 135.703 15.7575C135.713 15.7818 135.727 15.8038 135.746 15.8225C135.764 15.8411 135.786 15.8558 135.81 15.8659C135.834 15.8759 135.859 15.8811 135.885 15.8811Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M131.816 32.0635C131.945 32.0639 132.071 32.0255 132.178 31.953C132.286 31.8806 132.37 31.7775 132.419 31.6566C132.469 31.5358 132.482 31.4028 132.457 31.2745C132.432 31.1461 132.369 31.0282 132.278 30.9357C132.187 30.8432 132.071 30.7802 131.944 30.7548C131.818 30.7294 131.687 30.7426 131.568 30.7929C131.449 30.8432 131.347 30.9282 131.276 31.0371C131.204 31.1461 131.167 31.2741 131.167 31.405C131.167 31.4915 131.184 31.5771 131.216 31.657C131.249 31.7369 131.297 31.8095 131.357 31.8706C131.417 31.9318 131.489 31.9803 131.568 32.0134C131.646 32.0465 131.731 32.0635 131.816 32.0635Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M127.578 48.2065C128.187 48.2065 128.681 47.7055 128.681 47.0876C128.681 46.4697 128.187 45.9688 127.578 45.9688C126.969 45.9688 126.476 46.4697 126.476 47.0876C126.476 47.7055 126.969 48.2065 127.578 48.2065Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M123.172 64.3231C124.047 64.3231 124.756 63.6037 124.756 62.7163C124.756 61.8288 124.047 61.1094 123.172 61.1094C122.298 61.1094 121.589 61.8288 121.589 62.7163C121.589 63.6037 122.298 64.3231 123.172 64.3231Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M118.607 80.3933C119.016 80.3937 119.415 80.2711 119.755 80.0409C120.096 79.8108 120.361 79.4834 120.517 79.1003C120.674 78.7171 120.715 78.2954 120.636 77.8885C120.556 77.4815 120.36 77.1077 120.071 76.8142C119.782 76.5207 119.414 76.3208 119.013 76.2397C118.612 76.1586 118.196 76.2 117.819 76.3586C117.441 76.5173 117.118 76.7861 116.891 77.131C116.664 77.4759 116.542 77.8814 116.542 78.2963C116.542 78.8521 116.76 79.3851 117.147 79.7784C117.534 80.1716 118.059 80.3928 118.607 80.3933Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M113.856 96.3516C114.348 96.3516 114.829 96.2035 115.239 95.926C115.648 95.6485 115.967 95.2541 116.155 94.7926C116.344 94.3312 116.393 93.8234 116.297 93.3335C116.201 92.8436 115.964 92.3936 115.616 92.0405C115.268 91.6873 114.824 91.4468 114.342 91.3493C113.859 91.2519 113.359 91.3019 112.904 91.493C112.449 91.6842 112.061 92.0078 111.787 92.4232C111.514 92.8385 111.368 93.3267 111.368 93.8262C111.368 94.496 111.63 95.1383 112.097 95.6119C112.563 96.0855 113.196 96.3516 113.856 96.3516Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M108.947 112.199C109.512 112.199 110.064 112.029 110.534 111.711C111.003 111.392 111.369 110.939 111.585 110.41C111.802 109.88 111.858 109.298 111.748 108.735C111.638 108.173 111.366 107.657 110.966 107.251C110.567 106.846 110.058 106.57 109.504 106.458C108.95 106.346 108.376 106.404 107.854 106.623C107.332 106.842 106.886 107.214 106.572 107.69C106.258 108.167 106.091 108.727 106.091 109.301C106.091 110.069 106.392 110.807 106.927 111.35C107.463 111.894 108.189 112.199 108.947 112.199Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M103.871 127.935C105.62 127.935 107.038 126.497 107.038 124.722C107.038 122.947 105.62 121.508 103.871 121.508C102.122 121.508 100.704 122.947 100.704 124.722C100.704 126.497 102.122 127.935 103.871 127.935Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M101.846 141.061C102.385 139.255 101.379 137.348 99.5992 136.802C97.8197 136.255 95.9406 137.276 95.402 139.082C94.8634 140.888 95.8693 142.795 97.6487 143.341C99.4282 143.888 101.307 142.867 101.846 141.061Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M93.2238 158.894C93.9062 158.894 94.5733 158.688 95.1407 158.303C95.7081 157.919 96.1503 157.372 96.4114 156.732C96.6726 156.092 96.7409 155.388 96.6078 154.709C96.4746 154.03 96.146 153.406 95.6635 152.916C95.181 152.427 94.5662 152.093 93.8969 151.958C93.2276 151.823 92.5338 151.892 91.9034 152.157C91.2729 152.422 90.734 152.871 90.3549 153.447C89.9758 154.023 89.7734 154.7 89.7734 155.392C89.7732 155.852 89.8622 156.307 90.0355 156.732C90.2088 157.157 90.4629 157.543 90.7834 157.869C91.1038 158.194 91.4843 158.452 91.903 158.628C92.3218 158.803 92.7706 158.894 93.2238 158.894Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M87.6544 174.136C88.3368 174.136 89.0039 173.93 89.5713 173.546C90.1387 173.161 90.581 172.614 90.8421 171.974C91.1033 171.334 91.1716 170.63 91.0385 169.951C90.9053 169.272 90.5767 168.648 90.0942 168.158C89.6116 167.669 88.9968 167.335 88.3276 167.2C87.6583 167.065 86.9645 167.134 86.334 167.399C85.7036 167.664 85.1647 168.113 84.7856 168.689C84.4065 169.265 84.2041 169.942 84.2041 170.634C84.2038 171.094 84.2929 171.55 84.4662 171.975C84.6395 172.4 84.8936 172.786 85.2141 173.111C85.5345 173.436 85.915 173.694 86.3337 173.87C86.7525 174.046 87.2012 174.136 87.6544 174.136Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M81.9194 189.203C82.5799 189.203 83.2257 189.005 83.7751 188.633C84.3244 188.261 84.7527 187.732 85.0058 187.113C85.2588 186.493 85.3253 185.812 85.1967 185.155C85.0681 184.497 84.7502 183.893 84.2833 183.419C83.8164 182.945 83.2215 182.622 82.5737 182.491C81.926 182.36 81.2545 182.427 80.6442 182.684C80.034 182.94 79.5124 183.374 79.1454 183.932C78.7784 184.489 78.5825 185.144 78.5825 185.814C78.5822 186.259 78.6683 186.7 78.8359 187.111C79.0035 187.522 79.2493 187.896 79.5591 188.21C79.869 188.525 80.237 188.775 80.642 188.945C81.047 189.115 81.4811 189.203 81.9194 189.203Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M76.0203 204.09C76.636 204.091 77.238 203.906 77.7501 203.559C78.2623 203.212 78.6615 202.719 78.8973 202.141C79.1331 201.564 79.1949 200.929 79.0749 200.316C78.9549 199.703 78.6584 199.14 78.223 198.699C77.7877 198.257 77.2329 197.956 76.629 197.834C76.0251 197.712 75.3992 197.775 74.8304 198.014C74.2616 198.254 73.7756 198.659 73.4338 199.178C73.092 199.698 72.9097 200.309 72.9102 200.934C72.9102 201.771 73.2378 202.574 73.8211 203.166C74.4044 203.758 75.1954 204.09 76.0203 204.09Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M69.9619 218.823C70.5158 218.822 71.0571 218.654 71.5173 218.341C71.9775 218.028 72.3359 217.584 72.5472 217.064C72.7586 216.544 72.8133 215.973 72.7046 215.422C72.5959 214.87 72.3285 214.364 71.9363 213.967C71.5442 213.57 71.0448 213.3 70.5014 213.191C69.9579 213.082 69.3948 213.139 68.8832 213.354C68.3716 213.57 67.9344 213.935 67.6271 214.402C67.3197 214.87 67.1558 215.42 67.1563 215.982C67.1562 216.355 67.2289 216.725 67.3699 217.07C67.511 217.416 67.7178 217.729 67.9784 217.993C68.239 218.257 68.5483 218.466 68.8887 218.608C69.229 218.751 69.5937 218.823 69.9619 218.823Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M63.7395 233.404C64.215 233.404 64.6799 233.261 65.0754 232.993C65.4708 232.724 65.779 232.343 65.961 231.897C66.1429 231.452 66.1906 230.961 66.0978 230.488C66.005 230.014 65.776 229.579 65.4397 229.238C65.1035 228.897 64.675 228.664 64.2086 228.57C63.7421 228.476 63.2587 228.525 62.8193 228.709C62.3799 228.894 62.0044 229.207 61.7402 229.608C61.476 230.009 61.335 230.481 61.335 230.964C61.335 231.611 61.5883 232.231 62.0392 232.689C62.4902 233.147 63.1018 233.404 63.7395 233.404Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M57.3578 247.887C57.7495 247.887 58.1325 247.769 58.4582 247.548C58.7839 247.327 59.0377 247.013 59.1875 246.645C59.3373 246.278 59.3764 245.874 59.2999 245.484C59.2233 245.094 59.0345 244.736 58.7573 244.455C58.4801 244.174 58.1271 243.983 57.7428 243.906C57.3585 243.828 56.9603 243.868 56.5985 244.021C56.2366 244.173 55.9275 244.431 55.7102 244.762C55.4928 245.093 55.377 245.481 55.3774 245.879C55.378 246.412 55.5869 246.922 55.9582 247.299C56.3295 247.675 56.8329 247.887 57.3578 247.887Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M50.8138 262.267C51.1163 262.267 51.4121 262.177 51.6638 262.007C51.9154 261.836 52.1117 261.594 52.2278 261.311C52.3438 261.027 52.3744 260.715 52.3156 260.414C52.2569 260.113 52.1114 259.836 51.8977 259.619C51.684 259.402 51.4116 259.254 51.115 259.194C50.8183 259.134 50.5108 259.165 50.2314 259.282C49.9519 259.399 49.713 259.598 49.5449 259.853C49.3768 260.109 49.2871 260.409 49.2871 260.716C49.2868 260.919 49.3261 261.121 49.4027 261.309C49.4793 261.497 49.5917 261.668 49.7335 261.812C49.8753 261.957 50.0437 262.071 50.2291 262.149C50.4145 262.227 50.6132 262.267 50.8138 262.267Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M44.113 276.545C44.3207 276.545 44.5237 276.483 44.6963 276.366C44.869 276.249 45.0036 276.082 45.0831 275.887C45.1625 275.693 45.1833 275.478 45.1428 275.272C45.1023 275.065 45.0023 274.875 44.8555 274.726C44.7086 274.577 44.5215 274.476 44.3178 274.435C44.1142 274.393 43.903 274.415 43.7112 274.495C43.5193 274.576 43.3553 274.712 43.2399 274.888C43.1246 275.063 43.063 275.269 43.063 275.48C43.063 275.762 43.1736 276.033 43.3705 276.233C43.5674 276.433 43.8345 276.545 44.113 276.545Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M37.2521 290.752C37.3642 290.752 37.4738 290.719 37.5671 290.655C37.6603 290.592 37.733 290.502 37.7759 290.397C37.8188 290.292 37.8301 290.176 37.8082 290.065C37.7863 289.953 37.7323 289.851 37.653 289.77C37.5737 289.69 37.4727 289.635 37.3627 289.613C37.2527 289.59 37.1387 289.602 37.0351 289.645C36.9315 289.689 36.8429 289.763 36.7806 289.857C36.7183 289.952 36.6851 290.063 36.6851 290.177C36.6851 290.33 36.7448 290.476 36.8511 290.584C36.9575 290.692 37.1017 290.752 37.2521 290.752Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M30.2341 304.934C30.2618 304.934 30.2888 304.925 30.3117 304.909C30.3346 304.893 30.3523 304.871 30.3626 304.844C30.3729 304.818 30.3754 304.79 30.3697 304.762C30.3641 304.735 30.3505 304.709 30.3308 304.69C30.311 304.67 30.2859 304.656 30.2587 304.651C30.2315 304.646 30.2033 304.649 30.1777 304.66C30.1521 304.67 30.1303 304.689 30.1149 304.712C30.0995 304.736 30.0913 304.763 30.0913 304.791C30.0913 304.81 30.095 304.829 30.1022 304.846C30.1094 304.864 30.12 304.88 30.1333 304.893C30.1465 304.906 30.1623 304.917 30.1796 304.924C30.1969 304.931 30.2155 304.934 30.2341 304.934Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M149.027 16.0928C149.095 16.0928 149.16 16.0725 149.216 16.0345C149.272 15.9965 149.316 15.9424 149.342 15.8792C149.367 15.816 149.374 15.7465 149.361 15.6794C149.347 15.6124 149.315 15.5509 149.267 15.5027C149.219 15.4545 149.158 15.4218 149.092 15.4087C149.026 15.3956 148.958 15.4028 148.896 15.4292C148.833 15.4557 148.78 15.5003 148.743 15.5573C148.706 15.6144 148.687 15.6813 148.687 15.7497C148.688 15.8409 148.724 15.9282 148.787 15.9925C148.851 16.0568 148.937 16.0928 149.027 16.0928Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M144.993 32.315C145.156 32.315 145.315 32.2661 145.45 32.1746C145.585 32.083 145.69 31.9529 145.752 31.8006C145.814 31.6483 145.83 31.4808 145.799 31.3192C145.767 31.1575 145.689 31.009 145.574 30.8925C145.459 30.776 145.313 30.6966 145.154 30.6644C144.994 30.6323 144.829 30.6488 144.679 30.7119C144.529 30.7749 144.401 30.8817 144.311 31.0188C144.221 31.1558 144.172 31.3169 144.172 31.4817C144.172 31.7027 144.259 31.9147 144.413 32.0709C144.567 32.2272 144.776 32.315 144.993 32.315Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M140.791 48.5183C141.054 48.5183 141.311 48.4392 141.53 48.291C141.748 48.1428 141.919 47.9321 142.019 47.6856C142.12 47.4391 142.146 47.1678 142.095 46.9062C142.044 46.6445 141.917 46.4041 141.731 46.2154C141.545 46.0268 141.308 45.8983 141.051 45.8462C140.793 45.7942 140.525 45.8209 140.283 45.923C140.04 46.0251 139.832 46.198 139.686 46.4199C139.54 46.6417 139.462 46.9025 139.462 47.1693C139.462 47.5271 139.602 47.8702 139.851 48.1232C140.101 48.3762 140.439 48.5183 140.791 48.5183Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M136.421 64.7072C136.79 64.7072 137.151 64.596 137.458 64.3879C137.765 64.1797 138.005 63.8838 138.146 63.5376C138.287 63.1914 138.324 62.8105 138.252 62.4429C138.18 62.0754 138.002 61.7378 137.741 61.4729C137.48 61.2079 137.147 61.0275 136.785 60.9544C136.423 60.8813 136.048 60.9188 135.707 61.0622C135.366 61.2056 135.074 61.4484 134.869 61.76C134.664 62.0715 134.554 62.4378 134.554 62.8126C134.554 63.315 134.751 63.7969 135.101 64.1522C135.451 64.5076 135.926 64.7072 136.421 64.7072Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M131.885 80.8171C132.355 80.8175 132.815 80.6764 133.206 80.4116C133.597 80.1467 133.902 79.7701 134.083 79.3293C134.263 78.8886 134.31 78.4034 134.219 77.9353C134.127 77.4672 133.901 77.0371 133.569 76.6995C133.236 76.3619 132.813 76.132 132.352 76.0387C131.89 75.9454 131.412 75.9931 130.978 76.1756C130.543 76.3582 130.172 76.6674 129.911 77.0641C129.649 77.4609 129.51 77.9274 129.51 78.4046C129.509 78.7214 129.571 79.035 129.69 79.3277C129.809 79.6204 129.984 79.8863 130.205 80.1104C130.425 80.3344 130.687 80.5122 130.975 80.6334C131.264 80.7547 131.573 80.8171 131.885 80.8171Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M127.183 96.8397C127.748 96.8397 128.3 96.6697 128.77 96.3512C129.24 96.0328 129.606 95.5801 129.822 95.0505C130.038 94.5209 130.095 93.9381 129.984 93.3759C129.874 92.8137 129.602 92.2972 129.203 91.8919C128.803 91.4865 128.294 91.2105 127.74 91.0987C127.186 90.9868 126.612 91.0442 126.09 91.2636C125.568 91.483 125.122 91.8545 124.808 92.3311C124.495 92.8077 124.327 93.3681 124.327 93.9413C124.327 94.71 124.628 95.4472 125.164 95.9908C125.699 96.5343 126.426 96.8397 127.183 96.8397Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M122.315 112.767C122.964 112.765 123.597 112.569 124.136 112.202C124.674 111.835 125.093 111.315 125.34 110.706C125.587 110.098 125.651 109.429 125.523 108.784C125.396 108.138 125.083 107.546 124.624 107.081C124.164 106.617 123.58 106.3 122.944 106.173C122.308 106.045 121.649 106.111 121.05 106.364C120.451 106.616 119.939 107.042 119.579 107.59C119.219 108.137 119.027 108.78 119.027 109.438C119.027 109.876 119.112 110.31 119.277 110.714C119.443 111.119 119.685 111.486 119.991 111.795C120.296 112.104 120.659 112.349 121.058 112.516C121.457 112.683 121.884 112.768 122.315 112.767Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M117.282 128.576C118.004 128.576 118.709 128.359 119.31 127.953C119.911 127.546 120.379 126.967 120.655 126.29C120.932 125.613 121.004 124.869 120.863 124.15C120.723 123.431 120.375 122.771 119.864 122.253C119.354 121.735 118.703 121.382 117.995 121.239C117.287 121.096 116.553 121.17 115.886 121.45C115.219 121.731 114.649 122.206 114.248 122.815C113.847 123.425 113.633 124.141 113.634 124.874C113.634 125.856 114.018 126.797 114.702 127.492C115.386 128.186 116.314 128.576 117.282 128.576Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M112.084 144.213C112.856 144.213 113.611 143.98 114.253 143.545C114.895 143.109 115.396 142.491 115.691 141.766C115.986 141.042 116.064 140.246 115.913 139.477C115.762 138.709 115.39 138.003 114.844 137.449C114.298 136.895 113.602 136.518 112.844 136.365C112.087 136.212 111.302 136.291 110.589 136.591C109.875 136.891 109.266 137.4 108.837 138.051C108.408 138.703 108.18 139.469 108.18 140.253C108.18 140.773 108.281 141.288 108.477 141.769C108.674 142.249 108.961 142.686 109.324 143.054C109.686 143.421 110.117 143.713 110.59 143.912C111.064 144.111 111.572 144.213 112.084 144.213Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M106.723 159.678C107.523 159.678 108.305 159.437 108.97 158.986C109.635 158.535 110.153 157.894 110.46 157.144C110.766 156.394 110.846 155.569 110.69 154.773C110.534 153.976 110.148 153.245 109.583 152.671C109.017 152.097 108.296 151.706 107.512 151.548C106.727 151.389 105.914 151.471 105.175 151.781C104.436 152.092 103.804 152.618 103.36 153.293C102.915 153.968 102.678 154.762 102.678 155.573C102.679 156.662 103.105 157.705 103.863 158.475C104.622 159.245 105.65 159.677 106.723 159.678Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M101.197 174.964C102.003 174.965 102.791 174.722 103.462 174.268C104.132 173.814 104.654 173.168 104.963 172.413C105.272 171.657 105.352 170.826 105.195 170.024C105.038 169.221 104.65 168.485 104.08 167.906C103.51 167.328 102.784 166.934 101.994 166.775C101.203 166.615 100.384 166.697 99.6395 167.01C98.895 167.324 98.2587 167.854 97.8112 168.534C97.3637 169.214 97.1251 170.014 97.1255 170.832C97.1255 171.928 97.5545 172.979 98.3181 173.754C99.0818 174.529 100.117 174.964 101.197 174.964Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M95.5066 190.079C96.2958 190.079 97.0672 189.841 97.7234 189.396C98.3795 188.952 98.8909 188.319 99.1929 187.579C99.4949 186.839 99.5739 186.025 99.42 185.24C99.266 184.454 98.886 183.733 98.328 183.166C97.77 182.6 97.059 182.215 96.285 182.058C95.5111 181.902 94.7088 181.982 93.9797 182.289C93.2506 182.595 92.6275 183.114 92.189 183.78C91.7506 184.446 91.5166 185.229 91.5166 186.03C91.5166 187.104 91.937 188.134 92.6853 188.893C93.4335 189.652 94.4484 190.079 95.5066 190.079Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M89.6622 204.985C90.4059 204.985 91.1329 204.761 91.7511 204.341C92.3694 203.921 92.8511 203.325 93.1355 202.628C93.4198 201.93 93.494 201.163 93.3486 200.423C93.2033 199.682 92.8449 199.002 92.3188 198.469C91.7927 197.935 91.1226 197.572 90.393 197.425C89.6635 197.278 88.9074 197.353 88.2202 197.642C87.5331 197.931 86.9458 198.42 86.5326 199.048C86.1195 199.676 85.8989 200.414 85.8989 201.168C85.8989 201.67 85.9963 202.166 86.1854 202.63C86.3746 203.093 86.6518 203.514 87.0013 203.868C87.3508 204.223 87.7656 204.504 88.2222 204.695C88.6788 204.887 89.1681 204.986 89.6622 204.985Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M86.0714 218.695C87.4082 217.338 87.4082 215.139 86.0714 213.782C84.7346 212.425 82.5673 212.425 81.2305 213.782C79.8937 215.139 79.8937 217.338 81.2305 218.695C82.5673 220.051 84.7346 220.051 86.0714 218.695Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M77.4802 234.31C78.0787 234.31 78.6638 234.13 79.1614 233.792C79.6591 233.455 80.047 232.975 80.276 232.414C80.505 231.853 80.565 231.236 80.4482 230.64C80.3314 230.044 80.0432 229.497 79.62 229.067C79.1968 228.638 78.6576 228.345 78.0706 228.227C77.4836 228.108 76.8751 228.169 76.3222 228.402C75.7692 228.634 75.2966 229.028 74.9641 229.533C74.6316 230.038 74.4541 230.632 74.4541 231.239C74.4541 232.053 74.7729 232.835 75.3404 233.41C75.9079 233.986 76.6776 234.31 77.4802 234.31Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M71.1464 248.792C71.6556 248.792 72.1534 248.639 72.5768 248.352C73.0002 248.065 73.3302 247.656 73.525 247.179C73.7199 246.702 73.7709 246.176 73.6715 245.669C73.5722 245.163 73.327 244.697 72.9669 244.332C72.6069 243.966 72.1481 243.717 71.6487 243.617C71.1493 243.516 70.6316 243.568 70.1611 243.765C69.6907 243.963 69.2886 244.298 69.0057 244.728C68.7228 245.157 68.5718 245.662 68.5718 246.179C68.5718 246.872 68.843 247.537 69.3259 248.027C69.8087 248.517 70.4636 248.792 71.1464 248.792Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M64.6595 263.135C65.0678 263.135 65.4669 263.012 65.8064 262.782C66.1459 262.552 66.4105 262.225 66.5667 261.842C66.7229 261.459 66.7638 261.038 66.6842 260.632C66.6045 260.225 66.4079 259.852 66.1192 259.559C65.8305 259.266 65.4627 259.066 65.0623 258.986C64.6618 258.905 64.2468 258.946 63.8696 259.105C63.4923 259.263 63.1699 259.532 62.9431 259.876C62.7163 260.221 62.5952 260.626 62.5952 261.04C62.5952 261.596 62.8127 262.129 63.1998 262.522C63.587 262.914 64.112 263.135 64.6595 263.135Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M58.0106 277.412C58.3184 277.413 58.6195 277.32 58.8757 277.147C59.1318 276.974 59.3316 276.727 59.4497 276.439C59.5678 276.15 59.5989 275.833 59.5391 275.526C59.4793 275.22 59.3313 274.938 59.1137 274.717C58.8962 274.496 58.6189 274.346 58.317 274.284C58.0151 274.223 57.7021 274.254 57.4176 274.374C57.1332 274.493 56.89 274.696 56.7189 274.956C56.5479 275.215 56.4565 275.521 56.4565 275.833C56.4565 276.252 56.6202 276.653 56.9116 276.949C57.2029 277.245 57.5982 277.412 58.0106 277.412Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M51.2045 291.587C51.767 291.587 52.223 291.124 52.223 290.553C52.223 289.982 51.767 289.52 51.2045 289.52C50.642 289.52 50.186 289.982 50.186 290.553C50.186 291.124 50.642 291.587 51.2045 291.587Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M44.2452 305.711C44.3456 305.711 44.4436 305.68 44.5269 305.623C44.6102 305.566 44.675 305.486 44.7132 305.391C44.7513 305.297 44.7611 305.193 44.7412 305.094C44.7214 304.994 44.6728 304.902 44.6017 304.83C44.5305 304.758 44.44 304.709 44.3414 304.689C44.2429 304.67 44.1408 304.68 44.0481 304.719C43.9554 304.758 43.8761 304.824 43.8204 304.909C43.7646 304.994 43.7349 305.094 43.7349 305.195C43.7349 305.263 43.7481 305.331 43.7737 305.393C43.7994 305.456 43.837 305.513 43.8845 305.561C43.9319 305.609 43.9881 305.647 44.05 305.673C44.1119 305.698 44.1783 305.711 44.2452 305.711Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M37.1236 319.845C37.1697 319.845 37.2071 319.807 37.2071 319.761C37.2071 319.714 37.1697 319.676 37.1236 319.676C37.0774 319.676 37.04 319.714 37.04 319.761C37.04 319.807 37.0774 319.845 37.1236 319.845Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M165.995 0.0572995C166.003 0.0572995 166.011 0.0541739 166.016 0.04861C166.022 0.043046 166.025 0.0354997 166.025 0.0276311C166.025 0.0238278 166.024 0.0200639 166.022 0.0165754C166.021 0.0130869 166.019 0.00994919 166.016 0.00736124C166.013 0.00477329 166.01 0.00279119 166.007 0.00153832C166.003 0.000285446 165.999 -0.000211001 165.995 8.15767e-05C165.988 8.15767e-05 165.981 0.00298455 165.976 0.00815105C165.971 0.0133175 165.968 0.0203246 165.968 0.0276311C165.968 0.0314231 165.969 0.0352349 165.97 0.0388259C165.971 0.0424169 165.973 0.0457098 165.976 0.0484968C165.978 0.0512838 165.981 0.0535047 165.985 0.0550198C165.988 0.0565349 165.992 0.0573108 165.995 0.0572995Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.163 16.2431C162.246 16.2431 162.327 16.2181 162.397 16.1713C162.466 16.1244 162.519 16.0579 162.551 15.98C162.583 15.9021 162.591 15.8164 162.575 15.7337C162.559 15.651 162.519 15.5751 162.46 15.5155C162.401 15.4559 162.327 15.4153 162.245 15.3988C162.164 15.3824 162.079 15.3908 162.002 15.4231C161.926 15.4553 161.86 15.51 161.814 15.5801C161.768 15.6501 161.743 15.7326 161.743 15.8169C161.743 15.9299 161.787 16.0383 161.866 16.1182C161.945 16.1982 162.052 16.2431 162.163 16.2431Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M158.163 32.5061C158.347 32.5061 158.528 32.4505 158.682 32.3463C158.835 32.2421 158.955 32.0939 159.026 31.9207C159.097 31.7474 159.115 31.5567 159.079 31.3727C159.043 31.1888 158.954 31.0198 158.823 30.8871C158.693 30.7545 158.526 30.6642 158.345 30.6276C158.164 30.591 157.976 30.6098 157.805 30.6816C157.634 30.7533 157.488 30.8749 157.386 31.0309C157.283 31.1868 157.228 31.3702 157.228 31.5577C157.228 31.6824 157.252 31.8058 157.299 31.921C157.345 32.0362 157.414 32.1408 157.501 32.229C157.588 32.3171 157.691 32.3869 157.805 32.4345C157.918 32.482 158.04 32.5064 158.163 32.5061Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M153.994 48.7738C154.291 48.7737 154.581 48.6845 154.827 48.5172C155.074 48.3499 155.266 48.1121 155.38 47.8339C155.493 47.5558 155.523 47.2497 155.464 46.9545C155.406 46.6592 155.263 46.3881 155.054 46.1754C154.844 45.9627 154.576 45.8179 154.285 45.7594C153.994 45.701 153.693 45.7314 153.419 45.8469C153.145 45.9624 152.911 46.1578 152.746 46.4083C152.582 46.6588 152.494 46.9532 152.495 47.2542C152.495 47.6574 152.653 48.0439 152.935 48.3288C153.216 48.6137 153.597 48.7738 153.994 48.7738Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M149.661 65.0023C150.07 65.0023 150.469 64.8795 150.808 64.6493C151.148 64.4191 151.412 64.0919 151.569 63.7091C151.725 63.3263 151.766 62.9051 151.686 62.4987C151.606 62.0923 151.41 61.7191 151.121 61.4261C150.832 61.1331 150.465 60.9336 150.064 60.8528C149.664 60.7719 149.249 60.8134 148.872 60.972C148.494 61.1305 148.172 61.399 147.945 61.7435C147.718 62.0881 147.597 62.4931 147.597 62.9074C147.597 63.463 147.815 63.9959 148.202 64.3888C148.589 64.7816 149.114 65.0023 149.661 65.0023Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M145.164 81.1805C145.684 81.1805 146.193 81.0238 146.626 80.7303C147.058 80.4368 147.396 80.0196 147.595 79.5316C147.794 79.0435 147.846 78.5065 147.744 77.9884C147.642 77.4704 147.392 76.9946 147.023 76.6212C146.655 76.2478 146.186 75.9937 145.676 75.8909C145.165 75.7881 144.636 75.8413 144.155 76.0437C143.674 76.2462 143.264 76.5888 142.975 77.0282C142.686 77.4676 142.532 77.9841 142.532 78.5123C142.532 78.863 142.6 79.2102 142.732 79.5342C142.864 79.8582 143.058 80.1525 143.302 80.4004C143.547 80.6482 143.837 80.8447 144.156 80.9786C144.476 81.1125 144.818 81.1811 145.164 81.1805Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M141.222 97.201C142.924 96.7933 143.978 95.0624 143.576 93.335C143.175 91.6075 141.469 90.5376 139.767 90.9454C138.064 91.3531 137.01 93.084 137.412 94.8114C137.814 96.5389 139.519 97.6087 141.222 97.201Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M136.316 113.247C138.315 112.883 139.645 110.944 139.287 108.915C138.929 106.887 137.018 105.537 135.019 105.9C133.02 106.264 131.69 108.203 132.048 110.232C132.406 112.26 134.317 113.61 136.316 113.247Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M130.68 129.176C131.491 129.178 132.285 128.935 132.961 128.478C133.637 128.022 134.164 127.372 134.475 126.612C134.787 125.851 134.869 125.014 134.712 124.206C134.554 123.398 134.164 122.656 133.591 122.073C133.017 121.49 132.286 121.093 131.49 120.932C130.694 120.771 129.869 120.853 129.119 121.168C128.369 121.483 127.728 122.017 127.278 122.702C126.827 123.387 126.587 124.192 126.587 125.016C126.587 126.118 127.018 127.175 127.785 127.955C128.553 128.735 129.594 129.174 130.68 129.176Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M125.524 144.917C127.976 144.917 129.963 142.9 129.963 140.411C129.963 137.923 127.976 135.906 125.524 135.906C123.072 135.906 121.084 137.923 121.084 140.411C121.084 142.9 123.072 144.917 125.524 144.917Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M120.209 160.454C121.126 160.454 122.023 160.178 122.786 159.661C123.549 159.144 124.143 158.409 124.495 157.548C124.846 156.688 124.938 155.742 124.759 154.828C124.58 153.915 124.138 153.076 123.489 152.418C122.84 151.76 122.014 151.311 121.114 151.13C120.214 150.948 119.281 151.041 118.434 151.397C117.586 151.754 116.861 152.357 116.352 153.131C115.842 153.905 115.57 154.816 115.57 155.747C115.57 156.365 115.69 156.977 115.923 157.548C116.156 158.12 116.498 158.638 116.929 159.076C117.359 159.513 117.871 159.86 118.434 160.096C118.996 160.333 119.6 160.454 120.209 160.454Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M114.728 175.816C115.662 175.815 116.574 175.532 117.35 175.004C118.125 174.477 118.729 173.728 119.085 172.852C119.442 171.976 119.534 171.012 119.351 170.083C119.167 169.154 118.717 168.301 118.056 167.631C117.395 166.962 116.554 166.506 115.638 166.322C114.722 166.138 113.773 166.233 112.91 166.596C112.048 166.959 111.311 167.573 110.792 168.361C110.273 169.149 109.997 170.076 109.997 171.023C109.996 171.654 110.119 172.278 110.356 172.86C110.594 173.442 110.943 173.971 111.382 174.416C111.822 174.861 112.344 175.214 112.918 175.455C113.492 175.695 114.107 175.818 114.728 175.816Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M109.088 190.951C110.005 190.951 110.902 190.675 111.665 190.158C112.428 189.641 113.023 188.906 113.375 188.046C113.726 187.186 113.818 186.239 113.64 185.326C113.461 184.412 113.019 183.573 112.371 182.915C111.722 182.256 110.895 181.808 109.995 181.626C109.095 181.444 108.163 181.537 107.315 181.893C106.467 182.25 105.742 182.853 105.233 183.627C104.723 184.401 104.451 185.312 104.451 186.243C104.451 187.491 104.939 188.688 105.809 189.571C106.678 190.454 107.858 190.95 109.088 190.951Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M103.287 205.873C104.159 205.873 105.012 205.61 105.737 205.118C106.462 204.627 107.028 203.928 107.361 203.11C107.695 202.292 107.782 201.392 107.612 200.524C107.442 199.656 107.022 198.859 106.405 198.233C105.789 197.607 105.003 197.181 104.147 197.008C103.292 196.835 102.405 196.924 101.599 197.263C100.794 197.601 100.105 198.175 99.6202 198.911C99.1356 199.647 98.877 200.512 98.877 201.397C98.877 202.584 99.3416 203.723 100.169 204.562C100.996 205.401 102.117 205.873 103.287 205.873Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M97.325 220.66C98.1361 220.66 98.9291 220.416 99.6035 219.959C100.278 219.501 100.804 218.851 101.114 218.091C101.425 217.33 101.506 216.493 101.347 215.686C101.189 214.879 100.799 214.137 100.225 213.555C99.6514 212.973 98.9207 212.577 98.1251 212.416C97.3295 212.255 96.5049 212.338 95.7554 212.653C95.006 212.968 94.3655 213.501 93.9148 214.186C93.4642 214.87 93.2236 215.675 93.2236 216.498C93.2236 217.602 93.6557 218.661 94.4249 219.441C95.194 220.222 96.2372 220.66 97.325 220.66Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M91.2034 235.212C91.9248 235.212 92.6301 234.995 93.2299 234.588C93.8298 234.182 94.2974 233.603 94.5734 232.927C94.8495 232.251 94.9218 231.506 94.781 230.788C94.6403 230.07 94.2929 229.411 93.7827 228.893C93.2726 228.375 92.6226 228.023 91.915 227.88C91.2074 227.737 90.474 227.81 89.8075 228.09C89.1409 228.371 88.5712 228.845 88.1704 229.454C87.7696 230.063 87.5557 230.778 87.5557 231.51C87.5562 232.492 87.9407 233.433 88.6247 234.127C89.3086 234.821 90.2361 235.212 91.2034 235.212Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M85.44 249.634C87.1664 249.35 88.3388 247.699 88.0585 245.947C87.7783 244.195 86.1516 243.005 84.4252 243.29C82.6988 243.574 81.5265 245.225 81.8067 246.977C82.087 248.729 83.7136 249.919 85.44 249.634Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M78.4962 264.024C79.0166 264.023 79.5248 263.864 79.9566 263.569C80.3884 263.275 80.7244 262.857 80.922 262.368C81.1196 261.879 81.17 261.342 81.0669 260.825C80.9637 260.307 80.7116 259.832 80.3424 259.46C79.9733 259.087 79.5036 258.835 78.9929 258.733C78.4821 258.632 77.9532 258.686 77.4731 258.89C76.9929 259.094 76.583 259.437 76.2953 259.877C76.0075 260.318 75.8548 260.834 75.8565 261.362C75.8576 261.713 75.9267 262.06 76.06 262.384C76.1932 262.707 76.388 263.001 76.6331 263.248C76.8782 263.495 77.1689 263.691 77.4886 263.824C77.8082 263.957 78.1506 264.025 78.4962 264.024Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M71.8919 278.268C72.3008 278.269 72.7006 278.146 73.0408 277.916C73.3809 277.686 73.6461 277.358 73.8028 276.975C73.9594 276.591 74.0005 276.17 73.9209 275.763C73.8412 275.356 73.6443 274.982 73.3552 274.688C73.0661 274.395 72.6977 274.195 72.2967 274.114C71.8956 274.034 71.48 274.075 71.1023 274.234C70.7246 274.393 70.4019 274.662 70.175 275.008C69.9481 275.353 69.8272 275.758 69.8276 276.173C69.8276 276.729 70.0451 277.262 70.4323 277.655C70.8194 278.048 71.3445 278.268 71.8919 278.268Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M65.1425 292.438C65.439 292.438 65.7289 292.349 65.9755 292.181C66.2221 292.014 66.4143 291.777 66.5278 291.498C66.6412 291.22 66.6709 290.914 66.6131 290.619C66.5552 290.324 66.4124 290.053 66.2027 289.84C65.993 289.627 65.7259 289.482 65.435 289.424C65.1441 289.365 64.8427 289.395 64.5687 289.51C64.2947 289.626 64.0605 289.821 63.8958 290.071C63.731 290.321 63.6431 290.615 63.6431 290.916C63.6431 291.32 63.801 291.707 64.0822 291.992C64.3634 292.277 64.7448 292.438 65.1425 292.438Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M58.2353 306.545C58.4201 306.545 58.6008 306.49 58.7545 306.385C58.9081 306.281 59.0279 306.133 59.0987 305.96C59.1694 305.786 59.1879 305.596 59.1518 305.412C59.1158 305.228 59.0268 305.059 58.8961 304.926C58.7654 304.794 58.5989 304.703 58.4176 304.667C58.2363 304.63 58.0484 304.649 57.8777 304.721C57.7069 304.792 57.561 304.914 57.4583 305.07C57.3556 305.226 57.3008 305.409 57.3008 305.597C57.3005 305.721 57.3245 305.845 57.3714 305.96C57.4182 306.075 57.487 306.18 57.5739 306.268C57.6607 306.356 57.7638 306.426 57.8773 306.474C57.9908 306.521 58.1125 306.545 58.2353 306.545Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M51.1729 320.61C51.256 320.61 51.3372 320.585 51.4063 320.538C51.4753 320.492 51.5292 320.425 51.561 320.347C51.5928 320.269 51.6011 320.184 51.5849 320.101C51.5687 320.018 51.5287 319.942 51.4699 319.883C51.4112 319.823 51.3363 319.782 51.2549 319.766C51.1734 319.75 51.0889 319.758 51.0122 319.79C50.9355 319.823 50.8699 319.877 50.8237 319.947C50.7776 320.017 50.7529 320.1 50.7529 320.184C50.7529 320.297 50.7972 320.405 50.8759 320.485C50.9547 320.565 51.0615 320.61 51.1729 320.61Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M43.9574 334.725C43.9652 334.725 43.9726 334.722 43.9781 334.716C43.9836 334.711 43.9866 334.703 43.9866 334.696C43.9861 334.688 43.9828 334.681 43.9774 334.676C43.9719 334.671 43.9648 334.668 43.9574 334.668C43.9502 334.668 43.9433 334.671 43.9382 334.676C43.9331 334.681 43.9303 334.688 43.9303 334.696C43.93 334.699 43.9305 334.703 43.9317 334.707C43.9329 334.71 43.9349 334.714 43.9374 334.716C43.94 334.719 43.9431 334.721 43.9465 334.723C43.9499 334.724 43.9537 334.725 43.9574 334.725Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M179.087 0.141779C179.098 0.141779 179.109 0.138423 179.118 0.132136C179.127 0.125849 179.134 0.116913 179.139 0.106457C179.143 0.0960022 179.144 0.0844978 179.142 0.0733986C179.14 0.0622994 179.134 0.0521042 179.127 0.0441021C179.119 0.0361 179.109 0.0306511 179.098 0.0284434C179.087 0.0262356 179.075 0.0273681 179.065 0.0316988C179.055 0.0360295 179.046 0.0433636 179.04 0.052773C179.034 0.0621824 179.03 0.0732452 179.03 0.0845618C179.03 0.0997369 179.036 0.11429 179.047 0.125021C179.057 0.135751 179.072 0.141779 179.087 0.141779Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M175.293 16.3951C175.393 16.3951 175.492 16.3647 175.576 16.3078C175.66 16.2509 175.725 16.1701 175.764 16.0754C175.803 15.9808 175.813 15.8767 175.793 15.7762C175.773 15.6758 175.725 15.5835 175.653 15.5111C175.582 15.4386 175.491 15.3893 175.392 15.3693C175.293 15.3493 175.19 15.3596 175.097 15.3988C175.004 15.438 174.924 15.5044 174.868 15.5895C174.812 15.6747 174.782 15.7748 174.782 15.8772C174.782 16.0146 174.836 16.1463 174.932 16.2434C175.027 16.3406 175.157 16.3951 175.293 16.3951Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M171.317 32.6937C171.525 32.6937 171.728 32.6312 171.9 32.5141C172.073 32.397 172.208 32.2306 172.287 32.0359C172.367 31.8411 172.387 31.6269 172.347 31.4202C172.306 31.2135 172.206 31.0236 172.06 30.8746C171.913 30.7256 171.726 30.6241 171.522 30.583C171.318 30.5419 171.107 30.563 170.915 30.6436C170.723 30.7243 170.559 30.8608 170.444 31.0361C170.329 31.2113 170.267 31.4173 170.267 31.6281C170.267 31.9107 170.378 32.1817 170.575 32.3816C170.772 32.5814 171.039 32.6937 171.317 32.6937Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M167.19 49.0007C167.515 49.0007 167.832 48.9031 168.102 48.7202C168.371 48.5373 168.582 48.2774 168.706 47.9733C168.83 47.6691 168.862 47.3345 168.799 47.0116C168.736 46.6887 168.58 46.3922 168.35 46.1594C168.121 45.9266 167.829 45.7681 167.51 45.7039C167.192 45.6396 166.862 45.6726 166.563 45.7986C166.263 45.9245 166.007 46.1379 165.827 46.4116C165.646 46.6853 165.55 47.0071 165.55 47.3363C165.55 47.7777 165.723 48.2011 166.031 48.5132C166.338 48.8254 166.755 49.0007 167.19 49.0007Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.894 65.2979C163.342 65.2983 163.78 65.1639 164.152 64.9117C164.525 64.6596 164.815 64.3009 164.987 63.8812C165.159 63.4614 165.204 62.9994 165.117 62.5536C165.03 62.1078 164.814 61.6983 164.498 61.3768C164.181 61.0553 163.778 60.8362 163.339 60.7474C162.899 60.6586 162.444 60.704 162.03 60.8778C161.617 61.0516 161.263 61.3461 161.014 61.7239C160.765 62.1018 160.632 62.546 160.632 63.0005C160.632 63.6094 160.871 64.1935 161.295 64.6242C161.719 65.055 162.294 65.2973 162.894 65.2979Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M158.431 81.5116C158.996 81.5116 159.548 81.3416 160.018 81.0231C160.488 80.7046 160.854 80.252 161.07 79.7224C161.286 79.1928 161.343 78.61 161.232 78.0478C161.122 77.4855 160.85 76.9691 160.451 76.5638C160.051 76.1584 159.542 75.8824 158.988 75.7705C158.434 75.6587 157.86 75.7161 157.338 75.9355C156.816 76.1548 156.37 76.5263 156.057 77.003C155.743 77.4796 155.575 78.04 155.575 78.6132C155.575 79.3819 155.876 80.1191 156.412 80.6627C156.947 81.2062 157.674 81.5116 158.431 81.5116Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M153.807 97.6905C154.49 97.6905 155.157 97.4851 155.724 97.1004C156.292 96.7156 156.734 96.1688 156.995 95.5289C157.256 94.8891 157.324 94.1851 157.191 93.5059C157.058 92.8267 156.73 92.2028 156.247 91.7131C155.764 91.2234 155.15 90.8899 154.48 90.7548C153.811 90.6197 153.117 90.689 152.487 90.954C151.856 91.2191 151.318 91.6679 150.938 92.2437C150.559 92.8195 150.357 93.4965 150.357 94.189C150.357 94.6489 150.446 95.1043 150.619 95.5293C150.792 95.9542 151.046 96.3403 151.367 96.6655C151.687 96.9907 152.068 97.2486 152.487 97.4245C152.905 97.6004 153.354 97.6907 153.807 97.6905Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M149.019 113.771C149.814 113.771 150.591 113.533 151.252 113.085C151.913 112.637 152.428 112.001 152.732 111.256C153.037 110.511 153.116 109.691 152.962 108.9C152.807 108.109 152.424 107.382 151.863 106.812C151.301 106.242 150.585 105.853 149.806 105.696C149.026 105.538 148.219 105.619 147.484 105.927C146.75 106.236 146.123 106.758 145.681 107.429C145.24 108.099 145.004 108.888 145.004 109.694C145.004 110.775 145.427 111.812 146.18 112.576C146.933 113.341 147.954 113.77 149.019 113.771Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M148.542 125.899C148.942 123.396 147.267 121.037 144.8 120.63C142.333 120.224 140.008 121.924 139.607 124.428C139.207 126.931 140.882 129.29 143.349 129.697C145.816 130.103 148.141 128.403 148.542 125.899Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M138.956 145.561C139.93 145.562 140.882 145.269 141.692 144.72C142.501 144.171 143.133 143.391 143.505 142.478C143.878 141.565 143.976 140.561 143.786 139.592C143.596 138.622 143.127 137.732 142.439 137.033C141.75 136.335 140.873 135.859 139.918 135.666C138.963 135.474 137.973 135.573 137.073 135.951C136.174 136.329 135.405 136.97 134.864 137.792C134.324 138.614 134.035 139.58 134.036 140.568C134.036 141.892 134.554 143.162 135.477 144.099C136.4 145.035 137.651 145.561 138.956 145.561Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M133.682 161.199C134.712 161.198 135.717 160.888 136.573 160.308C137.428 159.727 138.095 158.903 138.489 157.938C138.882 156.973 138.985 155.911 138.784 154.887C138.583 153.863 138.088 152.922 137.36 152.183C136.632 151.445 135.705 150.942 134.696 150.738C133.687 150.534 132.641 150.639 131.69 151.038C130.739 151.438 129.926 152.114 129.354 152.982C128.782 153.851 128.477 154.871 128.477 155.916C128.476 156.609 128.611 157.297 128.872 157.938C129.134 158.579 129.517 159.161 130.001 159.652C130.484 160.143 131.058 160.532 131.69 160.797C132.322 161.063 132.999 161.199 133.682 161.199Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M133.584 171.513C133.748 168.522 131.491 165.963 128.544 165.797C125.596 165.631 123.075 167.922 122.912 170.913C122.749 173.904 125.005 176.462 127.953 176.628C130.9 176.794 133.421 174.503 133.584 171.513Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M122.651 191.843C123.703 191.845 124.733 191.531 125.609 190.94C126.485 190.348 127.168 189.506 127.573 188.521C127.977 187.535 128.084 186.45 127.881 185.402C127.677 184.354 127.171 183.392 126.428 182.636C125.685 181.88 124.738 181.365 123.706 181.155C122.674 180.946 121.604 181.052 120.632 181.46C119.66 181.868 118.828 182.56 118.244 183.448C117.659 184.335 117.347 185.379 117.347 186.447C117.347 187.876 117.905 189.246 118.9 190.258C119.894 191.27 121.243 191.84 122.651 191.843Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M117.922 206.68C120.676 206.106 122.45 203.375 121.885 200.581C121.32 197.786 118.629 195.985 115.875 196.559C113.121 197.133 111.347 199.863 111.912 202.658C112.478 205.453 115.168 207.253 117.922 206.68Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M114.344 220.141C116.2 218.257 116.2 215.204 114.344 213.32C112.488 211.437 109.479 211.437 107.623 213.32C105.767 215.204 105.767 218.257 107.623 220.141C109.479 222.024 112.488 222.024 114.344 220.141Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M104.912 236.135C105.763 236.135 106.594 235.879 107.301 235.4C108.008 234.921 108.559 234.239 108.884 233.442C109.209 232.645 109.294 231.768 109.129 230.922C108.963 230.075 108.553 229.298 107.952 228.688C107.351 228.078 106.585 227.662 105.751 227.494C104.917 227.326 104.053 227.412 103.267 227.742C102.482 228.072 101.811 228.632 101.338 229.349C100.866 230.066 100.614 230.91 100.614 231.773C100.613 232.346 100.724 232.913 100.94 233.442C101.156 233.972 101.473 234.453 101.872 234.858C102.271 235.263 102.745 235.584 103.267 235.804C103.789 236.023 104.348 236.135 104.912 236.135Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M98.684 250.571C99.4279 250.571 100.155 250.347 100.774 249.928C101.392 249.509 101.874 248.912 102.159 248.215C102.443 247.518 102.518 246.75 102.373 246.01C102.228 245.269 101.869 244.589 101.343 244.055C100.817 243.522 100.147 243.158 99.4177 243.011C98.6881 242.864 97.9319 242.939 97.2447 243.228C96.5574 243.517 95.97 244.006 95.5567 244.634C95.1434 245.262 94.9229 245.999 94.9229 246.754C94.9229 247.767 95.3191 248.738 96.0245 249.453C96.7298 250.169 97.6865 250.571 98.684 250.571Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M92.2978 264.877C92.9246 264.877 93.5373 264.689 94.0584 264.335C94.5795 263.982 94.9857 263.48 95.2255 262.892C95.4654 262.304 95.5281 261.658 95.4059 261.034C95.2836 260.41 94.9818 259.837 94.5386 259.387C94.0954 258.937 93.5308 258.631 92.9161 258.507C92.3013 258.383 91.6642 258.447 91.0851 258.69C90.5061 258.934 90.0112 259.346 89.663 259.875C89.3148 260.403 89.1289 261.025 89.1289 261.661C89.1289 262.514 89.4628 263.332 90.0571 263.935C90.6513 264.538 91.4574 264.877 92.2978 264.877Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M85.7563 279.116C86.2651 279.116 86.7626 278.963 87.1858 278.676C87.609 278.39 87.939 277.982 88.1341 277.505C88.3292 277.028 88.3807 276.503 88.282 275.997C88.1833 275.49 87.939 275.025 87.5797 274.659C87.2205 274.293 86.7626 274.044 86.2637 273.942C85.7648 273.84 85.2474 273.891 84.7768 274.087C84.3062 274.284 83.9035 274.617 83.6196 275.046C83.3357 275.474 83.1833 275.978 83.1817 276.495C83.1805 276.839 83.2463 277.179 83.3752 277.497C83.5041 277.815 83.6936 278.104 83.9328 278.348C84.1719 278.591 84.4561 278.785 84.7691 278.916C85.082 279.048 85.4175 279.116 85.7563 279.116Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M79.0573 293.281C79.4491 293.281 79.8322 293.164 80.1581 292.943C80.484 292.723 80.7382 292.409 80.8884 292.042C81.0386 291.675 81.0781 291.271 81.0019 290.881C80.9258 290.491 80.7373 290.132 80.4605 289.851C80.1836 289.57 79.8307 289.378 79.4465 289.3C79.0623 289.223 78.664 289.262 78.3021 289.414C77.9401 289.567 77.6307 289.824 77.413 290.155C77.1953 290.485 77.0791 290.874 77.0791 291.271C77.0791 291.804 77.2875 292.315 77.6584 292.692C78.0293 293.069 78.5325 293.281 79.0573 293.281Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M72.1964 307.376C72.4706 307.376 72.7388 307.294 72.967 307.14C73.1952 306.985 73.3732 306.766 73.4784 306.509C73.5836 306.252 73.6114 305.969 73.5581 305.696C73.5049 305.423 73.3731 305.172 73.1793 304.975C72.9856 304.778 72.7386 304.644 72.4697 304.59C72.2008 304.535 71.922 304.563 71.6686 304.669C71.4152 304.776 71.1986 304.956 71.0462 305.187C70.8938 305.419 70.8125 305.691 70.8125 305.969C70.8122 306.154 70.8478 306.337 70.9172 306.507C70.9867 306.678 71.0886 306.833 71.2171 306.964C71.3456 307.094 71.4983 307.198 71.6663 307.269C71.8344 307.339 72.0145 307.376 72.1964 307.376Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M65.1989 321.396C65.3555 321.396 65.5086 321.349 65.6388 321.261C65.769 321.172 65.8704 321.047 65.9304 320.9C65.9903 320.753 66.006 320.592 65.9754 320.436C65.9449 320.28 65.8695 320.137 65.7588 320.024C65.648 319.912 65.507 319.835 65.3534 319.804C65.1998 319.773 65.0406 319.789 64.896 319.85C64.7513 319.911 64.6276 320.014 64.5406 320.146C64.4537 320.278 64.4072 320.434 64.4072 320.593C64.4072 320.806 64.4906 321.01 64.6391 321.161C64.7876 321.311 64.989 321.396 65.1989 321.396Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M58.0402 335.423C58.0964 335.423 58.1515 335.407 58.1985 335.375C58.2454 335.344 58.2821 335.299 58.3038 335.246C58.3255 335.194 58.3313 335.136 58.3204 335.08C58.3096 335.024 58.2825 334.972 58.2428 334.932C58.203 334.892 58.1523 334.864 58.0971 334.853C58.0419 334.842 57.9847 334.848 57.9328 334.87C57.8809 334.892 57.8367 334.929 57.8057 334.977C57.7747 335.024 57.7584 335.08 57.7588 335.138C57.7588 335.213 57.7884 335.286 57.8412 335.339C57.894 335.393 57.9656 335.423 58.0402 335.423Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M192.184 0.224222C192.206 0.224222 192.228 0.215292 192.243 0.199395C192.259 0.183498 192.268 0.161937 192.268 0.139455C192.268 0.116973 192.259 0.0954121 192.243 0.0795152C192.228 0.0636182 192.206 0.0546875 192.184 0.0546875C192.162 0.0546875 192.141 0.0636182 192.125 0.0795152C192.109 0.0954121 192.101 0.116973 192.101 0.139455C192.101 0.161937 192.109 0.183498 192.125 0.199395C192.141 0.215292 192.162 0.224222 192.184 0.224222Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M188.413 16.4935C188.519 16.4935 188.623 16.4615 188.712 16.4015C188.8 16.3416 188.869 16.2564 188.91 16.1567C188.95 16.057 188.961 15.9473 188.94 15.8415C188.92 15.7357 188.868 15.6384 188.793 15.5621C188.718 15.4858 188.622 15.4339 188.518 15.4128C188.414 15.3918 188.306 15.4026 188.207 15.4439C188.109 15.4852 188.025 15.5551 187.966 15.6448C187.907 15.7345 187.875 15.84 187.875 15.9479C187.875 16.0196 187.889 16.0907 187.916 16.157C187.943 16.2234 187.982 16.2836 188.032 16.3343C188.082 16.385 188.142 16.4252 188.207 16.4525C188.272 16.4799 188.342 16.4938 188.413 16.4935Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M184.478 32.8482C184.702 32.8486 184.921 32.7815 185.108 32.6555C185.294 32.5294 185.439 32.35 185.525 32.14C185.611 31.9301 185.634 31.6989 185.59 31.4759C185.547 31.2529 185.439 31.048 185.28 30.8872C185.122 30.7265 184.92 30.617 184.7 30.5727C184.481 30.5285 184.253 30.5514 184.046 30.6386C183.839 30.7258 183.662 30.8734 183.538 31.0626C183.414 31.2518 183.348 31.4742 183.348 31.7016C183.348 32.0057 183.467 32.2973 183.679 32.5123C183.891 32.7274 184.178 32.8482 184.478 32.8482Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M180.38 49.1957C180.727 49.1957 181.066 49.0914 181.355 48.8958C181.643 48.7003 181.868 48.4224 182 48.0972C182.133 47.7721 182.168 47.4143 182.1 47.0691C182.033 46.7239 181.866 46.4068 181.62 46.1579C181.375 45.9091 181.063 45.7396 180.723 45.6709C180.382 45.6022 180.03 45.6375 179.709 45.7722C179.389 45.9069 179.115 46.1349 178.922 46.4276C178.73 46.7202 178.627 47.0643 178.627 47.4162C178.627 47.8882 178.812 48.3408 179.141 48.6745C179.469 49.0083 179.915 49.1957 180.38 49.1957Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M176.118 65.5124C176.588 65.5128 177.048 65.3717 177.439 65.1069C177.83 64.8421 178.135 64.4654 178.316 64.0247C178.496 63.5839 178.543 63.0987 178.452 62.6306C178.36 62.1625 178.134 61.7325 177.802 61.3949C177.469 61.0572 177.046 60.8273 176.584 60.734C176.123 60.6408 175.645 60.6884 175.211 60.8709C174.776 61.0535 174.405 61.3627 174.143 61.7594C173.882 62.1562 173.743 62.6227 173.743 63.1C173.742 63.4167 173.804 63.7303 173.923 64.023C174.042 64.3157 174.217 64.5817 174.438 64.8057C174.658 65.0297 174.92 65.2075 175.208 65.3287C175.497 65.45 175.806 65.5124 176.118 65.5124Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M171.693 81.7865C172.292 81.7865 172.877 81.6061 173.375 81.2682C173.873 80.9303 174.261 80.45 174.489 79.8883C174.718 79.3265 174.777 78.7085 174.66 78.1125C174.542 77.5165 174.253 76.9693 173.829 76.5402C173.404 76.1112 172.864 75.8195 172.277 75.7022C171.689 75.585 171.08 75.6473 170.527 75.8814C169.975 76.1154 169.503 76.5107 169.171 77.0171C168.84 77.5236 168.664 78.1183 168.667 78.7262C168.669 79.5388 168.989 80.3172 169.557 80.8908C170.124 81.4644 170.892 81.7865 171.693 81.7865Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M167.104 98.0258C169.135 98.0258 170.781 96.3551 170.781 94.2941C170.781 92.2332 169.135 90.5625 167.104 90.5625C165.074 90.5625 163.427 92.2332 163.427 94.2941C163.427 96.3551 165.074 98.0258 167.104 98.0258Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.356 114.182C163.207 114.182 164.038 113.926 164.745 113.447C165.452 112.967 166.002 112.286 166.328 111.489C166.653 110.692 166.738 109.815 166.572 108.968C166.407 108.122 165.997 107.345 165.396 106.735C164.795 106.125 164.029 105.709 163.195 105.541C162.361 105.373 161.497 105.459 160.711 105.789C159.926 106.119 159.254 106.678 158.782 107.396C158.31 108.113 158.058 108.957 158.058 109.819C158.058 110.976 158.511 112.086 159.317 112.904C160.123 113.722 161.216 114.182 162.356 114.182Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M157.457 130.231C158.419 130.232 159.36 129.942 160.161 129.4C160.961 128.858 161.585 128.087 161.954 127.184C162.322 126.282 162.419 125.289 162.231 124.331C162.044 123.373 161.581 122.493 160.9 121.802C160.22 121.112 159.353 120.641 158.409 120.451C157.465 120.26 156.487 120.357 155.597 120.731C154.708 121.105 153.948 121.738 153.413 122.55C152.879 123.362 152.593 124.317 152.593 125.293C152.593 126.603 153.106 127.858 154.018 128.784C154.93 129.71 156.167 130.231 157.457 130.231Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M157.744 141.086C157.941 138.081 155.7 135.482 152.738 135.283C149.777 135.083 147.217 137.358 147.02 140.363C146.824 143.368 149.065 145.967 152.026 146.166C154.988 146.366 157.548 144.091 157.744 141.086Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M147.144 161.939C150.33 161.939 152.912 159.318 152.912 156.085C152.912 152.852 150.33 150.23 147.144 150.23C143.958 150.23 141.375 152.852 141.375 156.085C141.375 159.318 143.958 161.939 147.144 161.939Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M147.265 173.712C148.527 170.621 147.081 167.078 144.035 165.798C140.99 164.518 137.499 165.986 136.238 169.076C134.976 172.167 136.422 175.71 139.468 176.99C142.513 178.27 146.004 176.802 147.265 173.712Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M136.203 192.743C137.388 192.743 138.548 192.386 139.534 191.718C140.519 191.049 141.288 190.099 141.742 188.987C142.196 187.875 142.314 186.652 142.083 185.472C141.852 184.291 141.281 183.207 140.442 182.356C139.604 181.505 138.535 180.926 137.372 180.691C136.209 180.456 135.004 180.577 133.908 181.037C132.813 181.498 131.876 182.278 131.217 183.278C130.559 184.279 130.207 185.455 130.207 186.659C130.207 188.272 130.839 189.82 131.963 190.961C133.087 192.102 134.612 192.743 136.203 192.743Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M130.495 207.721C131.642 207.721 132.763 207.376 133.716 206.73C134.67 206.083 135.413 205.164 135.852 204.089C136.291 203.014 136.405 201.831 136.182 200.689C135.958 199.548 135.406 198.499 134.595 197.677C133.784 196.854 132.751 196.293 131.626 196.066C130.501 195.839 129.336 195.956 128.276 196.401C127.217 196.846 126.311 197.601 125.674 198.568C125.037 199.536 124.697 200.673 124.697 201.837C124.697 203.398 125.308 204.894 126.395 205.998C127.482 207.101 128.957 207.721 130.495 207.721Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M124.627 222.475C125.702 222.476 126.752 222.153 127.645 221.548C128.539 220.942 129.235 220.081 129.646 219.074C130.057 218.067 130.165 216.959 129.956 215.89C129.746 214.82 129.229 213.838 128.469 213.067C127.71 212.296 126.742 211.771 125.688 211.559C124.635 211.346 123.543 211.456 122.55 211.873C121.558 212.29 120.71 212.997 120.113 213.904C119.517 214.81 119.198 215.876 119.199 216.966C119.199 218.428 119.771 219.829 120.789 220.862C121.807 221.895 123.188 222.475 124.627 222.475Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M118.607 237.026C119.581 237.026 120.533 236.734 121.342 236.185C122.152 235.636 122.783 234.856 123.156 233.943C123.529 233.03 123.627 232.026 123.437 231.057C123.247 230.087 122.778 229.197 122.09 228.498C121.401 227.8 120.524 227.324 119.569 227.131C118.614 226.938 117.624 227.037 116.724 227.416C115.825 227.794 115.056 228.435 114.515 229.257C113.975 230.078 113.686 231.045 113.687 232.033C113.687 232.688 113.814 233.338 114.061 233.944C114.308 234.549 114.671 235.1 115.128 235.563C115.585 236.027 116.127 236.395 116.724 236.646C117.321 236.897 117.961 237.026 118.607 237.026Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M112.426 251.449C113.288 251.449 114.13 251.19 114.846 250.704C115.562 250.219 116.12 249.528 116.45 248.721C116.78 247.913 116.866 247.024 116.698 246.167C116.53 245.31 116.115 244.522 115.506 243.904C114.897 243.286 114.121 242.865 113.276 242.694C112.431 242.524 111.555 242.611 110.759 242.946C109.964 243.28 109.283 243.847 108.805 244.574C108.326 245.301 108.071 246.155 108.071 247.029C108.071 248.202 108.53 249.326 109.346 250.155C110.163 250.984 111.271 251.449 112.426 251.449Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M106.091 265.754C106.829 265.754 107.551 265.532 108.165 265.116C108.779 264.699 109.258 264.107 109.54 263.415C109.823 262.723 109.897 261.961 109.753 261.226C109.609 260.491 109.253 259.816 108.731 259.286C108.209 258.756 107.543 258.395 106.819 258.249C106.095 258.102 105.344 258.177 104.662 258.464C103.98 258.751 103.396 259.237 102.986 259.86C102.576 260.483 102.357 261.216 102.357 261.965C102.357 262.97 102.75 263.934 103.451 264.644C104.151 265.355 105.1 265.754 106.091 265.754Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M99.5994 279.956C100.209 279.956 100.805 279.773 101.312 279.429C101.819 279.085 102.214 278.597 102.448 278.025C102.681 277.453 102.742 276.824 102.623 276.217C102.504 275.611 102.21 275.053 101.779 274.616C101.348 274.178 100.799 273.88 100.201 273.759C99.6028 273.639 98.983 273.701 98.4197 273.937C97.8564 274.174 97.3749 274.575 97.0362 275.09C96.6974 275.604 96.5166 276.209 96.5166 276.828C96.5166 277.657 96.8414 278.453 97.4195 279.04C97.9977 279.627 98.7818 279.956 99.5994 279.956Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M95.2298 292.581C95.75 291.306 95.1537 289.845 93.8978 289.317C92.642 288.789 91.2023 289.395 90.6821 290.669C90.1619 291.943 90.7583 293.405 92.0141 293.932C93.2699 294.46 94.7096 293.855 95.2298 292.581Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M86.1574 308.178C86.5154 308.178 86.8654 308.07 87.1631 307.868C87.4608 307.667 87.6928 307.38 87.8298 307.044C87.9668 306.708 88.0027 306.339 87.9328 305.983C87.863 305.626 87.6906 305.299 87.4374 305.042C87.1842 304.785 86.8617 304.61 86.5105 304.539C86.1594 304.468 85.7954 304.505 85.4646 304.644C85.1339 304.783 84.8512 305.018 84.6522 305.32C84.4533 305.622 84.3472 305.978 84.3472 306.341C84.3472 306.828 84.5379 307.295 84.8774 307.64C85.2168 307.984 85.6773 308.178 86.1574 308.178Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M79.2042 322.198C79.8607 322.198 80.3928 321.658 80.3928 320.991C80.3928 320.325 79.8607 319.785 79.2042 319.785C78.5478 319.785 78.0156 320.325 78.0156 320.991C78.0156 321.658 78.5478 322.198 79.2042 322.198Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M72.1017 336.197C72.2263 336.197 72.3481 336.159 72.4517 336.089C72.5553 336.019 72.636 335.919 72.6837 335.802C72.7314 335.685 72.7439 335.557 72.7196 335.433C72.6953 335.309 72.6353 335.195 72.5472 335.105C72.4591 335.016 72.3468 334.955 72.2246 334.93C72.1024 334.906 71.9757 334.918 71.8606 334.967C71.7455 335.015 71.6471 335.097 71.5779 335.202C71.5086 335.307 71.4717 335.431 71.4717 335.557C71.4717 335.727 71.5381 335.89 71.6562 336.009C71.7744 336.129 71.9346 336.197 72.1017 336.197Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M64.8463 350.175C64.8688 350.175 64.8909 350.169 64.9095 350.156C64.9282 350.143 64.9428 350.125 64.9513 350.104C64.9598 350.083 64.9619 350.06 64.9574 350.037C64.9528 350.015 64.9418 349.994 64.9257 349.978C64.9097 349.962 64.8893 349.951 64.8671 349.947C64.845 349.943 64.8221 349.946 64.8015 349.955C64.7808 349.964 64.7632 349.979 64.751 349.998C64.7388 350.017 64.7325 350.04 64.7329 350.063C64.7335 350.093 64.7457 350.121 64.7669 350.143C64.7881 350.164 64.8166 350.175 64.8463 350.175Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M205.27 0.275004C205.292 0.275004 205.313 0.266073 205.329 0.250176C205.344 0.234279 205.353 0.212718 205.353 0.190236C205.353 0.167755 205.344 0.146193 205.329 0.130296C205.313 0.114399 205.292 0.105469 205.27 0.105469C205.247 0.105469 205.226 0.114399 205.21 0.130296C205.195 0.146193 205.186 0.167755 205.186 0.190236C205.186 0.212718 205.195 0.234279 205.21 0.250176C205.226 0.266073 205.247 0.275004 205.27 0.275004Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M201.53 16.5723C201.641 16.5723 201.751 16.5387 201.844 16.4757C201.936 16.4127 202.009 16.3232 202.052 16.2184C202.094 16.1137 202.106 15.9984 202.084 15.8872C202.062 15.776 202.008 15.6739 201.929 15.5937C201.85 15.5135 201.75 15.4589 201.64 15.4368C201.53 15.4147 201.417 15.426 201.314 15.4694C201.21 15.5128 201.122 15.5863 201.06 15.6806C200.998 15.7748 200.965 15.8857 200.965 15.9991C200.965 16.0744 200.979 16.1491 201.007 16.2188C201.036 16.2885 201.077 16.3518 201.13 16.4051C201.182 16.4584 201.245 16.5006 201.313 16.5293C201.382 16.558 201.455 16.5726 201.53 16.5723Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M197.628 32.9465C197.857 32.9461 198.081 32.8768 198.272 32.7472C198.462 32.6177 198.61 32.4339 198.698 32.2189C198.785 32.0039 198.808 31.7674 198.763 31.5393C198.718 31.3113 198.607 31.1019 198.445 30.9376C198.283 30.7732 198.076 30.6614 197.851 30.6162C197.627 30.571 197.394 30.5944 197.182 30.6835C196.97 30.7726 196.789 30.9234 196.662 31.1168C196.535 31.3102 196.467 31.5376 196.467 31.7701C196.467 31.9248 196.497 32.078 196.555 32.2208C196.614 32.3637 196.699 32.4935 196.807 32.6027C196.915 32.712 197.043 32.7986 197.184 32.8576C197.325 32.9166 197.476 32.9468 197.628 32.9465Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M193.562 49.3023C193.915 49.3023 194.26 49.1961 194.553 48.9972C194.846 48.7983 195.075 48.5156 195.21 48.1849C195.344 47.8541 195.38 47.4902 195.311 47.1392C195.242 46.7881 195.072 46.4657 194.822 46.2128C194.573 45.9598 194.255 45.7877 193.909 45.7181C193.563 45.6485 193.204 45.6847 192.878 45.8219C192.553 45.9592 192.274 46.1914 192.079 46.4893C191.883 46.7871 191.779 47.1371 191.779 47.4951C191.779 47.7326 191.825 47.9678 191.915 48.1872C192.005 48.4066 192.136 48.6059 192.302 48.7737C192.467 48.9416 192.664 49.0746 192.88 49.1653C193.096 49.256 193.328 49.3026 193.562 49.3023Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M189.335 65.6751C189.822 65.6751 190.297 65.5288 190.702 65.2547C191.106 64.9807 191.422 64.5911 191.608 64.1352C191.795 63.6793 191.844 63.1775 191.75 62.6932C191.655 62.209 191.422 61.7639 191.079 61.4143C190.735 61.0646 190.297 60.8261 189.821 60.7287C189.344 60.6314 188.849 60.6796 188.399 60.8674C187.949 61.0551 187.564 61.3739 187.293 61.7836C187.021 62.1932 186.876 62.6752 186.874 63.1689C186.873 63.4976 186.936 63.8233 187.059 64.1273C187.182 64.4313 187.363 64.7077 187.592 64.9405C187.821 65.1734 188.092 65.3581 188.391 65.4842C188.691 65.6102 189.011 65.6751 189.335 65.6751Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M184.946 81.9988C185.57 82.0031 186.182 81.8189 186.703 81.4698C187.224 81.1206 187.631 80.6222 187.872 80.0378C188.113 79.4535 188.178 78.8095 188.058 78.1877C187.938 77.5659 187.639 76.9943 187.198 76.5456C186.757 76.0968 186.195 75.791 185.583 75.6672C184.97 75.5433 184.336 75.6069 183.759 75.8498C183.182 76.0928 182.69 76.5041 182.344 77.0317C181.998 77.5592 181.815 78.1792 181.817 78.8128C181.82 79.6551 182.15 80.4622 182.736 81.0588C183.322 81.6554 184.116 81.9932 184.946 81.9988Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M180.395 98.2762C181.151 98.2762 181.889 98.049 182.517 97.6233C183.144 97.1975 183.634 96.5924 183.923 95.8845C184.212 95.1765 184.287 94.3975 184.14 93.6459C183.993 92.8943 183.629 92.204 183.095 91.6621C182.561 91.1203 181.881 90.7513 181.14 90.6018C180.4 90.4523 179.632 90.529 178.934 90.8223C178.237 91.1155 177.641 91.6121 177.221 92.2493C176.802 92.8864 176.578 93.6355 176.578 94.4018C176.578 95.4293 176.98 96.4148 177.696 97.1414C178.412 97.868 179.383 98.2762 180.395 98.2762Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M175.685 114.505C176.575 114.505 177.445 114.238 178.185 113.737C178.925 113.235 179.502 112.522 179.842 111.688C180.183 110.854 180.273 109.936 180.099 109.051C179.926 108.165 179.498 107.351 178.869 106.713C178.24 106.074 177.438 105.639 176.566 105.463C175.693 105.287 174.788 105.377 173.966 105.722C173.144 106.068 172.442 106.653 171.947 107.404C171.453 108.154 171.189 109.037 171.189 109.94C171.189 111.15 171.663 112.311 172.506 113.167C173.349 114.023 174.492 114.504 175.685 114.505Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M170.813 130.682C171.837 130.684 172.839 130.378 173.692 129.802C174.544 129.226 175.21 128.407 175.603 127.447C175.996 126.487 176.1 125.43 175.902 124.411C175.703 123.391 175.211 122.454 174.488 121.718C173.764 120.982 172.842 120.481 171.837 120.278C170.833 120.074 169.791 120.177 168.845 120.575C167.898 120.972 167.089 121.645 166.52 122.509C165.951 123.374 165.647 124.39 165.647 125.429C165.647 126.82 166.191 128.155 167.159 129.14C168.128 130.125 169.442 130.68 170.813 130.682Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M165.783 146.72C168.969 146.72 171.552 144.099 171.552 140.866C171.552 137.633 168.969 135.012 165.783 135.012C162.597 135.012 160.015 137.633 160.015 140.866C160.015 144.099 162.597 146.72 165.783 146.72Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.494 161.602C165.548 160.317 167.01 156.789 165.757 153.721C164.505 150.653 161.014 149.207 157.959 150.491C154.904 151.775 153.443 155.304 154.695 158.371C155.947 161.439 159.439 162.886 162.494 161.602Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M155.246 178.262C158.885 178.262 161.835 175.268 161.835 171.574C161.835 167.881 158.885 164.887 155.246 164.887C151.606 164.887 148.656 167.881 148.656 171.574C148.656 175.268 151.606 178.262 155.246 178.262Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M149.002 193C150.188 193 151.348 192.647 152.335 191.988C153.321 191.328 154.09 190.391 154.544 189.295C154.998 188.198 155.116 186.992 154.884 185.828C154.653 184.665 154.081 183.596 153.242 182.757C152.403 181.918 151.334 181.347 150.17 181.115C149.006 180.884 147.8 181.003 146.703 181.457C145.607 181.911 144.67 182.68 144.011 183.667C143.352 184.653 143 185.813 143 187C143 187.788 143.155 188.568 143.457 189.297C143.759 190.025 144.201 190.686 144.758 191.243C145.315 191.8 145.977 192.242 146.705 192.544C147.433 192.845 148.214 193 149.002 193Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M143.5 208C144.786 208 146.042 207.619 147.111 206.905C148.18 206.19 149.013 205.175 149.505 203.987C149.997 202.8 150.126 201.493 149.875 200.232C149.624 198.971 149.005 197.813 148.096 196.904C147.187 195.995 146.029 195.376 144.768 195.125C143.507 194.874 142.2 195.003 141.013 195.495C139.825 195.987 138.81 196.82 138.095 197.889C137.381 198.958 137 200.214 137 201.5C137 203.224 137.685 204.877 138.904 206.096C140.123 207.315 141.776 208 143.5 208Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M138.258 223.395C139.467 223.395 140.648 223.032 141.652 222.35C142.657 221.669 143.44 220.701 143.902 219.568C144.365 218.435 144.486 217.189 144.25 215.986C144.014 214.784 143.432 213.679 142.578 212.812C141.724 211.945 140.635 211.354 139.45 211.115C138.265 210.876 137.037 210.999 135.921 211.468C134.804 211.937 133.85 212.732 133.179 213.751C132.508 214.771 132.149 215.969 132.149 217.196C132.149 218.84 132.793 220.417 133.939 221.579C135.084 222.742 136.638 223.395 138.258 223.395Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M132.282 237.933C133.384 237.933 134.461 237.601 135.377 236.98C136.293 236.359 137.007 235.476 137.429 234.443C137.851 233.409 137.961 232.273 137.746 231.176C137.531 230.079 137 229.072 136.221 228.281C135.442 227.49 134.449 226.952 133.369 226.734C132.288 226.515 131.168 226.627 130.15 227.055C129.132 227.483 128.262 228.208 127.649 229.138C127.037 230.068 126.71 231.161 126.71 232.279C126.71 233.778 127.297 235.217 128.342 236.277C129.387 237.337 130.804 237.933 132.282 237.933Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M126.152 252.327C128.886 252.327 131.102 250.079 131.102 247.304C131.102 244.53 128.886 242.281 126.152 242.281C123.418 242.281 121.202 244.53 121.202 247.304C121.202 250.079 123.418 252.327 126.152 252.327Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M121.587 266.938C123.961 266.746 125.732 264.636 125.542 262.227C125.352 259.818 123.273 258.021 120.899 258.214C118.525 258.406 116.755 260.516 116.944 262.925C117.134 265.334 119.213 267.131 121.587 266.938Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M114.295 281.617C116.259 281.295 117.593 279.419 117.276 277.426C116.958 275.434 115.109 274.079 113.146 274.401C111.183 274.723 109.848 276.6 110.165 278.592C110.483 280.585 112.332 281.939 114.295 281.617Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M106.834 294.916C107.41 294.916 107.973 294.742 108.452 294.418C108.931 294.093 109.305 293.631 109.525 293.091C109.746 292.551 109.803 291.957 109.691 291.383C109.578 290.81 109.301 290.283 108.894 289.87C108.486 289.456 107.967 289.175 107.402 289.061C106.837 288.947 106.252 289.005 105.719 289.229C105.187 289.453 104.732 289.832 104.412 290.318C104.092 290.804 103.921 291.375 103.921 291.96C103.921 292.744 104.228 293.496 104.775 294.05C105.321 294.604 106.062 294.916 106.834 294.916Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M100.089 308.973C100.531 308.973 100.963 308.84 101.33 308.59C101.698 308.341 101.984 307.987 102.153 307.573C102.322 307.158 102.367 306.703 102.28 306.263C102.194 305.823 101.981 305.419 101.669 305.102C101.356 304.785 100.958 304.569 100.525 304.481C100.091 304.394 99.6421 304.438 99.2338 304.61C98.8256 304.782 98.4766 305.072 98.2311 305.445C97.9855 305.818 97.8545 306.257 97.8545 306.705C97.8545 307.306 98.0899 307.883 98.5089 308.308C98.928 308.734 99.4963 308.973 100.089 308.973Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M94.3111 322.519C94.9294 321.892 94.9294 320.874 94.3111 320.247C93.6927 319.619 92.6901 319.619 92.0718 320.247C91.4534 320.874 91.4534 321.892 92.0718 322.519C92.6902 323.147 93.6927 323.147 94.3111 322.519Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M86.1444 336.96C86.3347 336.96 86.5206 336.903 86.6788 336.795C86.8369 336.688 86.9602 336.536 87.033 336.357C87.1058 336.179 87.1249 335.983 87.0877 335.793C87.0506 335.604 86.959 335.43 86.8245 335.294C86.69 335.157 86.5186 335.064 86.3321 335.027C86.1455 334.989 85.9521 335.008 85.7764 335.082C85.6006 335.156 85.4504 335.281 85.3447 335.442C85.239 335.602 85.1826 335.791 85.1826 335.984C85.1826 336.243 85.284 336.491 85.4643 336.674C85.6447 336.857 85.8893 336.96 86.1444 336.96Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M78.9457 350.907C79.0242 350.907 79.101 350.884 79.1662 350.839C79.2315 350.795 79.2824 350.732 79.3124 350.659C79.3425 350.585 79.3503 350.504 79.335 350.426C79.3197 350.348 79.2819 350.276 79.2264 350.22C79.1709 350.163 79.1002 350.125 79.0232 350.109C78.9462 350.094 78.8664 350.102 78.7938 350.132C78.7213 350.163 78.6593 350.214 78.6157 350.281C78.5721 350.347 78.5488 350.425 78.5488 350.504C78.5488 350.611 78.5906 350.714 78.6651 350.789C78.7395 350.865 78.8405 350.907 78.9457 350.907Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M218.357 0.29799C218.368 0.298412 218.379 0.295419 218.389 0.289394C218.398 0.283369 218.406 0.274588 218.411 0.264177C218.415 0.253766 218.417 0.2422 218.415 0.230965C218.413 0.21973 218.408 0.209338 218.4 0.201122C218.392 0.192907 218.382 0.187244 218.371 0.184859C218.36 0.182474 218.348 0.183476 218.338 0.187738C218.328 0.191999 218.319 0.199325 218.312 0.208775C218.306 0.218224 218.303 0.229367 218.303 0.240772C218.303 0.255587 218.308 0.269829 218.319 0.2805C218.329 0.291172 218.342 0.297441 218.357 0.29799Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M214.64 16.6068C214.746 16.6068 214.85 16.5748 214.939 16.5148C215.027 16.4549 215.096 16.3697 215.137 16.27C215.178 16.1703 215.188 16.0606 215.167 15.9548C215.147 15.8489 215.095 15.7517 215.02 15.6754C214.945 15.5991 214.849 15.5472 214.745 15.5261C214.641 15.5051 214.533 15.5159 214.434 15.5572C214.336 15.5984 214.252 15.6684 214.193 15.7581C214.134 15.8478 214.103 15.9533 214.103 16.0612C214.103 16.2059 214.159 16.3447 214.26 16.447C214.361 16.5493 214.498 16.6068 214.64 16.6068Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M210.77 32.9849C210.994 32.9849 211.213 32.9175 211.399 32.7913C211.585 32.6651 211.73 32.4857 211.816 32.2758C211.902 32.0659 211.924 31.8349 211.88 31.6121C211.837 31.3893 211.729 31.1846 211.57 31.0239C211.412 30.8633 211.21 30.7539 210.991 30.7096C210.771 30.6653 210.544 30.688 210.337 30.7749C210.13 30.8619 209.953 31.0091 209.829 31.198C209.705 31.3869 209.638 31.609 209.638 31.8362C209.638 31.9871 209.667 32.1366 209.724 32.2761C209.781 32.4156 209.864 32.5423 209.969 32.6491C210.074 32.7558 210.199 32.8404 210.337 32.898C210.474 32.9556 210.621 32.9852 210.77 32.9849Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M206.736 49.3804C207.089 49.3808 207.434 49.275 207.727 49.0764C208.021 48.8777 208.25 48.5952 208.385 48.2645C208.52 47.9338 208.555 47.5698 208.487 47.2186C208.418 46.8674 208.248 46.5448 207.999 46.2917C207.749 46.0385 207.431 45.8661 207.085 45.7964C206.739 45.7266 206.381 45.7626 206.055 45.8999C205.729 46.0371 205.45 46.2693 205.255 46.5672C205.059 46.865 204.955 47.2152 204.955 47.5732C204.956 48.0523 205.143 48.5117 205.477 48.8505C205.811 49.1893 206.264 49.3798 206.736 49.3804Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M202.544 65.7571C203.031 65.758 203.507 65.6122 203.912 65.3383C204.318 65.0643 204.634 64.6745 204.821 64.2182C205.008 63.7619 205.057 63.2596 204.963 62.7748C204.868 62.29 204.634 61.8445 204.29 61.4948C203.946 61.1451 203.507 60.9067 203.03 60.81C202.552 60.7133 202.057 60.7625 201.607 60.9514C201.157 61.1404 200.773 61.4605 200.502 61.8713C200.231 62.2822 200.087 62.7652 200.087 63.2594C200.087 63.9211 200.346 64.5558 200.806 65.0241C201.267 65.4924 201.892 65.756 202.544 65.7571Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M198.197 82.1513C198.829 82.1517 199.447 81.9618 199.973 81.6057C200.499 81.2495 200.909 80.7431 201.151 80.1504C201.394 79.5578 201.457 78.9055 201.334 78.2762C201.211 77.6468 200.907 77.0687 200.46 76.6148C200.013 76.161 199.444 75.8519 198.823 75.7265C198.203 75.6012 197.561 75.6653 196.976 75.9108C196.392 76.1562 195.893 76.5719 195.542 77.1054C195.19 77.6388 195.003 78.2661 195.003 78.9077C195.003 79.3335 195.085 79.7553 195.245 80.1488C195.406 80.5423 195.641 80.8999 195.938 81.2011C196.234 81.5023 196.587 81.7413 196.974 81.9043C197.362 82.0674 197.777 82.1513 198.197 82.1513Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M193.676 98.4666C194.448 98.467 195.203 98.235 195.845 97.7998C196.488 97.3646 196.988 96.7459 197.284 96.0219C197.58 95.2979 197.657 94.5011 197.507 93.7324C197.356 92.9637 196.984 92.2576 196.438 91.7034C195.892 91.1492 195.196 90.7718 194.439 90.619C193.681 90.4662 192.896 90.5448 192.183 90.845C191.469 91.1451 190.86 91.6532 190.431 92.305C190.002 92.9569 189.774 93.7232 189.774 94.5069C189.774 95.5571 190.185 96.5642 190.917 97.3068C191.648 98.0494 192.641 98.4666 193.676 98.4666Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M190.012 114.669C192.512 114.1 194.084 111.582 193.524 109.045C192.963 106.508 190.482 104.913 187.982 105.482C185.482 106.051 183.91 108.568 184.471 111.105C185.031 113.642 187.512 115.238 190.012 114.669Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M184.171 130.984C187.123 130.984 189.516 128.556 189.516 125.561C189.516 122.565 187.123 120.137 184.171 120.137C181.219 120.137 178.827 122.565 178.827 125.561C178.827 128.556 181.219 130.984 184.171 130.984Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M179.182 147.151C180.379 147.151 181.549 146.791 182.544 146.116C183.539 145.441 184.315 144.482 184.773 143.36C185.231 142.237 185.351 141.002 185.118 139.811C184.884 138.62 184.308 137.525 183.461 136.666C182.615 135.807 181.536 135.222 180.362 134.985C179.188 134.748 177.971 134.87 176.866 135.335C175.76 135.8 174.814 136.587 174.149 137.597C173.484 138.607 173.129 139.794 173.129 141.009C173.129 141.816 173.286 142.614 173.59 143.36C173.894 144.105 174.34 144.782 174.902 145.352C175.464 145.923 176.131 146.375 176.866 146.684C177.6 146.992 178.387 147.151 179.182 147.151Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M173.032 163.178C174.352 163.178 175.643 162.781 176.74 162.037C177.838 161.293 178.693 160.235 179.198 158.997C179.703 157.76 179.835 156.398 179.578 155.084C179.32 153.771 178.685 152.564 177.751 151.617C176.818 150.669 175.629 150.024 174.334 149.763C173.04 149.502 171.698 149.636 170.478 150.148C169.259 150.661 168.216 151.529 167.483 152.643C166.75 153.757 166.358 155.066 166.358 156.406C166.358 158.202 167.062 159.925 168.313 161.195C169.565 162.465 171.262 163.178 173.032 163.178Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M169.553 178.087C172.776 177.315 174.78 174.073 174.029 170.846C173.278 167.618 170.058 165.627 166.835 166.399C163.612 167.171 161.609 170.413 162.359 173.641C163.11 176.868 166.331 178.859 169.553 178.087Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M161.498 194C162.784 194 164.041 193.619 165.11 192.905C166.179 192.191 167.012 191.176 167.505 189.989C167.997 188.801 168.126 187.494 167.875 186.233C167.625 184.972 167.006 183.814 166.097 182.904C165.188 181.995 164.03 181.376 162.769 181.125C161.508 180.874 160.201 181.003 159.013 181.495C157.825 181.987 156.81 182.82 156.096 183.889C155.381 184.958 155 186.214 155 187.5C155 189.224 155.685 190.877 156.903 192.096C158.122 193.314 159.775 193.999 161.498 194Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.466 204.713C164.053 201.493 162.744 197.566 159.543 195.941C156.342 194.316 152.46 195.61 150.873 198.83C149.286 202.05 150.595 205.977 153.796 207.602C156.997 209.227 160.879 207.933 162.466 204.713Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M152.562 223.499C156.104 222.916 158.515 219.569 157.948 216.024C157.381 212.479 154.05 210.079 150.508 210.662C146.966 211.246 144.554 214.592 145.121 218.137C145.688 221.682 149.019 224.083 152.562 223.499Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M145.944 238.812C149.365 238.812 152.137 235.998 152.137 232.527C152.137 229.056 149.365 226.242 145.944 226.242C142.524 226.242 139.751 229.056 139.751 232.527C139.751 235.998 142.524 238.812 145.944 238.812Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M143.761 251.524C145.914 249.338 145.914 245.795 143.761 243.609C141.607 241.424 138.116 241.424 135.962 243.609C133.808 245.795 133.808 249.338 135.962 251.524C138.116 253.709 141.607 253.709 143.761 251.524Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M133.626 267.421C134.577 267.421 135.507 267.135 136.298 266.599C137.089 266.063 137.706 265.301 138.07 264.41C138.435 263.518 138.53 262.537 138.345 261.59C138.159 260.643 137.702 259.773 137.029 259.09C136.357 258.408 135.5 257.943 134.567 257.754C133.634 257.566 132.667 257.662 131.788 258.031C130.909 258.401 130.158 259.026 129.629 259.829C129.101 260.632 128.819 261.575 128.819 262.54C128.819 263.834 129.325 265.075 130.227 265.991C131.128 266.906 132.351 267.42 133.626 267.421Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M127.236 281.581C129.484 281.581 131.307 279.731 131.307 277.449C131.307 275.167 129.484 273.316 127.236 273.316C124.987 273.316 123.164 275.167 123.164 277.449C123.164 279.731 124.987 281.581 127.236 281.581Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M120.694 295.707C122.553 295.707 124.06 294.178 124.06 292.291C124.06 290.405 122.553 288.875 120.694 288.875C118.835 288.875 117.328 290.405 117.328 292.291C117.328 294.178 118.835 295.707 120.694 295.707Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M114.003 309.743C114.524 309.743 115.033 309.586 115.465 309.293C115.898 309 116.235 308.583 116.434 308.095C116.634 307.607 116.686 307.07 116.584 306.552C116.483 306.034 116.232 305.558 115.864 305.184C115.496 304.811 115.027 304.557 114.517 304.454C114.006 304.351 113.477 304.403 112.996 304.606C112.516 304.808 112.105 305.15 111.816 305.589C111.526 306.028 111.372 306.545 111.372 307.073C111.372 307.781 111.649 308.46 112.143 308.961C112.636 309.462 113.306 309.743 114.003 309.743Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M107.159 323.745C107.545 323.745 107.922 323.629 108.243 323.411C108.564 323.194 108.814 322.884 108.962 322.523C109.109 322.161 109.148 321.763 109.073 321.379C108.998 320.995 108.812 320.642 108.539 320.365C108.266 320.088 107.918 319.9 107.54 319.823C107.162 319.747 106.769 319.786 106.413 319.936C106.056 320.086 105.752 320.339 105.537 320.665C105.323 320.991 105.208 321.373 105.208 321.765C105.208 322.29 105.414 322.794 105.78 323.165C106.146 323.536 106.642 323.745 107.159 323.745Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M100.165 337.709C100.422 337.71 100.674 337.633 100.888 337.489C101.103 337.345 101.27 337.139 101.37 336.898C101.469 336.657 101.496 336.392 101.447 336.136C101.398 335.879 101.275 335.643 101.094 335.458C100.913 335.272 100.682 335.145 100.429 335.093C100.177 335.041 99.9155 335.066 99.6772 335.164C99.4389 335.263 99.2348 335.431 99.0905 335.647C98.9463 335.863 98.8684 336.118 98.8667 336.379C98.8656 336.553 98.8983 336.725 98.963 336.886C99.0277 337.047 99.123 337.194 99.2436 337.317C99.3642 337.441 99.5076 337.539 99.6656 337.606C99.8237 337.674 99.9932 337.708 100.165 337.709Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M93.0221 351.631C93.1562 351.631 93.2873 351.59 93.3989 351.515C93.5104 351.439 93.5974 351.331 93.6487 351.206C93.7001 351.08 93.7135 350.941 93.6873 350.808C93.6612 350.674 93.5965 350.552 93.5017 350.456C93.4068 350.359 93.286 350.294 93.1544 350.267C93.0228 350.241 92.8864 350.254 92.7625 350.306C92.6385 350.358 92.5326 350.447 92.4581 350.56C92.3835 350.673 92.3438 350.806 92.3438 350.942C92.3438 351.125 92.4152 351.3 92.5424 351.429C92.6696 351.558 92.8422 351.631 93.0221 351.631Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M85.7309 365.562C85.7655 365.558 85.7974 365.541 85.8205 365.514C85.8436 365.488 85.8564 365.454 85.8564 365.418C85.8564 365.383 85.8436 365.349 85.8205 365.322C85.7974 365.296 85.7655 365.279 85.7309 365.275C85.7108 365.272 85.6905 365.274 85.6712 365.28C85.6519 365.286 85.6341 365.296 85.6189 365.31C85.6038 365.323 85.5917 365.34 85.5834 365.359C85.5751 365.378 85.5708 365.398 85.5708 365.418C85.5708 365.439 85.5751 365.459 85.5834 365.478C85.5917 365.497 85.6038 365.513 85.6189 365.527C85.6341 365.54 85.6519 365.551 85.6712 365.557C85.6905 365.563 85.7108 365.565 85.7309 365.562Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M231.423 0.352717C231.438 0.352717 231.452 0.346689 231.463 0.335958C231.474 0.325228 231.479 0.310674 231.479 0.295499C231.479 0.280324 231.474 0.265771 231.463 0.25504C231.452 0.24431 231.438 0.238281 231.423 0.238281C231.408 0.238281 231.394 0.24431 231.383 0.25504C231.373 0.265771 231.367 0.280324 231.367 0.295499C231.367 0.310674 231.373 0.325228 231.383 0.335958C231.394 0.346689 231.408 0.352717 231.423 0.352717Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M227.745 16.6334C227.846 16.6338 227.945 16.6037 228.029 16.547C228.113 16.4903 228.179 16.4094 228.218 16.3147C228.257 16.22 228.267 16.1157 228.247 16.015C228.228 15.9144 228.179 15.8219 228.107 15.7493C228.036 15.6768 227.945 15.6274 227.846 15.6075C227.746 15.5876 227.644 15.598 227.55 15.6375C227.457 15.6769 227.377 15.7437 227.321 15.8291C227.266 15.9146 227.236 16.015 227.236 16.1177C227.236 16.1854 227.249 16.2524 227.275 16.315C227.301 16.3776 227.338 16.4344 227.385 16.4823C227.432 16.5302 227.488 16.5682 227.55 16.5941C227.612 16.6201 227.678 16.6334 227.745 16.6334Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M223.905 33.019C224.123 33.0185 224.336 32.9526 224.517 32.8294C224.698 32.7062 224.839 32.5313 224.922 32.3268C225.006 32.1223 225.027 31.8974 224.984 31.6805C224.942 31.4636 224.836 31.2645 224.682 31.1082C224.528 30.9519 224.331 30.8456 224.118 30.8026C223.904 30.7596 223.682 30.7819 223.481 30.8666C223.28 30.9514 223.107 31.0948 222.986 31.2787C222.865 31.4627 222.801 31.6789 222.801 31.9001C222.801 32.0472 222.829 32.1929 222.885 32.3288C222.94 32.4646 223.022 32.5881 223.124 32.692C223.227 32.7959 223.349 32.8783 223.483 32.9344C223.617 32.9905 223.76 33.0192 223.905 33.019Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M219.905 49.4223C220.252 49.4223 220.591 49.3179 220.879 49.1224C221.167 48.9269 221.392 48.6489 221.525 48.3238C221.658 47.9986 221.692 47.6408 221.625 47.2956C221.557 46.9504 221.39 46.6334 221.145 46.3845C220.9 46.1356 220.587 45.9661 220.247 45.8975C219.907 45.8288 219.554 45.8641 219.234 45.9987C218.913 46.1334 218.64 46.3615 218.447 46.6542C218.254 46.9468 218.151 47.2908 218.151 47.6428C218.151 48.1148 218.336 48.5674 218.665 48.9011C218.994 49.2348 219.44 49.4223 219.905 49.4223Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M215.745 65.815C216.227 65.8163 216.698 65.6725 217.099 65.4018C217.5 65.1312 217.813 64.7459 217.998 64.2947C218.183 63.8434 218.232 63.3466 218.139 62.8671C218.046 62.3875 217.815 61.9468 217.475 61.6007C217.134 61.2546 216.701 61.0188 216.228 60.9229C215.756 60.8271 215.266 60.8756 214.821 61.0624C214.376 61.2492 213.996 61.5658 213.728 61.9721C213.46 62.3784 213.317 62.8562 213.317 63.345C213.317 63.9991 213.572 64.6268 214.027 65.0899C214.483 65.5531 215.1 65.8139 215.745 65.815Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M212.157 82.1313C213.858 81.7209 214.91 79.9883 214.506 78.2615C214.101 76.5347 212.394 75.4675 210.692 75.8779C208.991 76.2884 207.939 78.021 208.344 79.7478C208.748 81.4746 210.455 82.5417 212.157 82.1313Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M207.5 98.5194C209.633 98.2124 211.118 96.2083 210.815 94.0431C210.513 91.8779 208.538 90.3715 206.404 90.6785C204.271 90.9855 202.786 92.9896 203.089 95.1548C203.391 97.3201 205.366 98.8264 207.5 98.5194Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M202.313 114.908C203.236 114.908 204.138 114.631 204.906 114.11C205.673 113.59 206.271 112.85 206.624 111.985C206.977 111.12 207.07 110.168 206.89 109.249C206.71 108.331 206.265 107.487 205.613 106.824C204.96 106.162 204.129 105.711 203.224 105.528C202.318 105.346 201.38 105.44 200.528 105.798C199.675 106.156 198.946 106.763 198.433 107.542C197.921 108.321 197.647 109.236 197.647 110.173C197.647 111.429 198.139 112.633 199.014 113.521C199.889 114.409 201.076 114.908 202.313 114.908Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M198.762 131.063C201.681 130.364 203.489 127.396 202.8 124.433C202.111 121.471 199.186 119.636 196.267 120.336C193.348 121.035 191.54 124.003 192.229 126.965C192.918 129.928 195.843 131.762 198.762 131.063Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M196.967 145.617C199.397 143.151 199.397 139.153 196.967 136.687C194.537 134.221 190.597 134.221 188.167 136.687C185.737 139.153 185.737 143.151 188.167 145.617C190.597 148.083 194.537 148.083 196.967 145.617Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M187.03 162.527C190.62 162.527 193.53 159.617 193.53 156.027C193.53 152.437 190.62 149.527 187.03 149.527C183.44 149.527 180.53 152.437 180.53 156.027C180.53 159.617 183.44 162.527 187.03 162.527Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M182.396 177.636C185.938 177.052 188.349 173.706 187.782 170.161C187.215 166.616 183.884 164.215 180.342 164.799C176.8 165.382 174.388 168.729 174.955 172.274C175.522 175.819 178.853 178.219 182.396 177.636Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M177.266 194.175C180.757 193.339 182.928 189.827 182.115 186.33C181.302 182.834 177.812 180.677 174.321 181.513C170.83 182.349 168.659 185.862 169.472 189.358C170.286 192.855 173.775 195.012 177.266 194.175Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M170.502 209C171.787 209 173.044 208.618 174.113 207.904C175.181 207.189 176.014 206.174 176.506 204.986C176.997 203.798 177.126 202.491 176.875 201.231C176.624 199.97 176.005 198.812 175.096 197.903C174.186 196.994 173.028 196.375 171.767 196.125C170.507 195.874 169.2 196.003 168.012 196.495C166.825 196.987 165.809 197.82 165.095 198.889C164.381 199.958 164 201.215 164 202.5C164 203.354 164.168 204.199 164.495 204.988C164.822 205.777 165.301 206.493 165.904 207.097C166.508 207.7 167.225 208.179 168.014 208.506C168.803 208.832 169.648 209 170.502 209Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M164.764 223.32C166.049 223.321 167.306 222.94 168.376 222.226C169.445 221.512 170.278 220.496 170.77 219.309C171.263 218.121 171.392 216.814 171.141 215.553C170.89 214.292 170.271 213.133 169.362 212.224C168.453 211.315 167.294 210.696 166.033 210.445C164.772 210.194 163.465 210.323 162.277 210.815C161.09 211.308 160.074 212.141 159.36 213.21C158.646 214.28 158.265 215.536 158.266 216.822C158.266 218.545 158.951 220.198 160.169 221.417C161.388 222.635 163.04 223.32 164.764 223.32Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M159.639 238.882C163.223 238.68 165.97 235.611 165.774 232.026C165.579 228.442 162.514 225.699 158.93 225.901C155.346 226.102 152.599 229.171 152.795 232.756C152.99 236.34 156.054 239.083 159.639 238.882Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M154.007 254.68C155.292 254.68 156.549 254.298 157.618 253.584C158.687 252.87 159.52 251.855 160.012 250.667C160.504 249.479 160.633 248.172 160.382 246.912C160.131 245.651 159.512 244.493 158.603 243.584C157.694 242.674 156.536 242.055 155.275 241.805C154.014 241.554 152.707 241.683 151.519 242.174C150.332 242.666 149.317 243.5 148.602 244.568C147.888 245.637 147.507 246.894 147.507 248.18C147.507 249.904 148.192 251.557 149.411 252.776C150.63 253.995 152.283 254.68 154.007 254.68Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M147.377 268.186C148.423 268.186 149.445 267.871 150.314 267.281C151.184 266.692 151.862 265.853 152.262 264.873C152.662 263.892 152.767 262.813 152.563 261.772C152.359 260.732 151.855 259.775 151.116 259.025C150.376 258.274 149.434 257.763 148.408 257.556C147.383 257.349 146.319 257.455 145.353 257.862C144.387 258.268 143.561 258.956 142.98 259.838C142.399 260.721 142.089 261.758 142.089 262.819C142.089 264.243 142.646 265.608 143.638 266.614C144.629 267.62 145.974 268.186 147.377 268.186Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M141.03 282.342C143.53 282.342 145.556 280.285 145.556 277.749C145.556 275.212 143.53 273.156 141.03 273.156C138.531 273.156 136.505 275.212 136.505 277.749C136.505 280.285 138.531 282.342 141.03 282.342Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M134.539 296.431C135.284 296.433 136.013 296.211 136.633 295.792C137.253 295.374 137.737 294.778 138.024 294.08C138.31 293.383 138.386 292.614 138.242 291.873C138.098 291.131 137.74 290.45 137.214 289.915C136.688 289.379 136.017 289.015 135.287 288.867C134.556 288.719 133.799 288.794 133.111 289.083C132.422 289.372 131.834 289.862 131.421 290.491C131.007 291.119 130.786 291.858 130.787 292.614C130.787 293.625 131.182 294.594 131.885 295.31C132.589 296.026 133.543 296.429 134.539 296.431Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M127.899 310.482C128.498 310.482 129.083 310.302 129.58 309.964C130.078 309.627 130.466 309.147 130.695 308.586C130.924 308.025 130.984 307.407 130.867 306.812C130.75 306.216 130.462 305.669 130.039 305.239C129.616 304.81 129.077 304.517 128.49 304.399C127.903 304.28 127.294 304.341 126.741 304.574C126.188 304.806 125.716 305.2 125.383 305.705C125.051 306.21 124.873 306.803 124.873 307.411C124.873 308.225 125.192 309.006 125.759 309.582C126.327 310.158 127.097 310.482 127.899 310.482Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M121.108 324.459C121.561 324.459 122.004 324.322 122.38 324.067C122.757 323.811 123.051 323.448 123.224 323.023C123.398 322.599 123.443 322.131 123.355 321.68C123.266 321.229 123.048 320.815 122.728 320.49C122.407 320.164 121.999 319.943 121.554 319.853C121.11 319.764 120.649 319.81 120.231 319.986C119.812 320.162 119.454 320.46 119.203 320.842C118.951 321.224 118.816 321.674 118.816 322.134C118.816 322.75 119.058 323.342 119.487 323.778C119.917 324.214 120.5 324.459 121.108 324.459Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M114.167 338.426C114.486 338.426 114.798 338.33 115.063 338.15C115.328 337.97 115.535 337.714 115.657 337.415C115.779 337.116 115.811 336.787 115.749 336.47C115.687 336.152 115.533 335.861 115.307 335.632C115.082 335.403 114.795 335.247 114.482 335.184C114.169 335.121 113.845 335.153 113.55 335.277C113.255 335.401 113.003 335.611 112.826 335.88C112.649 336.149 112.554 336.465 112.554 336.789C112.554 337.004 112.595 337.217 112.676 337.416C112.757 337.614 112.876 337.795 113.026 337.947C113.176 338.099 113.354 338.22 113.549 338.302C113.745 338.384 113.955 338.426 114.167 338.426Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M107.078 352.343C107.268 352.343 107.454 352.286 107.612 352.178C107.77 352.071 107.893 351.919 107.966 351.74C108.039 351.562 108.058 351.366 108.021 351.176C107.984 350.987 107.892 350.813 107.758 350.677C107.623 350.54 107.452 350.447 107.265 350.409C107.079 350.372 106.885 350.391 106.709 350.465C106.534 350.539 106.383 350.664 106.278 350.824C106.172 350.985 106.116 351.174 106.116 351.367C106.116 351.626 106.217 351.874 106.397 352.057C106.578 352.24 106.822 352.343 107.078 352.343Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M99.8411 366.274C99.9198 366.275 99.9968 366.251 100.062 366.207C100.128 366.163 100.179 366.1 100.209 366.027C100.24 365.953 100.248 365.872 100.233 365.793C100.217 365.715 100.179 365.643 100.124 365.587C100.068 365.53 99.9973 365.492 99.9201 365.476C99.8429 365.461 99.7629 365.469 99.6903 365.5C99.6177 365.531 99.5558 365.583 99.5123 365.649C99.4689 365.716 99.4459 365.794 99.4463 365.874C99.4468 365.98 99.4886 366.081 99.5625 366.156C99.6365 366.231 99.7366 366.274 99.8411 366.274Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M244.494 0.371505C244.501 0.371505 244.508 0.368602 244.513 0.363436C244.518 0.358269 244.521 0.351262 244.521 0.343955C244.521 0.336648 244.518 0.329641 244.513 0.324475C244.508 0.319308 244.501 0.316406 244.494 0.316406C244.49 0.316406 244.487 0.317119 244.484 0.318503C244.48 0.319888 244.477 0.321917 244.475 0.324475C244.472 0.327033 244.47 0.33007 244.469 0.333413C244.467 0.336755 244.467 0.340337 244.467 0.343955C244.467 0.347573 244.467 0.351156 244.469 0.354498C244.47 0.357841 244.472 0.360878 244.475 0.363436C244.477 0.365994 244.48 0.368023 244.484 0.369408C244.487 0.370792 244.49 0.371505 244.494 0.371505Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M240.844 16.6025C240.927 16.6025 241.009 16.5775 241.078 16.5306C241.147 16.4838 241.201 16.4172 241.232 16.3393C241.264 16.2615 241.272 16.1758 241.256 16.0931C241.24 16.0104 241.2 15.9344 241.141 15.8748C241.083 15.8152 241.008 15.7746 240.926 15.7582C240.845 15.7417 240.76 15.7502 240.684 15.7824C240.607 15.8147 240.541 15.8693 240.495 15.9394C240.449 16.0095 240.424 16.0919 240.424 16.1762C240.424 16.2893 240.469 16.3977 240.547 16.4776C240.626 16.5576 240.733 16.6025 240.844 16.6025Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M237.035 32.9727C237.231 32.9727 237.422 32.9138 237.585 32.8032C237.748 32.6927 237.875 32.5356 237.95 32.3518C238.025 32.168 238.045 31.9657 238.007 31.7706C237.969 31.5755 237.874 31.3962 237.736 31.2556C237.597 31.1149 237.42 31.0191 237.228 30.9803C237.036 30.9415 236.836 30.9614 236.655 31.0375C236.474 31.1136 236.319 31.2426 236.211 31.408C236.102 31.5734 236.043 31.7679 236.043 31.9668C236.043 32.2336 236.148 32.4895 236.334 32.6781C236.52 32.8668 236.772 32.9727 237.035 32.9727Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M233.442 49.3281C234.323 49.1161 234.869 48.2192 234.66 47.3247C234.451 46.4303 233.567 45.877 232.686 46.0889C231.804 46.3008 231.259 47.1978 231.468 48.0922C231.677 48.9867 232.561 49.54 233.442 49.3281Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M230.598 65.1144C231.515 64.184 231.515 62.6754 230.598 61.7449C229.681 60.8144 228.195 60.8144 227.278 61.7449C226.361 62.6754 226.361 64.184 227.278 65.1145C228.195 66.0449 229.681 66.0449 230.598 65.1144Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M224.658 82.218C225.267 82.218 225.863 82.0345 226.37 81.6907C226.877 81.347 227.272 80.8584 227.506 80.2867C227.739 79.715 227.8 79.086 227.681 78.4791C227.562 77.8722 227.269 77.3148 226.837 76.8773C226.406 76.4397 225.857 76.1418 225.259 76.0211C224.661 75.9003 224.041 75.9623 223.478 76.1991C222.914 76.4359 222.433 76.8369 222.094 77.3514C221.756 77.8658 221.575 78.4707 221.575 79.0895C221.575 79.9192 221.9 80.715 222.478 81.3017C223.056 81.8884 223.84 82.218 224.658 82.218Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M220.424 98.583C222.529 98.4636 224.141 96.6348 224.023 94.4983C223.905 92.3619 222.103 90.7268 219.998 90.8462C217.893 90.9657 216.281 92.7944 216.399 94.9309C216.517 97.0673 218.319 98.7025 220.424 98.583Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M215.613 114.963C216.527 114.963 217.421 114.688 218.181 114.172C218.941 113.656 219.533 112.924 219.882 112.066C220.231 111.209 220.322 110.266 220.143 109.356C219.964 108.446 219.523 107.611 218.876 106.955C218.229 106.3 217.404 105.854 216.508 105.675C215.611 105.495 214.681 105.589 213.837 105.946C212.993 106.302 212.273 106.905 211.766 107.677C211.26 108.45 210.991 109.357 210.993 110.285C210.993 110.9 211.112 111.509 211.345 112.078C211.577 112.646 211.917 113.162 212.346 113.597C212.776 114.031 213.285 114.376 213.845 114.61C214.406 114.844 215.007 114.964 215.613 114.963Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M210.858 131.295C211.927 131.294 212.971 130.972 213.859 130.369C214.747 129.766 215.439 128.909 215.848 127.907C216.256 126.905 216.362 125.802 216.152 124.739C215.943 123.675 215.427 122.699 214.671 121.933C213.914 121.167 212.951 120.646 211.902 120.436C210.854 120.226 209.768 120.336 208.781 120.753C207.794 121.169 206.952 121.873 206.36 122.776C205.767 123.679 205.453 124.74 205.455 125.824C205.458 127.276 206.029 128.668 207.042 129.693C208.055 130.719 209.427 131.295 210.858 131.295Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M206.711 147.548C210.122 147.122 212.546 143.97 212.126 140.509C211.706 137.048 208.601 134.587 205.19 135.013C201.779 135.44 199.355 138.591 199.775 142.052C200.195 145.514 203.3 147.974 206.711 147.548Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M200.365 162.594C201.65 162.594 202.907 162.213 203.976 161.498C205.045 160.784 205.878 159.769 206.37 158.581C206.862 157.393 206.991 156.087 206.74 154.826C206.489 153.565 205.87 152.407 204.961 151.498C204.052 150.589 202.894 149.969 201.633 149.719C200.372 149.468 199.065 149.597 197.877 150.089C196.69 150.581 195.674 151.414 194.96 152.483C194.246 153.551 193.865 154.808 193.865 156.094C193.865 157.818 194.55 159.471 195.769 160.69C196.988 161.909 198.641 162.594 200.365 162.594Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M201.139 174.089C201.874 170.575 199.624 167.114 196.115 166.358C192.606 165.603 189.165 167.839 188.43 171.352C187.696 174.866 189.945 178.327 193.454 179.083C196.964 179.839 200.404 177.603 201.139 174.089Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M196.034 188.522C196.21 184.936 193.447 181.882 189.862 181.7C186.277 181.519 183.227 184.278 183.051 187.863C182.874 191.449 185.637 194.503 189.223 194.685C192.808 194.866 195.857 192.107 196.034 188.522Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M189.766 205.637C191.123 202.313 189.54 198.491 186.23 197.1C182.921 195.709 179.139 197.276 177.782 200.599C176.425 203.923 178.008 207.745 181.318 209.136C184.627 210.527 188.41 208.96 189.766 205.637Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M178.354 223.535C179.64 223.535 180.896 223.153 181.965 222.439C183.034 221.724 183.867 220.709 184.358 219.521C184.85 218.334 184.978 217.027 184.727 215.766C184.476 214.505 183.857 213.347 182.948 212.438C182.039 211.529 180.881 210.911 179.62 210.66C178.359 210.409 177.052 210.538 175.865 211.03C174.677 211.522 173.662 212.355 172.948 213.424C172.234 214.493 171.853 215.75 171.853 217.035C171.853 217.889 172.021 218.734 172.348 219.523C172.674 220.312 173.153 221.028 173.757 221.632C174.361 222.236 175.078 222.714 175.866 223.041C176.655 223.367 177.501 223.535 178.354 223.535Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M178.06 236.338C179.647 233.118 178.339 229.191 175.137 227.566C171.936 225.941 168.055 227.235 166.468 230.455C164.881 233.675 166.19 237.602 169.391 239.227C172.592 240.852 176.474 239.558 178.06 236.338Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M167.231 254.465C168.517 254.465 169.773 254.084 170.842 253.369C171.911 252.655 172.744 251.64 173.236 250.452C173.728 249.265 173.857 247.958 173.606 246.697C173.355 245.436 172.736 244.278 171.827 243.369C170.918 242.46 169.76 241.841 168.499 241.59C167.238 241.339 165.931 241.468 164.744 241.96C163.556 242.452 162.541 243.285 161.826 244.354C161.112 245.423 160.731 246.679 160.731 247.965C160.731 249.689 161.416 251.342 162.635 252.561C163.854 253.78 165.507 254.465 167.231 254.465Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M161.1 268.858C162.225 268.858 163.324 268.52 164.259 267.886C165.194 267.252 165.922 266.351 166.352 265.297C166.783 264.242 166.895 263.082 166.676 261.963C166.456 260.844 165.914 259.816 165.119 259.009C164.324 258.203 163.311 257.653 162.208 257.431C161.105 257.209 159.962 257.323 158.923 257.76C157.885 258.197 156.997 258.937 156.373 259.886C155.748 260.835 155.415 261.95 155.416 263.091C155.415 263.849 155.562 264.599 155.848 265.299C156.133 265.999 156.552 266.635 157.08 267.171C157.608 267.706 158.235 268.131 158.925 268.421C159.614 268.71 160.354 268.859 161.1 268.858Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M154.809 283.009C155.776 283.009 156.722 282.718 157.527 282.172C158.332 281.627 158.959 280.851 159.329 279.943C159.7 279.036 159.796 278.037 159.607 277.074C159.418 276.111 158.952 275.226 158.268 274.532C157.583 273.837 156.711 273.365 155.762 273.173C154.813 272.982 153.829 273.081 152.935 273.457C152.041 273.833 151.277 274.47 150.739 275.287C150.202 276.103 149.915 277.064 149.916 278.046C149.916 279.362 150.432 280.625 151.349 281.556C152.267 282.486 153.511 283.009 154.809 283.009Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M148.366 297.094C150.631 297.094 152.467 295.23 152.467 292.932C152.467 290.633 150.631 288.77 148.366 288.77C146.101 288.77 144.265 290.633 144.265 292.932C144.265 295.23 146.101 297.094 148.366 297.094Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M141.776 311.136C142.436 311.136 143.081 310.937 143.63 310.565C144.179 310.193 144.606 309.664 144.859 309.046C145.111 308.427 145.177 307.746 145.049 307.089C144.92 306.432 144.602 305.829 144.135 305.355C143.669 304.882 143.074 304.559 142.427 304.428C141.78 304.298 141.109 304.365 140.499 304.621C139.889 304.877 139.368 305.311 139.001 305.868C138.635 306.425 138.439 307.08 138.439 307.75C138.439 308.648 138.791 309.509 139.416 310.144C140.042 310.779 140.891 311.136 141.776 311.136Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M137.439 323.507C137.989 322.16 137.359 320.615 136.031 320.057C134.703 319.499 133.181 320.139 132.631 321.486C132.082 322.834 132.712 324.378 134.04 324.936C135.367 325.494 136.889 324.855 137.439 323.507Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M128.149 339.102C128.523 339.102 128.889 338.989 129.199 338.778C129.51 338.568 129.752 338.268 129.895 337.918C130.038 337.567 130.076 337.182 130.003 336.809C129.93 336.437 129.75 336.096 129.486 335.827C129.221 335.559 128.885 335.376 128.518 335.302C128.151 335.228 127.771 335.266 127.426 335.412C127.081 335.557 126.785 335.803 126.578 336.118C126.37 336.433 126.259 336.804 126.259 337.184C126.259 337.692 126.458 338.18 126.813 338.54C127.167 338.9 127.648 339.102 128.149 339.102Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M121.114 353.015C121.354 353.015 121.589 352.942 121.789 352.807C121.989 352.671 122.145 352.478 122.237 352.253C122.329 352.028 122.353 351.779 122.306 351.54C122.259 351.301 122.144 351.081 121.974 350.908C121.804 350.736 121.587 350.618 121.351 350.571C121.115 350.523 120.871 350.547 120.649 350.641C120.426 350.734 120.236 350.892 120.103 351.095C119.969 351.298 119.898 351.537 119.898 351.781C119.898 352.108 120.026 352.422 120.254 352.653C120.482 352.885 120.791 353.015 121.114 353.015Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M113.932 366.947C114.056 366.947 114.178 366.909 114.282 366.839C114.385 366.769 114.466 366.669 114.514 366.552C114.561 366.435 114.574 366.307 114.55 366.183C114.525 366.059 114.465 365.945 114.377 365.855C114.289 365.766 114.177 365.705 114.055 365.68C113.932 365.656 113.806 365.668 113.691 365.717C113.576 365.765 113.477 365.847 113.408 365.952C113.339 366.057 113.302 366.181 113.302 366.307C113.302 366.477 113.368 366.639 113.486 366.759C113.604 366.879 113.765 366.947 113.932 366.947Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M106.603 380.886C106.626 380.887 106.648 380.88 106.667 380.868C106.686 380.855 106.701 380.837 106.709 380.816C106.718 380.795 106.721 380.772 106.716 380.749C106.712 380.727 106.701 380.706 106.685 380.69C106.669 380.674 106.649 380.663 106.627 380.658C106.605 380.654 106.582 380.656 106.561 380.665C106.54 380.674 106.522 380.689 106.51 380.709C106.498 380.728 106.491 380.751 106.492 380.773C106.492 380.803 106.504 380.832 106.525 380.853C106.546 380.874 106.574 380.886 106.603 380.886Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M253.936 16.5449C253.997 16.5449 254.057 16.5264 254.108 16.4917C254.16 16.4571 254.199 16.4078 254.223 16.3502C254.246 16.2925 254.253 16.2291 254.241 16.1679C254.229 16.1068 254.199 16.0506 254.156 16.0064C254.112 15.9623 254.057 15.9323 253.996 15.9201C253.936 15.908 253.874 15.9142 253.817 15.9381C253.76 15.9619 253.712 16.0024 253.677 16.0542C253.643 16.1061 253.625 16.1671 253.625 16.2295C253.626 16.313 253.658 16.3929 253.717 16.4519C253.775 16.5109 253.854 16.5443 253.936 16.5449Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M250.158 32.9184C250.331 32.9184 250.501 32.8661 250.645 32.7682C250.79 32.6703 250.902 32.5312 250.969 32.3684C251.035 32.2057 251.052 32.0266 251.019 31.8538C250.985 31.6809 250.901 31.5222 250.778 31.3976C250.656 31.2731 250.499 31.1882 250.329 31.1538C250.159 31.1195 249.982 31.1371 249.822 31.2045C249.661 31.272 249.524 31.3861 249.428 31.5326C249.331 31.6791 249.28 31.8514 249.28 32.0275C249.28 32.2638 249.372 32.4904 249.537 32.6574C249.701 32.8245 249.925 32.9184 250.158 32.9184Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M246.57 49.3185C247.39 49.1214 247.898 48.2866 247.704 47.4539C247.51 46.6213 246.687 46.1061 245.867 46.3032C245.046 46.5003 244.538 47.3352 244.733 48.1678C244.927 49.0005 245.749 49.5157 246.57 49.3185Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M242.125 65.7453C242.562 65.7457 242.989 65.6147 243.352 65.3687C243.716 65.1228 243.999 64.773 244.166 64.3636C244.334 63.9542 244.377 63.5037 244.292 63.069C244.207 62.6343 243.997 62.235 243.688 61.9217C243.379 61.6083 242.986 61.3949 242.558 61.3086C242.129 61.2222 241.685 61.2667 241.282 61.4365C240.879 61.6063 240.534 61.8937 240.292 62.2624C240.049 62.6311 239.92 63.0644 239.92 63.5076C239.92 64.1011 240.153 64.6702 240.566 65.0899C240.98 65.5095 241.541 65.7453 242.125 65.7453Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M238.318 82.1107C239.908 81.8601 240.996 80.3492 240.749 78.736C240.502 77.1229 239.014 76.0183 237.424 76.2689C235.835 76.5195 234.746 78.0304 234.993 79.6435C235.24 81.2567 236.729 82.3613 238.318 82.1107Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M233.467 98.5453C235.497 98.5453 237.144 96.8746 237.144 94.8137C237.144 92.7527 235.497 91.082 233.467 91.082C231.436 91.082 229.79 92.7527 229.79 94.8137C229.79 96.8746 231.436 98.5453 233.467 98.5453Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M228.906 114.93C229.79 114.932 230.655 114.667 231.391 114.17C232.127 113.673 232.702 112.966 233.042 112.137C233.382 111.309 233.472 110.397 233.3 109.516C233.129 108.636 232.704 107.827 232.08 107.191C231.455 106.556 230.659 106.123 229.792 105.947C228.925 105.771 228.026 105.861 227.208 106.204C226.391 106.547 225.693 107.128 225.201 107.874C224.71 108.62 224.447 109.497 224.447 110.394C224.447 111.595 224.917 112.747 225.752 113.597C226.588 114.448 227.722 114.927 228.906 114.93Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M224.187 131.271C225.228 131.273 226.246 130.962 227.113 130.376C227.979 129.791 228.655 128.958 229.055 127.983C229.454 127.007 229.56 125.934 229.358 124.897C229.156 123.861 228.656 122.909 227.921 122.161C227.186 121.413 226.248 120.904 225.228 120.697C224.207 120.49 223.149 120.595 222.187 120.999C221.225 121.403 220.403 122.087 219.824 122.965C219.246 123.843 218.937 124.876 218.937 125.932C218.938 127.346 219.491 128.702 220.475 129.703C221.459 130.704 222.794 131.267 224.187 131.271Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M219.313 147.589C222.671 147.589 225.392 144.827 225.392 141.42C225.392 138.012 222.671 135.25 219.313 135.25C215.955 135.25 213.233 138.012 213.233 141.42C213.233 144.827 215.955 147.589 219.313 147.589Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M213.855 162.824C215.141 162.824 216.398 162.443 217.467 161.729C218.536 161.015 219.369 159.999 219.861 158.812C220.353 157.624 220.481 156.317 220.231 155.056C219.98 153.795 219.361 152.637 218.452 151.728C217.543 150.819 216.384 150.2 215.124 149.949C213.863 149.698 212.556 149.827 211.368 150.319C210.18 150.811 209.165 151.644 208.451 152.713C207.737 153.782 207.355 155.039 207.355 156.324C207.355 158.048 208.04 159.701 209.259 160.92C210.478 162.139 212.132 162.824 213.855 162.824Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M208.393 177.922C209.679 177.922 210.935 177.54 212.004 176.825C213.072 176.111 213.905 175.096 214.397 173.908C214.889 172.72 215.017 171.413 214.766 170.153C214.515 168.892 213.896 167.734 212.987 166.825C212.078 165.916 210.919 165.297 209.659 165.047C208.398 164.796 207.091 164.925 205.903 165.417C204.716 165.909 203.701 166.742 202.986 167.811C202.272 168.88 201.891 170.136 201.891 171.422C201.891 172.276 202.059 173.121 202.386 173.91C202.713 174.698 203.192 175.415 203.796 176.019C204.399 176.622 205.116 177.101 205.905 177.428C206.694 177.754 207.539 177.922 208.393 177.922Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M208.787 190.555C210.144 187.231 208.561 183.409 205.251 182.018C201.942 180.627 198.16 182.193 196.803 185.517C195.446 188.841 197.029 192.663 200.339 194.054C203.648 195.445 207.431 193.878 208.787 190.555Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M203.303 203.15C203.479 199.565 200.716 196.511 197.131 196.329C193.546 196.147 190.496 198.907 190.32 202.492C190.143 206.078 192.906 209.132 196.492 209.313C200.077 209.495 203.126 206.736 203.303 203.15Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M191.929 223.746C193.215 223.746 194.471 223.365 195.54 222.651C196.609 221.936 197.442 220.921 197.934 219.734C198.426 218.546 198.555 217.239 198.304 215.978C198.053 214.717 197.434 213.559 196.525 212.65C195.616 211.741 194.458 211.122 193.197 210.871C191.936 210.62 190.629 210.749 189.442 211.241C188.254 211.733 187.239 212.566 186.525 213.635C185.81 214.704 185.429 215.96 185.429 217.246C185.429 218.1 185.597 218.945 185.923 219.734C186.25 220.523 186.729 221.239 187.332 221.843C187.936 222.446 188.653 222.925 189.441 223.252C190.23 223.578 191.076 223.746 191.929 223.746Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M186.145 238.902C187.43 238.901 188.687 238.518 189.755 237.803C190.823 237.087 191.655 236.071 192.145 234.882C192.636 233.694 192.763 232.387 192.511 231.126C192.258 229.866 191.638 228.708 190.727 227.8C189.817 226.892 188.658 226.275 187.397 226.026C186.135 225.776 184.829 225.907 183.641 226.401C182.454 226.894 181.44 227.729 180.728 228.799C180.015 229.869 179.635 231.126 179.637 232.412C179.638 233.265 179.807 234.11 180.135 234.898C180.463 235.687 180.942 236.402 181.546 237.005C182.151 237.608 182.868 238.086 183.657 238.411C184.446 238.737 185.291 238.904 186.145 238.902Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M180.562 254.375C184.151 254.375 187.062 251.465 187.062 247.875C187.062 244.285 184.151 241.375 180.562 241.375C176.972 241.375 174.062 244.285 174.062 247.875C174.062 251.465 176.972 254.375 180.562 254.375Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M174.813 269.463C176.006 269.465 177.172 269.107 178.164 268.436C179.156 267.765 179.929 266.81 180.387 265.692C180.844 264.575 180.964 263.345 180.731 262.158C180.499 260.971 179.925 259.881 179.082 259.025C178.239 258.17 177.165 257.587 175.995 257.351C174.826 257.116 173.614 257.238 172.512 257.701C171.411 258.165 170.47 258.95 169.809 259.957C169.147 260.964 168.795 262.147 168.797 263.357C168.799 264.976 169.434 266.528 170.562 267.672C171.689 268.817 173.218 269.461 174.813 269.463Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M168.57 283.613C169.599 283.613 170.605 283.303 171.461 282.723C172.317 282.142 172.984 281.318 173.378 280.353C173.772 279.388 173.875 278.326 173.674 277.301C173.473 276.277 172.977 275.336 172.25 274.598C171.522 273.859 170.595 273.356 169.585 273.152C168.576 272.948 167.53 273.053 166.579 273.453C165.628 273.852 164.815 274.529 164.243 275.398C163.671 276.266 163.366 277.287 163.366 278.332C163.367 279.732 163.915 281.075 164.891 282.065C165.867 283.056 167.19 283.612 168.57 283.613Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.178 297.685C163.045 297.685 163.893 297.424 164.614 296.935C165.335 296.446 165.897 295.751 166.229 294.937C166.561 294.124 166.648 293.229 166.478 292.366C166.309 291.503 165.891 290.71 165.278 290.088C164.664 289.466 163.883 289.042 163.032 288.87C162.181 288.699 161.3 288.787 160.498 289.124C159.697 289.462 159.012 290.032 158.531 290.764C158.049 291.496 157.793 292.357 157.793 293.237C157.793 293.821 157.906 294.4 158.127 294.94C158.347 295.479 158.67 295.97 159.077 296.383C159.485 296.796 159.968 297.124 160.5 297.347C161.032 297.57 161.602 297.685 162.178 297.685Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M155.636 311.754C156.352 311.754 157.052 311.539 157.647 311.135C158.243 310.732 158.707 310.158 158.981 309.486C159.255 308.815 159.327 308.076 159.187 307.364C159.047 306.651 158.702 305.996 158.196 305.482C157.69 304.969 157.045 304.619 156.342 304.477C155.64 304.335 154.912 304.408 154.251 304.686C153.589 304.964 153.024 305.435 152.626 306.039C152.228 306.643 152.016 307.354 152.016 308.08C152.016 309.055 152.397 309.989 153.076 310.678C153.755 311.367 154.676 311.754 155.636 311.754Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M148.948 325.75C150.525 325.75 151.804 324.452 151.804 322.852C151.804 321.251 150.525 319.953 148.948 319.953C147.37 319.953 146.092 321.251 146.092 322.852C146.092 324.452 147.37 325.75 148.948 325.75Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M142.112 339.736C142.538 339.736 142.953 339.608 143.307 339.368C143.661 339.128 143.936 338.787 144.099 338.389C144.262 337.99 144.304 337.551 144.221 337.128C144.138 336.704 143.934 336.315 143.633 336.01C143.332 335.705 142.949 335.497 142.532 335.413C142.115 335.329 141.682 335.372 141.289 335.537C140.896 335.702 140.561 335.982 140.324 336.341C140.088 336.7 139.962 337.122 139.962 337.553C139.962 338.132 140.188 338.687 140.592 339.096C140.995 339.506 141.542 339.736 142.112 339.736Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M135.13 353.683C135.42 353.683 135.705 353.595 135.946 353.431C136.188 353.267 136.377 353.035 136.488 352.762C136.599 352.489 136.628 352.189 136.571 351.9C136.515 351.611 136.375 351.345 136.169 351.136C135.964 350.928 135.702 350.785 135.416 350.728C135.131 350.67 134.836 350.7 134.567 350.813C134.299 350.926 134.069 351.117 133.907 351.362C133.746 351.608 133.66 351.896 133.66 352.191C133.66 352.587 133.815 352.966 134.09 353.246C134.366 353.526 134.74 353.683 135.13 353.683Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M128.002 367.581C128.165 367.581 128.324 367.532 128.459 367.44C128.594 367.348 128.699 367.218 128.761 367.066C128.823 366.913 128.839 366.746 128.807 366.584C128.776 366.422 128.697 366.274 128.582 366.157C128.467 366.041 128.321 365.962 128.161 365.93C128.002 365.898 127.837 365.915 127.687 365.978C127.537 366.041 127.408 366.149 127.319 366.286C127.229 366.423 127.181 366.585 127.181 366.749C127.182 366.97 127.268 367.181 127.422 367.337C127.576 367.493 127.785 367.581 128.002 367.581Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M120.728 381.492C120.778 381.492 120.827 381.477 120.869 381.449C120.911 381.421 120.943 381.38 120.962 381.333C120.982 381.286 120.987 381.234 120.977 381.184C120.967 381.134 120.943 381.088 120.907 381.052C120.872 381.016 120.827 380.991 120.777 380.982C120.728 380.972 120.677 380.977 120.63 380.996C120.584 381.016 120.544 381.049 120.516 381.091C120.489 381.134 120.474 381.183 120.474 381.234C120.474 381.303 120.5 381.368 120.548 381.417C120.596 381.465 120.66 381.492 120.728 381.492Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M267.025 16.4823C267.063 16.4798 267.1 16.466 267.131 16.4425C267.162 16.419 267.185 16.3869 267.198 16.3502C267.211 16.3134 267.213 16.2736 267.204 16.2356C267.195 16.1976 267.176 16.1631 267.148 16.1364C267.12 16.1096 267.084 16.0918 267.046 16.085C267.009 16.0783 266.97 16.0829 266.934 16.0984C266.899 16.1139 266.869 16.1395 266.848 16.1721C266.826 16.2047 266.815 16.2429 266.815 16.282C266.815 16.3094 266.82 16.3365 266.831 16.3617C266.842 16.3869 266.857 16.4095 266.877 16.4283C266.897 16.4471 266.92 16.4616 266.946 16.4709C266.971 16.4801 266.998 16.484 267.025 16.4823Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M263.275 32.8075C263.415 32.8075 263.551 32.7654 263.668 32.6865C263.784 32.6075 263.875 32.4954 263.928 32.3641C263.982 32.2329 263.996 32.0885 263.969 31.9492C263.941 31.8099 263.874 31.6819 263.775 31.5815C263.676 31.481 263.55 31.4126 263.413 31.3849C263.275 31.3572 263.133 31.3714 263.004 31.4258C262.874 31.4801 262.764 31.5722 262.686 31.6903C262.608 31.8084 262.567 31.9472 262.567 32.0893C262.567 32.2798 262.641 32.4624 262.774 32.5971C262.907 32.7318 263.087 32.8075 263.275 32.8075Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M259.368 49.2058C259.631 49.2058 259.888 49.1267 260.107 48.9785C260.326 48.8303 260.496 48.6196 260.597 48.3731C260.697 48.1266 260.723 47.8553 260.672 47.5937C260.621 47.332 260.494 47.0916 260.308 46.9029C260.122 46.7143 259.886 46.5858 259.628 46.5337C259.37 46.4817 259.103 46.5084 258.86 46.6105C258.617 46.7126 258.409 46.8855 258.263 47.1074C258.117 47.3292 258.039 47.59 258.039 47.8568C258.039 48.2146 258.179 48.5577 258.428 48.8107C258.678 49.0637 259.016 49.2058 259.368 49.2058Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M257.32 63.688C257.375 62.5642 256.522 61.6076 255.415 61.5515C254.308 61.4954 253.365 62.3609 253.31 63.4847C253.254 64.6085 254.107 65.565 255.215 65.6212C256.322 65.6773 257.265 64.8118 257.32 63.688Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M251.088 82.0229C251.625 82.0229 252.15 81.8613 252.596 81.5585C253.043 81.2557 253.391 80.8253 253.596 80.3218C253.802 79.8183 253.856 79.2642 253.751 78.7297C253.646 78.1952 253.388 77.7042 253.008 77.3188C252.628 76.9334 252.144 76.671 251.618 76.5647C251.091 76.4583 250.545 76.5129 250.049 76.7215C249.553 76.93 249.129 77.2832 248.83 77.7364C248.532 78.1895 248.373 78.7223 248.373 79.2673C248.373 79.9981 248.659 80.699 249.168 81.2158C249.677 81.7326 250.368 82.0229 251.088 82.0229Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M246.708 98.4092C247.39 98.4092 248.057 98.2039 248.625 97.8191C249.192 97.4344 249.634 96.8875 249.895 96.2477C250.156 95.6079 250.225 94.9039 250.092 94.2246C249.959 93.5454 249.63 92.9215 249.147 92.4318C248.665 91.9421 248.05 91.6086 247.381 91.4735C246.711 91.3384 246.018 91.4078 245.387 91.6728C244.757 91.9378 244.218 92.3866 243.839 92.9624C243.46 93.5382 243.257 94.2152 243.257 94.9077C243.258 95.8362 243.622 96.7265 244.269 97.383C244.915 98.0396 245.793 98.4087 246.708 98.4092Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M242.188 114.781C243.022 114.781 243.837 114.53 244.53 114.06C245.223 113.59 245.764 112.922 246.082 112.14C246.401 111.358 246.485 110.498 246.322 109.669C246.159 108.839 245.758 108.077 245.168 107.479C244.578 106.88 243.827 106.473 243.009 106.308C242.192 106.144 241.344 106.229 240.574 106.553C239.804 106.877 239.146 107.425 238.683 108.129C238.22 108.833 237.973 109.66 237.974 110.506C237.974 111.64 238.418 112.727 239.209 113.529C239.999 114.331 241.071 114.781 242.188 114.781Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M237.507 131.13C238.498 131.13 239.466 130.832 240.289 130.274C241.112 129.716 241.754 128.922 242.133 127.994C242.512 127.065 242.611 126.044 242.418 125.058C242.224 124.073 241.748 123.167 241.048 122.457C240.347 121.746 239.455 121.262 238.484 121.066C237.513 120.87 236.506 120.971 235.592 121.356C234.677 121.74 233.895 122.391 233.345 123.227C232.795 124.062 232.501 125.045 232.501 126.049C232.501 126.717 232.63 127.377 232.882 127.994C233.133 128.611 233.502 129.171 233.967 129.643C234.432 130.114 234.984 130.489 235.591 130.744C236.199 130.999 236.85 131.13 237.507 131.13Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M238.458 142.281C238.851 139.04 236.581 136.09 233.388 135.691C230.195 135.292 227.287 137.595 226.894 140.836C226.501 144.076 228.771 147.027 231.964 147.426C235.157 147.825 238.064 145.521 238.458 142.281Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M227.681 163.716C231.336 163.716 234.298 160.709 234.298 157C234.298 153.292 231.336 150.285 227.681 150.285C224.027 150.285 221.064 153.292 221.064 157C221.064 160.709 224.027 163.716 227.681 163.716Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M221.829 178.082C223.115 178.082 224.371 177.701 225.44 176.987C226.509 176.272 227.342 175.257 227.834 174.069C228.326 172.882 228.455 171.575 228.204 170.314C227.953 169.053 227.334 167.895 226.425 166.986C225.516 166.077 224.358 165.458 223.097 165.207C221.836 164.956 220.529 165.085 219.342 165.577C218.154 166.069 217.139 166.902 216.425 167.971C215.71 169.04 215.329 170.296 215.329 171.582C215.329 172.436 215.497 173.281 215.823 174.07C216.15 174.859 216.629 175.575 217.232 176.179C217.836 176.782 218.553 177.261 219.341 177.588C220.13 177.914 220.975 178.082 221.829 178.082Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M216.533 193.422C217.819 193.422 219.076 193.041 220.145 192.327C221.214 191.613 222.048 190.598 222.54 189.411C223.032 188.223 223.161 186.916 222.91 185.655C222.66 184.394 222.041 183.236 221.132 182.326C220.223 181.417 219.065 180.798 217.804 180.547C216.543 180.296 215.236 180.425 214.048 180.916C212.86 181.408 211.845 182.242 211.131 183.31C210.416 184.379 210.035 185.636 210.035 186.922C210.035 187.775 210.203 188.621 210.529 189.409C210.856 190.198 211.334 190.914 211.938 191.518C212.541 192.122 213.258 192.6 214.046 192.927C214.835 193.254 215.68 193.422 216.533 193.422Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M214.298 208.554C217.332 206.634 218.267 202.599 216.388 199.54C214.509 196.481 210.526 195.558 207.493 197.477C204.459 199.397 203.523 203.433 205.403 206.491C207.282 209.55 211.265 210.473 214.298 208.554Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M208.907 223.387C211.805 221.268 212.469 217.177 210.39 214.25C208.312 211.323 204.278 210.669 201.38 212.788C198.483 214.907 197.819 218.998 199.897 221.925C201.976 224.851 206.01 225.506 208.907 223.387Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M201.038 239.16C204.529 238.324 206.7 234.811 205.887 231.315C205.074 227.818 201.584 225.661 198.093 226.498C194.602 227.334 192.431 230.846 193.244 234.343C194.058 237.839 197.547 239.996 201.038 239.16Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M194.66 254.483C198.228 254.086 200.807 250.87 200.421 247.301C200.036 243.732 196.831 241.161 193.263 241.558C189.695 241.955 187.115 245.171 187.501 248.74C187.887 252.309 191.092 254.88 194.66 254.483Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M188.51 269.902C191.93 269.902 194.703 267.088 194.703 263.617C194.703 260.146 191.93 257.332 188.51 257.332C185.09 257.332 182.317 260.146 182.317 263.617C182.317 267.088 185.09 269.902 188.51 269.902Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M182.315 284.092C183.384 284.092 184.429 283.771 185.318 283.169C186.206 282.566 186.899 281.71 187.309 280.708C187.718 279.706 187.825 278.603 187.617 277.539C187.408 276.475 186.893 275.498 186.138 274.731C185.382 273.964 184.419 273.442 183.371 273.23C182.322 273.019 181.236 273.128 180.248 273.543C179.261 273.958 178.417 274.661 177.823 275.563C177.23 276.465 176.913 277.526 176.914 278.611C176.914 280.064 177.483 281.458 178.496 282.486C179.509 283.514 180.882 284.091 182.315 284.092Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M175.973 298.217C176.886 298.217 177.78 297.942 178.539 297.427C179.299 296.912 179.891 296.179 180.241 295.323C180.591 294.466 180.682 293.523 180.504 292.614C180.326 291.704 179.886 290.869 179.239 290.213C178.593 289.557 177.77 289.111 176.874 288.93C175.978 288.749 175.049 288.842 174.205 289.197C173.36 289.552 172.639 290.153 172.131 290.924C171.624 291.695 171.353 292.601 171.353 293.528C171.353 294.772 171.839 295.964 172.706 296.844C173.572 297.723 174.747 298.217 175.973 298.217Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M169.479 312.276C170.235 312.276 170.973 312.049 171.601 311.623C172.228 311.198 172.718 310.592 173.007 309.884C173.296 309.177 173.371 308.397 173.224 307.646C173.077 306.894 172.713 306.204 172.179 305.662C171.645 305.12 170.965 304.751 170.224 304.602C169.484 304.452 168.716 304.529 168.018 304.822C167.321 305.116 166.725 305.612 166.305 306.249C165.886 306.886 165.662 307.635 165.662 308.402C165.662 309.429 166.064 310.415 166.78 311.141C167.496 311.868 168.467 312.276 169.479 312.276Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.842 326.327C163.452 326.329 164.048 326.147 164.557 325.804C165.065 325.462 165.461 324.973 165.696 324.402C165.93 323.83 165.993 323.201 165.875 322.594C165.757 321.986 165.464 321.428 165.033 320.99C164.602 320.551 164.053 320.252 163.454 320.131C162.856 320.01 162.236 320.071 161.672 320.308C161.108 320.544 160.626 320.945 160.287 321.46C159.948 321.974 159.767 322.58 159.767 323.199C159.767 324.027 160.091 324.822 160.667 325.408C161.243 325.994 162.025 326.325 162.842 326.327Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M157.714 339.611C158.631 338.68 158.631 337.171 157.714 336.241C156.797 335.311 155.311 335.311 154.394 336.241C153.477 337.171 153.477 338.68 154.394 339.611C155.311 340.541 156.797 340.541 157.714 339.611Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M149.166 354.287C150.087 354.254 150.808 353.469 150.775 352.534C150.742 351.598 149.968 350.867 149.047 350.901C148.125 350.934 147.405 351.719 147.438 352.654C147.471 353.589 148.244 354.32 149.166 354.287Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M142.051 368.204C142.253 368.204 142.45 368.143 142.617 368.03C142.785 367.916 142.915 367.755 142.992 367.566C143.069 367.377 143.089 367.169 143.05 366.969C143.011 366.768 142.914 366.584 142.771 366.439C142.629 366.295 142.447 366.196 142.25 366.157C142.052 366.117 141.848 366.137 141.661 366.215C141.475 366.294 141.316 366.426 141.204 366.596C141.092 366.766 141.033 366.966 141.033 367.17C141.033 367.444 141.14 367.707 141.331 367.901C141.522 368.095 141.781 368.204 142.051 368.204Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M134.831 382.114C134.914 382.114 134.995 382.089 135.064 382.042C135.134 381.996 135.187 381.929 135.219 381.851C135.251 381.773 135.259 381.687 135.243 381.605C135.227 381.522 135.187 381.446 135.128 381.387C135.069 381.327 134.995 381.286 134.913 381.27C134.832 381.253 134.747 381.262 134.67 381.294C134.594 381.326 134.528 381.381 134.482 381.451C134.436 381.521 134.411 381.604 134.411 381.688C134.411 381.801 134.455 381.909 134.534 381.989C134.613 382.069 134.72 382.114 134.831 382.114Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M127.469 396.151C127.472 396.151 127.476 396.151 127.48 396.15C127.483 396.148 127.486 396.146 127.489 396.144C127.492 396.141 127.494 396.138 127.496 396.134C127.497 396.131 127.498 396.127 127.498 396.123C127.498 396.116 127.495 396.108 127.489 396.102C127.484 396.097 127.476 396.094 127.469 396.094C127.465 396.094 127.461 396.095 127.458 396.096C127.454 396.098 127.451 396.1 127.449 396.103C127.446 396.105 127.444 396.109 127.443 396.112C127.442 396.116 127.441 396.12 127.441 396.123C127.441 396.131 127.444 396.138 127.449 396.143C127.455 396.148 127.461 396.151 127.469 396.151Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M280.097 16.3918C280.112 16.3918 280.127 16.3858 280.137 16.375C280.148 16.3643 280.154 16.3497 280.154 16.3346C280.154 16.3194 280.148 16.3048 280.137 16.2941C280.127 16.2834 280.112 16.2773 280.097 16.2773C280.09 16.2773 280.083 16.2788 280.076 16.2817C280.069 16.2846 280.063 16.2888 280.058 16.2941C280.052 16.2994 280.048 16.3057 280.045 16.3127C280.042 16.3196 280.041 16.327 280.041 16.3346C280.041 16.3421 280.042 16.3495 280.045 16.3565C280.048 16.3634 280.052 16.3697 280.058 16.375C280.063 16.3803 280.069 16.3846 280.076 16.3874C280.083 16.3903 280.09 16.3918 280.097 16.3918Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M276.387 32.6927C276.493 32.6927 276.597 32.6607 276.685 32.6008C276.774 32.5408 276.843 32.4556 276.883 32.3559C276.924 32.2562 276.935 32.1465 276.914 32.0407C276.893 31.9349 276.842 31.8377 276.767 31.7614C276.692 31.6851 276.596 31.6331 276.492 31.612C276.387 31.591 276.279 31.6018 276.181 31.6431C276.083 31.6844 275.999 31.7543 275.94 31.844C275.881 31.9338 275.849 32.0392 275.849 32.1471C275.849 32.2918 275.906 32.4306 276.007 32.5329C276.107 32.6352 276.244 32.6927 276.387 32.6927Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M272.51 49.0708C272.734 49.0708 272.953 49.0035 273.139 48.8772C273.325 48.751 273.47 48.5716 273.556 48.3617C273.642 48.1518 273.664 47.9209 273.62 47.698C273.577 47.4752 273.469 47.2705 273.311 47.1099C273.152 46.9492 272.951 46.8398 272.731 46.7955C272.512 46.7512 272.284 46.7739 272.077 46.8609C271.87 46.9478 271.694 47.095 271.569 47.2839C271.445 47.4728 271.378 47.6949 271.378 47.9221C271.378 48.073 271.408 48.2223 271.465 48.3617C271.521 48.5011 271.605 48.6277 271.71 48.7344C271.815 48.841 271.94 48.9257 272.077 48.9834C272.215 49.0411 272.362 49.0708 272.51 49.0708Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M268.48 65.4664C268.833 65.4664 269.178 65.3602 269.471 65.1613C269.764 64.9624 269.993 64.6797 270.128 64.3489C270.262 64.0182 270.298 63.6543 270.229 63.3032C270.16 62.9522 269.99 62.6298 269.74 62.3768C269.491 62.1239 269.173 61.9517 268.827 61.8822C268.481 61.8126 268.122 61.8487 267.796 61.986C267.471 62.1233 267.192 62.3555 266.997 62.6533C266.801 62.9512 266.697 63.3012 266.697 63.6591C266.697 63.8966 266.743 64.1318 266.833 64.3512C266.923 64.5706 267.054 64.7699 267.22 64.9378C267.385 65.1056 267.582 65.2387 267.798 65.3294C268.014 65.4201 268.246 65.4666 268.48 65.4664Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M264.295 81.8509C264.782 81.8496 265.257 81.7021 265.661 81.4268C266.065 81.1516 266.379 80.7611 266.565 80.3046C266.75 79.8481 266.798 79.3461 266.702 78.862C266.606 78.3779 266.371 77.9334 266.027 77.5848C265.683 77.2361 265.244 76.9989 264.767 76.903C264.289 76.8071 263.795 76.857 263.346 77.0462C262.896 77.2354 262.512 77.5556 262.242 77.9662C261.972 78.3768 261.828 78.8594 261.828 79.3532C261.828 79.6817 261.892 80.007 262.016 80.3105C262.14 80.6139 262.322 80.8896 262.551 81.1216C262.78 81.3536 263.052 81.5374 263.351 81.6626C263.651 81.7877 263.971 81.8517 264.295 81.8509Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M259.971 98.1937C261.72 98.1897 263.134 96.7475 263.13 94.9726C263.126 93.1977 261.705 91.7621 259.956 91.7661C258.207 91.7702 256.793 93.2123 256.797 94.9872C256.801 96.7621 258.222 98.1977 259.971 98.1937Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M255.462 114.568C256.235 114.569 256.99 114.337 257.632 113.901C258.274 113.466 258.775 112.847 259.071 112.123C259.367 111.399 259.444 110.603 259.293 109.834C259.143 109.065 258.771 108.359 258.225 107.805C257.679 107.251 256.983 106.873 256.226 106.721C255.468 106.568 254.683 106.646 253.97 106.947C253.256 107.247 252.646 107.755 252.218 108.407C251.789 109.058 251.56 109.825 251.561 110.608C251.561 111.659 251.972 112.666 252.703 113.408C253.435 114.151 254.428 114.568 255.462 114.568Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M254.115 129.516C255.938 127.667 255.938 124.669 254.115 122.82C252.293 120.97 249.339 120.97 247.516 122.82C245.694 124.669 245.694 127.667 247.516 129.516C249.339 131.366 252.293 131.366 254.115 129.516Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M246.019 147.19C247.093 147.191 248.143 146.868 249.037 146.263C249.93 145.657 250.626 144.797 251.038 143.79C251.449 142.783 251.557 141.674 251.348 140.605C251.138 139.536 250.621 138.554 249.862 137.783C249.102 137.012 248.135 136.487 247.081 136.274C246.028 136.061 244.936 136.17 243.943 136.587C242.951 137.004 242.103 137.711 241.506 138.617C240.909 139.523 240.59 140.589 240.59 141.679C240.59 143.14 241.162 144.542 242.18 145.575C243.198 146.609 244.579 147.19 246.019 147.19Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M241.069 163.429C242.295 163.43 243.493 163.061 244.512 162.37C245.532 161.679 246.326 160.697 246.795 159.547C247.264 158.398 247.386 157.133 247.147 155.913C246.907 154.693 246.316 153.573 245.449 152.694C244.581 151.815 243.476 151.217 242.274 150.975C241.071 150.734 239.825 150.859 238.693 151.337C237.562 151.814 236.595 152.622 235.915 153.657C235.236 154.692 234.874 155.909 234.876 157.153C234.878 158.818 235.532 160.415 236.693 161.592C237.854 162.768 239.428 163.429 241.069 163.429Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M235.966 179.585C237.336 179.585 238.676 179.173 239.816 178.4C240.955 177.627 241.844 176.529 242.368 175.244C242.893 173.959 243.03 172.545 242.763 171.18C242.495 169.816 241.835 168.563 240.866 167.579C239.897 166.596 238.662 165.926 237.318 165.655C235.973 165.383 234.58 165.523 233.314 166.055C232.047 166.587 230.965 167.489 230.204 168.645C229.442 169.802 229.036 171.161 229.036 172.552C229.036 174.418 229.766 176.206 231.065 177.525C232.365 178.844 234.128 179.585 235.966 179.585Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M230.695 193.634C234.258 193.189 236.795 189.94 236.362 186.376C235.93 182.812 232.692 180.284 229.13 180.729C225.567 181.174 223.03 184.424 223.463 187.988C223.895 191.552 227.133 194.08 230.695 193.634Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M225.611 208.937C229.141 208.287 231.492 204.896 230.86 201.362C230.228 197.828 226.854 195.49 223.324 196.14C219.793 196.79 217.443 200.181 218.075 203.715C218.706 207.249 222.08 209.587 225.611 208.937Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M219.041 224.145C220.326 224.145 221.583 223.764 222.652 223.05C223.722 222.336 224.555 221.321 225.047 220.133C225.54 218.945 225.668 217.638 225.418 216.377C225.167 215.116 224.548 213.957 223.639 213.048C222.73 212.139 221.571 211.52 220.31 211.269C219.049 211.019 217.742 211.147 216.554 211.64C215.366 212.132 214.351 212.965 213.637 214.035C212.923 215.104 212.542 216.361 212.542 217.646C212.542 219.37 213.227 221.023 214.446 222.241C215.664 223.46 217.317 224.145 219.041 224.145Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M219.353 236.161C220.379 232.721 218.43 229.078 214.998 228.023C211.567 226.968 207.953 228.902 206.926 232.342C205.9 235.782 207.849 239.425 211.281 240.48C214.712 241.535 218.326 239.601 219.353 236.161Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M208.691 254.726C212.234 254.142 214.645 250.796 214.078 247.251C213.511 243.706 210.18 241.305 206.638 241.889C203.096 242.472 200.684 245.819 201.251 249.364C201.818 252.909 205.149 255.309 208.691 254.726Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M203.482 270.051C206.844 269.327 208.991 265.975 208.277 262.563C207.564 259.152 204.26 256.973 200.899 257.697C197.537 258.421 195.39 261.773 196.104 265.185C196.817 268.596 200.12 270.775 203.482 270.051Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M196.047 284.45C197.132 284.45 198.193 284.123 199.096 283.511C199.998 282.899 200.701 282.029 201.117 281.012C201.532 279.994 201.641 278.874 201.429 277.794C201.217 276.714 200.694 275.721 199.926 274.943C199.159 274.164 198.181 273.634 197.116 273.419C196.052 273.205 194.948 273.315 193.946 273.737C192.943 274.159 192.086 274.873 191.483 275.789C190.881 276.705 190.559 277.782 190.56 278.883C190.56 279.615 190.702 280.339 190.977 281.014C191.253 281.69 191.657 282.303 192.167 282.82C192.676 283.337 193.281 283.747 193.947 284.027C194.613 284.306 195.326 284.45 196.047 284.45Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M193.09 297.221C194.934 295.349 194.934 292.315 193.09 290.443C191.245 288.571 188.255 288.571 186.41 290.443C184.566 292.315 184.566 295.349 186.41 297.221C188.255 299.093 191.245 299.093 193.09 297.221Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M183.306 312.734C184.09 312.734 184.856 312.499 185.507 312.058C186.159 311.616 186.667 310.989 186.967 310.254C187.267 309.52 187.346 308.712 187.193 307.932C187.04 307.152 186.663 306.436 186.11 305.873C185.556 305.311 184.85 304.928 184.082 304.773C183.313 304.617 182.517 304.697 181.793 305.001C181.069 305.305 180.451 305.82 180.015 306.481C179.58 307.142 179.348 307.92 179.348 308.715C179.348 309.78 179.765 310.802 180.507 311.556C181.249 312.31 182.256 312.733 183.306 312.734Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M176.718 326.808C177.356 326.808 177.979 326.616 178.509 326.257C179.039 325.897 179.452 325.387 179.696 324.789C179.94 324.191 180.004 323.533 179.88 322.899C179.755 322.264 179.448 321.681 178.998 321.224C178.547 320.766 177.972 320.455 177.347 320.328C176.722 320.202 176.074 320.267 175.485 320.515C174.896 320.762 174.392 321.182 174.038 321.72C173.684 322.257 173.495 322.89 173.495 323.537C173.495 324.405 173.834 325.237 174.439 325.85C175.043 326.464 175.863 326.808 176.718 326.808Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M170.541 340.758C171.878 340.437 172.707 339.077 172.391 337.72C172.075 336.362 170.735 335.521 169.398 335.842C168.06 336.162 167.232 337.522 167.547 338.88C167.863 340.237 169.203 341.078 170.541 340.758Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M163.104 354.811C163.462 354.811 163.812 354.703 164.109 354.501C164.407 354.299 164.639 354.012 164.776 353.677C164.913 353.341 164.949 352.972 164.879 352.615C164.809 352.259 164.637 351.932 164.384 351.675C164.131 351.418 163.808 351.243 163.457 351.172C163.106 351.101 162.742 351.138 162.411 351.277C162.08 351.416 161.797 351.651 161.599 351.953C161.4 352.255 161.293 352.61 161.293 352.974C161.293 353.461 161.484 353.928 161.824 354.273C162.163 354.617 162.624 354.811 163.104 354.811Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M156.082 368.763C156.311 368.764 156.536 368.695 156.727 368.566C156.919 368.436 157.068 368.253 157.156 368.037C157.244 367.822 157.267 367.585 157.223 367.356C157.178 367.127 157.068 366.917 156.906 366.752C156.743 366.587 156.536 366.475 156.311 366.429C156.086 366.383 155.852 366.407 155.64 366.496C155.427 366.585 155.246 366.736 155.118 366.93C154.991 367.124 154.922 367.352 154.922 367.585C154.922 367.897 155.044 368.196 155.262 368.417C155.479 368.638 155.774 368.763 156.082 368.763Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M148.916 382.698C149.028 382.698 149.138 382.664 149.231 382.601C149.324 382.538 149.397 382.448 149.44 382.342C149.483 382.237 149.494 382.122 149.472 382.01C149.45 381.898 149.396 381.796 149.317 381.715C149.238 381.635 149.137 381.58 149.027 381.558C148.917 381.536 148.803 381.547 148.699 381.591C148.596 381.634 148.507 381.708 148.445 381.803C148.382 381.897 148.349 382.008 148.349 382.122C148.349 382.275 148.409 382.421 148.515 382.529C148.622 382.637 148.766 382.698 148.916 382.698Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M141.606 396.677C141.622 396.677 141.638 396.672 141.652 396.663C141.666 396.654 141.676 396.641 141.683 396.625C141.689 396.61 141.691 396.592 141.687 396.576C141.684 396.56 141.676 396.545 141.665 396.533C141.653 396.521 141.638 396.513 141.622 396.509C141.606 396.506 141.589 396.508 141.574 396.514C141.558 396.521 141.545 396.532 141.536 396.545C141.527 396.559 141.522 396.576 141.522 396.593C141.522 396.615 141.531 396.637 141.546 396.653C141.562 396.668 141.583 396.677 141.606 396.677Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M289.493 32.5499C289.56 32.5499 289.626 32.5296 289.682 32.4917C289.738 32.4537 289.782 32.3998 289.807 32.3367C289.833 32.2737 289.84 32.2042 289.827 32.1373C289.814 32.0703 289.781 32.0088 289.734 31.9605C289.686 31.9122 289.625 31.8793 289.559 31.866C289.493 31.8527 289.425 31.8595 289.363 31.8857C289.301 31.9118 289.248 31.956 289.21 32.0128C289.173 32.0696 289.153 32.1363 289.153 32.2046C289.153 32.2962 289.189 32.384 289.252 32.4487C289.316 32.5135 289.403 32.5499 289.493 32.5499Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M285.646 48.9074C285.825 48.9074 286 48.8535 286.149 48.7526C286.298 48.6516 286.414 48.5082 286.482 48.3403C286.551 48.1725 286.568 47.9878 286.534 47.8096C286.499 47.6315 286.412 47.4678 286.286 47.3393C286.159 47.2109 285.998 47.1234 285.822 47.088C285.647 47.0525 285.465 47.0707 285.299 47.1402C285.134 47.2097 284.993 47.3275 284.893 47.4785C284.794 47.6296 284.741 47.8072 284.741 47.9888C284.741 48.2324 284.836 48.4661 285.006 48.6383C285.176 48.8106 285.406 48.9074 285.646 48.9074Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M281.647 65.2542C281.944 65.2542 282.234 65.165 282.48 64.9978C282.727 64.8306 282.919 64.5929 283.033 64.3149C283.146 64.0368 283.176 63.7309 283.118 63.4357C283.06 63.1406 282.917 62.8694 282.708 62.6566C282.498 62.4438 282.231 62.2989 281.94 62.2402C281.649 62.1815 281.348 62.2116 281.074 62.3268C280.8 62.4419 280.565 62.637 280.401 62.8872C280.236 63.1374 280.148 63.4316 280.148 63.7326C280.148 64.1361 280.306 64.5232 280.587 64.8085C280.868 65.0939 281.25 65.2542 281.647 65.2542Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M277.494 81.6427C277.924 81.6427 278.345 81.513 278.703 81.2702C279.062 81.0274 279.341 80.6822 279.506 80.2784C279.67 79.8746 279.714 79.4302 279.63 79.0015C279.545 78.5728 279.338 78.179 279.034 77.87C278.729 77.5609 278.341 77.3504 277.918 77.2651C277.496 77.1798 277.058 77.2236 276.66 77.3909C276.262 77.5581 275.922 77.8414 275.683 78.2048C275.444 78.5683 275.316 78.9956 275.316 79.4327C275.316 80.0188 275.545 80.5809 275.954 80.9954C276.362 81.4098 276.916 81.6427 277.494 81.6427Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M273.189 97.9963C273.754 97.9967 274.307 97.827 274.777 97.5085C275.247 97.1901 275.614 96.7372 275.831 96.2073C276.047 95.6773 276.104 95.094 275.994 94.5313C275.884 93.9685 275.612 93.4515 275.212 93.0456C274.813 92.6397 274.303 92.3633 273.749 92.2512C273.195 92.1391 272.62 92.1964 272.097 92.4159C271.575 92.6354 271.129 93.0071 270.814 93.4842C270.5 93.9612 270.333 94.5221 270.333 95.0958C270.332 95.4766 270.406 95.8537 270.549 96.2056C270.693 96.5575 270.903 96.8773 271.168 97.1466C271.434 97.416 271.748 97.6297 272.095 97.7755C272.442 97.9213 272.813 97.9963 273.189 97.9963Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M268.73 114.328C269.436 114.328 270.126 114.115 270.714 113.717C271.301 113.319 271.758 112.753 272.028 112.091C272.299 111.429 272.369 110.701 272.232 109.998C272.094 109.295 271.754 108.65 271.255 108.143C270.755 107.636 270.119 107.291 269.427 107.152C268.734 107.012 268.016 107.084 267.364 107.358C266.712 107.632 266.154 108.096 265.762 108.692C265.37 109.288 265.16 109.988 265.16 110.705C265.16 111.666 265.536 112.587 266.206 113.267C266.875 113.946 267.783 114.328 268.73 114.328Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M264.121 130.615C264.965 130.615 265.791 130.361 266.494 129.884C267.196 129.408 267.744 128.731 268.067 127.938C268.39 127.146 268.475 126.275 268.31 125.434C268.145 124.593 267.738 123.82 267.14 123.214C266.543 122.608 265.781 122.195 264.953 122.028C264.124 121.861 263.265 121.947 262.484 122.276C261.704 122.604 261.037 123.16 260.568 123.873C260.099 124.586 259.849 125.425 259.849 126.282C259.849 126.851 259.96 127.415 260.174 127.941C260.389 128.467 260.704 128.944 261.1 129.347C261.497 129.749 261.968 130.068 262.486 130.286C263.004 130.503 263.56 130.615 264.121 130.615Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M259.358 146.884C260.348 146.884 261.316 146.586 262.14 146.028C262.963 145.469 263.605 144.676 263.984 143.747C264.362 142.819 264.461 141.797 264.268 140.811C264.075 139.826 263.598 138.92 262.897 138.21C262.197 137.5 261.305 137.016 260.333 136.82C259.362 136.624 258.355 136.725 257.441 137.11C256.526 137.495 255.744 138.146 255.194 138.982C254.644 139.818 254.351 140.801 254.352 141.805C254.352 143.153 254.88 144.444 255.819 145.397C256.757 146.349 258.031 146.884 259.358 146.884Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M254.446 163.05C255.57 163.05 256.669 162.711 257.604 162.078C258.539 161.444 259.268 160.543 259.698 159.488C260.128 158.434 260.241 157.274 260.021 156.155C259.802 155.036 259.261 154.008 258.466 153.201C257.671 152.395 256.658 151.845 255.555 151.623C254.452 151.4 253.309 151.514 252.27 151.951C251.232 152.388 250.344 153.127 249.719 154.076C249.095 155.024 248.761 156.14 248.761 157.281C248.761 158.811 249.36 160.278 250.426 161.36C251.492 162.442 252.938 163.05 254.446 163.05Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M249.383 179.161C250.641 179.16 251.871 178.781 252.917 178.072C253.963 177.362 254.779 176.353 255.26 175.173C255.741 173.993 255.867 172.695 255.621 171.442C255.375 170.19 254.769 169.04 253.879 168.137C252.989 167.234 251.855 166.619 250.621 166.37C249.387 166.121 248.108 166.249 246.945 166.738C245.783 167.227 244.789 168.054 244.09 169.116C243.391 170.178 243.018 171.426 243.018 172.703C243.018 174.416 243.689 176.059 244.883 177.27C246.076 178.481 247.695 179.161 249.383 179.161Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M244.691 194.03C248.234 193.447 250.645 190.1 250.078 186.555C249.511 183.011 246.18 180.61 242.638 181.193C239.096 181.777 236.684 185.124 237.251 188.668C237.818 192.213 241.149 194.614 244.691 194.03Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M238.581 209.151C242.159 208.851 244.822 205.707 244.53 202.129C244.239 198.551 241.102 195.894 237.525 196.194C233.948 196.495 231.284 199.639 231.576 203.217C231.868 206.795 235.004 209.452 238.581 209.151Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M233.228 224.8C236.782 224.29 239.261 220.994 238.765 217.439C238.27 213.883 234.988 211.414 231.434 211.924C227.881 212.434 225.402 215.73 225.897 219.285C226.393 222.841 229.675 225.31 233.228 224.8Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M228.281 239.636C231.772 238.8 233.943 235.288 233.129 231.791C232.316 228.295 228.827 226.138 225.336 226.974C221.845 227.81 219.674 231.323 220.487 234.819C221.3 238.316 224.79 240.472 228.281 239.636Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M222.575 255.144C226.117 254.56 228.529 251.213 227.962 247.669C227.395 244.124 224.064 241.723 220.522 242.307C216.98 242.89 214.568 246.237 215.135 249.782C215.702 253.326 219.033 255.727 222.575 255.144Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M221.508 266.486C222.8 263.323 221.319 259.696 218.202 258.386C215.085 257.076 211.512 258.578 210.221 261.741C208.929 264.904 210.41 268.531 213.527 269.841C216.644 271.151 220.217 269.649 221.508 266.486Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M209.762 284.659C210.836 284.659 211.887 284.337 212.78 283.731C213.673 283.126 214.37 282.265 214.781 281.258C215.192 280.251 215.3 279.142 215.091 278.073C214.881 277.004 214.364 276.022 213.604 275.251C212.845 274.48 211.877 273.955 210.823 273.743C209.769 273.53 208.677 273.639 207.685 274.057C206.693 274.474 205.844 275.181 205.248 276.087C204.651 276.994 204.333 278.06 204.333 279.15C204.333 280.611 204.905 282.012 205.923 283.045C206.942 284.079 208.322 284.659 209.762 284.659Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M203.512 298.91C204.447 298.91 205.36 298.629 206.136 298.102C206.913 297.576 207.518 296.827 207.876 295.951C208.233 295.076 208.327 294.112 208.145 293.182C207.962 292.252 207.513 291.398 206.852 290.728C206.192 290.058 205.35 289.601 204.434 289.416C203.518 289.231 202.568 289.326 201.705 289.689C200.842 290.052 200.104 290.666 199.586 291.454C199.067 292.243 198.79 293.169 198.79 294.117C198.79 295.388 199.287 296.607 200.173 297.506C201.059 298.405 202.26 298.91 203.512 298.91Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M197.118 313.071C197.907 313.071 198.679 312.834 199.335 312.389C199.991 311.944 200.502 311.311 200.804 310.571C201.106 309.832 201.185 309.017 201.031 308.232C200.877 307.446 200.497 306.725 199.939 306.159C199.381 305.592 198.67 305.207 197.896 305.05C197.122 304.894 196.32 304.974 195.591 305.281C194.862 305.587 194.239 306.106 193.8 306.772C193.362 307.438 193.128 308.221 193.128 309.022C193.128 310.096 193.548 311.126 194.297 311.885C195.045 312.644 196.06 313.071 197.118 313.071Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M190.578 327.197C191.227 327.196 191.861 327.001 192.4 326.635C192.939 326.269 193.359 325.749 193.607 325.14C193.855 324.532 193.92 323.863 193.793 323.217C193.666 322.572 193.354 321.979 192.895 321.513C192.436 321.048 191.852 320.731 191.215 320.603C190.579 320.475 189.92 320.541 189.32 320.793C188.721 321.045 188.209 321.471 187.849 322.019C187.488 322.566 187.296 323.21 187.296 323.868C187.296 324.305 187.381 324.738 187.546 325.142C187.711 325.546 187.953 325.913 188.257 326.223C188.562 326.532 188.924 326.777 189.322 326.944C189.721 327.111 190.147 327.197 190.578 327.197Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M183.892 341.253C184.401 341.253 184.899 341.1 185.323 340.813C185.747 340.527 186.077 340.118 186.272 339.641C186.467 339.163 186.518 338.638 186.419 338.131C186.32 337.624 186.075 337.158 185.714 336.793C185.354 336.427 184.895 336.178 184.396 336.077C183.896 335.977 183.378 336.029 182.908 336.227C182.437 336.425 182.035 336.76 181.752 337.19C181.47 337.62 181.319 338.125 181.319 338.642C181.319 339.335 181.59 339.999 182.073 340.488C182.555 340.978 183.21 341.253 183.892 341.253Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M177.065 355.303C177.445 355.303 177.817 355.188 178.133 354.974C178.45 354.759 178.696 354.454 178.842 354.098C178.988 353.741 179.026 353.348 178.951 352.97C178.877 352.591 178.694 352.243 178.425 351.97C178.156 351.697 177.813 351.511 177.44 351.436C177.067 351.361 176.68 351.399 176.329 351.547C175.977 351.695 175.677 351.945 175.465 352.266C175.254 352.587 175.141 352.964 175.141 353.351C175.141 353.868 175.344 354.365 175.705 354.731C176.065 355.097 176.555 355.303 177.065 355.303Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M170.092 369.279C170.345 369.279 170.591 369.204 170.801 369.062C171.011 368.92 171.175 368.718 171.272 368.482C171.368 368.245 171.394 367.985 171.345 367.734C171.296 367.483 171.175 367.252 170.997 367.071C170.818 366.89 170.591 366.767 170.344 366.716C170.097 366.666 169.84 366.692 169.607 366.79C169.374 366.888 169.175 367.053 169.035 367.266C168.895 367.479 168.82 367.729 168.82 367.985C168.82 368.155 168.852 368.323 168.916 368.48C168.98 368.637 169.074 368.779 169.192 368.9C169.31 369.02 169.45 369.115 169.605 369.18C169.759 369.245 169.925 369.279 170.092 369.279Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M162.98 383.244C163.114 383.243 163.245 383.203 163.356 383.127C163.467 383.051 163.554 382.943 163.605 382.817C163.656 382.692 163.669 382.553 163.643 382.42C163.616 382.287 163.551 382.164 163.457 382.068C163.362 381.972 163.241 381.907 163.109 381.88C162.978 381.854 162.841 381.868 162.718 381.92C162.594 381.972 162.488 382.06 162.413 382.173C162.339 382.286 162.299 382.419 162.299 382.556C162.299 382.646 162.317 382.736 162.351 382.819C162.385 382.903 162.436 382.979 162.499 383.043C162.562 383.107 162.637 383.158 162.719 383.192C162.802 383.227 162.89 383.244 162.98 383.244Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M155.724 397.22C155.758 397.22 155.791 397.21 155.819 397.191C155.847 397.172 155.869 397.145 155.882 397.113C155.894 397.082 155.898 397.047 155.891 397.013C155.884 396.98 155.868 396.949 155.844 396.925C155.82 396.901 155.789 396.884 155.756 396.878C155.723 396.872 155.689 396.875 155.658 396.889C155.627 396.902 155.6 396.925 155.582 396.953C155.563 396.982 155.554 397.016 155.554 397.05C155.554 397.072 155.559 397.095 155.567 397.116C155.576 397.136 155.588 397.155 155.604 397.171C155.62 397.187 155.639 397.199 155.659 397.208C155.68 397.216 155.702 397.221 155.724 397.22Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M302.593 32.4067C302.621 32.4067 302.648 32.3983 302.671 32.3826C302.694 32.3669 302.712 32.3446 302.723 32.3185C302.734 32.2924 302.736 32.2637 302.731 32.236C302.725 32.2083 302.712 32.1829 302.692 32.1629C302.673 32.1429 302.648 32.1293 302.62 32.1238C302.593 32.1183 302.565 32.1212 302.539 32.132C302.513 32.1428 302.491 32.1611 302.476 32.1846C302.46 32.208 302.452 32.2356 302.452 32.2639C302.452 32.3018 302.467 32.3381 302.493 32.3648C302.52 32.3916 302.556 32.4067 302.593 32.4067Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M298.788 48.7119C298.916 48.7119 299.042 48.6732 299.149 48.6006C299.256 48.528 299.34 48.4248 299.389 48.3041C299.438 48.1834 299.451 48.0506 299.426 47.9224C299.401 47.7942 299.339 47.6765 299.248 47.5841C299.157 47.4917 299.041 47.4288 298.915 47.4033C298.788 47.3778 298.658 47.3909 298.539 47.4409C298.42 47.4909 298.318 47.5756 298.246 47.6842C298.175 47.7929 298.137 47.9206 298.137 48.0513C298.136 48.1381 298.153 48.2242 298.186 48.3044C298.218 48.3847 298.266 48.4577 298.327 48.5191C298.387 48.5805 298.459 48.6291 298.538 48.6622C298.617 48.6953 298.702 48.7122 298.788 48.7119Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M294.808 65.0382C295.049 65.0382 295.284 64.9658 295.484 64.8302C295.684 64.6946 295.84 64.5019 295.932 64.2765C296.024 64.051 296.048 63.8029 296.001 63.5635C295.954 63.3242 295.838 63.1043 295.668 62.9317C295.498 62.7592 295.281 62.6416 295.045 62.594C294.81 62.5464 294.565 62.5708 294.343 62.6642C294.121 62.7576 293.931 62.9158 293.797 63.1187C293.664 63.3216 293.592 63.5602 293.592 63.8042C293.592 64.1315 293.72 64.4454 293.948 64.6768C294.176 64.9082 294.486 65.0382 294.808 65.0382Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M290.981 81.3435C291.982 81.1785 292.663 80.2206 292.5 79.204C292.337 78.1875 291.394 77.4971 290.392 77.6622C289.39 77.8272 288.71 78.785 288.873 79.8016C289.035 80.8182 289.979 81.5085 290.981 81.3435Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M286.414 97.7113C286.907 97.7113 287.389 97.563 287.798 97.2852C288.208 97.0074 288.527 96.6125 288.716 96.1506C288.904 95.6886 288.953 95.1803 288.857 94.6899C288.761 94.1996 288.523 93.7492 288.175 93.3958C287.826 93.0424 287.382 92.8018 286.899 92.7046C286.416 92.6073 285.915 92.6576 285.46 92.8493C285.005 93.0409 284.616 93.3652 284.343 93.7811C284.069 94.1971 283.923 94.6859 283.924 95.1859C283.924 95.8559 284.187 96.4982 284.654 96.9718C285.121 97.4453 285.754 97.7113 286.414 97.7113Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M281.988 114.025C283.737 114.025 285.154 112.586 285.154 110.811C285.154 109.037 283.737 107.598 281.988 107.598C280.239 107.598 278.821 109.037 278.821 110.811C278.821 112.586 280.239 114.025 281.988 114.025Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M277.414 130.297C278.175 130.297 278.919 130.069 279.552 129.64C280.185 129.211 280.679 128.601 280.97 127.888C281.261 127.174 281.338 126.389 281.189 125.631C281.041 124.874 280.675 124.178 280.136 123.632C279.598 123.086 278.913 122.714 278.166 122.563C277.42 122.413 276.646 122.49 275.943 122.786C275.24 123.082 274.639 123.582 274.216 124.225C273.794 124.867 273.568 125.622 273.569 126.395C273.569 127.429 273.975 128.422 274.696 129.153C275.417 129.885 276.394 130.296 277.414 130.297Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M272.689 146.497C273.578 146.496 274.447 146.228 275.186 145.727C275.925 145.225 276.501 144.512 276.841 143.679C277.181 142.845 277.27 141.927 277.096 141.042C276.922 140.157 276.494 139.345 275.865 138.707C275.236 138.069 274.435 137.634 273.563 137.459C272.691 137.283 271.787 137.373 270.965 137.719C270.144 138.064 269.442 138.649 268.948 139.399C268.454 140.149 268.19 141.032 268.19 141.934C268.19 142.533 268.307 143.127 268.533 143.68C268.759 144.234 269.09 144.737 269.508 145.161C269.926 145.585 270.422 145.921 270.967 146.15C271.513 146.379 272.098 146.497 272.689 146.497Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M267.813 162.638C268.831 162.639 269.826 162.333 270.673 161.759C271.519 161.185 272.179 160.37 272.569 159.415C272.959 158.461 273.061 157.411 272.863 156.397C272.665 155.384 272.175 154.453 271.455 153.722C270.735 152.991 269.818 152.494 268.82 152.292C267.821 152.09 266.786 152.194 265.845 152.589C264.905 152.984 264.101 153.654 263.535 154.513C262.969 155.372 262.667 156.382 262.667 157.415C262.667 158.8 263.209 160.128 264.174 161.108C265.139 162.087 266.448 162.638 267.813 162.638Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M262.787 178.705C265.973 178.705 268.556 176.084 268.556 172.85C268.556 169.617 265.973 166.996 262.787 166.996C259.601 166.996 257.019 169.617 257.019 172.85C257.019 176.084 259.601 178.705 262.787 178.705Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M259.049 194.463C262.424 193.652 264.511 190.218 263.711 186.793C262.912 183.369 259.528 181.251 256.154 182.062C252.779 182.873 250.692 186.307 251.492 189.732C252.291 193.156 255.675 195.274 259.049 194.463Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M258.947 203.929C259.13 200.208 256.307 197.041 252.64 196.855C248.974 196.669 245.854 199.535 245.67 203.256C245.487 206.976 248.311 210.143 251.977 210.329C255.643 210.515 258.764 207.649 258.947 203.929Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M247.833 224.88C251.337 224.101 253.563 220.624 252.804 217.115C252.046 213.606 248.591 211.394 245.086 212.174C241.582 212.954 239.356 216.43 240.115 219.939C240.873 223.448 244.328 225.66 247.833 224.88Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M241.314 240.293C244.9 240.128 247.677 237.087 247.517 233.501C247.356 229.914 244.319 227.141 240.733 227.306C237.147 227.472 234.37 230.513 234.53 234.099C234.691 237.685 237.728 240.459 241.314 240.293Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M237.156 255.589C240.637 254.712 242.767 251.174 241.914 247.687C241.06 244.2 237.546 242.084 234.066 242.962C230.585 243.839 228.455 247.377 229.308 250.864C230.162 254.351 233.675 256.467 237.156 255.589Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M230.468 270.211C233.66 269.686 235.827 266.634 235.309 263.394C234.791 260.155 231.783 257.956 228.592 258.482C225.4 259.007 223.232 262.059 223.751 265.298C224.269 268.538 227.276 270.737 230.468 270.211Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M224.662 284.618C227.49 283.941 229.241 281.066 228.574 278.196C227.906 275.327 225.073 273.55 222.245 274.227C219.418 274.904 217.667 277.779 218.334 280.649C219.001 283.518 221.835 285.296 224.662 284.618Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M217.261 299.084C218.175 299.084 219.068 298.809 219.828 298.294C220.588 297.779 221.18 297.047 221.529 296.19C221.879 295.333 221.971 294.39 221.792 293.481C221.614 292.571 221.174 291.736 220.528 291.08C219.882 290.425 219.059 289.978 218.162 289.797C217.266 289.616 216.337 289.709 215.493 290.064C214.649 290.419 213.927 291.02 213.42 291.791C212.912 292.562 212.641 293.468 212.641 294.396C212.641 295.639 213.128 296.832 213.994 297.711C214.861 298.59 216.036 299.084 217.261 299.084Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M210.913 313.343C211.696 313.343 212.462 313.108 213.113 312.666C213.765 312.224 214.272 311.596 214.572 310.862C214.872 310.127 214.95 309.319 214.797 308.539C214.644 307.759 214.267 307.043 213.713 306.481C213.158 305.919 212.453 305.537 211.684 305.382C210.916 305.227 210.119 305.307 209.396 305.611C208.672 305.916 208.054 306.431 207.619 307.093C207.184 307.754 206.952 308.531 206.952 309.326C206.952 309.854 207.055 310.376 207.254 310.864C207.453 311.352 207.745 311.794 208.112 312.168C208.48 312.541 208.917 312.836 209.397 313.038C209.878 313.24 210.393 313.344 210.913 313.343Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M204.42 327.517C205.068 327.517 205.702 327.321 206.241 326.955C206.781 326.589 207.201 326.069 207.449 325.461C207.697 324.852 207.761 324.183 207.634 323.538C207.508 322.892 207.195 322.299 206.736 321.834C206.277 321.368 205.693 321.051 205.057 320.923C204.42 320.795 203.761 320.861 203.162 321.113C202.562 321.365 202.05 321.792 201.69 322.339C201.33 322.886 201.137 323.53 201.137 324.188C201.137 324.626 201.222 325.059 201.387 325.463C201.552 325.867 201.794 326.234 202.099 326.543C202.404 326.852 202.765 327.097 203.164 327.264C203.562 327.431 203.989 327.517 204.42 327.517Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M197.777 341.657C198.298 341.657 198.807 341.5 199.239 341.207C199.672 340.913 200.009 340.496 200.209 340.008C200.408 339.52 200.46 338.983 200.358 338.465C200.256 337.947 200.005 337.471 199.637 337.098C199.269 336.724 198.8 336.47 198.289 336.367C197.779 336.265 197.25 336.318 196.769 336.52C196.288 336.723 195.877 337.065 195.588 337.505C195.3 337.944 195.146 338.461 195.146 338.989C195.147 339.697 195.424 340.375 195.917 340.876C196.411 341.376 197.08 341.657 197.777 341.657Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M191.007 355.698C191.392 355.698 191.769 355.581 192.09 355.363C192.411 355.145 192.66 354.836 192.808 354.474C192.955 354.112 192.993 353.714 192.918 353.331C192.842 352.947 192.656 352.594 192.383 352.317C192.11 352.041 191.763 351.852 191.384 351.776C191.006 351.7 190.614 351.739 190.258 351.889C189.901 352.039 189.597 352.293 189.382 352.618C189.168 352.944 189.054 353.327 189.054 353.718C189.054 353.978 189.104 354.236 189.202 354.476C189.301 354.717 189.444 354.935 189.626 355.119C189.807 355.303 190.023 355.448 190.259 355.548C190.496 355.647 190.75 355.698 191.007 355.698Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M184.085 369.729C184.348 369.729 184.605 369.65 184.824 369.502C185.042 369.354 185.213 369.143 185.313 368.897C185.414 368.65 185.44 368.379 185.389 368.117C185.338 367.855 185.211 367.615 185.025 367.426C184.839 367.238 184.602 367.109 184.345 367.057C184.087 367.005 183.819 367.032 183.576 367.134C183.334 367.236 183.126 367.409 182.98 367.631C182.834 367.853 182.756 368.113 182.756 368.38C182.756 368.558 182.79 368.733 182.856 368.897C182.923 369.061 183.021 369.209 183.145 369.335C183.268 369.46 183.415 369.559 183.576 369.627C183.738 369.695 183.911 369.73 184.085 369.729Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M177.023 383.718C177.168 383.718 177.31 383.675 177.431 383.593C177.552 383.511 177.646 383.394 177.702 383.258C177.757 383.122 177.772 382.972 177.743 382.827C177.715 382.682 177.645 382.549 177.542 382.445C177.44 382.341 177.309 382.27 177.166 382.241C177.023 382.212 176.876 382.227 176.741 382.283C176.607 382.34 176.492 382.435 176.411 382.558C176.331 382.681 176.288 382.825 176.288 382.972C176.288 383.17 176.365 383.36 176.503 383.5C176.641 383.64 176.828 383.718 177.023 383.718Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M169.82 397.726C169.88 397.726 169.937 397.702 169.98 397.659C170.022 397.615 170.046 397.557 170.046 397.496C170.046 397.435 170.022 397.376 169.98 397.333C169.937 397.29 169.88 397.266 169.82 397.266C169.759 397.266 169.702 397.29 169.659 397.333C169.617 397.376 169.593 397.435 169.593 397.496C169.593 397.557 169.617 397.615 169.659 397.659C169.702 397.702 169.759 397.726 169.82 397.726Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M315.688 32.3463C315.696 32.3463 315.703 32.3434 315.708 32.3382C315.713 32.333 315.716 32.326 315.716 32.3187C315.716 32.3149 315.715 32.3111 315.714 32.3075C315.713 32.3039 315.711 32.3007 315.708 32.2979C315.706 32.2951 315.703 32.2929 315.699 32.2913C315.696 32.2898 315.692 32.2891 315.688 32.2891C315.681 32.2891 315.673 32.2922 315.668 32.2978C315.662 32.3033 315.659 32.3109 315.659 32.3187C315.659 32.3225 315.66 32.3263 315.661 32.3298C315.663 32.3333 315.665 32.3364 315.668 32.339C315.671 32.3416 315.674 32.3436 315.677 32.3448C315.681 32.3461 315.685 32.3466 315.688 32.3463Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M311.9 48.5165C311.979 48.5169 312.056 48.4937 312.121 48.4497C312.187 48.4057 312.238 48.3429 312.268 48.2693C312.299 48.1958 312.307 48.1147 312.292 48.0365C312.277 47.9582 312.239 47.8862 312.184 47.8297C312.128 47.7731 312.058 47.7346 311.98 47.7188C311.903 47.7031 311.823 47.711 311.751 47.7414C311.678 47.7718 311.616 47.8234 311.572 47.8897C311.529 47.956 311.505 48.034 311.505 48.1137C311.505 48.2202 311.547 48.3223 311.621 48.3978C311.695 48.4733 311.795 48.5159 311.9 48.5165Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M307.963 64.7941C308.142 64.7941 308.317 64.7402 308.466 64.6393C308.614 64.5384 308.73 64.3949 308.799 64.2271C308.867 64.0592 308.885 63.8745 308.85 63.6964C308.816 63.5182 308.729 63.3545 308.603 63.2261C308.476 63.0976 308.315 63.0101 308.139 62.9747C307.964 62.9392 307.782 62.9574 307.616 63.027C307.451 63.0965 307.31 63.2142 307.21 63.3653C307.111 63.5163 307.058 63.6939 307.058 63.8756C307.058 64.1192 307.153 64.3528 307.323 64.5251C307.492 64.6973 307.723 64.7941 307.963 64.7941Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M303.872 81.1175C304.169 81.1175 304.458 81.0283 304.705 80.8611C304.952 80.6939 305.144 80.4562 305.257 80.1782C305.371 79.9001 305.4 79.5942 305.343 79.299C305.285 79.0038 305.142 78.7327 304.932 78.5199C304.723 78.3071 304.455 78.1622 304.164 78.1035C303.874 78.0447 303.572 78.0749 303.298 78.19C303.024 78.3052 302.79 78.5003 302.625 78.7505C302.461 79.0007 302.373 79.2949 302.373 79.5959C302.373 79.9994 302.531 80.3865 302.812 80.6718C303.093 80.9572 303.474 81.1175 303.872 81.1175Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M299.628 97.426C300.047 97.426 300.457 97.2998 300.806 97.0633C301.155 96.8267 301.427 96.4906 301.587 96.0973C301.748 95.704 301.79 95.2712 301.708 94.8536C301.626 94.4361 301.424 94.0526 301.128 93.7515C300.831 93.4505 300.453 93.2455 300.042 93.1625C299.63 93.0794 299.204 93.122 298.816 93.2849C298.429 93.4479 298.097 93.7237 297.864 94.0777C297.631 94.4317 297.507 94.8478 297.507 95.2736C297.507 95.8444 297.73 96.3919 298.128 96.7956C298.526 97.1992 299.065 97.426 299.628 97.426Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M295.827 113.612C297.307 113.285 298.246 111.802 297.923 110.3C297.601 108.798 296.14 107.846 294.66 108.173C293.18 108.5 292.241 109.983 292.564 111.485C292.886 112.987 294.347 113.939 295.827 113.612Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M290.698 129.918C292.558 129.918 294.065 128.389 294.065 126.502C294.065 124.615 292.558 123.086 290.698 123.086C288.839 123.086 287.332 124.615 287.332 126.502C287.332 128.389 288.839 129.918 290.698 129.918Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M289.709 143.585C290.542 141.516 289.565 139.154 287.526 138.308C285.488 137.463 283.159 138.454 282.326 140.523C281.493 142.592 282.47 144.955 284.509 145.801C286.548 146.646 288.876 145.654 289.709 143.585Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M281.171 162.195C282.077 162.195 282.963 161.922 283.716 161.411C284.47 160.9 285.057 160.174 285.404 159.324C285.751 158.475 285.842 157.54 285.665 156.637C285.488 155.735 285.052 154.907 284.411 154.257C283.77 153.606 282.953 153.163 282.065 152.984C281.176 152.804 280.254 152.897 279.417 153.249C278.58 153.6 277.864 154.196 277.361 154.961C276.857 155.726 276.588 156.625 276.588 157.545C276.588 158.778 277.071 159.961 277.93 160.833C278.79 161.705 279.955 162.195 281.171 162.195Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M276.183 178.188C277.196 178.189 278.186 177.885 279.029 177.315C279.871 176.744 280.528 175.933 280.916 174.984C281.304 174.035 281.406 172.99 281.209 171.982C281.012 170.973 280.525 170.047 279.809 169.32C279.093 168.593 278.181 168.098 277.188 167.897C276.194 167.696 275.165 167.799 274.229 168.192C273.293 168.585 272.493 169.251 271.931 170.106C271.368 170.96 271.067 171.965 271.067 172.993C271.067 174.37 271.606 175.691 272.565 176.665C273.525 177.639 274.826 178.187 276.183 178.188Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M276.66 188.418C276.668 185.279 274.167 182.728 271.073 182.721C267.98 182.713 265.467 185.251 265.459 188.39C265.451 191.53 267.953 194.08 271.046 194.088C274.139 194.096 276.653 191.557 276.66 188.418Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M269.961 208.004C272.28 205.65 272.28 201.834 269.961 199.481C267.642 197.127 263.881 197.127 261.562 199.481C259.243 201.834 259.243 205.65 261.562 208.004C263.881 210.357 267.642 210.357 269.961 208.004Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M260.333 225.239C261.541 225.239 262.722 224.875 263.726 224.194C264.731 223.513 265.514 222.545 265.976 221.412C266.439 220.279 266.56 219.032 266.324 217.83C266.088 216.627 265.507 215.523 264.652 214.656C263.798 213.789 262.709 213.198 261.524 212.959C260.339 212.72 259.111 212.843 257.995 213.312C256.878 213.781 255.924 214.576 255.253 215.595C254.582 216.615 254.224 217.813 254.224 219.039C254.223 219.854 254.381 220.66 254.688 221.412C254.995 222.164 255.445 222.848 256.012 223.424C256.58 223.999 257.253 224.456 257.994 224.768C258.736 225.079 259.53 225.239 260.333 225.239Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M254.757 240.451C255.962 240.451 257.139 240.088 258.14 239.409C259.142 238.73 259.923 237.765 260.384 236.635C260.844 235.506 260.965 234.263 260.73 233.064C260.495 231.866 259.915 230.764 259.063 229.9C258.212 229.036 257.127 228.447 255.945 228.209C254.764 227.97 253.539 228.093 252.426 228.56C251.314 229.028 250.363 229.82 249.693 230.837C249.024 231.853 248.667 233.048 248.667 234.27C248.667 235.909 249.309 237.481 250.451 238.64C251.593 239.799 253.142 240.451 254.757 240.451Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M249.032 255.399C250.19 255.399 251.322 255.051 252.285 254.399C253.248 253.746 253.999 252.818 254.443 251.733C254.886 250.647 255.002 249.452 254.777 248.299C254.551 247.147 253.994 246.088 253.175 245.257C252.356 244.425 251.313 243.859 250.177 243.63C249.041 243.401 247.864 243.518 246.794 243.968C245.724 244.417 244.809 245.179 244.166 246.156C243.523 247.133 243.179 248.282 243.179 249.457C243.179 251.033 243.796 252.544 244.893 253.658C245.991 254.772 247.479 255.398 249.032 255.399Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M243.165 270.161C244.25 270.161 245.311 269.834 246.213 269.222C247.116 268.61 247.819 267.741 248.234 266.723C248.65 265.706 248.758 264.586 248.546 263.506C248.335 262.426 247.812 261.433 247.045 260.654C246.277 259.876 245.3 259.345 244.235 259.13C243.171 258.916 242.067 259.026 241.065 259.447C240.062 259.869 239.205 260.583 238.602 261.498C237.999 262.414 237.677 263.491 237.677 264.592C237.677 266.069 238.255 267.485 239.284 268.53C240.314 269.574 241.709 270.161 243.165 270.161Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M237.15 284.715C238.135 284.715 239.097 284.419 239.915 283.864C240.734 283.309 241.372 282.52 241.749 281.597C242.125 280.674 242.224 279.659 242.032 278.679C241.84 277.699 241.366 276.799 240.67 276.093C239.974 275.386 239.087 274.905 238.121 274.71C237.156 274.515 236.155 274.615 235.246 274.998C234.336 275.38 233.559 276.027 233.012 276.858C232.465 277.689 232.173 278.665 232.173 279.664C232.174 281.003 232.698 282.288 233.632 283.235C234.565 284.182 235.831 284.714 237.15 284.715Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M230.993 299.179C231.872 299.179 232.731 298.915 233.462 298.42C234.192 297.925 234.762 297.221 235.098 296.397C235.435 295.574 235.523 294.667 235.352 293.793C235.18 292.918 234.757 292.115 234.136 291.484C233.515 290.854 232.723 290.424 231.861 290.251C230.999 290.077 230.106 290.166 229.295 290.508C228.483 290.849 227.789 291.427 227.301 292.169C226.813 292.91 226.553 293.782 226.554 294.674C226.553 295.265 226.668 295.851 226.891 296.398C227.114 296.945 227.441 297.442 227.853 297.86C228.266 298.278 228.755 298.61 229.294 298.836C229.833 299.063 230.41 299.179 230.993 299.179Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M225.557 313.406C227.609 312.914 228.88 310.827 228.395 308.745C227.911 306.662 225.855 305.372 223.803 305.864C221.751 306.355 220.48 308.442 220.964 310.525C221.448 312.607 223.504 313.897 225.557 313.406Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M218.246 327.749C218.878 327.749 219.496 327.559 220.022 327.203C220.548 326.847 220.958 326.341 221.2 325.748C221.443 325.155 221.506 324.503 221.383 323.874C221.26 323.245 220.956 322.666 220.509 322.213C220.062 321.759 219.492 321.45 218.872 321.324C218.252 321.199 217.609 321.263 217.025 321.508C216.441 321.754 215.942 322.17 215.591 322.703C215.239 323.237 215.052 323.864 215.052 324.505C215.052 325.365 215.388 326.19 215.987 326.798C216.586 327.406 217.399 327.748 218.246 327.749Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M211.661 341.937C212.17 341.937 212.668 341.783 213.091 341.496C213.515 341.209 213.845 340.801 214.039 340.323C214.234 339.846 214.285 339.32 214.186 338.813C214.086 338.306 213.841 337.841 213.48 337.475C213.12 337.11 212.661 336.861 212.162 336.761C211.662 336.66 211.144 336.712 210.674 336.91C210.203 337.109 209.801 337.444 209.519 337.874C209.236 338.304 209.086 338.809 209.086 339.326C209.086 339.669 209.153 340.009 209.282 340.325C209.411 340.642 209.601 340.93 209.84 341.173C210.079 341.415 210.363 341.607 210.675 341.738C210.988 341.869 211.323 341.937 211.661 341.937Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M204.93 356.057C205.316 356.057 205.693 355.941 206.014 355.724C206.335 355.506 206.585 355.197 206.732 354.835C206.88 354.473 206.919 354.075 206.843 353.691C206.768 353.307 206.582 352.954 206.309 352.678C206.037 352.401 205.689 352.212 205.311 352.136C204.932 352.059 204.54 352.099 204.183 352.248C203.827 352.398 203.522 352.652 203.308 352.978C203.093 353.303 202.979 353.686 202.979 354.078C202.979 354.603 203.185 355.106 203.55 355.477C203.916 355.849 204.412 356.057 204.93 356.057Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M198.059 370.144C198.328 370.145 198.591 370.064 198.814 369.913C199.038 369.762 199.213 369.546 199.316 369.294C199.419 369.042 199.446 368.765 199.394 368.497C199.341 368.229 199.212 367.984 199.022 367.791C198.831 367.598 198.589 367.466 198.325 367.413C198.062 367.36 197.788 367.387 197.54 367.492C197.292 367.597 197.079 367.774 196.93 368.001C196.781 368.228 196.702 368.495 196.702 368.768C196.702 369.133 196.845 369.483 197.099 369.741C197.354 369.999 197.699 370.144 198.059 370.144Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M191.057 384.161C191.208 384.161 191.356 384.115 191.482 384.03C191.607 383.945 191.705 383.824 191.763 383.682C191.821 383.54 191.836 383.384 191.807 383.234C191.777 383.083 191.704 382.945 191.597 382.837C191.49 382.728 191.354 382.654 191.206 382.624C191.058 382.594 190.904 382.61 190.764 382.668C190.625 382.727 190.505 382.827 190.421 382.954C190.337 383.082 190.292 383.232 190.292 383.385C190.292 383.487 190.312 383.588 190.35 383.682C190.388 383.777 190.445 383.862 190.516 383.934C190.587 384.006 190.671 384.063 190.764 384.102C190.857 384.141 190.956 384.161 191.057 384.161Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M183.896 398.184C183.946 398.184 183.996 398.169 184.037 398.14C184.079 398.112 184.112 398.072 184.131 398.025C184.15 397.977 184.155 397.926 184.145 397.876C184.136 397.826 184.111 397.78 184.076 397.744C184.04 397.707 183.995 397.683 183.946 397.673C183.896 397.663 183.845 397.668 183.799 397.688C183.753 397.707 183.713 397.74 183.685 397.783C183.657 397.825 183.642 397.875 183.642 397.926C183.643 397.994 183.67 398.059 183.717 398.108C183.765 398.156 183.829 398.183 183.896 398.184Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M325.019 48.3207C325.047 48.3207 325.074 48.3124 325.097 48.2967C325.12 48.281 325.138 48.2587 325.149 48.2326C325.16 48.2065 325.163 48.1778 325.157 48.1501C325.152 48.1224 325.138 48.0969 325.119 48.077C325.099 48.057 325.074 48.0434 325.047 48.0379C325.019 48.0324 324.991 48.0352 324.965 48.046C324.94 48.0568 324.918 48.0751 324.902 48.0986C324.887 48.1221 324.878 48.1497 324.878 48.1779C324.878 48.2158 324.893 48.2521 324.92 48.2789C324.946 48.3057 324.982 48.3207 325.019 48.3207Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M321.111 64.5461C321.228 64.5461 321.343 64.5107 321.441 64.4444C321.539 64.3782 321.615 64.284 321.66 64.1738C321.705 64.0636 321.717 63.9423 321.694 63.8253C321.671 63.7083 321.614 63.6008 321.531 63.5165C321.448 63.4321 321.342 63.3747 321.227 63.3514C321.112 63.3282 320.992 63.3401 320.883 63.3858C320.775 63.4314 320.682 63.5087 320.617 63.6079C320.551 63.7071 320.517 63.8237 320.517 63.943C320.516 64.0222 320.532 64.1008 320.561 64.1741C320.591 64.2474 320.635 64.314 320.69 64.3701C320.745 64.4261 320.811 64.4705 320.883 64.5007C320.955 64.5309 321.033 64.5464 321.111 64.5461Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M317.058 80.8208C317.282 80.8208 317.5 80.7535 317.687 80.6272C317.873 80.501 318.018 80.3216 318.103 80.1117C318.189 79.9018 318.212 79.6709 318.168 79.448C318.124 79.2252 318.016 79.0205 317.858 78.8599C317.7 78.6992 317.498 78.5898 317.279 78.5455C317.059 78.5012 316.831 78.5239 316.625 78.6109C316.418 78.6978 316.241 78.845 316.117 79.0339C315.992 79.2228 315.926 79.4449 315.926 79.6721C315.926 79.8231 315.955 79.9726 316.011 80.112C316.068 80.2515 316.152 80.3783 316.257 80.485C316.362 80.5917 316.487 80.6763 316.624 80.734C316.762 80.7916 316.909 80.8211 317.058 80.8208Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M312.843 97.0807C313.178 97.0802 313.506 96.9789 313.785 96.7894C314.064 96.5999 314.281 96.3309 314.409 96.0162C314.537 95.7015 314.571 95.3553 314.505 95.0214C314.439 94.6876 314.277 94.3809 314.04 94.1403C313.803 93.8997 313.5 93.7359 313.171 93.6697C312.842 93.6034 312.501 93.6376 312.191 93.768C311.881 93.8984 311.616 94.1191 311.43 94.4022C311.244 94.6854 311.144 95.0182 311.144 95.3587C311.144 95.585 311.188 95.8091 311.273 96.0181C311.359 96.2272 311.484 96.4171 311.642 96.5771C311.8 96.737 311.987 96.8638 312.193 96.9502C312.399 97.0366 312.62 97.0809 312.843 97.0807Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M308.484 113.33C308.937 113.33 309.38 113.193 309.756 112.938C310.133 112.683 310.427 112.319 310.6 111.895C310.774 111.47 310.819 111.002 310.731 110.551C310.642 110.1 310.424 109.686 310.104 109.361C309.783 109.036 309.375 108.814 308.93 108.724C308.486 108.635 308.025 108.681 307.607 108.857C307.188 109.033 306.83 109.331 306.578 109.713C306.327 110.095 306.192 110.545 306.192 111.005C306.192 111.31 306.251 111.613 306.366 111.895C306.481 112.177 306.65 112.434 306.863 112.649C307.076 112.865 307.328 113.037 307.606 113.153C307.885 113.27 308.183 113.33 308.484 113.33Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M303.977 129.532C304.548 129.533 305.106 129.363 305.582 129.042C306.057 128.721 306.428 128.264 306.647 127.729C306.866 127.194 306.924 126.605 306.814 126.037C306.703 125.468 306.429 124.946 306.026 124.536C305.622 124.126 305.108 123.846 304.548 123.733C303.988 123.619 303.408 123.677 302.88 123.898C302.353 124.12 301.902 124.495 301.584 124.977C301.267 125.458 301.098 126.025 301.098 126.604C301.098 127.379 301.401 128.123 301.941 128.672C302.48 129.221 303.213 129.53 303.977 129.532Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M299.323 145.663C300.006 145.663 300.673 145.458 301.24 145.073C301.808 144.688 302.25 144.141 302.511 143.502C302.772 142.862 302.841 142.158 302.707 141.479C302.574 140.799 302.246 140.175 301.763 139.686C301.281 139.196 300.666 138.863 299.997 138.727C299.327 138.592 298.633 138.662 298.003 138.927C297.373 139.192 296.834 139.641 296.455 140.216C296.075 140.792 295.873 141.469 295.873 142.162C295.874 143.09 296.237 143.98 296.884 144.637C297.531 145.293 298.408 145.663 299.323 145.663Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M294.518 161.719C295.307 161.719 296.079 161.482 296.735 161.037C297.391 160.592 297.903 159.96 298.205 159.22C298.507 158.48 298.586 157.666 298.432 156.88C298.278 156.095 297.898 155.373 297.34 154.807C296.782 154.241 296.071 153.855 295.297 153.699C294.523 153.543 293.721 153.623 292.991 153.929C292.262 154.236 291.639 154.755 291.201 155.421C290.762 156.087 290.528 156.869 290.528 157.67C290.528 158.744 290.949 159.774 291.697 160.533C292.445 161.293 293.46 161.719 294.518 161.719Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M292.551 176.58C294.411 174.911 294.586 172.028 292.941 170.14C291.297 168.252 288.455 168.074 286.595 169.743C284.735 171.413 284.56 174.296 286.205 176.184C287.849 178.072 290.691 178.249 292.551 176.58Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M284.47 193.541C285.443 193.541 286.395 193.248 287.204 192.7C288.013 192.151 288.644 191.371 289.016 190.459C289.388 189.546 289.486 188.542 289.296 187.574C289.106 186.605 288.637 185.716 287.949 185.017C287.261 184.319 286.384 183.843 285.43 183.651C284.476 183.458 283.486 183.557 282.587 183.935C281.688 184.313 280.92 184.953 280.379 185.774C279.838 186.595 279.55 187.56 279.55 188.548C279.55 189.872 280.068 191.142 280.991 192.079C281.914 193.015 283.165 193.541 284.47 193.541Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M279.226 209.219C280.261 209.22 281.274 208.909 282.134 208.325C282.995 207.742 283.666 206.912 284.063 205.942C284.459 204.971 284.563 203.903 284.361 202.873C284.159 201.843 283.661 200.896 282.929 200.153C282.197 199.41 281.264 198.904 280.249 198.7C279.233 198.495 278.181 198.6 277.225 199.002C276.268 199.405 275.451 200.086 274.876 200.959C274.301 201.833 273.995 202.86 273.995 203.911C273.996 205.318 274.547 206.668 275.528 207.664C276.509 208.659 277.839 209.219 279.226 209.219Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M273.835 224.733C276.835 224.733 279.266 222.266 279.266 219.222C279.266 216.178 276.835 213.711 273.835 213.711C270.836 213.711 268.405 216.178 268.405 219.222C268.405 222.266 270.836 224.733 273.835 224.733Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M268.3 240.016C269.38 240.016 270.435 239.691 271.333 239.082C272.231 238.473 272.931 237.608 273.344 236.595C273.758 235.583 273.866 234.468 273.655 233.394C273.444 232.319 272.924 231.331 272.161 230.557C271.397 229.782 270.424 229.254 269.365 229.04C268.306 228.826 267.208 228.936 266.21 229.355C265.213 229.775 264.36 230.485 263.76 231.396C263.16 232.307 262.84 233.379 262.84 234.475C262.84 235.944 263.415 237.354 264.439 238.393C265.463 239.432 266.852 240.016 268.3 240.016Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M262.619 255.073C263.671 255.073 264.699 254.757 265.573 254.164C266.448 253.571 267.129 252.728 267.532 251.742C267.934 250.756 268.039 249.671 267.834 248.624C267.629 247.577 267.122 246.616 266.378 245.861C265.634 245.106 264.687 244.593 263.655 244.385C262.623 244.177 261.554 244.284 260.583 244.693C259.611 245.101 258.781 245.793 258.197 246.681C257.613 247.569 257.301 248.612 257.302 249.679C257.302 251.11 257.863 252.482 258.86 253.494C259.857 254.505 261.209 255.073 262.619 255.073Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M258.235 269.74C260.896 268.923 262.4 266.071 261.594 263.371C260.789 260.671 257.979 259.144 255.318 259.962C252.658 260.779 251.153 263.63 251.959 266.331C252.764 269.031 255.574 270.557 258.235 269.74Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M255.412 280.682C255.822 278.116 254.105 275.697 251.576 275.281C249.047 274.864 246.664 276.607 246.254 279.173C245.843 281.74 247.56 284.158 250.089 284.575C252.618 284.991 255.001 283.248 255.412 280.682Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M244.712 299.158C245.535 299.158 246.339 298.911 247.022 298.447C247.706 297.983 248.239 297.324 248.554 296.553C248.868 295.782 248.951 294.934 248.79 294.115C248.63 293.297 248.234 292.545 247.652 291.955C247.071 291.365 246.33 290.963 245.523 290.8C244.717 290.637 243.881 290.721 243.121 291.04C242.361 291.359 241.712 291.9 241.255 292.594C240.798 293.288 240.554 294.104 240.554 294.938C240.554 295.493 240.661 296.041 240.87 296.554C241.079 297.066 241.385 297.531 241.771 297.923C242.158 298.315 242.616 298.626 243.121 298.837C243.625 299.049 244.166 299.158 244.712 299.158Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M238.456 313.579C239.172 313.579 239.872 313.363 240.468 312.959C241.063 312.556 241.527 311.982 241.801 311.311C242.075 310.639 242.147 309.9 242.007 309.188C241.868 308.475 241.523 307.82 241.016 307.307C240.51 306.793 239.865 306.443 239.163 306.301C238.46 306.159 237.732 306.232 237.071 306.51C236.409 306.788 235.844 307.259 235.446 307.863C235.048 308.468 234.836 309.178 234.836 309.905C234.836 310.387 234.929 310.865 235.111 311.311C235.293 311.757 235.559 312.162 235.896 312.503C236.232 312.844 236.631 313.115 237.071 313.3C237.51 313.484 237.981 313.579 238.456 313.579Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M232.058 327.913C232.662 327.913 233.253 327.731 233.756 327.39C234.258 327.049 234.65 326.565 234.881 325.998C235.112 325.432 235.173 324.808 235.055 324.207C234.937 323.605 234.646 323.053 234.219 322.619C233.791 322.185 233.247 321.89 232.654 321.771C232.061 321.651 231.447 321.712 230.889 321.947C230.33 322.182 229.853 322.579 229.517 323.089C229.182 323.599 229.002 324.198 229.002 324.812C229.002 325.219 229.081 325.622 229.234 325.999C229.388 326.375 229.613 326.717 229.897 327.005C230.181 327.293 230.518 327.521 230.888 327.677C231.259 327.833 231.657 327.913 232.058 327.913Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M225.518 342.152C226.005 342.152 226.481 342.005 226.886 341.731C227.291 341.456 227.606 341.066 227.792 340.609C227.979 340.153 228.027 339.65 227.932 339.166C227.837 338.681 227.602 338.236 227.258 337.887C226.914 337.538 226.475 337.3 225.997 337.204C225.52 337.108 225.025 337.158 224.575 337.347C224.125 337.536 223.741 337.857 223.471 338.268C223.201 338.679 223.057 339.162 223.057 339.656C223.057 339.984 223.121 340.309 223.245 340.612C223.368 340.915 223.55 341.19 223.778 341.421C224.007 341.653 224.278 341.837 224.577 341.962C224.875 342.088 225.195 342.152 225.518 342.152Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M220.176 355.789C220.916 355.038 220.916 353.821 220.176 353.07C219.437 352.32 218.237 352.32 217.498 353.07C216.758 353.821 216.758 355.038 217.498 355.789C218.237 356.54 219.437 356.54 220.176 355.789Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M212.015 370.463C212.273 370.463 212.525 370.386 212.739 370.241C212.954 370.096 213.121 369.89 213.22 369.649C213.319 369.407 213.345 369.142 213.295 368.885C213.245 368.629 213.121 368.393 212.939 368.208C212.757 368.023 212.525 367.897 212.272 367.846C212.019 367.795 211.758 367.821 211.52 367.921C211.282 368.021 211.078 368.19 210.935 368.407C210.792 368.625 210.715 368.88 210.715 369.142C210.716 369.492 210.853 369.827 211.097 370.075C211.34 370.322 211.67 370.462 212.015 370.463Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M205.056 384.559C205.207 384.559 205.355 384.514 205.481 384.429C205.606 384.343 205.704 384.222 205.762 384.08C205.82 383.939 205.835 383.783 205.806 383.632C205.776 383.482 205.703 383.343 205.596 383.235C205.49 383.127 205.353 383.053 205.205 383.023C205.057 382.993 204.903 383.008 204.763 383.067C204.624 383.126 204.504 383.225 204.42 383.353C204.336 383.48 204.292 383.63 204.292 383.784C204.292 383.989 204.372 384.187 204.515 384.332C204.659 384.478 204.853 384.559 205.056 384.559Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M197.955 398.609C198.006 398.609 198.054 398.594 198.096 398.565C198.138 398.536 198.17 398.496 198.189 398.449C198.208 398.402 198.212 398.35 198.202 398.3C198.192 398.25 198.168 398.204 198.132 398.169C198.097 398.133 198.051 398.108 198.002 398.099C197.953 398.089 197.902 398.094 197.856 398.114C197.809 398.133 197.77 398.166 197.742 398.209C197.714 398.251 197.699 398.301 197.699 398.352C197.699 398.386 197.706 398.419 197.719 398.451C197.732 398.482 197.751 398.511 197.774 398.535C197.798 398.559 197.826 398.578 197.858 398.59C197.889 398.603 197.922 398.61 197.955 398.609Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M334.253 64.2981C334.309 64.2981 334.364 64.2812 334.41 64.2496C334.457 64.218 334.493 64.173 334.515 64.1205C334.536 64.0679 334.542 64.01 334.531 63.9542C334.52 63.8984 334.493 63.8472 334.453 63.8069C334.414 63.7667 334.363 63.7393 334.308 63.7282C334.253 63.7171 334.196 63.7228 334.144 63.7446C334.092 63.7663 334.048 63.8032 334.017 63.8505C333.986 63.8978 333.969 63.9535 333.969 64.0104C333.969 64.0867 333.999 64.1598 334.052 64.2138C334.105 64.2678 334.178 64.2981 334.253 64.2981Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M330.223 80.5241C330.645 80.5241 330.987 80.1768 330.987 79.7484C330.987 79.32 330.645 78.9727 330.223 78.9727C329.801 78.9727 329.458 79.32 329.458 79.7484C329.458 80.1768 329.801 80.5241 330.223 80.5241Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M326.046 96.7637C326.304 96.7641 326.556 96.687 326.77 96.5421C326.984 96.3971 327.152 96.1909 327.25 95.9495C327.349 95.7081 327.375 95.4424 327.325 95.1859C327.275 94.9295 327.152 94.6939 326.97 94.5089C326.788 94.3239 326.555 94.1978 326.303 94.1466C326.05 94.0955 325.788 94.1215 325.55 94.2215C325.312 94.3214 325.109 94.4908 324.966 94.7081C324.823 94.9254 324.746 95.181 324.746 95.4424C324.746 95.7925 324.883 96.1282 325.127 96.376C325.37 96.6237 325.701 96.7632 326.046 96.7637Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M321.72 112.96C322.735 112.96 323.557 112.125 323.557 111.095C323.557 110.065 322.735 109.23 321.72 109.23C320.705 109.23 319.882 110.065 319.882 111.095C319.882 112.125 320.705 112.96 321.72 112.96Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M317.247 129.122C317.717 129.122 318.177 128.981 318.568 128.716C318.959 128.451 319.264 128.075 319.444 127.634C319.625 127.193 319.672 126.708 319.581 126.24C319.489 125.772 319.263 125.342 318.93 125.004C318.598 124.667 318.175 124.437 317.713 124.343C317.252 124.25 316.774 124.298 316.34 124.48C315.905 124.663 315.534 124.972 315.272 125.369C315.011 125.766 314.872 126.232 314.872 126.709C314.871 127.026 314.933 127.34 315.052 127.632C315.171 127.925 315.346 128.191 315.566 128.415C315.787 128.639 316.049 128.817 316.337 128.938C316.626 129.059 316.935 129.122 317.247 129.122Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M312.627 145.232C313.203 145.231 313.765 145.056 314.244 144.731C314.722 144.405 315.094 143.943 315.314 143.403C315.533 142.863 315.59 142.269 315.477 141.696C315.364 141.123 315.086 140.597 314.678 140.184C314.271 139.771 313.752 139.49 313.187 139.377C312.622 139.263 312.036 139.322 311.505 139.546C310.973 139.77 310.518 140.149 310.198 140.635C309.879 141.121 309.708 141.692 309.708 142.276C309.708 142.665 309.784 143.05 309.93 143.409C310.077 143.768 310.292 144.094 310.563 144.369C310.834 144.643 311.156 144.861 311.51 145.009C311.865 145.157 312.244 145.233 312.627 145.232Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M307.858 161.272C309.748 161.272 311.281 159.717 311.281 157.798C311.281 155.879 309.748 154.324 307.858 154.324C305.967 154.324 304.435 155.879 304.435 157.798C304.435 159.717 305.967 161.272 307.858 161.272Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M302.946 177.204C303.712 177.204 304.461 176.973 305.098 176.541C305.736 176.109 306.232 175.495 306.525 174.777C306.819 174.058 306.895 173.267 306.746 172.505C306.596 171.742 306.227 171.041 305.686 170.491C305.144 169.942 304.453 169.567 303.702 169.415C302.95 169.264 302.171 169.342 301.463 169.639C300.755 169.937 300.15 170.441 299.724 171.087C299.299 171.734 299.071 172.494 299.071 173.272C299.071 173.788 299.172 174.299 299.366 174.777C299.561 175.254 299.846 175.687 300.206 176.052C300.566 176.417 300.993 176.707 301.463 176.904C301.933 177.102 302.437 177.204 302.946 177.204Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M297.885 193.033C298.729 193.033 299.555 192.779 300.257 192.303C300.96 191.826 301.507 191.15 301.831 190.358C302.154 189.566 302.239 188.695 302.074 187.854C301.91 187.013 301.503 186.241 300.907 185.634C300.31 185.028 299.549 184.615 298.721 184.447C297.892 184.279 297.034 184.365 296.253 184.692C295.472 185.019 294.805 185.574 294.335 186.287C293.865 186.999 293.614 187.837 293.613 188.694C293.613 189.263 293.723 189.828 293.937 190.354C294.152 190.88 294.466 191.359 294.863 191.762C295.26 192.165 295.731 192.484 296.249 192.702C296.768 192.921 297.323 193.033 297.885 193.033Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M292.679 208.726C293.585 208.726 294.471 208.453 295.225 207.942C295.978 207.431 296.566 206.705 296.912 205.856C297.259 205.006 297.35 204.071 297.173 203.169C296.996 202.267 296.56 201.438 295.919 200.788C295.278 200.137 294.462 199.695 293.573 199.515C292.684 199.336 291.763 199.428 290.925 199.78C290.088 200.132 289.372 200.728 288.869 201.492C288.365 202.257 288.097 203.156 288.097 204.076C288.097 205.309 288.579 206.492 289.439 207.364C290.298 208.236 291.464 208.726 292.679 208.726Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M287.328 224.22C289.953 224.22 292.08 222.061 292.08 219.397C292.08 216.733 289.953 214.574 287.328 214.574C284.703 214.574 282.576 216.733 282.576 219.397C282.576 222.061 284.703 224.22 287.328 224.22Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M281.832 239.549C284.487 239.549 286.639 237.365 286.639 234.671C286.639 231.977 284.487 229.793 281.832 229.793C279.178 229.793 277.025 231.977 277.025 234.671C277.025 237.365 279.178 239.549 281.832 239.549Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M276.243 254.721C278.868 254.685 280.967 252.497 280.931 249.833C280.896 247.17 278.74 245.04 276.116 245.076C273.491 245.112 271.392 247.3 271.428 249.963C271.463 252.626 273.619 254.756 276.243 254.721Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M270.41 269.674C271.311 269.674 272.191 269.403 272.94 268.896C273.688 268.388 274.272 267.666 274.617 266.822C274.961 265.978 275.051 265.049 274.876 264.153C274.7 263.256 274.266 262.433 273.63 261.787C272.993 261.141 272.182 260.701 271.298 260.522C270.415 260.344 269.5 260.436 268.668 260.785C267.836 261.135 267.125 261.727 266.625 262.487C266.124 263.247 265.857 264.14 265.857 265.054C265.857 266.279 266.337 267.455 267.191 268.321C268.045 269.187 269.203 269.674 270.41 269.674Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M264.484 284.429C265.318 284.429 266.133 284.179 266.826 283.708C267.519 283.238 268.059 282.57 268.378 281.789C268.697 281.007 268.781 280.147 268.618 279.317C268.455 278.487 268.053 277.725 267.464 277.127C266.874 276.529 266.123 276.122 265.305 275.957C264.488 275.792 263.64 275.877 262.87 276.201C262.1 276.525 261.442 277.074 260.979 277.777C260.516 278.481 260.269 279.308 260.27 280.154C260.27 281.288 260.714 282.376 261.505 283.177C262.295 283.979 263.367 284.429 264.484 284.429Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M262.211 295.688C262.469 293.564 260.981 291.63 258.888 291.369C256.796 291.107 254.89 292.617 254.633 294.741C254.375 296.864 255.863 298.798 257.955 299.059C260.048 299.321 261.953 297.811 262.211 295.688Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M252.205 313.605C252.87 313.605 253.519 313.405 254.072 313.03C254.624 312.655 255.055 312.123 255.309 311.5C255.564 310.877 255.63 310.191 255.501 309.53C255.371 308.868 255.051 308.261 254.581 307.784C254.111 307.307 253.513 306.982 252.861 306.851C252.209 306.719 251.533 306.787 250.919 307.045C250.305 307.303 249.781 307.74 249.411 308.301C249.042 308.861 248.845 309.521 248.845 310.195C248.845 311.099 249.199 311.967 249.829 312.606C250.459 313.246 251.314 313.605 252.205 313.605Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M248.691 325.136C248.717 323.536 247.459 322.218 245.881 322.192C244.304 322.166 243.005 323.443 242.98 325.043C242.955 326.644 244.213 327.962 245.79 327.988C247.367 328.014 248.666 326.737 248.691 325.136Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M239.357 342.329C239.814 342.329 240.261 342.192 240.641 341.934C241.021 341.676 241.317 341.31 241.492 340.882C241.666 340.454 241.712 339.982 241.623 339.528C241.534 339.073 241.314 338.655 240.991 338.327C240.668 337.999 240.256 337.776 239.808 337.686C239.36 337.595 238.895 337.642 238.473 337.819C238.051 337.997 237.691 338.297 237.437 338.682C237.183 339.068 237.047 339.521 237.047 339.985C237.047 340.607 237.291 341.203 237.724 341.643C238.157 342.082 238.745 342.329 239.357 342.329Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M232.728 356.555C233.074 356.555 233.413 356.451 233.702 356.255C233.99 356.06 234.215 355.782 234.348 355.457C234.48 355.131 234.515 354.774 234.447 354.428C234.38 354.083 234.213 353.766 233.968 353.517C233.722 353.268 233.41 353.099 233.07 353.03C232.73 352.962 232.377 352.997 232.057 353.132C231.736 353.266 231.462 353.494 231.27 353.787C231.077 354.08 230.974 354.424 230.974 354.776C230.974 355.248 231.159 355.7 231.488 356.034C231.817 356.368 232.263 356.555 232.728 356.555Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M225.955 370.745C226.196 370.745 226.431 370.673 226.631 370.537C226.831 370.402 226.986 370.209 227.079 369.983C227.171 369.758 227.195 369.51 227.148 369.271C227.101 369.031 226.985 368.811 226.815 368.639C226.645 368.466 226.428 368.349 226.192 368.301C225.957 368.253 225.712 368.278 225.49 368.371C225.268 368.465 225.078 368.623 224.944 368.826C224.811 369.029 224.739 369.267 224.739 369.511C224.739 369.839 224.867 370.152 225.095 370.384C225.323 370.615 225.633 370.745 225.955 370.745Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M219.044 384.893C219.184 384.893 219.321 384.851 219.437 384.772C219.554 384.693 219.644 384.581 219.698 384.45C219.752 384.319 219.766 384.174 219.738 384.035C219.711 383.896 219.644 383.768 219.545 383.667C219.446 383.567 219.319 383.499 219.182 383.471C219.045 383.443 218.903 383.457 218.773 383.512C218.644 383.566 218.533 383.658 218.456 383.776C218.378 383.894 218.336 384.033 218.336 384.175C218.336 384.27 218.354 384.363 218.39 384.45C218.425 384.538 218.477 384.617 218.543 384.684C218.609 384.75 218.687 384.803 218.773 384.839C218.859 384.875 218.951 384.894 219.044 384.893Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M211.992 399.035C212.132 399.035 212.246 398.92 212.246 398.777C212.246 398.635 212.132 398.52 211.992 398.52C211.852 398.52 211.738 398.635 211.738 398.777C211.738 398.92 211.852 399.035 211.992 399.035Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M347.388 64.134C347.399 64.134 347.41 64.1306 347.419 64.1243C347.429 64.118 347.436 64.1091 347.44 64.0986C347.444 64.0882 347.445 64.0767 347.443 64.0656C347.441 64.0545 347.436 64.0443 347.428 64.0363C347.42 64.0283 347.41 64.0228 347.399 64.0206C347.388 64.0184 347.377 64.0196 347.366 64.0239C347.356 64.0282 347.347 64.0356 347.341 64.045C347.335 64.0544 347.332 64.0654 347.332 64.0767C347.332 64.0919 347.337 64.1065 347.348 64.1172C347.359 64.1279 347.373 64.134 347.388 64.134Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M343.39 80.2509C343.473 80.2509 343.554 80.2259 343.623 80.1791C343.692 80.1322 343.746 80.0657 343.778 79.9878C343.81 79.9099 343.818 79.8242 343.802 79.7415C343.785 79.6588 343.745 79.5829 343.687 79.5233C343.628 79.4637 343.553 79.4231 343.472 79.4066C343.39 79.3902 343.306 79.3986 343.229 79.4309C343.152 79.4631 343.087 79.5178 343.041 79.5879C342.994 79.658 342.97 79.7404 342.97 79.8247C342.97 79.9377 343.014 80.0461 343.093 80.1261C343.172 80.206 343.278 80.2509 343.39 80.2509Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M339.243 96.4425C339.422 96.4425 339.597 96.3887 339.745 96.2877C339.894 96.1868 340.01 96.0433 340.079 95.8755C340.147 95.7077 340.165 95.523 340.13 95.3448C340.095 95.1666 340.009 95.003 339.883 94.8745C339.756 94.746 339.595 94.6586 339.419 94.6231C339.244 94.5877 339.062 94.6059 338.896 94.6754C338.731 94.7449 338.589 94.8626 338.49 95.0137C338.391 95.1647 338.337 95.3423 338.337 95.524C338.337 95.7676 338.433 96.0012 338.603 96.1735C338.772 96.3457 339.002 96.4425 339.243 96.4425Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M334.95 112.594C335.224 112.594 335.492 112.512 335.72 112.357C335.948 112.203 336.126 111.983 336.23 111.726C336.335 111.469 336.363 111.186 336.309 110.913C336.256 110.641 336.124 110.39 335.93 110.193C335.736 109.997 335.489 109.863 335.22 109.808C334.952 109.754 334.673 109.782 334.42 109.888C334.166 109.995 333.95 110.175 333.798 110.406C333.645 110.638 333.564 110.91 333.564 111.188C333.565 111.561 333.711 111.918 333.971 112.182C334.23 112.445 334.583 112.594 334.95 112.594Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M330.509 128.731C330.882 128.731 331.248 128.618 331.559 128.407C331.87 128.197 332.112 127.897 332.255 127.547C332.398 127.196 332.435 126.81 332.362 126.438C332.289 126.066 332.109 125.725 331.845 125.456C331.581 125.188 331.244 125.005 330.877 124.931C330.511 124.857 330.131 124.895 329.785 125.041C329.44 125.186 329.145 125.432 328.937 125.747C328.729 126.062 328.619 126.433 328.619 126.813C328.619 127.321 328.818 127.809 329.172 128.169C329.527 128.529 330.007 128.731 330.509 128.731Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M325.922 144.789C326.392 144.789 326.851 144.648 327.242 144.383C327.632 144.118 327.937 143.742 328.116 143.301C328.296 142.861 328.343 142.376 328.251 141.909C328.16 141.441 327.934 141.012 327.601 140.675C327.269 140.338 326.846 140.108 326.385 140.015C325.925 139.922 325.447 139.97 325.013 140.152C324.579 140.335 324.208 140.644 323.947 141.04C323.686 141.436 323.547 141.902 323.547 142.379C323.547 143.018 323.797 143.631 324.243 144.083C324.688 144.535 325.292 144.789 325.922 144.789Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M321.191 160.788C321.75 160.788 322.297 160.62 322.762 160.304C323.227 159.989 323.59 159.541 323.804 159.016C324.018 158.492 324.074 157.914 323.965 157.357C323.856 156.801 323.586 156.289 323.191 155.888C322.795 155.486 322.291 155.213 321.742 155.102C321.194 154.991 320.625 155.048 320.108 155.265C319.591 155.483 319.149 155.851 318.839 156.323C318.528 156.795 318.362 157.35 318.362 157.918C318.362 158.679 318.66 159.409 319.19 159.947C319.721 160.486 320.44 160.788 321.191 160.788Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M316.312 176.708C316.956 176.709 317.586 176.517 318.122 176.156C318.658 175.794 319.076 175.279 319.324 174.676C319.571 174.073 319.637 173.409 319.512 172.768C319.388 172.127 319.079 171.538 318.624 171.075C318.169 170.613 317.59 170.298 316.959 170.17C316.327 170.041 315.673 170.106 315.078 170.356C314.483 170.606 313.974 171.029 313.617 171.572C313.259 172.115 313.068 172.753 313.068 173.407C313.068 174.28 313.41 175.119 314.018 175.737C314.626 176.356 315.451 176.705 316.312 176.708Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M311.289 192.528C312.005 192.528 312.705 192.312 313.301 191.909C313.896 191.505 314.36 190.931 314.634 190.26C314.908 189.588 314.98 188.85 314.84 188.137C314.701 187.424 314.356 186.77 313.849 186.256C313.343 185.742 312.698 185.392 311.996 185.25C311.293 185.109 310.565 185.181 309.904 185.459C309.242 185.737 308.677 186.208 308.279 186.813C307.881 187.417 307.669 188.127 307.669 188.854C307.669 189.828 308.05 190.763 308.729 191.452C309.408 192.141 310.329 192.528 311.289 192.528Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M306.121 208.193C306.893 208.194 307.648 207.962 308.291 207.526C308.933 207.091 309.434 206.473 309.729 205.749C310.025 205.025 310.103 204.228 309.952 203.46C309.802 202.691 309.43 201.985 308.884 201.431C308.339 200.876 307.643 200.499 306.886 200.346C306.128 200.193 305.343 200.271 304.63 200.571C303.916 200.871 303.306 201.378 302.877 202.03C302.448 202.682 302.219 203.448 302.219 204.231C302.219 205.282 302.63 206.289 303.362 207.032C304.094 207.775 305.086 208.193 306.121 208.193Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M300.81 223.734C301.621 223.734 302.414 223.49 303.089 223.033C303.763 222.576 304.289 221.926 304.599 221.165C304.91 220.405 304.991 219.568 304.833 218.76C304.675 217.953 304.284 217.211 303.71 216.629C303.137 216.047 302.406 215.651 301.61 215.49C300.815 215.33 299.99 215.412 299.241 215.727C298.491 216.042 297.851 216.575 297.4 217.26C296.95 217.944 296.709 218.749 296.709 219.572C296.709 220.119 296.815 220.66 297.021 221.165C297.227 221.671 297.529 222.129 297.91 222.516C298.291 222.903 298.743 223.209 299.24 223.418C299.738 223.627 300.272 223.735 300.81 223.734Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M299.457 235.652C299.893 233.348 298.405 231.122 296.135 230.68C293.865 230.238 291.672 231.748 291.236 234.051C290.801 236.355 292.288 238.581 294.558 239.023C296.828 239.465 299.022 237.956 299.457 235.652Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M289.758 254.31C290.58 254.31 291.384 254.063 292.068 253.599C292.751 253.136 293.284 252.477 293.599 251.706C293.914 250.935 293.996 250.086 293.836 249.268C293.675 248.449 293.279 247.697 292.698 247.107C292.116 246.517 291.375 246.115 290.569 245.952C289.762 245.789 288.926 245.873 288.166 246.192C287.407 246.512 286.757 247.053 286.3 247.746C285.843 248.44 285.6 249.256 285.6 250.091C285.6 251.21 286.038 252.283 286.818 253.074C287.598 253.865 288.655 254.31 289.758 254.31Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M284.014 269.345C284.809 269.346 285.586 269.107 286.247 268.659C286.908 268.211 287.423 267.575 287.727 266.83C288.032 266.085 288.111 265.265 287.957 264.474C287.802 263.683 287.419 262.957 286.858 262.386C286.296 261.816 285.58 261.427 284.801 261.27C284.022 261.112 283.214 261.193 282.479 261.502C281.745 261.81 281.118 262.333 280.676 263.003C280.235 263.674 279.999 264.462 279.999 265.268C279.999 266.349 280.422 267.386 281.175 268.15C281.928 268.915 282.949 269.345 284.014 269.345Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M278.13 284.208C278.874 284.208 279.601 283.984 280.219 283.565C280.838 283.145 281.32 282.549 281.605 281.852C281.889 281.154 281.964 280.387 281.819 279.646C281.674 278.906 281.315 278.226 280.789 277.692C280.263 277.158 279.593 276.795 278.864 276.648C278.134 276.5 277.378 276.576 276.69 276.865C276.003 277.154 275.416 277.643 275.003 278.271C274.589 278.898 274.369 279.636 274.369 280.391C274.369 281.403 274.765 282.374 275.47 283.09C276.176 283.806 277.132 284.208 278.13 284.208Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M272.105 298.928C272.782 298.928 273.444 298.725 274.008 298.343C274.571 297.962 275.01 297.419 275.269 296.785C275.528 296.15 275.596 295.451 275.464 294.777C275.332 294.103 275.006 293.484 274.528 292.998C274.049 292.512 273.439 292.181 272.774 292.047C272.11 291.913 271.422 291.982 270.796 292.245C270.171 292.509 269.636 292.954 269.26 293.526C268.884 294.097 268.684 294.769 268.684 295.456C268.684 296.377 269.045 297.26 269.686 297.911C270.328 298.562 271.198 298.928 272.105 298.928Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M265.939 313.533C266.538 313.533 267.123 313.352 267.62 313.015C268.118 312.678 268.506 312.198 268.735 311.637C268.964 311.076 269.024 310.458 268.907 309.862C268.79 309.267 268.502 308.72 268.079 308.29C267.656 307.861 267.117 307.568 266.53 307.45C265.943 307.331 265.334 307.392 264.781 307.624C264.228 307.857 263.756 308.25 263.423 308.755C263.091 309.261 262.913 309.854 262.913 310.462C262.913 311.276 263.232 312.057 263.799 312.633C264.367 313.209 265.137 313.533 265.939 313.533Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M259.633 328.019C260.142 328.019 260.641 327.866 261.064 327.579C261.488 327.292 261.818 326.884 262.013 326.407C262.209 325.929 262.26 325.404 262.16 324.897C262.061 324.39 261.816 323.924 261.456 323.558C261.095 323.193 260.637 322.944 260.137 322.843C259.637 322.742 259.119 322.794 258.649 322.992C258.178 323.19 257.776 323.526 257.494 323.955C257.211 324.385 257.06 324.891 257.061 325.408C257.061 326.1 257.332 326.764 257.815 327.253C258.297 327.743 258.951 328.018 259.633 328.019Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M253.186 342.415C253.601 342.415 254.007 342.29 254.353 342.055C254.698 341.821 254.967 341.488 255.126 341.099C255.285 340.71 255.327 340.281 255.246 339.868C255.165 339.454 254.965 339.075 254.671 338.777C254.377 338.478 254.003 338.276 253.596 338.193C253.188 338.111 252.766 338.153 252.382 338.315C251.999 338.476 251.671 338.749 251.44 339.099C251.209 339.45 251.086 339.862 251.086 340.284C251.086 340.849 251.307 341.391 251.701 341.79C252.095 342.19 252.629 342.415 253.186 342.415Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M246.6 356.75C246.92 356.75 247.232 356.655 247.497 356.475C247.763 356.296 247.97 356.04 248.092 355.741C248.214 355.442 248.247 355.113 248.185 354.795C248.123 354.478 247.969 354.186 247.744 353.957C247.518 353.728 247.231 353.571 246.918 353.508C246.605 353.445 246.281 353.477 245.986 353.601C245.691 353.725 245.439 353.935 245.262 354.204C245.084 354.473 244.99 354.789 244.99 355.113C244.99 355.547 245.159 355.963 245.461 356.27C245.763 356.577 246.173 356.749 246.6 356.75Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M239.876 370.988C240.094 370.988 240.307 370.922 240.488 370.799C240.67 370.676 240.811 370.501 240.895 370.297C240.978 370.093 241 369.868 240.957 369.651C240.915 369.434 240.81 369.234 240.656 369.078C240.501 368.921 240.305 368.815 240.091 368.771C239.877 368.728 239.656 368.75 239.454 368.835C239.253 368.92 239.08 369.063 238.959 369.247C238.838 369.431 238.773 369.648 238.773 369.869C238.773 370.166 238.89 370.45 239.096 370.66C239.303 370.87 239.584 370.988 239.876 370.988Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M233.013 385.185C233.138 385.185 233.26 385.147 233.363 385.077C233.467 385.007 233.548 384.907 233.595 384.79C233.643 384.673 233.655 384.545 233.631 384.421C233.607 384.297 233.547 384.183 233.459 384.094C233.371 384.004 233.258 383.943 233.136 383.919C233.014 383.894 232.887 383.907 232.772 383.955C232.657 384.003 232.559 384.085 232.489 384.19C232.42 384.296 232.383 384.419 232.383 384.546C232.383 384.715 232.45 384.878 232.568 384.998C232.686 385.118 232.846 385.185 233.013 385.185Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M226.014 399.385C226.053 399.386 226.092 399.374 226.125 399.352C226.159 399.33 226.184 399.298 226.2 399.261C226.215 399.224 226.219 399.183 226.212 399.144C226.204 399.104 226.185 399.068 226.157 399.04C226.129 399.011 226.093 398.992 226.054 398.984C226.015 398.977 225.975 398.981 225.939 398.996C225.902 399.012 225.871 399.038 225.849 399.072C225.827 399.105 225.816 399.145 225.816 399.185C225.816 399.211 225.822 399.237 225.831 399.262C225.841 399.286 225.856 399.308 225.874 399.327C225.893 399.345 225.914 399.36 225.938 399.37C225.962 399.38 225.988 399.385 226.014 399.385Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M356.549 80.0036C356.571 80.004 356.593 79.9976 356.612 79.9852C356.631 79.9729 356.646 79.955 356.655 79.934C356.664 79.9131 356.667 79.8898 356.662 79.8674C356.658 79.8449 356.648 79.8242 356.632 79.8079C356.616 79.7916 356.596 79.7804 356.574 79.7758C356.552 79.7712 356.529 79.7733 356.508 79.782C356.487 79.7906 356.469 79.8054 356.457 79.8243C356.444 79.8433 356.438 79.8656 356.438 79.8885C356.437 79.9187 356.449 79.9476 356.47 79.9691C356.491 79.9907 356.519 80.003 356.549 80.0036Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M352.433 96.1217C352.534 96.1221 352.633 96.092 352.717 96.0353C352.801 95.9785 352.867 95.8977 352.906 95.803C352.945 95.7083 352.955 95.604 352.935 95.5033C352.916 95.4026 352.867 95.3102 352.795 95.2376C352.724 95.1651 352.633 95.1157 352.534 95.0958C352.434 95.0759 352.332 95.0863 352.238 95.1258C352.145 95.1652 352.065 95.2319 352.009 95.3174C351.954 95.4029 351.924 95.5033 351.924 95.6059C351.925 95.7425 351.979 95.8734 352.074 95.97C352.169 96.0666 352.298 96.1211 352.433 96.1217Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M348.172 112.225C348.357 112.225 348.537 112.169 348.691 112.065C348.845 111.961 348.964 111.813 349.035 111.639C349.106 111.466 349.124 111.275 349.088 111.091C349.052 110.908 348.963 110.739 348.833 110.606C348.702 110.473 348.535 110.383 348.354 110.346C348.173 110.31 347.985 110.329 347.814 110.4C347.643 110.472 347.497 110.594 347.395 110.75C347.292 110.906 347.237 111.089 347.237 111.276C347.237 111.401 347.261 111.525 347.308 111.64C347.355 111.755 347.424 111.86 347.51 111.948C347.597 112.036 347.7 112.106 347.814 112.153C347.927 112.201 348.049 112.225 348.172 112.225Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M343.764 128.313C344.038 128.313 344.306 128.231 344.534 128.076C344.762 127.922 344.94 127.702 345.044 127.445C345.149 127.188 345.177 126.905 345.123 126.632C345.07 126.359 344.938 126.109 344.744 125.912C344.55 125.715 344.303 125.581 344.034 125.527C343.765 125.473 343.487 125.501 343.234 125.607C342.98 125.714 342.764 125.894 342.612 126.125C342.459 126.356 342.378 126.628 342.378 126.907C342.378 127.279 342.525 127.637 342.784 127.901C343.044 128.164 343.397 128.313 343.764 128.313Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M339.209 144.358C340.223 144.358 341.046 143.524 341.046 142.494C341.046 141.464 340.223 140.629 339.209 140.629C338.194 140.629 337.371 141.464 337.371 142.494C337.371 143.524 338.194 144.358 339.209 144.358Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M334.513 160.337C334.961 160.337 335.399 160.202 335.771 159.95C336.143 159.697 336.433 159.339 336.605 158.919C336.776 158.499 336.821 158.037 336.734 157.591C336.646 157.146 336.431 156.736 336.114 156.415C335.797 156.094 335.394 155.875 334.955 155.786C334.516 155.698 334.061 155.743 333.647 155.917C333.233 156.091 332.88 156.385 332.631 156.763C332.382 157.141 332.25 157.585 332.25 158.04C332.25 158.649 332.488 159.233 332.913 159.664C333.337 160.095 333.913 160.337 334.513 160.337Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M329.67 176.232C330.196 176.232 330.71 176.074 331.147 175.777C331.585 175.481 331.925 175.059 332.127 174.566C332.328 174.073 332.38 173.531 332.278 173.008C332.175 172.484 331.922 172.004 331.55 171.626C331.178 171.249 330.705 170.992 330.189 170.888C329.673 170.784 329.139 170.837 328.653 171.041C328.167 171.246 327.752 171.591 327.46 172.035C327.168 172.479 327.012 173 327.012 173.534C327.012 174.25 327.292 174.936 327.79 175.442C328.289 175.948 328.965 176.232 329.67 176.232Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M324.683 192.028C325.276 192.027 325.855 191.847 326.347 191.512C326.84 191.177 327.223 190.701 327.449 190.145C327.675 189.589 327.733 188.977 327.617 188.387C327.501 187.797 327.214 187.255 326.795 186.831C326.375 186.406 325.841 186.116 325.259 185.999C324.678 185.883 324.075 185.943 323.527 186.174C322.98 186.404 322.512 186.794 322.183 187.295C321.853 187.795 321.678 188.383 321.678 188.985C321.678 189.385 321.756 189.781 321.907 190.151C322.058 190.52 322.279 190.856 322.558 191.139C322.837 191.422 323.169 191.646 323.533 191.798C323.898 191.951 324.289 192.029 324.683 192.028Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M319.553 207.721C320.202 207.721 320.837 207.526 321.377 207.16C321.917 206.794 322.338 206.274 322.587 205.666C322.835 205.057 322.901 204.387 322.774 203.741C322.648 203.095 322.335 202.501 321.876 202.035C321.418 201.569 320.833 201.251 320.196 201.123C319.559 200.994 318.899 201.06 318.299 201.312C317.699 201.564 317.187 201.991 316.826 202.539C316.465 203.087 316.272 203.731 316.272 204.39C316.272 204.827 316.357 205.26 316.522 205.664C316.686 206.068 316.928 206.435 317.232 206.745C317.537 207.054 317.899 207.3 318.297 207.467C318.695 207.634 319.122 207.721 319.553 207.721Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M314.279 223.241C314.962 223.241 315.629 223.036 316.196 222.651C316.764 222.266 317.206 221.72 317.467 221.08C317.728 220.44 317.797 219.736 317.663 219.057C317.53 218.377 317.202 217.754 316.719 217.264C316.237 216.774 315.622 216.441 314.953 216.306C314.283 216.17 313.59 216.24 312.959 216.505C312.329 216.77 311.79 217.219 311.411 217.794C311.031 218.37 310.829 219.047 310.829 219.74C310.829 220.2 310.918 220.655 311.092 221.08C311.265 221.505 311.519 221.891 311.84 222.216C312.16 222.541 312.54 222.799 312.959 222.975C313.378 223.151 313.826 223.241 314.279 223.241Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M308.868 238.656C309.574 238.656 310.264 238.444 310.851 238.045C311.438 237.647 311.896 237.082 312.166 236.42C312.436 235.758 312.507 235.029 312.369 234.326C312.232 233.624 311.892 232.978 311.392 232.471C310.893 231.965 310.257 231.62 309.564 231.48C308.872 231.34 308.154 231.412 307.502 231.686C306.849 231.96 306.292 232.425 305.9 233.02C305.507 233.616 305.298 234.317 305.298 235.033C305.298 235.994 305.674 236.916 306.343 237.595C307.013 238.274 307.921 238.656 308.868 238.656Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M303.305 253.906C304.011 253.906 304.701 253.694 305.288 253.295C305.875 252.897 306.333 252.332 306.603 251.67C306.873 251.008 306.944 250.279 306.806 249.576C306.669 248.874 306.329 248.228 305.829 247.721C305.33 247.215 304.694 246.87 304.001 246.73C303.309 246.59 302.591 246.662 301.939 246.936C301.286 247.21 300.729 247.675 300.337 248.27C299.944 248.866 299.735 249.567 299.735 250.283C299.735 251.244 300.111 252.166 300.78 252.845C301.45 253.524 302.358 253.906 303.305 253.906Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M297.606 269.016C298.294 269.016 298.967 268.809 299.539 268.421C300.111 268.033 300.557 267.481 300.821 266.836C301.084 266.191 301.153 265.481 301.019 264.796C300.884 264.111 300.553 263.481 300.066 262.987C299.58 262.494 298.96 262.157 298.285 262.021C297.61 261.885 296.91 261.955 296.274 262.222C295.638 262.489 295.095 262.942 294.712 263.523C294.33 264.103 294.126 264.786 294.126 265.484C294.126 265.948 294.215 266.408 294.39 266.836C294.565 267.265 294.821 267.654 295.145 267.982C295.468 268.31 295.851 268.57 296.274 268.748C296.696 268.925 297.149 269.016 297.606 269.016Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M291.763 283.951C293.575 283.951 295.043 282.46 295.043 280.622C295.043 278.783 293.575 277.293 291.763 277.293C289.952 277.293 288.483 278.783 288.483 280.622C288.483 282.46 289.952 283.951 291.763 283.951Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M285.78 298.751C287.436 298.751 288.779 297.388 288.779 295.707C288.779 294.027 287.436 292.664 285.78 292.664C284.124 292.664 282.781 294.027 282.781 295.707C282.781 297.388 284.124 298.751 285.78 298.751Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M279.659 313.427C281.127 313.427 282.317 312.219 282.317 310.729C282.317 309.239 281.127 308.031 279.659 308.031C278.19 308.031 277 309.239 277 310.729C277 312.219 278.19 313.427 279.659 313.427Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M273.398 327.989C273.846 327.99 274.284 327.855 274.657 327.603C275.03 327.351 275.32 326.992 275.492 326.572C275.663 326.152 275.708 325.69 275.621 325.244C275.534 324.798 275.318 324.389 275.001 324.067C274.685 323.746 274.281 323.527 273.842 323.439C273.402 323.35 272.947 323.396 272.533 323.57C272.12 323.744 271.766 324.039 271.517 324.417C271.269 324.795 271.136 325.239 271.137 325.694C271.137 326.303 271.375 326.887 271.799 327.317C272.223 327.747 272.799 327.989 273.398 327.989Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M266.996 342.464C268.011 342.464 268.833 341.629 268.833 340.599C268.833 339.569 268.011 338.734 266.996 338.734C265.981 338.734 265.158 339.569 265.158 340.599C265.158 341.629 265.981 342.464 266.996 342.464Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M260.458 356.84C260.732 356.84 261 356.758 261.228 356.603C261.456 356.449 261.634 356.229 261.739 355.972C261.844 355.715 261.871 355.432 261.818 355.16C261.764 354.887 261.632 354.636 261.438 354.439C261.244 354.243 260.998 354.109 260.729 354.054C260.46 354 260.181 354.028 259.928 354.134C259.675 354.241 259.458 354.421 259.306 354.652C259.154 354.884 259.072 355.156 259.072 355.434C259.072 355.619 259.108 355.802 259.177 355.973C259.247 356.143 259.349 356.298 259.478 356.429C259.606 356.56 259.759 356.663 259.928 356.734C260.096 356.805 260.276 356.841 260.458 356.84Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M253.782 371.166C253.966 371.165 254.147 371.11 254.3 371.005C254.453 370.901 254.572 370.753 254.642 370.58C254.712 370.407 254.731 370.217 254.694 370.034C254.658 369.85 254.569 369.682 254.439 369.55C254.308 369.418 254.142 369.328 253.961 369.291C253.78 369.255 253.593 369.274 253.423 369.346C253.253 369.417 253.107 369.539 253.005 369.694C252.902 369.85 252.848 370.033 252.848 370.22C252.848 370.344 252.872 370.467 252.919 370.582C252.966 370.697 253.035 370.802 253.121 370.89C253.208 370.977 253.311 371.047 253.425 371.094C253.538 371.142 253.66 371.166 253.782 371.166Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M246.968 385.45C247.069 385.45 247.167 385.419 247.251 385.363C247.335 385.306 247.401 385.225 247.439 385.13C247.478 385.035 247.488 384.931 247.468 384.831C247.449 384.73 247.4 384.638 247.329 384.566C247.257 384.493 247.166 384.444 247.067 384.424C246.968 384.404 246.866 384.414 246.773 384.453C246.679 384.493 246.6 384.559 246.544 384.644C246.487 384.729 246.458 384.83 246.458 384.932C246.457 385 246.47 385.067 246.496 385.13C246.521 385.193 246.559 385.251 246.606 385.299C246.654 385.347 246.71 385.385 246.772 385.411C246.834 385.437 246.901 385.45 246.968 385.45Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M240.017 399.699C240.047 399.698 240.075 399.686 240.096 399.664C240.116 399.643 240.128 399.614 240.128 399.584C240.13 399.568 240.129 399.551 240.124 399.535C240.12 399.52 240.112 399.505 240.101 399.493C240.091 399.48 240.077 399.47 240.063 399.463C240.048 399.457 240.032 399.453 240.016 399.453C240 399.453 239.984 399.457 239.969 399.463C239.954 399.47 239.941 399.48 239.93 399.493C239.92 399.505 239.912 399.52 239.907 399.535C239.902 399.551 239.901 399.568 239.903 399.584C239.903 399.614 239.915 399.644 239.937 399.665C239.958 399.687 239.987 399.699 240.017 399.699Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M365.618 95.8289C365.647 95.8289 365.674 95.8204 365.698 95.8045C365.721 95.7886 365.74 95.7659 365.75 95.7394C365.761 95.713 365.764 95.6838 365.758 95.6557C365.753 95.6276 365.739 95.6018 365.719 95.5815C365.699 95.5612 365.674 95.5474 365.646 95.5418C365.619 95.5363 365.59 95.5391 365.564 95.5501C365.538 95.5611 365.515 95.5796 365.5 95.6035C365.484 95.6273 365.476 95.6553 365.476 95.684C365.475 95.7031 365.479 95.7221 365.486 95.7398C365.493 95.7575 365.503 95.7736 365.517 95.7871C365.53 95.8006 365.546 95.8113 365.563 95.8185C365.581 95.8256 365.6 95.8292 365.618 95.8289Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M361.387 111.908C361.494 111.908 361.597 111.876 361.686 111.816C361.774 111.756 361.843 111.67 361.884 111.571C361.925 111.471 361.935 111.361 361.914 111.256C361.894 111.15 361.843 111.053 361.767 110.976C361.692 110.9 361.596 110.848 361.492 110.827C361.388 110.806 361.28 110.817 361.181 110.858C361.083 110.899 360.999 110.969 360.94 111.059C360.881 111.149 360.85 111.254 360.85 111.362C360.85 111.507 360.906 111.645 361.007 111.748C361.108 111.85 361.245 111.908 361.387 111.908Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M357.011 127.955C357.195 127.955 357.375 127.899 357.529 127.795C357.682 127.692 357.801 127.544 357.872 127.371C357.943 127.198 357.961 127.008 357.925 126.824C357.889 126.641 357.8 126.472 357.67 126.34C357.539 126.207 357.373 126.117 357.192 126.081C357.012 126.044 356.824 126.063 356.654 126.135C356.483 126.206 356.338 126.327 356.235 126.483C356.133 126.639 356.078 126.822 356.078 127.009C356.078 127.26 356.176 127.5 356.351 127.678C356.526 127.855 356.763 127.955 357.011 127.955Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M352.491 143.952C352.754 143.952 353.011 143.873 353.23 143.725C353.449 143.576 353.619 143.366 353.72 143.119C353.82 142.873 353.846 142.601 353.795 142.34C353.744 142.078 353.617 141.838 353.431 141.649C353.245 141.46 353.009 141.332 352.751 141.28C352.493 141.228 352.226 141.254 351.983 141.357C351.74 141.459 351.532 141.632 351.386 141.853C351.24 142.075 351.162 142.336 351.162 142.603C351.163 142.961 351.303 143.303 351.552 143.556C351.801 143.809 352.139 143.951 352.491 143.952Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M347.827 159.906C348.169 159.906 348.502 159.803 348.786 159.611C349.07 159.418 349.291 159.145 349.422 158.825C349.553 158.504 349.587 158.152 349.52 157.812C349.454 157.473 349.289 157.16 349.048 156.915C348.806 156.67 348.499 156.504 348.164 156.436C347.829 156.368 347.482 156.403 347.167 156.536C346.851 156.668 346.582 156.893 346.392 157.181C346.202 157.469 346.101 157.808 346.101 158.154C346.101 158.619 346.283 159.064 346.607 159.393C346.93 159.721 347.369 159.906 347.827 159.906Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M343.018 175.789C344.174 175.789 345.112 174.837 345.112 173.664C345.112 172.49 344.174 171.539 343.018 171.539C341.862 171.539 340.924 172.49 340.924 173.664C340.924 174.837 341.862 175.789 343.018 175.789Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M338.069 191.568C338.544 191.568 339.008 191.425 339.404 191.157C339.799 190.889 340.107 190.509 340.289 190.063C340.471 189.618 340.52 189.128 340.428 188.655C340.335 188.182 340.107 187.747 339.772 187.405C339.436 187.064 339.009 186.831 338.543 186.735C338.077 186.64 337.594 186.687 337.154 186.871C336.715 187.054 336.339 187.366 336.073 187.766C335.808 188.166 335.666 188.637 335.664 189.119C335.663 189.44 335.724 189.759 335.845 190.056C335.965 190.353 336.142 190.623 336.365 190.85C336.589 191.078 336.854 191.258 337.146 191.381C337.439 191.504 337.752 191.568 338.069 191.568Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M334.67 206.626C335.801 205.677 335.96 203.976 335.024 202.828C334.089 201.68 332.413 201.518 331.281 202.468C330.15 203.418 329.991 205.118 330.927 206.267C331.862 207.415 333.538 207.576 334.67 206.626Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M327.74 222.805C328.305 222.804 328.857 222.634 329.327 222.315C329.796 221.996 330.162 221.544 330.378 221.014C330.593 220.484 330.65 219.902 330.539 219.339C330.429 218.777 330.157 218.261 329.757 217.856C329.358 217.451 328.849 217.175 328.295 217.063C327.741 216.952 327.167 217.009 326.645 217.229C326.123 217.448 325.677 217.82 325.363 218.296C325.05 218.773 324.882 219.333 324.882 219.906C324.882 220.287 324.956 220.664 325.1 221.016C325.244 221.368 325.454 221.687 325.72 221.956C325.985 222.226 326.3 222.439 326.647 222.585C326.994 222.73 327.365 222.805 327.74 222.805Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M322.362 238.206C322.944 238.206 323.512 238.031 323.996 237.703C324.479 237.375 324.856 236.909 325.079 236.364C325.301 235.818 325.359 235.219 325.246 234.64C325.132 234.061 324.852 233.529 324.441 233.112C324.03 232.695 323.506 232.411 322.936 232.296C322.366 232.18 321.775 232.24 321.237 232.465C320.7 232.691 320.241 233.074 319.918 233.564C319.595 234.055 319.422 234.632 319.422 235.222C319.422 236.013 319.732 236.772 320.283 237.332C320.835 237.891 321.583 238.206 322.362 238.206Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M316.848 253.5C317.435 253.5 318.009 253.323 318.498 252.992C318.986 252.661 319.366 252.19 319.591 251.639C319.816 251.089 319.875 250.483 319.76 249.898C319.646 249.314 319.363 248.777 318.948 248.355C318.532 247.934 318.003 247.647 317.427 247.531C316.851 247.414 316.254 247.474 315.711 247.702C315.169 247.93 314.705 248.316 314.379 248.812C314.053 249.307 313.878 249.89 313.878 250.486C313.878 250.882 313.955 251.274 314.104 251.639C314.254 252.005 314.472 252.337 314.748 252.617C315.024 252.897 315.351 253.119 315.711 253.27C316.072 253.422 316.458 253.5 316.848 253.5Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M311.184 268.65C312.793 268.65 314.097 267.327 314.097 265.694C314.097 264.062 312.793 262.738 311.184 262.738C309.576 262.738 308.271 264.062 308.271 265.694C308.271 267.327 309.576 268.65 311.184 268.65Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M305.384 283.661C305.932 283.662 306.468 283.497 306.924 283.188C307.38 282.879 307.736 282.44 307.946 281.926C308.156 281.412 308.212 280.847 308.105 280.301C307.998 279.755 307.734 279.253 307.347 278.86C306.959 278.466 306.465 278.198 305.927 278.089C305.39 277.981 304.832 278.036 304.325 278.249C303.819 278.462 303.386 278.823 303.081 279.285C302.776 279.748 302.614 280.292 302.614 280.848C302.614 281.594 302.906 282.309 303.425 282.837C303.944 283.364 304.649 283.661 305.384 283.661Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M299.445 298.533C299.949 298.534 300.442 298.383 300.861 298.099C301.28 297.815 301.607 297.411 301.8 296.939C301.993 296.467 302.044 295.947 301.946 295.445C301.848 294.944 301.605 294.483 301.249 294.121C300.893 293.759 300.439 293.513 299.945 293.413C299.451 293.313 298.938 293.364 298.473 293.56C298.007 293.755 297.609 294.087 297.329 294.512C297.049 294.937 296.9 295.437 296.9 295.948C296.9 296.288 296.965 296.624 297.093 296.937C297.221 297.251 297.408 297.536 297.645 297.776C297.881 298.016 298.162 298.207 298.471 298.337C298.78 298.467 299.111 298.533 299.445 298.533Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M294.905 312.664C295.821 311.802 295.874 310.35 295.025 309.42C294.175 308.491 292.744 308.436 291.829 309.298C290.913 310.161 290.859 311.613 291.709 312.542C292.558 313.471 293.989 313.526 294.905 312.664Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M287.15 327.928C287.53 327.928 287.902 327.813 288.219 327.599C288.535 327.384 288.782 327.079 288.927 326.722C289.073 326.365 289.111 325.973 289.036 325.594C288.962 325.215 288.778 324.867 288.509 324.594C288.24 324.322 287.897 324.136 287.524 324.061C287.15 323.986 286.764 324.025 286.412 324.173C286.061 324.321 285.76 324.571 285.549 324.893C285.338 325.214 285.226 325.592 285.226 325.978C285.227 326.495 285.43 326.991 285.79 327.357C286.151 327.722 286.64 327.928 287.15 327.928Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M280.793 342.479C281.101 342.479 281.402 342.387 281.658 342.214C281.914 342.04 282.114 341.794 282.232 341.505C282.35 341.217 282.381 340.899 282.321 340.593C282.262 340.286 282.113 340.005 281.896 339.784C281.678 339.563 281.401 339.412 281.099 339.351C280.797 339.29 280.484 339.321 280.2 339.44C279.915 339.56 279.672 339.762 279.501 340.022C279.33 340.282 279.239 340.587 279.239 340.899C279.239 341.318 279.402 341.719 279.694 342.015C279.985 342.311 280.38 342.478 280.793 342.479Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M274.299 356.939C274.529 356.94 274.754 356.871 274.945 356.741C275.136 356.612 275.286 356.428 275.374 356.213C275.462 355.998 275.485 355.761 275.441 355.532C275.396 355.303 275.286 355.093 275.123 354.928C274.961 354.763 274.754 354.65 274.529 354.605C274.303 354.559 274.07 354.582 273.858 354.672C273.645 354.761 273.464 354.912 273.336 355.106C273.208 355.299 273.14 355.527 273.14 355.761C273.141 356.073 273.263 356.372 273.48 356.593C273.697 356.813 273.992 356.938 274.299 356.939Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M267.67 371.308C267.815 371.308 267.957 371.264 268.078 371.183C268.199 371.101 268.293 370.984 268.349 370.848C268.404 370.711 268.419 370.561 268.39 370.417C268.362 370.272 268.292 370.139 268.189 370.035C268.087 369.931 267.956 369.86 267.813 369.831C267.67 369.802 267.523 369.817 267.388 369.873C267.254 369.93 267.139 370.025 267.058 370.148C266.978 370.271 266.935 370.415 266.935 370.562C266.935 370.76 267.012 370.95 267.15 371.09C267.288 371.23 267.475 371.308 267.67 371.308Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M260.904 385.672C260.976 385.672 261.047 385.65 261.108 385.609C261.168 385.568 261.215 385.51 261.243 385.441C261.271 385.373 261.278 385.298 261.264 385.226C261.25 385.154 261.215 385.087 261.163 385.035C261.112 384.983 261.047 384.947 260.975 384.933C260.904 384.919 260.83 384.926 260.763 384.954C260.696 384.982 260.638 385.03 260.598 385.092C260.558 385.153 260.536 385.225 260.536 385.299C260.536 385.398 260.575 385.493 260.644 385.562C260.713 385.632 260.806 385.672 260.904 385.672Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M254 399.999C254.004 399.999 254.008 399.998 254.011 399.997C254.014 399.995 254.017 399.993 254.02 399.991C254.022 399.988 254.024 399.985 254.026 399.982C254.027 399.978 254.028 399.975 254.028 399.971C254.028 399.967 254.027 399.963 254.026 399.96C254.025 399.956 254.023 399.953 254.02 399.95C254.018 399.947 254.015 399.945 254.011 399.944C254.008 399.942 254.004 399.941 254 399.941C253.993 399.941 253.985 399.945 253.98 399.95C253.974 399.956 253.971 399.963 253.971 399.971C253.971 399.975 253.972 399.979 253.973 399.982C253.975 399.986 253.977 399.989 253.98 399.991C253.983 399.994 253.986 399.996 253.989 399.997C253.993 399.998 253.997 399.999 254 399.999Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M374.598 111.595C374.636 111.595 374.673 111.579 374.699 111.552C374.726 111.525 374.741 111.488 374.741 111.45C374.741 111.421 374.733 111.393 374.717 111.369C374.701 111.345 374.679 111.327 374.653 111.316C374.627 111.305 374.598 111.302 374.571 111.307C374.543 111.313 374.517 111.327 374.497 111.347C374.477 111.367 374.464 111.393 374.458 111.421C374.453 111.449 374.456 111.479 374.466 111.505C374.477 111.532 374.496 111.554 374.519 111.57C374.543 111.586 374.57 111.595 374.598 111.595Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M370.251 127.585C370.346 127.585 370.439 127.556 370.518 127.502C370.597 127.448 370.658 127.371 370.694 127.282C370.73 127.192 370.739 127.094 370.72 126.999C370.701 126.905 370.655 126.818 370.587 126.75C370.519 126.682 370.433 126.636 370.339 126.618C370.246 126.6 370.149 126.61 370.062 126.648C369.974 126.686 369.899 126.749 369.847 126.83C369.795 126.91 369.767 127.005 369.768 127.102C369.769 127.231 369.821 127.354 369.911 127.445C370.002 127.535 370.124 127.586 370.251 127.585Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M365.763 143.568C365.929 143.568 366.092 143.518 366.23 143.425C366.368 143.331 366.476 143.198 366.539 143.042C366.603 142.886 366.62 142.715 366.587 142.549C366.555 142.384 366.475 142.232 366.357 142.113C366.24 141.994 366.09 141.913 365.927 141.88C365.764 141.847 365.595 141.864 365.442 141.928C365.288 141.993 365.157 142.102 365.065 142.242C364.973 142.382 364.923 142.547 364.923 142.716C364.923 142.942 365.012 143.159 365.169 143.319C365.327 143.478 365.541 143.568 365.763 143.568Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M361.133 159.475C361.368 159.475 361.598 159.404 361.794 159.272C361.989 159.139 362.141 158.95 362.231 158.73C362.321 158.509 362.345 158.267 362.299 158.033C362.253 157.799 362.139 157.584 361.973 157.415C361.806 157.246 361.594 157.132 361.364 157.085C361.133 157.039 360.894 157.063 360.677 157.155C360.459 157.247 360.274 157.401 360.144 157.6C360.013 157.799 359.944 158.032 359.944 158.271C359.944 158.429 359.975 158.586 360.035 158.732C360.095 158.878 360.182 159.011 360.293 159.123C360.403 159.235 360.534 159.324 360.678 159.384C360.822 159.444 360.977 159.475 361.133 159.475Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M356.36 175.337C356.662 175.337 356.957 175.246 357.208 175.076C357.459 174.906 357.655 174.664 357.77 174.381C357.886 174.097 357.916 173.786 357.857 173.485C357.798 173.185 357.653 172.909 357.439 172.692C357.226 172.475 356.954 172.328 356.658 172.268C356.361 172.208 356.054 172.239 355.775 172.356C355.497 172.473 355.258 172.672 355.09 172.927C354.923 173.182 354.833 173.481 354.833 173.788C354.833 173.991 354.872 174.193 354.949 174.381C355.025 174.569 355.138 174.74 355.28 174.884C355.421 175.028 355.59 175.142 355.775 175.22C355.96 175.297 356.159 175.337 356.36 175.337Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M351.443 191.1C351.801 191.1 352.152 190.993 352.45 190.791C352.748 190.59 352.98 190.303 353.117 189.967C353.255 189.632 353.291 189.262 353.221 188.906C353.152 188.549 352.979 188.222 352.726 187.965C352.473 187.707 352.151 187.532 351.799 187.461C351.448 187.39 351.084 187.426 350.753 187.565C350.422 187.704 350.139 187.94 349.94 188.242C349.741 188.544 349.635 188.899 349.635 189.263C349.635 189.504 349.682 189.743 349.772 189.966C349.863 190.189 349.996 190.391 350.164 190.562C350.332 190.732 350.531 190.868 350.751 190.96C350.97 191.052 351.206 191.1 351.443 191.1Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M346.387 206.788C346.795 206.788 347.194 206.665 347.533 206.434C347.873 206.204 348.138 205.877 348.294 205.494C348.45 205.111 348.491 204.69 348.411 204.284C348.332 203.878 348.135 203.504 347.846 203.211C347.558 202.918 347.19 202.719 346.789 202.638C346.389 202.557 345.974 202.599 345.597 202.757C345.219 202.916 344.897 203.184 344.67 203.529C344.443 203.873 344.322 204.278 344.322 204.693C344.323 205.248 344.54 205.781 344.928 206.173C345.315 206.566 345.839 206.787 346.387 206.788Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M341.189 222.336C341.631 222.336 342.063 222.203 342.43 221.954C342.798 221.705 343.084 221.35 343.253 220.936C343.422 220.522 343.467 220.066 343.38 219.626C343.294 219.186 343.081 218.782 342.769 218.465C342.456 218.148 342.058 217.932 341.625 217.844C341.191 217.757 340.742 217.802 340.334 217.973C339.926 218.145 339.577 218.436 339.331 218.809C339.086 219.181 338.955 219.62 338.955 220.068C338.955 220.67 339.19 221.246 339.609 221.672C340.028 222.097 340.596 222.336 341.189 222.336Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M335.851 237.777C336.315 237.777 336.769 237.637 337.155 237.375C337.541 237.113 337.842 236.741 338.02 236.306C338.198 235.87 338.244 235.391 338.153 234.929C338.063 234.466 337.839 234.042 337.51 233.709C337.182 233.376 336.763 233.149 336.307 233.057C335.852 232.966 335.38 233.013 334.951 233.194C334.522 233.374 334.155 233.68 333.898 234.072C333.64 234.464 333.503 234.925 333.503 235.396C333.503 236.028 333.751 236.634 334.191 237.08C334.632 237.526 335.228 237.777 335.851 237.777Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M330.372 253.115C330.847 253.115 331.312 252.972 331.708 252.703C332.103 252.435 332.411 252.054 332.593 251.608C332.775 251.162 332.823 250.672 332.73 250.198C332.637 249.725 332.408 249.29 332.072 248.949C331.736 248.608 331.307 248.375 330.841 248.281C330.374 248.187 329.891 248.235 329.452 248.42C329.012 248.605 328.637 248.918 328.373 249.319C328.108 249.72 327.967 250.192 327.967 250.675C327.967 250.995 328.029 251.313 328.15 251.609C328.27 251.905 328.448 252.174 328.671 252.401C328.894 252.627 329.159 252.807 329.451 252.93C329.743 253.052 330.056 253.115 330.372 253.115Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M324.752 268.313C325.222 268.313 325.682 268.172 326.073 267.906C326.464 267.641 326.769 267.264 326.949 266.823C327.129 266.383 327.175 265.897 327.084 265.429C326.992 264.961 326.765 264.531 326.432 264.194C326.1 263.857 325.676 263.627 325.215 263.534C324.753 263.442 324.275 263.49 323.841 263.673C323.407 263.855 323.036 264.165 322.775 264.562C322.514 264.959 322.375 265.426 322.375 265.903C322.375 266.22 322.437 266.533 322.556 266.826C322.676 267.118 322.851 267.384 323.071 267.608C323.292 267.832 323.554 268.009 323.843 268.13C324.131 268.251 324.44 268.313 324.752 268.313Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M318.994 283.368C319.442 283.368 319.88 283.233 320.252 282.981C320.624 282.729 320.914 282.37 321.086 281.95C321.257 281.53 321.302 281.068 321.215 280.623C321.127 280.177 320.912 279.768 320.595 279.446C320.278 279.125 319.875 278.906 319.436 278.818C318.997 278.729 318.542 278.774 318.128 278.948C317.714 279.122 317.361 279.417 317.112 279.794C316.863 280.172 316.73 280.616 316.73 281.071C316.73 281.68 316.969 282.264 317.394 282.695C317.818 283.126 318.394 283.368 318.994 283.368Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M313.095 298.284C313.504 298.284 313.904 298.162 314.244 297.932C314.584 297.701 314.849 297.374 315.006 296.991C315.162 296.608 315.204 296.186 315.124 295.779C315.045 295.372 314.848 294.998 314.559 294.705C314.27 294.411 313.902 294.211 313.501 294.13C313.1 294.049 312.685 294.091 312.307 294.249C311.929 294.408 311.606 294.677 311.379 295.022C311.152 295.367 311.031 295.772 311.031 296.187C311.031 296.743 311.248 297.276 311.635 297.669C312.022 298.062 312.547 298.283 313.095 298.284Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M307.058 313.112C308.073 313.112 308.895 312.277 308.895 311.248C308.895 310.218 308.073 309.383 307.058 309.383C306.043 309.383 305.22 310.218 305.22 311.248C305.22 312.277 306.043 313.112 307.058 313.112Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M300.888 327.83C301.196 327.83 301.496 327.738 301.752 327.564C302.008 327.39 302.208 327.144 302.326 326.855C302.443 326.566 302.474 326.249 302.414 325.942C302.353 325.636 302.205 325.354 301.987 325.134C301.769 324.913 301.492 324.763 301.19 324.702C300.888 324.641 300.575 324.673 300.291 324.793C300.006 324.913 299.764 325.115 299.593 325.375C299.422 325.635 299.331 325.941 299.332 326.253C299.332 326.46 299.372 326.666 299.45 326.857C299.528 327.049 299.643 327.223 299.787 327.369C299.932 327.516 300.104 327.632 300.292 327.711C300.481 327.79 300.683 327.831 300.888 327.83Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M294.575 342.457C294.822 342.457 295.063 342.383 295.267 342.244C295.472 342.105 295.632 341.908 295.726 341.677C295.82 341.446 295.845 341.191 295.797 340.946C295.748 340.701 295.63 340.476 295.455 340.299C295.281 340.122 295.059 340.002 294.817 339.954C294.575 339.905 294.325 339.931 294.097 340.027C293.87 340.122 293.676 340.285 293.539 340.493C293.402 340.701 293.33 340.946 293.33 341.196C293.33 341.361 293.362 341.526 293.425 341.679C293.488 341.832 293.579 341.971 293.695 342.088C293.811 342.206 293.948 342.299 294.099 342.362C294.25 342.425 294.412 342.458 294.575 342.457Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M288.126 356.969C288.3 356.97 288.47 356.918 288.614 356.82C288.759 356.722 288.872 356.583 288.939 356.421C289.005 356.258 289.023 356.079 288.989 355.906C288.956 355.733 288.872 355.574 288.75 355.449C288.627 355.324 288.471 355.239 288.3 355.205C288.13 355.17 287.953 355.188 287.793 355.255C287.632 355.322 287.495 355.437 287.399 355.583C287.302 355.73 287.25 355.902 287.25 356.078C287.25 356.314 287.343 356.54 287.507 356.707C287.671 356.874 287.894 356.969 288.126 356.969Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M281.542 371.447C281.649 371.447 281.753 371.415 281.841 371.355C281.93 371.295 281.998 371.21 282.039 371.11C282.08 371.01 282.091 370.9 282.07 370.795C282.049 370.689 281.998 370.592 281.923 370.515C281.847 370.439 281.752 370.387 281.647 370.366C281.543 370.345 281.435 370.356 281.337 370.397C281.239 370.438 281.155 370.508 281.096 370.598C281.036 370.688 281.005 370.793 281.005 370.901C281.005 371.046 281.062 371.184 281.162 371.287C281.263 371.389 281.4 371.447 281.542 371.447Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M274.822 385.858C274.861 385.858 274.9 385.846 274.932 385.824C274.965 385.802 274.99 385.771 275.005 385.734C275.02 385.697 275.024 385.657 275.016 385.618C275.008 385.579 274.99 385.544 274.962 385.516C274.934 385.488 274.899 385.469 274.861 385.461C274.823 385.453 274.783 385.457 274.747 385.472C274.711 385.487 274.68 385.513 274.658 385.546C274.637 385.579 274.625 385.618 274.625 385.657C274.625 385.71 274.646 385.761 274.683 385.799C274.72 385.837 274.77 385.858 274.822 385.858Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M383.484 127.316C383.506 127.316 383.528 127.309 383.547 127.297C383.565 127.284 383.58 127.266 383.588 127.245C383.597 127.223 383.599 127.2 383.595 127.178C383.59 127.155 383.579 127.135 383.563 127.119C383.547 127.103 383.526 127.092 383.504 127.088C383.482 127.084 383.459 127.086 383.439 127.095C383.418 127.104 383.4 127.119 383.388 127.139C383.376 127.158 383.37 127.18 383.37 127.203C383.371 127.233 383.383 127.262 383.404 127.283C383.425 127.304 383.454 127.316 383.484 127.316Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M379.027 143.208C379.106 143.208 379.183 143.185 379.248 143.141C379.314 143.097 379.365 143.034 379.395 142.961C379.426 142.887 379.434 142.806 379.419 142.728C379.404 142.65 379.366 142.578 379.311 142.521C379.255 142.465 379.184 142.426 379.107 142.41C379.03 142.395 378.95 142.402 378.878 142.433C378.805 142.463 378.743 142.515 378.699 142.581C378.656 142.647 378.632 142.725 378.632 142.805C378.632 142.912 378.674 143.014 378.748 143.089C378.822 143.165 378.922 143.207 379.027 143.208Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M374.43 159.1C374.57 159.1 374.707 159.058 374.824 158.979C374.94 158.901 375.031 158.788 375.084 158.657C375.138 158.526 375.152 158.381 375.124 158.242C375.097 158.103 375.03 157.975 374.931 157.874C374.832 157.774 374.706 157.706 374.568 157.678C374.431 157.65 374.289 157.664 374.16 157.719C374.03 157.773 373.92 157.865 373.842 157.983C373.764 158.101 373.723 158.24 373.723 158.382C373.723 158.573 373.797 158.755 373.93 158.89C374.063 159.025 374.243 159.1 374.43 159.1Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M369.692 174.918C369.889 174.918 370.08 174.859 370.243 174.748C370.406 174.638 370.533 174.481 370.608 174.297C370.683 174.113 370.703 173.91 370.664 173.715C370.626 173.52 370.531 173.341 370.393 173.2C370.254 173.06 370.077 172.964 369.884 172.925C369.692 172.887 369.493 172.907 369.312 172.983C369.131 173.06 368.976 173.189 368.867 173.355C368.759 173.521 368.701 173.715 368.701 173.914C368.701 174.046 368.727 174.177 368.777 174.299C368.827 174.421 368.9 174.532 368.992 174.625C369.084 174.718 369.193 174.792 369.313 174.842C369.433 174.893 369.562 174.918 369.692 174.918Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M364.812 190.66C365.059 190.66 365.299 190.586 365.504 190.447C365.709 190.309 365.868 190.111 365.963 189.88C366.057 189.649 366.082 189.395 366.034 189.15C365.986 188.905 365.867 188.68 365.693 188.503C365.519 188.326 365.297 188.206 365.055 188.157C364.814 188.108 364.563 188.133 364.336 188.229C364.108 188.325 363.914 188.487 363.777 188.694C363.64 188.902 363.567 189.147 363.567 189.397C363.567 189.732 363.698 190.053 363.932 190.29C364.165 190.527 364.482 190.66 364.812 190.66Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M359.791 206.356C360.087 206.356 360.377 206.267 360.624 206.099C360.871 205.932 361.063 205.694 361.176 205.416C361.29 205.138 361.319 204.832 361.262 204.537C361.204 204.242 361.061 203.971 360.851 203.758C360.641 203.545 360.374 203.4 360.083 203.342C359.793 203.283 359.491 203.313 359.217 203.428C358.943 203.543 358.709 203.739 358.544 203.989C358.379 204.239 358.292 204.533 358.292 204.834C358.291 205.034 358.33 205.232 358.405 205.417C358.48 205.602 358.591 205.769 358.73 205.911C358.869 206.052 359.035 206.164 359.217 206.241C359.399 206.317 359.594 206.356 359.791 206.356Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M354.629 221.92C354.959 221.918 355.28 221.817 355.553 221.63C355.826 221.443 356.038 221.178 356.163 220.869C356.288 220.56 356.32 220.22 356.256 219.892C356.191 219.565 356.032 219.264 355.799 219.027C355.566 218.791 355.27 218.63 354.947 218.564C354.624 218.499 354.289 218.531 353.985 218.658C353.68 218.785 353.419 219.001 353.235 219.278C353.051 219.555 352.951 219.881 352.949 220.215C352.949 220.667 353.126 221.101 353.441 221.42C353.756 221.74 354.184 221.92 354.629 221.92Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M349.329 237.376C349.681 237.376 350.026 237.27 350.319 237.072C350.613 236.873 350.841 236.59 350.976 236.26C351.111 235.929 351.146 235.565 351.077 235.214C351.009 234.863 350.839 234.541 350.59 234.288C350.34 234.035 350.022 233.862 349.677 233.793C349.331 233.723 348.972 233.759 348.647 233.896C348.321 234.032 348.042 234.264 347.846 234.562C347.65 234.859 347.546 235.209 347.546 235.567C347.546 236.047 347.734 236.507 348.068 236.847C348.402 237.186 348.856 237.376 349.329 237.376Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M343.885 252.726C344.9 252.726 345.723 251.891 345.723 250.861C345.723 249.831 344.9 248.996 343.885 248.996C342.871 248.996 342.048 249.831 342.048 250.861C342.048 251.891 342.871 252.726 343.885 252.726Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M338.625 267.912C339.626 267.743 340.303 266.783 340.137 265.767C339.97 264.751 339.024 264.064 338.023 264.233C337.022 264.402 336.345 265.363 336.511 266.379C336.678 267.394 337.624 268.081 338.625 267.912Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M332.598 283.067C332.945 283.067 333.284 282.962 333.572 282.767C333.861 282.571 334.086 282.293 334.218 281.968C334.351 281.643 334.386 281.285 334.318 280.94C334.25 280.595 334.083 280.278 333.838 280.029C333.593 279.78 333.28 279.611 332.94 279.542C332.6 279.473 332.248 279.509 331.927 279.643C331.607 279.778 331.333 280.006 331.14 280.299C330.948 280.591 330.845 280.935 330.845 281.287C330.845 281.759 331.029 282.212 331.358 282.546C331.687 282.879 332.133 283.067 332.598 283.067Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M326.733 298.059C327.052 298.059 327.364 297.963 327.629 297.784C327.895 297.604 328.102 297.349 328.224 297.05C328.347 296.751 328.379 296.422 328.317 296.104C328.255 295.786 328.102 295.494 327.876 295.265C327.651 295.036 327.363 294.88 327.05 294.817C326.737 294.753 326.413 294.786 326.118 294.91C325.823 295.033 325.571 295.243 325.394 295.512C325.217 295.782 325.122 296.098 325.122 296.422C325.122 296.856 325.292 297.272 325.594 297.578C325.896 297.885 326.305 298.058 326.733 298.059Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M320.739 312.939C321.019 312.939 321.292 312.855 321.525 312.697C321.757 312.54 321.938 312.316 322.045 312.053C322.152 311.791 322.18 311.503 322.126 311.225C322.071 310.947 321.936 310.691 321.739 310.49C321.541 310.29 321.289 310.153 321.015 310.098C320.741 310.043 320.457 310.071 320.199 310.179C319.94 310.288 319.72 310.472 319.564 310.708C319.409 310.944 319.326 311.221 319.326 311.505C319.326 311.885 319.475 312.25 319.74 312.519C320.005 312.788 320.365 312.939 320.739 312.939Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M314.609 327.725C314.845 327.725 315.074 327.654 315.27 327.522C315.465 327.389 315.618 327.201 315.708 326.98C315.798 326.76 315.821 326.517 315.775 326.283C315.729 326.049 315.616 325.834 315.45 325.666C315.284 325.497 315.072 325.382 314.841 325.336C314.611 325.289 314.372 325.313 314.155 325.404C313.937 325.496 313.752 325.65 313.621 325.849C313.491 326.047 313.421 326.28 313.421 326.519C313.421 326.839 313.546 327.145 313.769 327.372C313.992 327.598 314.294 327.725 314.609 327.725Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M308.341 342.4C308.52 342.4 308.695 342.346 308.843 342.245C308.992 342.144 309.108 342 309.177 341.833C309.245 341.665 309.263 341.48 309.228 341.302C309.193 341.124 309.107 340.96 308.981 340.832C308.854 340.703 308.693 340.616 308.517 340.58C308.342 340.545 308.16 340.563 307.994 340.632C307.829 340.702 307.688 340.82 307.588 340.971C307.489 341.122 307.436 341.299 307.436 341.481C307.436 341.725 307.531 341.958 307.701 342.131C307.87 342.303 308.101 342.4 308.341 342.4Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M301.938 356.987C302.056 356.987 302.17 356.952 302.268 356.886C302.366 356.82 302.442 356.725 302.487 356.615C302.532 356.505 302.544 356.384 302.521 356.267C302.498 356.15 302.441 356.042 302.358 355.958C302.275 355.874 302.169 355.816 302.054 355.793C301.939 355.77 301.819 355.782 301.711 355.827C301.602 355.873 301.509 355.95 301.444 356.049C301.379 356.148 301.344 356.265 301.344 356.384C301.344 356.544 301.406 356.698 301.518 356.811C301.629 356.924 301.78 356.987 301.938 356.987Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M295.398 371.545C295.46 371.545 295.52 371.526 295.571 371.492C295.622 371.457 295.662 371.408 295.685 371.35C295.709 371.293 295.715 371.229 295.703 371.168C295.691 371.107 295.661 371.051 295.618 371.006C295.575 370.962 295.519 370.932 295.459 370.92C295.399 370.908 295.336 370.914 295.279 370.938C295.222 370.962 295.174 371.002 295.14 371.054C295.106 371.106 295.087 371.167 295.087 371.229C295.088 371.313 295.121 371.393 295.179 371.452C295.237 371.511 295.316 371.544 295.398 371.545Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M288.724 386.068C288.735 386.068 288.747 386.065 288.756 386.059C288.766 386.053 288.773 386.044 288.778 386.034C288.782 386.023 288.784 386.012 288.782 386C288.78 385.989 288.775 385.979 288.767 385.971C288.759 385.962 288.749 385.957 288.738 385.954C288.727 385.952 288.716 385.953 288.705 385.957C288.695 385.962 288.686 385.969 288.68 385.978C288.673 385.988 288.67 385.999 288.67 386.01C288.67 386.025 288.676 386.039 288.686 386.05C288.696 386.061 288.71 386.067 288.724 386.068Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M392.284 142.962C392.299 142.962 392.314 142.956 392.324 142.945C392.335 142.935 392.341 142.92 392.341 142.905C392.341 142.89 392.335 142.875 392.324 142.864C392.314 142.854 392.299 142.848 392.284 142.848C392.269 142.848 392.255 142.854 392.245 142.864C392.234 142.875 392.228 142.89 392.228 142.905C392.228 142.92 392.234 142.935 392.245 142.945C392.255 142.956 392.269 142.962 392.284 142.962Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M387.721 158.75C387.772 158.751 387.822 158.736 387.865 158.708C387.907 158.679 387.94 158.639 387.96 158.591C387.979 158.543 387.985 158.491 387.975 158.44C387.965 158.39 387.941 158.343 387.905 158.307C387.869 158.27 387.823 158.245 387.773 158.235C387.723 158.225 387.671 158.231 387.624 158.251C387.578 158.271 387.538 158.304 387.51 158.347C387.482 158.39 387.467 158.441 387.467 158.493C387.467 158.526 387.474 158.56 387.487 158.591C387.499 158.623 387.518 158.651 387.542 158.675C387.565 158.699 387.593 158.718 387.624 158.731C387.655 158.744 387.688 158.75 387.721 158.75Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M383.015 174.547C383.116 174.547 383.214 174.517 383.297 174.46C383.381 174.404 383.446 174.323 383.485 174.229C383.523 174.134 383.533 174.031 383.513 173.931C383.494 173.831 383.445 173.739 383.374 173.667C383.303 173.595 383.213 173.545 383.114 173.526C383.016 173.506 382.913 173.516 382.821 173.555C382.728 173.594 382.648 173.66 382.592 173.745C382.537 173.83 382.507 173.929 382.507 174.031C382.507 174.168 382.56 174.299 382.656 174.396C382.751 174.493 382.88 174.547 383.015 174.547Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M378.168 190.277C378.314 190.277 378.457 190.233 378.578 190.151C378.699 190.069 378.793 189.952 378.849 189.816C378.905 189.679 378.92 189.528 378.891 189.383C378.863 189.238 378.793 189.105 378.689 189C378.586 188.896 378.455 188.824 378.312 188.796C378.169 188.767 378.021 188.782 377.886 188.838C377.751 188.895 377.636 188.991 377.555 189.114C377.474 189.237 377.431 189.381 377.431 189.529C377.431 189.728 377.509 189.918 377.647 190.058C377.785 190.199 377.973 190.277 378.168 190.277Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M373.185 205.928C373.37 205.928 373.551 205.872 373.704 205.768C373.858 205.664 373.978 205.516 374.048 205.343C374.119 205.169 374.138 204.979 374.102 204.795C374.066 204.611 373.976 204.442 373.846 204.309C373.715 204.176 373.549 204.086 373.367 204.049C373.186 204.013 372.998 204.032 372.827 204.103C372.657 204.175 372.511 204.297 372.408 204.453C372.305 204.609 372.25 204.792 372.25 204.98C372.25 205.104 372.274 205.228 372.321 205.343C372.368 205.458 372.437 205.563 372.524 205.651C372.61 205.739 372.714 205.809 372.827 205.856C372.941 205.904 373.062 205.928 373.185 205.928Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M368.059 221.512C368.277 221.512 368.491 221.447 368.673 221.324C368.855 221.201 368.997 221.026 369.081 220.821C369.165 220.616 369.187 220.391 369.144 220.173C369.102 219.956 368.997 219.756 368.842 219.599C368.688 219.442 368.491 219.335 368.277 219.291C368.063 219.248 367.84 219.27 367.638 219.355C367.436 219.439 367.264 219.583 367.142 219.768C367.021 219.952 366.956 220.169 366.956 220.391C366.956 220.687 367.072 220.972 367.279 221.182C367.486 221.393 367.766 221.511 368.059 221.512Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M362.794 236.972C363.035 236.973 363.271 236.9 363.472 236.765C363.672 236.629 363.829 236.436 363.921 236.21C364.013 235.984 364.038 235.735 363.991 235.495C363.944 235.255 363.828 235.035 363.657 234.862C363.487 234.689 363.27 234.571 363.033 234.524C362.797 234.476 362.552 234.501 362.329 234.595C362.106 234.688 361.916 234.847 361.783 235.051C361.649 235.254 361.578 235.494 361.578 235.738C361.579 236.065 361.707 236.379 361.935 236.61C362.163 236.841 362.472 236.972 362.794 236.972Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M357.393 252.365C357.65 252.365 357.902 252.288 358.116 252.143C358.33 251.997 358.497 251.791 358.596 251.55C358.694 251.308 358.72 251.043 358.67 250.786C358.62 250.53 358.496 250.294 358.313 250.11C358.131 249.925 357.899 249.799 357.647 249.748C357.394 249.697 357.132 249.723 356.895 249.823C356.657 249.923 356.453 250.093 356.31 250.31C356.167 250.527 356.091 250.783 356.091 251.044C356.091 251.218 356.124 251.39 356.189 251.55C356.255 251.71 356.351 251.856 356.472 251.979C356.593 252.102 356.736 252.199 356.894 252.265C357.052 252.332 357.222 252.366 357.393 252.365Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M351.851 267.619C352.108 267.62 352.36 267.542 352.575 267.398C352.789 267.253 352.956 267.046 353.055 266.805C353.154 266.564 353.18 266.298 353.13 266.041C353.08 265.785 352.956 265.549 352.774 265.364C352.592 265.179 352.36 265.053 352.108 265.002C351.855 264.951 351.593 264.977 351.355 265.077C351.117 265.177 350.914 265.346 350.77 265.564C350.627 265.781 350.551 266.036 350.551 266.298C350.551 266.471 350.584 266.643 350.649 266.803C350.714 266.964 350.81 267.109 350.931 267.232C351.052 267.355 351.195 267.452 351.353 267.519C351.511 267.585 351.68 267.619 351.851 267.619Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M346.172 282.766C346.419 282.766 346.66 282.692 346.865 282.554C347.07 282.415 347.23 282.218 347.324 281.987C347.419 281.756 347.444 281.502 347.396 281.257C347.348 281.012 347.23 280.786 347.056 280.609C346.882 280.432 346.66 280.312 346.418 280.263C346.177 280.214 345.926 280.239 345.698 280.334C345.471 280.43 345.276 280.592 345.139 280.8C345.002 281.008 344.929 281.252 344.929 281.502C344.929 281.837 345.06 282.158 345.293 282.395C345.526 282.632 345.843 282.765 346.172 282.766Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M340.368 297.83C340.598 297.83 340.823 297.761 341.014 297.632C341.205 297.503 341.354 297.319 341.443 297.104C341.531 296.888 341.554 296.651 341.51 296.423C341.465 296.194 341.355 295.984 341.192 295.819C341.03 295.654 340.823 295.541 340.598 295.495C340.372 295.45 340.139 295.473 339.926 295.562C339.714 295.651 339.533 295.802 339.405 295.996C339.277 296.19 339.209 296.418 339.209 296.651C339.209 296.963 339.331 297.263 339.548 297.484C339.766 297.705 340.061 297.829 340.368 297.83Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M334.404 312.75C334.95 312.75 335.393 312.3 335.393 311.746C335.393 311.192 334.95 310.742 334.404 310.742C333.858 310.742 333.415 311.192 333.415 311.746C333.415 312.3 333.858 312.75 334.404 312.75Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M328.318 327.587C328.475 327.587 328.628 327.54 328.758 327.452C328.888 327.364 328.99 327.238 329.05 327.091C329.109 326.945 329.125 326.783 329.095 326.627C329.064 326.471 328.989 326.328 328.878 326.216C328.767 326.103 328.626 326.027 328.473 325.996C328.319 325.965 328.16 325.981 328.015 326.042C327.87 326.102 327.747 326.205 327.66 326.338C327.573 326.47 327.526 326.625 327.526 326.784C327.526 326.997 327.61 327.201 327.758 327.352C327.907 327.503 328.108 327.587 328.318 327.587Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M322.098 342.35C322.209 342.349 322.318 342.315 322.411 342.252C322.504 342.189 322.576 342.099 322.618 341.994C322.661 341.89 322.671 341.774 322.649 341.663C322.627 341.552 322.573 341.45 322.494 341.37C322.415 341.29 322.315 341.236 322.205 341.214C322.096 341.192 321.982 341.203 321.879 341.247C321.776 341.29 321.688 341.364 321.626 341.458C321.564 341.552 321.531 341.663 321.531 341.776C321.53 341.852 321.545 341.927 321.573 341.997C321.602 342.066 321.644 342.13 321.696 342.183C321.749 342.236 321.812 342.279 321.881 342.307C321.95 342.336 322.023 342.35 322.098 342.35Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M315.735 357.002C315.796 357.002 315.856 356.983 315.907 356.949C315.958 356.914 315.998 356.865 316.022 356.807C316.045 356.75 316.051 356.686 316.039 356.625C316.027 356.564 315.998 356.508 315.954 356.463C315.911 356.419 315.856 356.389 315.795 356.377C315.735 356.365 315.672 356.371 315.616 356.395C315.559 356.419 315.51 356.459 315.476 356.511C315.442 356.563 315.424 356.624 315.424 356.687C315.424 356.728 315.432 356.769 315.447 356.807C315.463 356.845 315.486 356.88 315.515 356.91C315.544 356.939 315.578 356.962 315.616 356.978C315.653 356.994 315.694 357.002 315.735 357.002Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M309.239 371.634C309.252 371.636 309.264 371.635 309.276 371.631C309.288 371.628 309.299 371.622 309.308 371.614C309.318 371.606 309.325 371.596 309.33 371.584C309.336 371.573 309.338 371.56 309.338 371.548C309.338 371.535 309.336 371.523 309.33 371.511C309.325 371.5 309.318 371.49 309.308 371.482C309.299 371.474 309.288 371.468 309.276 371.464C309.264 371.461 309.252 371.46 309.239 371.462C309.219 371.465 309.201 371.476 309.188 371.491C309.174 371.507 309.167 371.527 309.167 371.548C309.167 371.569 309.174 371.589 309.188 371.604C309.201 371.62 309.219 371.63 309.239 371.634Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M396.331 174.265C396.354 174.265 396.376 174.259 396.394 174.246C396.413 174.233 396.427 174.215 396.436 174.194C396.445 174.173 396.447 174.15 396.442 174.128C396.438 174.105 396.427 174.085 396.411 174.069C396.396 174.053 396.375 174.042 396.353 174.037C396.331 174.033 396.309 174.035 396.288 174.044C396.267 174.053 396.249 174.067 396.237 174.086C396.224 174.105 396.218 174.127 396.218 174.15C396.218 174.181 396.23 174.21 396.251 174.232C396.272 174.253 396.301 174.265 396.331 174.265Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M391.52 189.943C391.576 189.943 391.631 189.926 391.678 189.894C391.724 189.862 391.761 189.818 391.782 189.765C391.804 189.712 391.809 189.655 391.798 189.599C391.787 189.543 391.76 189.492 391.721 189.451C391.681 189.411 391.631 189.384 391.576 189.373C391.521 189.362 391.464 189.367 391.412 189.389C391.36 189.411 391.316 189.448 391.285 189.495C391.253 189.542 391.237 189.598 391.237 189.655C391.237 189.693 391.244 189.73 391.258 189.765C391.272 189.8 391.293 189.832 391.319 189.859C391.346 189.886 391.377 189.907 391.412 189.921C391.446 189.936 391.483 189.943 391.52 189.943Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M386.568 205.577C386.658 205.577 386.746 205.551 386.821 205.5C386.896 205.45 386.954 205.378 386.989 205.294C387.024 205.21 387.033 205.117 387.015 205.027C386.998 204.938 386.955 204.856 386.891 204.791C386.827 204.727 386.746 204.683 386.658 204.665C386.57 204.647 386.479 204.657 386.396 204.692C386.313 204.727 386.242 204.786 386.192 204.862C386.143 204.938 386.116 205.027 386.117 205.119C386.117 205.24 386.165 205.356 386.25 205.442C386.334 205.528 386.449 205.576 386.568 205.577Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M381.48 221.136C381.598 221.136 381.713 221.1 381.81 221.034C381.908 220.968 381.984 220.873 382.029 220.763C382.074 220.653 382.086 220.531 382.063 220.414C382.04 220.297 381.983 220.19 381.9 220.106C381.816 220.021 381.71 219.964 381.595 219.941C381.479 219.918 381.36 219.93 381.251 219.976C381.143 220.022 381.05 220.1 380.985 220.199C380.92 220.299 380.885 220.416 380.886 220.535C380.886 220.614 380.901 220.692 380.931 220.765C380.961 220.838 381.005 220.905 381.06 220.961C381.115 221.016 381.181 221.061 381.253 221.091C381.325 221.121 381.402 221.136 381.48 221.136Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M376.253 236.62C376.393 236.62 376.53 236.578 376.646 236.499C376.763 236.42 376.853 236.308 376.907 236.177C376.961 236.045 376.975 235.901 376.947 235.762C376.92 235.622 376.853 235.494 376.754 235.394C376.655 235.294 376.528 235.225 376.391 235.197C376.254 235.17 376.112 235.184 375.982 235.238C375.853 235.293 375.742 235.385 375.665 235.503C375.587 235.621 375.545 235.76 375.545 235.902C375.545 236.092 375.62 236.275 375.753 236.41C375.885 236.544 376.065 236.62 376.253 236.62Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M370.887 252.025C371.044 252.025 371.197 251.978 371.327 251.889C371.457 251.801 371.559 251.676 371.619 251.529C371.679 251.382 371.694 251.221 371.664 251.065C371.633 250.909 371.558 250.766 371.447 250.653C371.337 250.541 371.195 250.464 371.042 250.433C370.888 250.402 370.729 250.418 370.584 250.479C370.44 250.54 370.316 250.643 370.229 250.775C370.142 250.907 370.096 251.063 370.096 251.221C370.096 251.435 370.179 251.639 370.328 251.79C370.476 251.94 370.677 252.025 370.887 252.025Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M365.385 267.294C365.542 267.294 365.695 267.247 365.825 267.159C365.955 267.071 366.057 266.945 366.117 266.798C366.177 266.652 366.192 266.49 366.162 266.334C366.131 266.178 366.056 266.035 365.945 265.923C365.835 265.81 365.693 265.734 365.54 265.703C365.386 265.672 365.227 265.688 365.082 265.749C364.938 265.809 364.814 265.912 364.727 266.045C364.64 266.177 364.594 266.332 364.594 266.491C364.594 266.704 364.677 266.908 364.826 267.059C364.974 267.21 365.175 267.294 365.385 267.294Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M359.745 282.485C359.896 282.485 360.044 282.44 360.17 282.355C360.296 282.27 360.395 282.149 360.453 282.007C360.511 281.865 360.526 281.709 360.497 281.559C360.467 281.408 360.394 281.269 360.287 281.161C360.18 281.052 360.044 280.978 359.895 280.948C359.747 280.919 359.593 280.934 359.453 280.993C359.314 281.052 359.194 281.152 359.11 281.28C359.027 281.408 358.982 281.558 358.982 281.711C358.983 281.916 359.063 282.113 359.206 282.258C359.349 282.403 359.543 282.484 359.745 282.485Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M353.97 297.593C354.11 297.593 354.247 297.551 354.364 297.473C354.48 297.394 354.571 297.282 354.625 297.151C354.679 297.02 354.693 296.875 354.666 296.736C354.639 296.596 354.572 296.468 354.473 296.367C354.374 296.267 354.248 296.198 354.111 296.17C353.973 296.142 353.831 296.156 353.702 296.211C353.572 296.265 353.461 296.357 353.384 296.475C353.306 296.593 353.264 296.732 353.264 296.874C353.264 297.065 353.338 297.247 353.471 297.382C353.603 297.516 353.782 297.592 353.97 297.593Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M348.06 312.589C348.178 312.589 348.293 312.554 348.39 312.487C348.488 312.421 348.564 312.327 348.609 312.217C348.654 312.107 348.666 311.985 348.643 311.868C348.62 311.751 348.563 311.644 348.48 311.559C348.397 311.475 348.291 311.418 348.176 311.394C348.061 311.371 347.941 311.383 347.833 311.429C347.724 311.474 347.631 311.552 347.566 311.651C347.501 311.75 347.466 311.867 347.466 311.986C347.466 312.146 347.528 312.299 347.64 312.412C347.751 312.526 347.902 312.589 348.06 312.589Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M342.012 327.474C342.095 327.474 342.177 327.449 342.246 327.402C342.315 327.355 342.369 327.288 342.4 327.21C342.432 327.133 342.44 327.047 342.424 326.964C342.408 326.881 342.368 326.806 342.309 326.746C342.251 326.686 342.176 326.646 342.094 326.629C342.013 326.613 341.928 326.621 341.852 326.654C341.775 326.686 341.709 326.74 341.663 326.811C341.617 326.881 341.592 326.963 341.592 327.047C341.592 327.16 341.637 327.269 341.715 327.349C341.794 327.429 341.901 327.474 342.012 327.474Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M335.832 342.297C335.883 342.298 335.933 342.283 335.975 342.254C336.018 342.226 336.051 342.185 336.071 342.138C336.09 342.09 336.096 342.038 336.086 341.987C336.076 341.937 336.051 341.89 336.015 341.853C335.98 341.817 335.934 341.792 335.884 341.782C335.834 341.772 335.782 341.778 335.735 341.798C335.688 341.817 335.648 341.851 335.62 341.894C335.592 341.937 335.578 341.988 335.578 342.039C335.578 342.073 335.585 342.107 335.597 342.138C335.61 342.169 335.629 342.198 335.653 342.222C335.676 342.246 335.704 342.265 335.735 342.278C335.766 342.291 335.799 342.297 335.832 342.297Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M329.515 357.068C329.532 357.069 329.549 357.064 329.563 357.055C329.577 357.045 329.589 357.032 329.595 357.016C329.602 357 329.604 356.982 329.601 356.965C329.598 356.948 329.589 356.932 329.577 356.92C329.565 356.908 329.55 356.899 329.533 356.896C329.516 356.893 329.499 356.895 329.483 356.902C329.467 356.908 329.454 356.92 329.445 356.934C329.435 356.949 329.431 356.966 329.431 356.984C329.431 357.006 329.44 357.028 329.456 357.043C329.471 357.059 329.493 357.068 329.515 357.068Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M399.943 205.314C399.954 205.314 399.965 205.31 399.974 205.304C399.984 205.298 399.991 205.289 399.995 205.278C399.999 205.268 400.001 205.256 399.998 205.245C399.996 205.234 399.991 205.224 399.983 205.216C399.975 205.208 399.965 205.203 399.954 205.2C399.943 205.198 399.932 205.199 399.922 205.204C399.911 205.208 399.902 205.215 399.896 205.225C399.89 205.234 399.887 205.245 399.887 205.256C399.887 205.272 399.893 205.286 399.903 205.297C399.914 205.308 399.928 205.314 399.943 205.314Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M394.891 220.856C394.914 220.859 394.938 220.856 394.961 220.849C394.984 220.841 395.005 220.829 395.023 220.813C395.041 220.797 395.055 220.777 395.065 220.755C395.075 220.733 395.08 220.709 395.08 220.684C395.08 220.66 395.075 220.636 395.065 220.614C395.055 220.592 395.041 220.572 395.023 220.556C395.005 220.539 394.984 220.527 394.961 220.52C394.938 220.512 394.914 220.51 394.891 220.513C394.867 220.51 394.843 220.512 394.82 220.52C394.797 220.527 394.776 220.539 394.758 220.556C394.741 220.572 394.726 220.592 394.716 220.614C394.707 220.636 394.702 220.66 394.702 220.684C394.702 220.709 394.707 220.733 394.716 220.755C394.726 220.777 394.741 220.797 394.758 220.813C394.776 220.829 394.797 220.841 394.82 220.849C394.843 220.856 394.867 220.859 394.891 220.856Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M389.699 236.325C389.75 236.325 389.8 236.31 389.843 236.282C389.885 236.253 389.918 236.213 389.938 236.165C389.957 236.118 389.963 236.065 389.953 236.014C389.943 235.964 389.919 235.917 389.883 235.881C389.847 235.844 389.801 235.82 389.751 235.81C389.701 235.8 389.649 235.805 389.603 235.825C389.556 235.845 389.516 235.878 389.488 235.922C389.46 235.965 389.445 236.015 389.445 236.067C389.445 236.101 389.452 236.134 389.465 236.165C389.477 236.197 389.496 236.225 389.52 236.249C389.543 236.273 389.571 236.292 389.602 236.305C389.633 236.318 389.666 236.325 389.699 236.325Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M384.372 251.741C384.439 251.741 384.505 251.721 384.561 251.683C384.617 251.645 384.661 251.591 384.686 251.528C384.712 251.465 384.719 251.396 384.706 251.329C384.692 251.262 384.66 251.2 384.612 251.152C384.565 251.104 384.504 251.071 384.438 251.057C384.372 251.044 384.304 251.051 384.242 251.077C384.18 251.103 384.126 251.147 384.089 251.204C384.052 251.261 384.032 251.328 384.032 251.396C384.032 251.488 384.068 251.575 384.131 251.64C384.195 251.705 384.282 251.741 384.372 251.741Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M378.908 267.055C378.981 267.055 379.053 267.034 379.114 266.993C379.175 266.951 379.222 266.893 379.251 266.824C379.279 266.756 379.286 266.68 379.272 266.607C379.258 266.534 379.223 266.467 379.171 266.415C379.119 266.362 379.053 266.326 378.981 266.312C378.909 266.297 378.835 266.305 378.767 266.334C378.7 266.362 378.642 266.411 378.601 266.473C378.561 266.535 378.54 266.608 378.54 266.682C378.541 266.781 378.58 266.875 378.648 266.945C378.717 267.015 378.81 267.054 378.908 267.055Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M373.307 282.249C373.374 282.249 373.44 282.229 373.496 282.191C373.551 282.153 373.595 282.099 373.621 282.036C373.647 281.973 373.653 281.903 373.64 281.836C373.627 281.77 373.595 281.708 373.547 281.66C373.499 281.611 373.439 281.579 373.373 281.565C373.307 281.552 373.238 281.559 373.176 281.585C373.114 281.611 373.061 281.655 373.024 281.712C372.986 281.769 372.966 281.836 372.966 281.904C372.967 281.995 373.003 282.083 373.067 282.147C373.13 282.212 373.216 282.249 373.307 282.249Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M367.572 297.38C367.628 297.38 367.682 297.363 367.729 297.332C367.776 297.3 367.812 297.255 367.834 297.202C367.855 297.15 367.861 297.092 367.85 297.036C367.839 296.98 367.812 296.929 367.772 296.889C367.732 296.849 367.682 296.821 367.627 296.81C367.572 296.799 367.515 296.805 367.463 296.827C367.411 296.848 367.367 296.885 367.336 296.933C367.305 296.98 367.288 297.036 367.288 297.092C367.288 297.13 367.295 297.168 367.309 297.203C367.323 297.238 367.344 297.27 367.371 297.296C367.397 297.323 367.428 297.344 367.463 297.359C367.497 297.373 367.534 297.38 367.572 297.38Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M361.7 312.423C361.728 312.426 361.756 312.423 361.782 312.414C361.809 312.406 361.833 312.391 361.854 312.372C361.875 312.353 361.891 312.33 361.903 312.304C361.914 312.278 361.92 312.25 361.92 312.222C361.92 312.194 361.914 312.166 361.903 312.14C361.891 312.114 361.875 312.091 361.854 312.072C361.833 312.053 361.809 312.038 361.782 312.03C361.756 312.021 361.728 312.018 361.7 312.021C361.651 312.026 361.605 312.049 361.572 312.086C361.539 312.124 361.521 312.172 361.521 312.222C361.521 312.272 361.539 312.32 361.572 312.358C361.605 312.395 361.651 312.418 361.7 312.423Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M355.698 327.41C355.713 327.41 355.728 327.407 355.742 327.401C355.756 327.395 355.768 327.387 355.779 327.376C355.789 327.365 355.797 327.353 355.803 327.339C355.809 327.325 355.812 327.31 355.812 327.295C355.812 327.28 355.809 327.265 355.803 327.251C355.797 327.237 355.789 327.224 355.779 327.213C355.768 327.203 355.756 327.194 355.742 327.188C355.728 327.183 355.713 327.18 355.698 327.18C355.668 327.18 355.639 327.192 355.618 327.213C355.597 327.235 355.585 327.264 355.585 327.295C355.585 327.325 355.597 327.355 355.618 327.376C355.639 327.398 355.668 327.41 355.698 327.41Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M349.556 342.346C349.563 342.346 349.571 342.343 349.576 342.338C349.582 342.332 349.585 342.325 349.585 342.317C349.585 342.313 349.584 342.309 349.583 342.306C349.581 342.302 349.579 342.299 349.576 342.296C349.573 342.294 349.57 342.292 349.567 342.291C349.563 342.289 349.559 342.289 349.556 342.289C349.548 342.289 349.541 342.292 349.536 342.297C349.531 342.302 349.528 342.309 349.528 342.317C349.528 342.32 349.529 342.324 349.53 342.328C349.531 342.331 349.533 342.335 349.536 342.338C349.538 342.34 349.541 342.343 349.545 342.344C349.548 342.346 349.552 342.346 349.556 342.346Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M397.845 251.596C397.849 251.596 397.853 251.595 397.856 251.594C397.859 251.592 397.863 251.59 397.865 251.587C397.868 251.585 397.87 251.581 397.871 251.578C397.872 251.574 397.873 251.57 397.872 251.567C397.872 251.563 397.872 251.559 397.87 251.556C397.869 251.553 397.867 251.55 397.864 251.547C397.862 251.545 397.859 251.543 397.856 251.541C397.852 251.54 397.849 251.539 397.845 251.539C397.838 251.539 397.831 251.542 397.825 251.547C397.82 251.552 397.816 251.559 397.816 251.567C397.816 251.571 397.817 251.574 397.818 251.578C397.82 251.582 397.822 251.585 397.824 251.588C397.827 251.59 397.83 251.593 397.834 251.594C397.838 251.595 397.841 251.596 397.845 251.596Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M392.419 266.905C392.423 266.905 392.426 266.904 392.43 266.903C392.433 266.901 392.436 266.899 392.439 266.896C392.441 266.893 392.443 266.89 392.445 266.886C392.446 266.883 392.446 266.879 392.446 266.875C392.446 266.872 392.445 266.868 392.444 266.865C392.443 266.861 392.441 266.858 392.438 266.856C392.436 266.853 392.433 266.851 392.429 266.85C392.426 266.848 392.422 266.848 392.419 266.848C392.415 266.847 392.411 266.848 392.408 266.849C392.404 266.85 392.401 266.852 392.398 266.855C392.396 266.858 392.393 266.861 392.392 266.864C392.39 266.868 392.39 266.871 392.39 266.875C392.39 266.883 392.393 266.891 392.398 266.896C392.404 266.902 392.411 266.905 392.419 266.905Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M386.856 282.139C386.86 282.139 386.863 282.139 386.867 282.137C386.871 282.136 386.874 282.133 386.877 282.131C386.879 282.128 386.881 282.125 386.883 282.121C386.884 282.117 386.885 282.114 386.885 282.11C386.885 282.106 386.884 282.102 386.883 282.099C386.881 282.095 386.879 282.092 386.876 282.089C386.874 282.087 386.87 282.085 386.867 282.084C386.863 282.082 386.86 282.082 386.856 282.082C386.849 282.082 386.842 282.085 386.837 282.09C386.832 282.095 386.829 282.102 386.829 282.11C386.828 282.113 386.829 282.117 386.83 282.121C386.831 282.124 386.833 282.128 386.836 282.131C386.838 282.133 386.842 282.136 386.845 282.137C386.848 282.139 386.852 282.139 386.856 282.139Z",fill:"#A2A2A2",fillOpacity:"0.5"}),S.jsx("path",{d:"M381.161 297.335C381.164 297.335 381.168 297.334 381.171 297.332C381.174 297.331 381.177 297.329 381.18 297.326C381.182 297.324 381.184 297.321 381.186 297.318C381.187 297.314 381.188 297.311 381.188 297.307C381.188 297.303 381.188 297.299 381.186 297.296C381.185 297.292 381.183 297.289 381.181 297.286C381.178 297.283 381.175 297.281 381.171 297.28C381.168 297.278 381.164 297.277 381.161 297.277C381.157 297.277 381.153 297.278 381.149 297.28C381.146 297.281 381.143 297.283 381.14 297.286C381.137 297.289 381.135 297.292 381.134 297.296C381.132 297.299 381.131 297.303 381.131 297.307C381.131 297.311 381.132 297.315 381.134 297.318C381.135 297.322 381.137 297.325 381.14 297.327C381.143 297.33 381.146 297.332 381.15 297.333C381.153 297.334 381.157 297.335 381.161 297.335Z",fill:"#A2A2A2",fillOpacity:"0.5"})]}),S.jsx("defs",{children:S.jsx("clipPath",{id:"clip0_1779_162055",children:S.jsx("rect",{width:"400",height:"400",fill:"white"})})})]});function c4(Xe,wt){if(!(Xe instanceof wt))throw new TypeError("Cannot call a class as a function")}function H7(Xe,wt){for(var Dt=0;Dt<wt.length;Dt++){var at=wt[Dt];at.enumerable=at.enumerable||!1,at.configurable=!0,"value"in at&&(at.writable=!0),Object.defineProperty(Xe,at.key,at)}}function u4(Xe,wt,Dt){return wt&&H7(Xe.prototype,wt),Xe}function h4(Xe,wt){if(typeof wt!="function"&&wt!==null)throw new TypeError("Super expression must either be null or a function");Xe.prototype=Object.create(wt&&wt.prototype,{constructor:{value:Xe,writable:!0,configurable:!0}}),wt&&W0(Xe,wt)}function Sh(Xe){return Sh=Object.setPrototypeOf?Object.getPrototypeOf:function(Dt){return Dt.__proto__||Object.getPrototypeOf(Dt)},Sh(Xe)}function W0(Xe,wt){return W0=Object.setPrototypeOf||function(at,Ge){return at.__proto__=Ge,at},W0(Xe,wt)}function X7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Y7(Xe){if(Xe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Xe}function J7(Xe,wt){return wt&&(typeof wt=="object"||typeof wt=="function")?wt:Y7(Xe)}function d4(Xe){var wt=X7();return function(){var at=Sh(Xe),Ge;if(wt){var Qt=Sh(this).constructor;Ge=Reflect.construct(at,arguments,Qt)}else Ge=at.apply(this,arguments);return J7(this,Ge)}}function K7(Xe){return Q7(Xe)||e8(Xe)||t8(Xe)||i8()}function Q7(Xe){if(Array.isArray(Xe))return H0(Xe)}function e8(Xe){if(typeof Symbol<"u"&&Symbol.iterator in Object(Xe))return Array.from(Xe)}function t8(Xe,wt){if(Xe){if(typeof Xe=="string")return H0(Xe,wt);var Dt=Object.prototype.toString.call(Xe).slice(8,-1);if(Dt==="Object"&&Xe.constructor&&(Dt=Xe.constructor.name),Dt==="Map"||Dt==="Set")return Array.from(Xe);if(Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt))return H0(Xe,wt)}}function H0(Xe,wt){(wt==null||wt>Xe.length)&&(wt=Xe.length);for(var Dt=0,at=new Array(wt);Dt<wt;Dt++)at[Dt]=Xe[Dt];return at}function i8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b3(Xe){var wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,Dt=String(Xe);if(wt===0)return Dt;var at=Dt.match(/(.*?)([0-9]+)(.*)/),Ge=at?at[1]:"",Qt=at?at[3]:"",Xt=at?at[2]:Dt,Ut=Xt.length>=wt?Xt:(K7(Array(wt)).map(function(){return"0"}).join("")+Xt).slice(wt*-1);return"".concat(Ge).concat(Ut).concat(Qt)}var p4={daysInHours:!1,zeroPadTime:2};function r8(Xe){var wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Dt=wt.now,at=Dt===void 0?Date.now:Dt,Ge=wt.precision,Qt=Ge===void 0?0:Ge,Xt=wt.controlled,Ut=wt.offsetTime,a=Ut===void 0?0:Ut,mi=wt.overtime,bi;typeof Xe=="string"?bi=new Date(Xe).getTime():Xe instanceof Date?bi=Xe.getTime():bi=Xe,Xt||(bi+=a);var st=Xt?bi:bi-at(),It=Math.min(20,Math.max(0,Qt)),_i=Math.round(parseFloat(((mi?st:Math.max(0,st))/1e3).toFixed(It))*1e3),Pi=Math.abs(_i)/1e3;return{total:_i,days:Math.floor(Pi/(3600*24)),hours:Math.floor(Pi/3600%24),minutes:Math.floor(Pi/60%60),seconds:Math.floor(Pi%60),milliseconds:Number((Pi%1*1e3).toFixed()),completed:_i<=0}}function n8(Xe,wt){var Dt=Xe.days,at=Xe.hours,Ge=Xe.minutes,Qt=Xe.seconds,Xt=Object.assign(Object.assign({},p4),wt),Ut=Xt.daysInHours,a=Xt.zeroPadTime,mi=Xt.zeroPadDays,bi=mi===void 0?a:mi,st=Math.min(2,a),It=Ut?b3(at+Dt*24,a):b3(at,st);return{days:Ut?"":b3(Dt,bi),hours:It,minutes:b3(Ge,st),seconds:b3(Qt,st)}}var f4=function(Xe){h4(Dt,Xe);var wt=d4(Dt);function Dt(){var at;return c4(this,Dt),at=wt.apply(this,arguments),at.state={count:at.props.count||3},at.startCountdown=function(){at.interval=window.setInterval(function(){var Ge=at.state.count-1;Ge===0?(at.stopCountdown(),at.props.onComplete&&at.props.onComplete()):at.setState(function(Qt){return{count:Qt.count-1}})},1e3)},at.stopCountdown=function(){clearInterval(at.interval)},at.addTime=function(Ge){at.stopCountdown(),at.setState(function(Qt){return{count:Qt.count+Ge}},at.startCountdown)},at}return u4(Dt,[{key:"componentDidMount",value:function(){this.startCountdown()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return this.props.children?hn.cloneElement(this.props.children,{count:this.state.count}):null}}]),Dt}(hn.Component);f4.propTypes={count:ji.number,children:ji.element,onComplete:ji.func};var Y0=function(Xe){h4(Dt,Xe);var wt=d4(Dt);function Dt(at){var Ge;if(c4(this,Dt),Ge=wt.call(this,at),Ge.mounted=!1,Ge.initialTimestamp=Ge.calcOffsetStartTimestamp(),Ge.offsetStartTimestamp=Ge.props.autoStart?0:Ge.initialTimestamp,Ge.offsetTime=0,Ge.legacyMode=!1,Ge.legacyCountdownRef=null,Ge.tick=function(){var Xt=Ge.calcTimeDelta(),Ut=Xt.completed&&!Ge.props.overtime?void 0:Ge.props.onTick;Ge.setTimeDeltaState(Xt,void 0,Ut)},Ge.setLegacyCountdownRef=function(Xt){Ge.legacyCountdownRef=Xt},Ge.start=function(){if(!Ge.isStarted()){var Xt=Ge.offsetStartTimestamp;Ge.offsetStartTimestamp=0,Ge.offsetTime+=Xt?Ge.calcOffsetStartTimestamp()-Xt:0;var Ut=Ge.calcTimeDelta();Ge.setTimeDeltaState(Ut,"STARTED",Ge.props.onStart),!Ge.props.controlled&&(!Ut.completed||Ge.props.overtime)&&(Ge.clearTimer(),Ge.interval=window.setInterval(Ge.tick,Ge.props.intervalDelay))}},Ge.pause=function(){Ge.isPaused()||(Ge.clearTimer(),Ge.offsetStartTimestamp=Ge.calcOffsetStartTimestamp(),Ge.setTimeDeltaState(Ge.state.timeDelta,"PAUSED",Ge.props.onPause))},Ge.stop=function(){Ge.isStopped()||(Ge.clearTimer(),Ge.offsetStartTimestamp=Ge.calcOffsetStartTimestamp(),Ge.offsetTime=Ge.offsetStartTimestamp-Ge.initialTimestamp,Ge.setTimeDeltaState(Ge.calcTimeDelta(),"STOPPED",Ge.props.onStop))},Ge.isStarted=function(){return Ge.isStatus("STARTED")},Ge.isPaused=function(){return Ge.isStatus("PAUSED")},Ge.isStopped=function(){return Ge.isStatus("STOPPED")},Ge.isCompleted=function(){return Ge.isStatus("COMPLETED")},at.date){var Qt=Ge.calcTimeDelta();Ge.state={timeDelta:Qt,status:Qt.completed?"COMPLETED":"STOPPED"}}else Ge.legacyMode=!0;return Ge}return u4(Dt,[{key:"componentDidMount",value:function(){this.legacyMode||(this.mounted=!0,this.props.onMount&&this.props.onMount(this.calcTimeDelta()),this.props.autoStart&&this.start())}},{key:"componentDidUpdate",value:function(Ge){this.legacyMode||this.props.date!==Ge.date&&(this.initialTimestamp=this.calcOffsetStartTimestamp(),this.offsetStartTimestamp=this.initialTimestamp,this.offsetTime=0,this.setTimeDeltaState(this.calcTimeDelta()))}},{key:"componentWillUnmount",value:function(){this.legacyMode||(this.mounted=!1,this.clearTimer())}},{key:"calcTimeDelta",value:function(){var Ge=this.props,Qt=Ge.date,Xt=Ge.now,Ut=Ge.precision,a=Ge.controlled,mi=Ge.overtime;return r8(Qt,{now:Xt,precision:Ut,controlled:a,offsetTime:this.offsetTime,overtime:mi})}},{key:"calcOffsetStartTimestamp",value:function(){return Date.now()}},{key:"addTime",value:function(Ge){this.legacyCountdownRef.addTime(Ge)}},{key:"clearTimer",value:function(){window.clearInterval(this.interval)}},{key:"isStatus",value:function(Ge){return this.state.status===Ge}},{key:"setTimeDeltaState",value:function(Ge,Qt,Xt){var Ut=this;if(this.mounted){var a=Ge.completed&&!this.state.timeDelta.completed,mi=Ge.completed&&Qt==="STARTED";a&&!this.props.overtime&&this.clearTimer();var bi=function(){Xt&&Xt(Ut.state.timeDelta),Ut.props.onComplete&&(a||mi)&&Ut.props.onComplete(Ge,mi)};return this.setState(function(st){var It=Qt||st.status;return Ge.completed&&!Ut.props.overtime?It="COMPLETED":!Qt&&It==="COMPLETED"&&(It="STOPPED"),{timeDelta:Ge,status:It}},bi)}}},{key:"getApi",value:function(){return this.api=this.api||{start:this.start,pause:this.pause,stop:this.stop,isStarted:this.isStarted,isPaused:this.isPaused,isStopped:this.isStopped,isCompleted:this.isCompleted}}},{key:"getRenderProps",value:function(){var Ge=this.props,Qt=Ge.daysInHours,Xt=Ge.zeroPadTime,Ut=Ge.zeroPadDays,a=this.state.timeDelta;return Object.assign(Object.assign({},a),{api:this.getApi(),props:this.props,formatted:n8(a,{daysInHours:Qt,zeroPadTime:Xt,zeroPadDays:Ut})})}},{key:"render",value:function(){if(this.legacyMode){var Ge=this.props,Qt=Ge.count,Xt=Ge.children,Ut=Ge.onComplete;return hn.createElement(f4,{ref:this.setLegacyCountdownRef,count:Qt,onComplete:Ut},Xt)}var a=this.props,mi=a.className,bi=a.overtime,st=a.children,It=a.renderer,_i=this.getRenderProps();if(It)return It(_i);if(st&&this.state.timeDelta.completed&&!bi)return hn.cloneElement(st,{countdown:_i});var Pi=_i.formatted,Sr=Pi.days,Kr=Pi.hours,pr=Pi.minutes,Zn=Pi.seconds;return hn.createElement("span",{className:mi},_i.total<0?"-":"",Sr,Sr?":":"",Kr,":",pr,":",Zn)}}]),Dt}(hn.Component);Y0.defaultProps=Object.assign(Object.assign({},p4),{controlled:!1,intervalDelay:1e3,precision:0,autoStart:!0});Y0.propTypes={date:ji.oneOfType([ji.instanceOf(Date),ji.string,ji.number]),daysInHours:ji.bool,zeroPadTime:ji.number,zeroPadDays:ji.number,controlled:ji.bool,intervalDelay:ji.number,precision:ji.number,autoStart:ji.bool,overtime:ji.bool,className:ji.string,children:ji.element,renderer:ji.func,now:ji.func,onMount:ji.func,onStart:ji.func,onPause:ji.func,onStop:ji.func,onTick:ji.func,onComplete:ji.func};const s8=hn.memo(Xe=>{const{duration:wt,className:Dt}=Xe,at=hn.useRef(null);return hn.useEffect(()=>{var Ge,Qt;(Qt=(Ge=at.current)==null?void 0:Ge.api)==null||Qt.start()},[wt]),S.jsx(Y0,{daysInHours:!0,autoStart:!0,date:Date.now()+wt,ref:at,renderer:({days:Ge,hours:Qt,minutes:Xt,seconds:Ut,completed:a})=>a?S.jsxs("div",{className:`${Dt} flex items-start justify-center gap-0.5 font-Roboto text-2xl font-bold leading-7`,children:["0",S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"D"}),"0",S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"H"}),"0",S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"M"}),"0",S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"S"})]}):S.jsxs("div",{className:`${Dt} flex items-start justify-center gap-0.5 font-Roboto text-2xl font-bold leading-7`,children:[Ge,S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"D"}),Qt<10?"0"+Qt:Qt,S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"H"}),Xt<10?"0"+Xt:Xt,S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"M"}),Ut<10?"0"+Ut:Ut,S.jsx("span",{className:"text-base font-normal leading-5 text-[#B1B1B1]",children:"S"})]})})},(Xe,wt)=>Xe.duration===wt.duration);var m4={exports:{}};(function(Xe,wt){var Dt={};(function(at,Ge){Xe.exports=Ge()})(V7,function(){var at,Ge,Qt;function Xt(a,mi){if(!at)at=mi;else if(!Ge)Ge=mi;else{var bi="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+at+")(sharedChunk); ("+Ge+")(sharedChunk); self.onerror = null;",st={};at(st),Qt=mi(st),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Qt.workerUrl=window.URL.createObjectURL(new Blob([bi],{type:"text/javascript"})))}}Xt(["exports"],function(a){var mi="3.6.0";let bi;const st={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(bi==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{bi=Dt.API_URL_REGEX!=null?new RegExp(Dt.API_URL_REGEX):t}catch{bi=t}}return bi},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!st.API_URL)return null;try{const t=new URL(st.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function It(t){return st.API_URL_REGEX.test(t)}function _i(t){return t.indexOf("mapbox:")===0}function Pi(t){return st.API_CDN_URL_REGEX.test(t)}function Sr(t){return st.API_SPRITE_REGEX.test(t)}function Kr(t){return st.API_STYLE_REGEX.test(t)&&!Sr(t)}const pr={create:"create",load:"load",fullLoad:"fullLoad"},Zn={mark(t){performance.mark(t)},measure(t,e,i){performance.measure(t,e,i)}};function $a(t){const e=t.name.split("?")[0];return Pi(e)&&e.includes("mapbox-gl.js")?"javascript":Pi(e)&&e.includes("mapbox-gl.css")?"css":function(i){return st.API_FONTS_REGEX.test(i)}(e)?"fontRange":Sr(e)?"sprite":Kr(e)?"style":function(i){return st.API_TILEJSON_REGEX.test(i)}(e)?"tilejson":"other"}function dn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ai={},Mi={};Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.setMatrixArrayType=function(t){Mi.ARRAY_TYPE=Vs=t},Mi.toRadian=function(t){return t*ll},Mi.equals=function(t,e){return Math.abs(t-e)<=$n*Math.max(1,Math.abs(t),Math.abs(e))},Mi.RANDOM=Mi.ARRAY_TYPE=Mi.EPSILON=void 0;var $n=1e-6;Mi.EPSILON=$n;var Vs=typeof Float32Array<"u"?Float32Array:Array;Mi.ARRAY_TYPE=Vs;var R1=Math.random;Mi.RANDOM=R1;var ll=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var pi={};function si(t){return si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},si(t)}Object.defineProperty(pi,"__esModule",{value:!0}),pi.create=function(){var t=new Qr.ARRAY_TYPE(4);return Qr.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},pi.clone=function(t){var e=new Qr.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},pi.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},pi.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},pi.fromValues=function(t,e,i,n){var s=new Qr.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=i,s[3]=n,s},pi.set=function(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t},pi.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},pi.invert=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=i*l-s*n;return c?(t[0]=l*(c=1/c),t[1]=-n*c,t[2]=-s*c,t[3]=i*c,t):null},pi.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},pi.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},pi.multiply=cl,pi.rotate=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=Math.sin(i),f=Math.cos(i);return t[0]=n*f+l*d,t[1]=s*f+c*d,t[2]=n*-d+l*f,t[3]=s*-d+c*f,t},pi.scale=function(t,e,i){var n=e[1],s=e[2],l=e[3],c=i[0],d=i[1];return t[0]=e[0]*c,t[1]=n*c,t[2]=s*d,t[3]=l*d,t},pi.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t},pi.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},pi.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},pi.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},pi.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},pi.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},pi.subtract=ul,pi.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},pi.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=t[3],c=e[0],d=e[1],f=e[2],_=e[3];return Math.abs(i-c)<=Qr.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(n-d)<=Qr.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-f)<=Qr.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-_)<=Qr.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))},pi.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},pi.multiplyScalarAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},pi.sub=pi.mul=void 0;var Qr=function(t,e){if(t&&t.__esModule)return t;if(t===null||si(t)!=="object"&&typeof t!="function")return{default:t};var i=Us(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function Us(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Us=function(n){return n?i:e})(t)}function cl(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=i[0],f=i[1],_=i[2],y=i[3];return t[0]=n*d+l*f,t[1]=s*d+c*f,t[2]=n*_+l*y,t[3]=s*_+c*y,t}function ul(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}pi.mul=cl,pi.sub=ul;var li={};function Ga(t){return Ga=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ga(t)}Object.defineProperty(li,"__esModule",{value:!0}),li.create=function(){var t=new Nr.ARRAY_TYPE(6);return Nr.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},li.clone=function(t){var e=new Nr.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},li.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},li.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},li.fromValues=function(t,e,i,n,s,l){var c=new Nr.ARRAY_TYPE(6);return c[0]=t,c[1]=e,c[2]=i,c[3]=n,c[4]=s,c[5]=l,c},li.set=function(t,e,i,n,s,l,c){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=l,t[5]=c,t},li.invert=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=i*l-n*s;return f?(t[0]=l*(f=1/f),t[1]=-n*f,t[2]=-s*f,t[3]=i*f,t[4]=(s*d-l*c)*f,t[5]=(n*c-i*d)*f,t):null},li.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},li.multiply=qa,li.rotate=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=Math.sin(i),y=Math.cos(i);return t[0]=n*y+l*_,t[1]=s*y+c*_,t[2]=n*-_+l*y,t[3]=s*-_+c*y,t[4]=d,t[5]=f,t},li.scale=function(t,e,i){var n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=i[0],_=i[1];return t[0]=e[0]*f,t[1]=n*f,t[2]=s*_,t[3]=l*_,t[4]=c,t[5]=d,t},li.translate=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=i[0],y=i[1];return t[0]=n,t[1]=s,t[2]=l,t[3]=c,t[4]=n*_+l*y+d,t[5]=s*_+c*y+f,t},li.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t},li.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},li.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},li.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},li.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},li.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t},li.subtract=ds,li.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t},li.multiplyScalarAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t},li.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},li.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=t[3],c=t[4],d=t[5],f=e[0],_=e[1],y=e[2],v=e[3],C=e[4],A=e[5];return Math.abs(i-f)<=Nr.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(n-_)<=Nr.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(s-y)<=Nr.EPSILON*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-v)<=Nr.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-C)<=Nr.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-A)<=Nr.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))},li.sub=li.mul=void 0;var Nr=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ga(t)!=="object"&&typeof t!="function")return{default:t};var i=hl(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function hl(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(hl=function(n){return n?i:e})(t)}function qa(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=i[0],y=i[1],v=i[2],C=i[3],A=i[4],M=i[5];return t[0]=n*_+l*y,t[1]=s*_+c*y,t[2]=n*v+l*C,t[3]=s*v+c*C,t[4]=n*A+l*M+d,t[5]=s*A+c*M+f,t}function ds(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}li.mul=qa,li.sub=ds;var ri={};function Zs(t){return Zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zs(t)}Object.defineProperty(ri,"__esModule",{value:!0}),ri.create=function(){var t=new er.ARRAY_TYPE(9);return er.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},ri.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},ri.clone=function(t){var e=new er.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},ri.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ri.fromValues=function(t,e,i,n,s,l,c,d,f){var _=new er.ARRAY_TYPE(9);return _[0]=t,_[1]=e,_[2]=i,_[3]=n,_[4]=s,_[5]=l,_[6]=c,_[7]=d,_[8]=f,_},ri.set=function(t,e,i,n,s,l,c,d,f,_){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=l,t[5]=c,t[6]=d,t[7]=f,t[8]=_,t},ri.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ri.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],s=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=s}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},ri.invert=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=e[6],_=e[7],y=e[8],v=y*c-d*_,C=-y*l+d*f,A=_*l-c*f,M=i*v+n*C+s*A;return M?(t[0]=v*(M=1/M),t[1]=(-y*n+s*_)*M,t[2]=(d*n-s*c)*M,t[3]=C*M,t[4]=(y*i-s*f)*M,t[5]=(-d*i+s*l)*M,t[6]=A*M,t[7]=(-_*i+n*f)*M,t[8]=(c*i-n*l)*M,t):null},ri.adjoint=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=e[6],_=e[7],y=e[8];return t[0]=c*y-d*_,t[1]=s*_-n*y,t[2]=n*d-s*c,t[3]=d*f-l*y,t[4]=i*y-s*f,t[5]=s*l-i*d,t[6]=l*_-c*f,t[7]=n*f-i*_,t[8]=i*c-n*l,t},ri.determinant=function(t){var e=t[3],i=t[4],n=t[5],s=t[6],l=t[7],c=t[8];return t[0]*(c*i-n*l)+t[1]*(-c*e+n*s)+t[2]*(l*e-i*s)},ri.multiply=pl,ri.translate=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=e[8],C=i[0],A=i[1];return t[0]=n,t[1]=s,t[2]=l,t[3]=c,t[4]=d,t[5]=f,t[6]=C*n+A*c+_,t[7]=C*s+A*d+y,t[8]=C*l+A*f+v,t},ri.rotate=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=e[8],C=Math.sin(i),A=Math.cos(i);return t[0]=A*n+C*c,t[1]=A*s+C*d,t[2]=A*l+C*f,t[3]=A*c-C*n,t[4]=A*d-C*s,t[5]=A*f-C*l,t[6]=_,t[7]=y,t[8]=v,t},ri.scale=function(t,e,i){var n=i[0],s=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ri.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},ri.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ri.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ri.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},ri.fromQuat=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=i+i,d=n+n,f=s+s,_=i*c,y=n*c,v=n*d,C=s*c,A=s*d,M=s*f,I=l*c,P=l*d,D=l*f;return t[0]=1-v-M,t[3]=y-D,t[6]=C+P,t[1]=y+D,t[4]=1-_-M,t[7]=A-I,t[2]=C-P,t[5]=A+I,t[8]=1-_-v,t},ri.normalFromMat4=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=e[6],_=e[7],y=e[8],v=e[9],C=e[10],A=e[11],M=e[12],I=e[13],P=e[14],D=e[15],V=i*d-n*c,N=i*f-s*c,U=i*_-l*c,X=n*f-s*d,Y=n*_-l*d,ee=s*_-l*f,le=y*I-v*M,pe=y*P-C*M,xe=y*D-A*M,fe=v*P-C*I,we=v*D-A*I,De=C*D-A*P,Ae=V*De-N*we+U*fe+X*xe-Y*pe+ee*le;return Ae?(t[0]=(d*De-f*we+_*fe)*(Ae=1/Ae),t[1]=(f*xe-c*De-_*pe)*Ae,t[2]=(c*we-d*xe+_*le)*Ae,t[3]=(s*we-n*De-l*fe)*Ae,t[4]=(i*De-s*xe+l*pe)*Ae,t[5]=(n*xe-i*we-l*le)*Ae,t[6]=(I*ee-P*Y+D*X)*Ae,t[7]=(P*U-M*ee-D*N)*Ae,t[8]=(M*Y-I*U+D*V)*Ae,t):null},ri.projection=function(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},ri.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},ri.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ri.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t},ri.subtract=fl,ri.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t},ri.multiplyScalarAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t},ri.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},ri.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=t[3],c=t[4],d=t[5],f=t[6],_=t[7],y=t[8],v=e[0],C=e[1],A=e[2],M=e[3],I=e[4],P=e[5],D=e[6],V=e[7],N=e[8];return Math.abs(i-v)<=er.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(n-C)<=er.EPSILON*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(s-A)<=er.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(l-M)<=er.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-I)<=er.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(d-P)<=er.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-D)<=er.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(_-V)<=er.EPSILON*Math.max(1,Math.abs(_),Math.abs(V))&&Math.abs(y-N)<=er.EPSILON*Math.max(1,Math.abs(y),Math.abs(N))},ri.sub=ri.mul=void 0;var er=function(t,e){if(t&&t.__esModule)return t;if(t===null||Zs(t)!=="object"&&typeof t!="function")return{default:t};var i=dl(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function dl(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(dl=function(n){return n?i:e})(t)}function pl(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=e[8],C=i[0],A=i[1],M=i[2],I=i[3],P=i[4],D=i[5],V=i[6],N=i[7],U=i[8];return t[0]=C*n+A*c+M*_,t[1]=C*s+A*d+M*y,t[2]=C*l+A*f+M*v,t[3]=I*n+P*c+D*_,t[4]=I*s+P*d+D*y,t[5]=I*l+P*f+D*v,t[6]=V*n+N*c+U*_,t[7]=V*s+N*d+U*y,t[8]=V*l+N*f+U*v,t}function fl(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}ri.mul=pl,ri.sub=fl;var gt={};function $s(t){return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$s(t)}Object.defineProperty(gt,"__esModule",{value:!0}),gt.create=function(){var t=new yi.ARRAY_TYPE(16);return yi.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},gt.clone=function(t){var e=new yi.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},gt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},gt.fromValues=function(t,e,i,n,s,l,c,d,f,_,y,v,C,A,M,I){var P=new yi.ARRAY_TYPE(16);return P[0]=t,P[1]=e,P[2]=i,P[3]=n,P[4]=s,P[5]=l,P[6]=c,P[7]=d,P[8]=f,P[9]=_,P[10]=y,P[11]=v,P[12]=C,P[13]=A,P[14]=M,P[15]=I,P},gt.set=function(t,e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=l,t[5]=c,t[6]=d,t[7]=f,t[8]=_,t[9]=y,t[10]=v,t[11]=C,t[12]=A,t[13]=M,t[14]=I,t[15]=P,t},gt.identity=_l,gt.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],s=e[3],l=e[6],c=e[7],d=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=l,t[11]=e[14],t[12]=s,t[13]=c,t[14]=d}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},gt.invert=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=e[6],_=e[7],y=e[8],v=e[9],C=e[10],A=e[11],M=e[12],I=e[13],P=e[14],D=e[15],V=i*d-n*c,N=i*f-s*c,U=i*_-l*c,X=n*f-s*d,Y=n*_-l*d,ee=s*_-l*f,le=y*I-v*M,pe=y*P-C*M,xe=y*D-A*M,fe=v*P-C*I,we=v*D-A*I,De=C*D-A*P,Ae=V*De-N*we+U*fe+X*xe-Y*pe+ee*le;return Ae?(t[0]=(d*De-f*we+_*fe)*(Ae=1/Ae),t[1]=(s*we-n*De-l*fe)*Ae,t[2]=(I*ee-P*Y+D*X)*Ae,t[3]=(C*Y-v*ee-A*X)*Ae,t[4]=(f*xe-c*De-_*pe)*Ae,t[5]=(i*De-s*xe+l*pe)*Ae,t[6]=(P*U-M*ee-D*N)*Ae,t[7]=(y*ee-C*U+A*N)*Ae,t[8]=(c*we-d*xe+_*le)*Ae,t[9]=(n*xe-i*we-l*le)*Ae,t[10]=(M*Y-I*U+D*V)*Ae,t[11]=(v*U-y*Y-A*V)*Ae,t[12]=(d*pe-c*fe-f*le)*Ae,t[13]=(i*fe-n*pe+s*le)*Ae,t[14]=(I*N-M*X-P*V)*Ae,t[15]=(y*X-v*N+C*V)*Ae,t):null},gt.adjoint=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=e[4],d=e[5],f=e[6],_=e[7],y=e[8],v=e[9],C=e[10],A=e[11],M=e[12],I=e[13],P=e[14],D=e[15];return t[0]=d*(C*D-A*P)-v*(f*D-_*P)+I*(f*A-_*C),t[1]=-(n*(C*D-A*P)-v*(s*D-l*P)+I*(s*A-l*C)),t[2]=n*(f*D-_*P)-d*(s*D-l*P)+I*(s*_-l*f),t[3]=-(n*(f*A-_*C)-d*(s*A-l*C)+v*(s*_-l*f)),t[4]=-(c*(C*D-A*P)-y*(f*D-_*P)+M*(f*A-_*C)),t[5]=i*(C*D-A*P)-y*(s*D-l*P)+M*(s*A-l*C),t[6]=-(i*(f*D-_*P)-c*(s*D-l*P)+M*(s*_-l*f)),t[7]=i*(f*A-_*C)-c*(s*A-l*C)+y*(s*_-l*f),t[8]=c*(v*D-A*I)-y*(d*D-_*I)+M*(d*A-_*v),t[9]=-(i*(v*D-A*I)-y*(n*D-l*I)+M*(n*A-l*v)),t[10]=i*(d*D-_*I)-c*(n*D-l*I)+M*(n*_-l*d),t[11]=-(i*(d*A-_*v)-c*(n*A-l*v)+y*(n*_-l*d)),t[12]=-(c*(v*P-C*I)-y*(d*P-f*I)+M*(d*C-f*v)),t[13]=i*(v*P-C*I)-y*(n*P-s*I)+M*(n*C-s*v),t[14]=-(i*(d*P-f*I)-c*(n*P-s*I)+M*(n*f-s*d)),t[15]=i*(d*C-f*v)-c*(n*C-s*v)+y*(n*f-s*d),t},gt.determinant=function(t){var e=t[0],i=t[1],n=t[2],s=t[3],l=t[4],c=t[5],d=t[6],f=t[7],_=t[8],y=t[9],v=t[10],C=t[11],A=t[12],M=t[13],I=t[14],P=t[15];return(e*c-i*l)*(v*P-C*I)-(e*d-n*l)*(y*P-C*M)+(e*f-s*l)*(y*I-v*M)+(i*d-n*c)*(_*P-C*A)-(i*f-s*c)*(_*I-v*A)+(n*f-s*d)*(_*M-y*A)},gt.multiply=gl,gt.translate=function(t,e,i){var n,s,l,c,d,f,_,y,v,C,A,M,I=i[0],P=i[1],D=i[2];return e===t?(t[12]=e[0]*I+e[4]*P+e[8]*D+e[12],t[13]=e[1]*I+e[5]*P+e[9]*D+e[13],t[14]=e[2]*I+e[6]*P+e[10]*D+e[14],t[15]=e[3]*I+e[7]*P+e[11]*D+e[15]):(s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=e[8],C=e[9],A=e[10],M=e[11],t[0]=n=e[0],t[1]=s,t[2]=l,t[3]=c,t[4]=d,t[5]=f,t[6]=_,t[7]=y,t[8]=v,t[9]=C,t[10]=A,t[11]=M,t[12]=n*I+d*P+v*D+e[12],t[13]=s*I+f*P+C*D+e[13],t[14]=l*I+_*P+A*D+e[14],t[15]=c*I+y*P+M*D+e[15]),t},gt.scale=function(t,e,i){var n=i[0],s=i[1],l=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*l,t[9]=e[9]*l,t[10]=e[10]*l,t[11]=e[11]*l,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},gt.rotate=function(t,e,i,n){var s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X,Y,ee,le,pe,xe,fe,we=n[0],De=n[1],Ae=n[2],ke=Math.hypot(we,De,Ae);return ke<yi.EPSILON?null:(we*=ke=1/ke,De*=ke,Ae*=ke,s=Math.sin(i),l=Math.cos(i),f=e[1],_=e[2],y=e[3],C=e[5],A=e[6],M=e[7],P=e[9],D=e[10],V=e[11],N=we*we*(c=1-l)+l,Y=we*De*c-Ae*s,ee=De*De*c+l,le=Ae*De*c+we*s,pe=we*Ae*c+De*s,xe=De*Ae*c-we*s,fe=Ae*Ae*c+l,t[0]=(d=e[0])*N+(v=e[4])*(U=De*we*c+Ae*s)+(I=e[8])*(X=Ae*we*c-De*s),t[1]=f*N+C*U+P*X,t[2]=_*N+A*U+D*X,t[3]=y*N+M*U+V*X,t[4]=d*Y+v*ee+I*le,t[5]=f*Y+C*ee+P*le,t[6]=_*Y+A*ee+D*le,t[7]=y*Y+M*ee+V*le,t[8]=d*pe+v*xe+I*fe,t[9]=f*pe+C*xe+P*fe,t[10]=_*pe+A*xe+D*fe,t[11]=y*pe+M*xe+V*fe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},gt.rotateX=function(t,e,i){var n=Math.sin(i),s=Math.cos(i),l=e[4],c=e[5],d=e[6],f=e[7],_=e[8],y=e[9],v=e[10],C=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=l*s+_*n,t[5]=c*s+y*n,t[6]=d*s+v*n,t[7]=f*s+C*n,t[8]=_*s-l*n,t[9]=y*s-c*n,t[10]=v*s-d*n,t[11]=C*s-f*n,t},gt.rotateY=function(t,e,i){var n=Math.sin(i),s=Math.cos(i),l=e[0],c=e[1],d=e[2],f=e[3],_=e[8],y=e[9],v=e[10],C=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*s-_*n,t[1]=c*s-y*n,t[2]=d*s-v*n,t[3]=f*s-C*n,t[8]=l*n+_*s,t[9]=c*n+y*s,t[10]=d*n+v*s,t[11]=f*n+C*s,t},gt.rotateZ=function(t,e,i){var n=Math.sin(i),s=Math.cos(i),l=e[0],c=e[1],d=e[2],f=e[3],_=e[4],y=e[5],v=e[6],C=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=l*s+_*n,t[1]=c*s+y*n,t[2]=d*s+v*n,t[3]=f*s+C*n,t[4]=_*s-l*n,t[5]=y*s-c*n,t[6]=v*s-d*n,t[7]=C*s-f*n,t},gt.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},gt.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},gt.fromRotation=function(t,e,i){var n,s,l,c=i[0],d=i[1],f=i[2],_=Math.hypot(c,d,f);return _<yi.EPSILON?null:(c*=_=1/_,d*=_,f*=_,n=Math.sin(e),s=Math.cos(e),t[0]=c*c*(l=1-s)+s,t[1]=d*c*l+f*n,t[2]=f*c*l-d*n,t[3]=0,t[4]=c*d*l-f*n,t[5]=d*d*l+s,t[6]=f*d*l+c*n,t[7]=0,t[8]=c*f*l+d*n,t[9]=d*f*l-c*n,t[10]=f*f*l+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},gt.fromXRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},gt.fromYRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},gt.fromZRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},gt.fromRotationTranslation=Wa,gt.fromQuat2=function(t,e){var i=new yi.ARRAY_TYPE(3),n=-e[0],s=-e[1],l=-e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=n*n+s*s+l*l+c*c;return v>0?(i[0]=2*(d*c+y*n+f*l-_*s)/v,i[1]=2*(f*c+y*s+_*n-d*l)/v,i[2]=2*(_*c+y*l+d*s-f*n)/v):(i[0]=2*(d*c+y*n+f*l-_*s),i[1]=2*(f*c+y*s+_*n-d*l),i[2]=2*(_*c+y*l+d*s-f*n)),Wa(t,e,i),t},gt.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},gt.getScaling=Gs,gt.getRotation=function(t,e){var i=new yi.ARRAY_TYPE(3);Gs(i,e);var n=1/i[0],s=1/i[1],l=1/i[2],c=e[0]*n,d=e[1]*s,f=e[2]*l,_=e[4]*n,y=e[5]*s,v=e[6]*l,C=e[8]*n,A=e[9]*s,M=e[10]*l,I=c+y+M,P=0;return I>0?(P=2*Math.sqrt(I+1),t[3]=.25*P,t[0]=(v-A)/P,t[1]=(C-f)/P,t[2]=(d-_)/P):c>y&&c>M?(P=2*Math.sqrt(1+c-y-M),t[3]=(v-A)/P,t[0]=.25*P,t[1]=(d+_)/P,t[2]=(C+f)/P):y>M?(P=2*Math.sqrt(1+y-c-M),t[3]=(C-f)/P,t[0]=(d+_)/P,t[1]=.25*P,t[2]=(v+A)/P):(P=2*Math.sqrt(1+M-c-y),t[3]=(d-_)/P,t[0]=(C+f)/P,t[1]=(v+A)/P,t[2]=.25*P),t},gt.fromRotationTranslationScale=function(t,e,i,n){var s=e[0],l=e[1],c=e[2],d=e[3],f=s+s,_=l+l,y=c+c,v=s*f,C=s*_,A=s*y,M=l*_,I=l*y,P=c*y,D=d*f,V=d*_,N=d*y,U=n[0],X=n[1],Y=n[2];return t[0]=(1-(M+P))*U,t[1]=(C+N)*U,t[2]=(A-V)*U,t[3]=0,t[4]=(C-N)*X,t[5]=(1-(v+P))*X,t[6]=(I+D)*X,t[7]=0,t[8]=(A+V)*Y,t[9]=(I-D)*Y,t[10]=(1-(v+M))*Y,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},gt.fromRotationTranslationScaleOrigin=function(t,e,i,n,s){var l=e[0],c=e[1],d=e[2],f=e[3],_=l+l,y=c+c,v=d+d,C=l*_,A=l*y,M=l*v,I=c*y,P=c*v,D=d*v,V=f*_,N=f*y,U=f*v,X=n[0],Y=n[1],ee=n[2],le=s[0],pe=s[1],xe=s[2],fe=(1-(I+D))*X,we=(A+U)*X,De=(M-N)*X,Ae=(A-U)*Y,ke=(1-(C+D))*Y,be=(P+V)*Y,Ee=(M+N)*ee,Fe=(P-V)*ee,Te=(1-(C+I))*ee;return t[0]=fe,t[1]=we,t[2]=De,t[3]=0,t[4]=Ae,t[5]=ke,t[6]=be,t[7]=0,t[8]=Ee,t[9]=Fe,t[10]=Te,t[11]=0,t[12]=i[0]+le-(fe*le+Ae*pe+Ee*xe),t[13]=i[1]+pe-(we*le+ke*pe+Fe*xe),t[14]=i[2]+xe-(De*le+be*pe+Te*xe),t[15]=1,t},gt.fromQuat=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=i+i,d=n+n,f=s+s,_=i*c,y=n*c,v=n*d,C=s*c,A=s*d,M=s*f,I=l*c,P=l*d,D=l*f;return t[0]=1-v-M,t[1]=y+D,t[2]=C-P,t[3]=0,t[4]=y-D,t[5]=1-_-M,t[6]=A+I,t[7]=0,t[8]=C+P,t[9]=A-I,t[10]=1-_-v,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},gt.frustum=function(t,e,i,n,s,l,c){var d=1/(i-e),f=1/(s-n),_=1/(l-c);return t[0]=2*l*d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*l*f,t[6]=0,t[7]=0,t[8]=(i+e)*d,t[9]=(s+n)*f,t[10]=(c+l)*_,t[11]=-1,t[12]=0,t[13]=0,t[14]=c*l*2*_,t[15]=0,t},gt.perspectiveNO=en,gt.perspectiveZO=function(t,e,i,n,s){var l,c=1/Math.tan(e/2);return t[0]=c/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(t[10]=s*(l=1/(n-s)),t[14]=s*n*l):(t[10]=-1,t[14]=-n),t},gt.perspectiveFromFieldOfView=function(t,e,i,n){var s=Math.tan(e.upDegrees*Math.PI/180),l=Math.tan(e.downDegrees*Math.PI/180),c=Math.tan(e.leftDegrees*Math.PI/180),d=Math.tan(e.rightDegrees*Math.PI/180),f=2/(c+d),_=2/(s+l);return t[0]=f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=_,t[6]=0,t[7]=0,t[8]=-(c-d)*f*.5,t[9]=(s-l)*_*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t},gt.orthoNO=tn,gt.orthoZO=function(t,e,i,n,s,l,c){var d=1/(e-i),f=1/(n-s),_=1/(l-c);return t[0]=-2*d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=_,t[11]=0,t[12]=(e+i)*d,t[13]=(s+n)*f,t[14]=l*_,t[15]=1,t},gt.lookAt=function(t,e,i,n){var s,l,c,d,f,_,y,v,C,A,M=e[0],I=e[1],P=e[2],D=n[0],V=n[1],N=n[2],U=i[0],X=i[1],Y=i[2];return Math.abs(M-U)<yi.EPSILON&&Math.abs(I-X)<yi.EPSILON&&Math.abs(P-Y)<yi.EPSILON?_l(t):(y=M-U,v=I-X,C=P-Y,s=V*(C*=A=1/Math.hypot(y,v,C))-N*(v*=A),l=N*(y*=A)-D*C,c=D*v-V*y,(A=Math.hypot(s,l,c))?(s*=A=1/A,l*=A,c*=A):(s=0,l=0,c=0),d=v*c-C*l,f=C*s-y*c,_=y*l-v*s,(A=Math.hypot(d,f,_))?(d*=A=1/A,f*=A,_*=A):(d=0,f=0,_=0),t[0]=s,t[1]=d,t[2]=y,t[3]=0,t[4]=l,t[5]=f,t[6]=v,t[7]=0,t[8]=c,t[9]=_,t[10]=C,t[11]=0,t[12]=-(s*M+l*I+c*P),t[13]=-(d*M+f*I+_*P),t[14]=-(y*M+v*I+C*P),t[15]=1,t)},gt.targetTo=function(t,e,i,n){var s=e[0],l=e[1],c=e[2],d=n[0],f=n[1],_=n[2],y=s-i[0],v=l-i[1],C=c-i[2],A=y*y+v*v+C*C;A>0&&(y*=A=1/Math.sqrt(A),v*=A,C*=A);var M=f*C-_*v,I=_*y-d*C,P=d*v-f*y;return(A=M*M+I*I+P*P)>0&&(M*=A=1/Math.sqrt(A),I*=A,P*=A),t[0]=M,t[1]=I,t[2]=P,t[3]=0,t[4]=v*P-C*I,t[5]=C*M-y*P,t[6]=y*I-v*M,t[7]=0,t[8]=y,t[9]=v,t[10]=C,t[11]=0,t[12]=s,t[13]=l,t[14]=c,t[15]=1,t},gt.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},gt.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},gt.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},gt.subtract=Ha,gt.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},gt.multiplyScalarAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t[9]=e[9]+i[9]*n,t[10]=e[10]+i[10]*n,t[11]=e[11]+i[11]*n,t[12]=e[12]+i[12]*n,t[13]=e[13]+i[13]*n,t[14]=e[14]+i[14]*n,t[15]=e[15]+i[15]*n,t},gt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},gt.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=t[3],c=t[4],d=t[5],f=t[6],_=t[7],y=t[8],v=t[9],C=t[10],A=t[11],M=t[12],I=t[13],P=t[14],D=t[15],V=e[0],N=e[1],U=e[2],X=e[3],Y=e[4],ee=e[5],le=e[6],pe=e[7],xe=e[8],fe=e[9],we=e[10],De=e[11],Ae=e[12],ke=e[13],be=e[14],Ee=e[15];return Math.abs(i-V)<=yi.EPSILON*Math.max(1,Math.abs(i),Math.abs(V))&&Math.abs(n-N)<=yi.EPSILON*Math.max(1,Math.abs(n),Math.abs(N))&&Math.abs(s-U)<=yi.EPSILON*Math.max(1,Math.abs(s),Math.abs(U))&&Math.abs(l-X)<=yi.EPSILON*Math.max(1,Math.abs(l),Math.abs(X))&&Math.abs(c-Y)<=yi.EPSILON*Math.max(1,Math.abs(c),Math.abs(Y))&&Math.abs(d-ee)<=yi.EPSILON*Math.max(1,Math.abs(d),Math.abs(ee))&&Math.abs(f-le)<=yi.EPSILON*Math.max(1,Math.abs(f),Math.abs(le))&&Math.abs(_-pe)<=yi.EPSILON*Math.max(1,Math.abs(_),Math.abs(pe))&&Math.abs(y-xe)<=yi.EPSILON*Math.max(1,Math.abs(y),Math.abs(xe))&&Math.abs(v-fe)<=yi.EPSILON*Math.max(1,Math.abs(v),Math.abs(fe))&&Math.abs(C-we)<=yi.EPSILON*Math.max(1,Math.abs(C),Math.abs(we))&&Math.abs(A-De)<=yi.EPSILON*Math.max(1,Math.abs(A),Math.abs(De))&&Math.abs(M-Ae)<=yi.EPSILON*Math.max(1,Math.abs(M),Math.abs(Ae))&&Math.abs(I-ke)<=yi.EPSILON*Math.max(1,Math.abs(I),Math.abs(ke))&&Math.abs(P-be)<=yi.EPSILON*Math.max(1,Math.abs(P),Math.abs(be))&&Math.abs(D-Ee)<=yi.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ee))},gt.sub=gt.mul=gt.ortho=gt.perspective=void 0;var yi=function(t,e){if(t&&t.__esModule)return t;if(t===null||$s(t)!=="object"&&typeof t!="function")return{default:t};var i=ml(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function ml(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(ml=function(n){return n?i:e})(t)}function _l(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gl(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=e[8],C=e[9],A=e[10],M=e[11],I=e[12],P=e[13],D=e[14],V=e[15],N=i[0],U=i[1],X=i[2],Y=i[3];return t[0]=N*n+U*d+X*v+Y*I,t[1]=N*s+U*f+X*C+Y*P,t[2]=N*l+U*_+X*A+Y*D,t[3]=N*c+U*y+X*M+Y*V,t[4]=(N=i[4])*n+(U=i[5])*d+(X=i[6])*v+(Y=i[7])*I,t[5]=N*s+U*f+X*C+Y*P,t[6]=N*l+U*_+X*A+Y*D,t[7]=N*c+U*y+X*M+Y*V,t[8]=(N=i[8])*n+(U=i[9])*d+(X=i[10])*v+(Y=i[11])*I,t[9]=N*s+U*f+X*C+Y*P,t[10]=N*l+U*_+X*A+Y*D,t[11]=N*c+U*y+X*M+Y*V,t[12]=(N=i[12])*n+(U=i[13])*d+(X=i[14])*v+(Y=i[15])*I,t[13]=N*s+U*f+X*C+Y*P,t[14]=N*l+U*_+X*A+Y*D,t[15]=N*c+U*y+X*M+Y*V,t}function Wa(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=n+n,f=s+s,_=l+l,y=n*d,v=n*f,C=n*_,A=s*f,M=s*_,I=l*_,P=c*d,D=c*f,V=c*_;return t[0]=1-(A+I),t[1]=v+V,t[2]=C-D,t[3]=0,t[4]=v-V,t[5]=1-(y+I),t[6]=M+P,t[7]=0,t[8]=C+D,t[9]=M-P,t[10]=1-(y+A),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function Gs(t,e){var i=e[4],n=e[5],s=e[6],l=e[8],c=e[9],d=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(i,n,s),t[2]=Math.hypot(l,c,d),t}function en(t,e,i,n,s){var l,c=1/Math.tan(e/2);return t[0]=c/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(t[10]=(s+n)*(l=1/(n-s)),t[14]=2*s*n*l):(t[10]=-1,t[14]=-2*n),t}function tn(t,e,i,n,s,l,c){var d=1/(e-i),f=1/(n-s),_=1/(l-c);return t[0]=-2*d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*_,t[11]=0,t[12]=(e+i)*d,t[13]=(s+n)*f,t[14]=(c+l)*_,t[15]=1,t}function Ha(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}gt.perspective=en,gt.ortho=tn,gt.mul=gl,gt.sub=Ha;var pt={},yt={};function qs(t){return qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qs(t)}Object.defineProperty(yt,"__esModule",{value:!0}),yt.create=yl,yt.clone=function(t){var e=new br.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},yt.length=ps,yt.fromValues=function(t,e,i){var n=new br.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=i,n},yt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},yt.set=function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},yt.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},yt.subtract=xl,yt.multiply=Gn,yt.divide=qn,yt.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},yt.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},yt.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},yt.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},yt.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},yt.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},yt.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},yt.distance=Ws,yt.squaredDistance=Xa,yt.squaredLength=Hs,yt.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},yt.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},yt.normalize=function(t,e){var i=e[0],n=e[1],s=e[2],l=i*i+n*n+s*s;return l>0&&(l=1/Math.sqrt(l)),t[0]=e[0]*l,t[1]=e[1]*l,t[2]=e[2]*l,t},yt.dot=Xs,yt.cross=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=i[0],d=i[1],f=i[2];return t[0]=s*f-l*d,t[1]=l*c-n*f,t[2]=n*d-s*c,t},yt.lerp=function(t,e,i,n){var s=e[0],l=e[1],c=e[2];return t[0]=s+n*(i[0]-s),t[1]=l+n*(i[1]-l),t[2]=c+n*(i[2]-c),t},yt.hermite=function(t,e,i,n,s,l){var c=l*l,d=c*(2*l-3)+1,f=c*(l-2)+l,_=c*(l-1),y=c*(3-2*l);return t[0]=e[0]*d+i[0]*f+n[0]*_+s[0]*y,t[1]=e[1]*d+i[1]*f+n[1]*_+s[1]*y,t[2]=e[2]*d+i[2]*f+n[2]*_+s[2]*y,t},yt.bezier=function(t,e,i,n,s,l){var c=1-l,d=c*c,f=l*l,_=d*c,y=3*l*d,v=3*f*c,C=f*l;return t[0]=e[0]*_+i[0]*y+n[0]*v+s[0]*C,t[1]=e[1]*_+i[1]*y+n[1]*v+s[1]*C,t[2]=e[2]*_+i[2]*y+n[2]*v+s[2]*C,t},yt.random=function(t,e){e=e||1;var i=2*br.RANDOM()*Math.PI,n=2*br.RANDOM()-1,s=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(i)*s,t[1]=Math.sin(i)*s,t[2]=n*e,t},yt.transformMat4=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=i[3]*n+i[7]*s+i[11]*l+i[15];return t[0]=(i[0]*n+i[4]*s+i[8]*l+i[12])/(c=c||1),t[1]=(i[1]*n+i[5]*s+i[9]*l+i[13])/c,t[2]=(i[2]*n+i[6]*s+i[10]*l+i[14])/c,t},yt.transformMat3=function(t,e,i){var n=e[0],s=e[1],l=e[2];return t[0]=n*i[0]+s*i[3]+l*i[6],t[1]=n*i[1]+s*i[4]+l*i[7],t[2]=n*i[2]+s*i[5]+l*i[8],t},yt.transformQuat=function(t,e,i){var n=i[0],s=i[1],l=i[2],c=e[0],d=e[1],f=e[2],_=s*f-l*d,y=l*c-n*f,v=n*d-s*c,C=s*v-l*y,A=l*_-n*v,M=n*y-s*_,I=2*i[3];return y*=I,v*=I,A*=2,M*=2,t[0]=c+(_*=I)+(C*=2),t[1]=d+y+A,t[2]=f+v+M,t},yt.rotateX=function(t,e,i,n){var s=[],l=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],l[0]=s[0],l[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),l[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),t[0]=l[0]+i[0],t[1]=l[1]+i[1],t[2]=l[2]+i[2],t},yt.rotateY=function(t,e,i,n){var s=[],l=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],l[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),l[1]=s[1],l[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),t[0]=l[0]+i[0],t[1]=l[1]+i[1],t[2]=l[2]+i[2],t},yt.rotateZ=function(t,e,i,n){var s=[],l=[];return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],l[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),l[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),l[2]=s[2],t[0]=l[0]+i[0],t[1]=l[1]+i[1],t[2]=l[2]+i[2],t},yt.angle=function(t,e){var i=t[0],n=t[1],s=t[2],l=e[0],c=e[1],d=e[2],f=Math.sqrt(i*i+n*n+s*s)*Math.sqrt(l*l+c*c+d*d),_=f&&Xs(t,e)/f;return Math.acos(Math.min(Math.max(_,-1),1))},yt.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},yt.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},yt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},yt.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=e[0],c=e[1],d=e[2];return Math.abs(i-l)<=br.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-c)<=br.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-d)<=br.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))},yt.forEach=yt.sqrLen=yt.len=yt.sqrDist=yt.dist=yt.div=yt.mul=yt.sub=void 0;var br=function(t,e){if(t&&t.__esModule)return t;if(t===null||qs(t)!=="object"&&typeof t!="function")return{default:t};var i=Tn(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function Tn(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Tn=function(n){return n?i:e})(t)}function yl(){var t=new br.ARRAY_TYPE(3);return br.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ps(t){return Math.hypot(t[0],t[1],t[2])}function xl(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Gn(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function qn(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function Ws(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function Xa(t,e){var i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return i*i+n*n+s*s}function Hs(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}function Xs(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}yt.sub=xl,yt.mul=Gn,yt.div=qn,yt.dist=Ws,yt.sqrDist=Xa,yt.len=ps,yt.sqrLen=Hs;var Vr,xr=(Vr=yl(),function(t,e,i,n,s,l){var c,d;for(e||(e=3),i||(i=0),d=n?Math.min(n*e+i,t.length):t.length,c=i;c<d;c+=e)Vr[0]=t[c],Vr[1]=t[c+1],Vr[2]=t[c+2],s(Vr,Vr,l),t[c]=Vr[0],t[c+1]=Vr[1],t[c+2]=Vr[2];return t});yt.forEach=xr;var ft={};function Ys(t){return Ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ys(t)}Object.defineProperty(ft,"__esModule",{value:!0}),ft.create=fs,ft.clone=function(t){var e=new fr.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ft.fromValues=function(t,e,i,n){var s=new fr.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=i,s[3]=n,s},ft.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ft.set=function(t,e,i,n,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t},ft.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},ft.subtract=Ur,ft.multiply=Js,ft.divide=Ya,ft.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},ft.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},ft.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},ft.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},ft.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},ft.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},ft.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},ft.distance=Ks,ft.squaredDistance=ms,ft.length=Qs,ft.squaredLength=ea,ft.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},ft.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},ft.normalize=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=i*i+n*n+s*s+l*l;return c>0&&(c=1/Math.sqrt(c)),t[0]=i*c,t[1]=n*c,t[2]=s*c,t[3]=l*c,t},ft.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},ft.cross=function(t,e,i,n){var s=i[0]*n[1]-i[1]*n[0],l=i[0]*n[2]-i[2]*n[0],c=i[0]*n[3]-i[3]*n[0],d=i[1]*n[2]-i[2]*n[1],f=i[1]*n[3]-i[3]*n[1],_=i[2]*n[3]-i[3]*n[2],y=e[0],v=e[1],C=e[2],A=e[3];return t[0]=v*_-C*f+A*d,t[1]=-y*_+C*c-A*l,t[2]=y*f-v*c+A*s,t[3]=-y*d+v*l-C*s,t},ft.lerp=function(t,e,i,n){var s=e[0],l=e[1],c=e[2],d=e[3];return t[0]=s+n*(i[0]-s),t[1]=l+n*(i[1]-l),t[2]=c+n*(i[2]-c),t[3]=d+n*(i[3]-d),t},ft.random=function(t,e){var i,n,s,l,c,d;e=e||1;do c=(i=2*fr.RANDOM()-1)*i+(n=2*fr.RANDOM()-1)*n;while(c>=1);do d=(s=2*fr.RANDOM()-1)*s+(l=2*fr.RANDOM()-1)*l;while(d>=1);var f=Math.sqrt((1-c)/d);return t[0]=e*i,t[1]=e*n,t[2]=e*s*f,t[3]=e*l*f,t},ft.transformMat4=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3];return t[0]=i[0]*n+i[4]*s+i[8]*l+i[12]*c,t[1]=i[1]*n+i[5]*s+i[9]*l+i[13]*c,t[2]=i[2]*n+i[6]*s+i[10]*l+i[14]*c,t[3]=i[3]*n+i[7]*s+i[11]*l+i[15]*c,t},ft.transformQuat=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=i[0],d=i[1],f=i[2],_=i[3],y=_*n+d*l-f*s,v=_*s+f*n-c*l,C=_*l+c*s-d*n,A=-c*n-d*s-f*l;return t[0]=y*_+A*-c+v*-f-C*-d,t[1]=v*_+A*-d+C*-c-y*-f,t[2]=C*_+A*-f+y*-d-v*-c,t[3]=e[3],t},ft.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},ft.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ft.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ft.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=t[3],c=e[0],d=e[1],f=e[2],_=e[3];return Math.abs(i-c)<=fr.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(n-d)<=fr.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-f)<=fr.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(l-_)<=fr.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))},ft.forEach=ft.sqrLen=ft.len=ft.sqrDist=ft.dist=ft.div=ft.mul=ft.sub=void 0;var fr=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ys(t)!=="object"&&typeof t!="function")return{default:t};var i=rn(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function rn(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(rn=function(n){return n?i:e})(t)}function fs(){var t=new fr.ARRAY_TYPE(4);return fr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ur(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Js(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Ya(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function Ks(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function ms(t,e){var i=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2],l=e[3]-t[3];return i*i+n*n+s*s+l*l}function Qs(t){return Math.hypot(t[0],t[1],t[2],t[3])}function ea(t){var e=t[0],i=t[1],n=t[2],s=t[3];return e*e+i*i+n*n+s*s}ft.sub=Ur,ft.mul=Js,ft.div=Ya,ft.dist=Ks,ft.sqrDist=ms,ft.len=Qs,ft.sqrLen=ea;var Wn=function(){var t=fs();return function(e,i,n,s,l,c){var d,f;for(i||(i=4),n||(n=0),f=s?Math.min(s*i+n,e.length):e.length,d=n;d<f;d+=i)t[0]=e[d],t[1]=e[d+1],t[2]=e[d+2],t[3]=e[d+3],l(t,t,c),e[d]=t[0],e[d+1]=t[1],e[d+2]=t[2],e[d+3]=t[3];return e}}();function ta(t){return ta=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ta(t)}ft.forEach=Wn,Object.defineProperty(pt,"__esModule",{value:!0}),pt.create=ia,pt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},pt.setAxisAngle=Ni,pt.getAxisAngle=function(t,e){var i=2*Math.acos(e[3]),n=Math.sin(i/2);return n>Zr.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),i},pt.getAngle=function(t,e){var i=Q(t,e);return Math.acos(2*i*i-1)},pt.multiply=Ka,pt.rotateX=function(t,e,i){i*=.5;var n=e[0],s=e[1],l=e[2],c=e[3],d=Math.sin(i),f=Math.cos(i);return t[0]=n*f+c*d,t[1]=s*f+l*d,t[2]=l*f-s*d,t[3]=c*f-n*d,t},pt.rotateY=function(t,e,i){i*=.5;var n=e[0],s=e[1],l=e[2],c=e[3],d=Math.sin(i),f=Math.cos(i);return t[0]=n*f-l*d,t[1]=s*f+c*d,t[2]=l*f+n*d,t[3]=c*f-s*d,t},pt.rotateZ=function(t,e,i){i*=.5;var n=e[0],s=e[1],l=e[2],c=e[3],d=Math.sin(i),f=Math.cos(i);return t[0]=n*f+s*d,t[1]=s*f-n*d,t[2]=l*f+c*d,t[3]=c*f-l*d,t},pt.calculateW=function(t,e){var i=e[0],n=e[1],s=e[2];return t[0]=i,t[1]=n,t[2]=s,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-s*s)),t},pt.exp=ae,pt.ln=R,pt.pow=function(t,e,i){return R(t,e),ie(t,t,i),ae(t,t),t},pt.slerp=j,pt.random=function(t){var e=Zr.RANDOM(),i=Zr.RANDOM(),n=Zr.RANDOM(),s=Math.sqrt(1-e),l=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*i),t[1]=s*Math.cos(2*Math.PI*i),t[2]=l*Math.sin(2*Math.PI*n),t[3]=l*Math.cos(2*Math.PI*n),t},pt.invert=function(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=i*i+n*n+s*s+l*l,d=c?1/c:0;return t[0]=-i*d,t[1]=-n*d,t[2]=-s*d,t[3]=l*d,t},pt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},pt.fromMat3=q,pt.fromEuler=function(t,e,i,n){var s=.5*Math.PI/180;e*=s,i*=s,n*=s;var l=Math.sin(e),c=Math.cos(e),d=Math.sin(i),f=Math.cos(i),_=Math.sin(n),y=Math.cos(n);return t[0]=l*f*y-c*d*_,t[1]=c*d*y+l*f*_,t[2]=c*f*_-l*d*y,t[3]=c*f*y+l*d*_,t},pt.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},pt.setAxes=pt.sqlerp=pt.rotationTo=pt.equals=pt.exactEquals=pt.normalize=pt.sqrLen=pt.squaredLength=pt.len=pt.length=pt.lerp=pt.dot=pt.scale=pt.mul=pt.add=pt.set=pt.copy=pt.fromValues=pt.clone=void 0;var Zr=_s(Mi),L1=_s(ri),$r=_s(yt),Yi=_s(ft);function Ja(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(Ja=function(n){return n?i:e})(t)}function _s(t,e){if(t&&t.__esModule)return t;if(t===null||ta(t)!=="object"&&typeof t!="function")return{default:t};var i=Ja(e);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}function ia(){var t=new Zr.ARRAY_TYPE(4);return Zr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ni(t,e,i){i*=.5;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t}function Ka(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=i[0],f=i[1],_=i[2],y=i[3];return t[0]=n*y+c*d+s*_-l*f,t[1]=s*y+c*f+l*d-n*_,t[2]=l*y+c*_+n*f-s*d,t[3]=c*y-n*d-s*f-l*_,t}function ae(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=Math.sqrt(i*i+n*n+s*s),d=Math.exp(l),f=c>0?d*Math.sin(c)/c:0;return t[0]=i*f,t[1]=n*f,t[2]=s*f,t[3]=d*Math.cos(c),t}function R(t,e){var i=e[0],n=e[1],s=e[2],l=e[3],c=Math.sqrt(i*i+n*n+s*s),d=c>0?Math.atan2(c,l)/c:0;return t[0]=i*d,t[1]=n*d,t[2]=s*d,t[3]=.5*Math.log(i*i+n*n+s*s+l*l),t}function j(t,e,i,n){var s,l,c,d,f,_=e[0],y=e[1],v=e[2],C=e[3],A=i[0],M=i[1],I=i[2],P=i[3];return(l=_*A+y*M+v*I+C*P)<0&&(l=-l,A=-A,M=-M,I=-I,P=-P),1-l>Zr.EPSILON?(s=Math.acos(l),c=Math.sin(s),d=Math.sin((1-n)*s)/c,f=Math.sin(n*s)/c):(d=1-n,f=n),t[0]=d*_+f*A,t[1]=d*y+f*M,t[2]=d*v+f*I,t[3]=d*C+f*P,t}function q(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,t[0]=(e[5]-e[7])*(i=.5/i),t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[3*s+s]&&(s=2);var l=(s+1)%3,c=(s+2)%3;i=Math.sqrt(e[3*s+s]-e[3*l+l]-e[3*c+c]+1),t[s]=.5*i,t[3]=(e[3*l+c]-e[3*c+l])*(i=.5/i),t[l]=(e[3*l+s]+e[3*s+l])*i,t[c]=(e[3*c+s]+e[3*s+c])*i}return t}pt.clone=Yi.clone,pt.fromValues=Yi.fromValues,pt.copy=Yi.copy,pt.set=Yi.set,pt.add=Yi.add,pt.mul=Ka;var ie=Yi.scale;pt.scale=ie;var Q=Yi.dot;pt.dot=Q,pt.lerp=Yi.lerp;var ue=Yi.length;pt.length=ue,pt.len=ue;var ve=Yi.squaredLength;pt.squaredLength=ve,pt.sqrLen=ve;var ce=Yi.normalize;pt.normalize=ce,pt.exactEquals=Yi.exactEquals,pt.equals=Yi.equals;var ye,ze,Oe,We=(ye=$r.create(),ze=$r.fromValues(1,0,0),Oe=$r.fromValues(0,1,0),function(t,e,i){var n=$r.dot(e,i);return n<-.999999?($r.cross(ye,ze,e),$r.len(ye)<1e-6&&$r.cross(ye,Oe,e),$r.normalize(ye,ye),Ni(t,ye,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):($r.cross(ye,e,i),t[0]=ye[0],t[1]=ye[1],t[2]=ye[2],t[3]=1+n,ce(t,t))});pt.rotationTo=We;var nt,ut,Gt=(nt=ia(),ut=ia(),function(t,e,i,n,s,l){return j(nt,e,s,l),j(ut,i,n,l),j(t,nt,ut,2*l*(1-l)),t});pt.sqlerp=Gt;var At,Zt=(At=L1.create(),function(t,e,i,n){return At[0]=i[0],At[3]=i[1],At[6]=i[2],At[1]=n[0],At[4]=n[1],At[7]=n[2],At[2]=-e[0],At[5]=-e[1],At[8]=-e[2],ce(t,q(t,At))});pt.setAxes=Zt;var et={};function gi(t){return gi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gi(t)}Object.defineProperty(et,"__esModule",{value:!0}),et.create=function(){var t=new qt.ARRAY_TYPE(8);return qt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},et.clone=function(t){var e=new qt.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},et.fromValues=function(t,e,i,n,s,l,c,d){var f=new qt.ARRAY_TYPE(8);return f[0]=t,f[1]=e,f[2]=i,f[3]=n,f[4]=s,f[5]=l,f[6]=c,f[7]=d,f},et.fromRotationTranslationValues=function(t,e,i,n,s,l,c){var d=new qt.ARRAY_TYPE(8);d[0]=t,d[1]=e,d[2]=i,d[3]=n;var f=.5*s,_=.5*l,y=.5*c;return d[4]=f*n+_*i-y*e,d[5]=_*n+y*t-f*i,d[6]=y*n+f*e-_*t,d[7]=-f*t-_*e-y*i,d},et.fromRotationTranslation=tr,et.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},et.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},et.fromMat4=function(t,e){var i=jt.create();Oi.getRotation(i,e);var n=new qt.ARRAY_TYPE(3);return Oi.getTranslation(n,e),tr(t,i,n),t},et.copy=mr,et.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},et.set=function(t,e,i,n,s,l,c,d,f){return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t[4]=l,t[5]=c,t[6]=d,t[7]=f,t},et.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},et.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},et.getTranslation=function(t,e){var i=e[4],n=e[5],s=e[6],l=e[7],c=-e[0],d=-e[1],f=-e[2],_=e[3];return t[0]=2*(i*_+l*c+n*f-s*d),t[1]=2*(n*_+l*d+s*c-i*f),t[2]=2*(s*_+l*f+i*d-n*c),t},et.translate=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=.5*i[0],f=.5*i[1],_=.5*i[2],y=e[4],v=e[5],C=e[6],A=e[7];return t[0]=n,t[1]=s,t[2]=l,t[3]=c,t[4]=c*d+s*_-l*f+y,t[5]=c*f+l*d-n*_+v,t[6]=c*_+n*f-s*d+C,t[7]=-n*d-s*f-l*_+A,t},et.rotateX=function(t,e,i){var n=-e[0],s=-e[1],l=-e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=d*c+y*n+f*l-_*s,C=f*c+y*s+_*n-d*l,A=_*c+y*l+d*s-f*n,M=y*c-d*n-f*s-_*l;return jt.rotateX(t,e,i),t[4]=v*(c=t[3])+M*(n=t[0])+C*(l=t[2])-A*(s=t[1]),t[5]=C*c+M*s+A*n-v*l,t[6]=A*c+M*l+v*s-C*n,t[7]=M*c-v*n-C*s-A*l,t},et.rotateY=function(t,e,i){var n=-e[0],s=-e[1],l=-e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=d*c+y*n+f*l-_*s,C=f*c+y*s+_*n-d*l,A=_*c+y*l+d*s-f*n,M=y*c-d*n-f*s-_*l;return jt.rotateY(t,e,i),t[4]=v*(c=t[3])+M*(n=t[0])+C*(l=t[2])-A*(s=t[1]),t[5]=C*c+M*s+A*n-v*l,t[6]=A*c+M*l+v*s-C*n,t[7]=M*c-v*n-C*s-A*l,t},et.rotateZ=function(t,e,i){var n=-e[0],s=-e[1],l=-e[2],c=e[3],d=e[4],f=e[5],_=e[6],y=e[7],v=d*c+y*n+f*l-_*s,C=f*c+y*s+_*n-d*l,A=_*c+y*l+d*s-f*n,M=y*c-d*n-f*s-_*l;return jt.rotateZ(t,e,i),t[4]=v*(c=t[3])+M*(n=t[0])+C*(l=t[2])-A*(s=t[1]),t[5]=C*c+M*s+A*n-v*l,t[6]=A*c+M*l+v*s-C*n,t[7]=M*c-v*n-C*s-A*l,t},et.rotateByQuatAppend=function(t,e,i){var n=i[0],s=i[1],l=i[2],c=i[3],d=e[0],f=e[1],_=e[2],y=e[3];return t[0]=d*c+y*n+f*l-_*s,t[1]=f*c+y*s+_*n-d*l,t[2]=_*c+y*l+d*s-f*n,t[3]=y*c-d*n-f*s-_*l,t[4]=(d=e[4])*c+(y=e[7])*n+(f=e[5])*l-(_=e[6])*s,t[5]=f*c+y*s+_*n-d*l,t[6]=_*c+y*l+d*s-f*n,t[7]=y*c-d*n-f*s-_*l,t},et.rotateByQuatPrepend=function(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=i[0],f=i[1],_=i[2],y=i[3];return t[0]=n*y+c*d+s*_-l*f,t[1]=s*y+c*f+l*d-n*_,t[2]=l*y+c*_+n*f-s*d,t[3]=c*y-n*d-s*f-l*_,t[4]=n*(y=i[7])+c*(d=i[4])+s*(_=i[6])-l*(f=i[5]),t[5]=s*y+c*f+l*d-n*_,t[6]=l*y+c*_+n*f-s*d,t[7]=c*y-n*d-s*f-l*_,t},et.rotateAroundAxis=function(t,e,i,n){if(Math.abs(n)<qt.EPSILON)return mr(t,e);var s=Math.hypot(i[0],i[1],i[2]);n*=.5;var l=Math.sin(n),c=l*i[0]/s,d=l*i[1]/s,f=l*i[2]/s,_=Math.cos(n),y=e[0],v=e[1],C=e[2],A=e[3];t[0]=y*_+A*c+v*f-C*d,t[1]=v*_+A*d+C*c-y*f,t[2]=C*_+A*f+y*d-v*c,t[3]=A*_-y*c-v*d-C*f;var M=e[4],I=e[5],P=e[6],D=e[7];return t[4]=M*_+D*c+I*f-P*d,t[5]=I*_+D*d+P*c-M*f,t[6]=P*_+D*f+M*d-I*c,t[7]=D*_-M*c-I*d-P*f,t},et.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t},et.multiply=gs,et.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t},et.lerp=function(t,e,i,n){var s=1-n;return k1(e,i)<0&&(n=-n),t[0]=e[0]*s+i[0]*n,t[1]=e[1]*s+i[1]*n,t[2]=e[2]*s+i[2]*n,t[3]=e[3]*s+i[3]*n,t[4]=e[4]*s+i[4]*n,t[5]=e[5]*s+i[5]*n,t[6]=e[6]*s+i[6]*n,t[7]=e[7]*s+i[7]*n,t},et.invert=function(t,e){var i=Qa(e);return t[0]=-e[0]/i,t[1]=-e[1]/i,t[2]=-e[2]/i,t[3]=e[3]/i,t[4]=-e[4]/i,t[5]=-e[5]/i,t[6]=-e[6]/i,t[7]=e[7]/i,t},et.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},et.normalize=function(t,e){var i=Qa(e);if(i>0){i=Math.sqrt(i);var n=e[0]/i,s=e[1]/i,l=e[2]/i,c=e[3]/i,d=e[4],f=e[5],_=e[6],y=e[7],v=n*d+s*f+l*_+c*y;t[0]=n,t[1]=s,t[2]=l,t[3]=c,t[4]=(d-n*v)/i,t[5]=(f-s*v)/i,t[6]=(_-l*v)/i,t[7]=(y-c*v)/i}return t},et.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},et.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},et.equals=function(t,e){var i=t[0],n=t[1],s=t[2],l=t[3],c=t[4],d=t[5],f=t[6],_=t[7],y=e[0],v=e[1],C=e[2],A=e[3],M=e[4],I=e[5],P=e[6],D=e[7];return Math.abs(i-y)<=qt.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(n-v)<=qt.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(s-C)<=qt.EPSILON*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(l-A)<=qt.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-M)<=qt.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(d-I)<=qt.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-P)<=qt.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(_-D)<=qt.EPSILON*Math.max(1,Math.abs(_),Math.abs(D))},et.sqrLen=et.squaredLength=et.len=et.length=et.dot=et.mul=et.setReal=et.getReal=void 0;var qt=qi(Mi),jt=qi(pt),Oi=qi(gt);function zi(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(zi=function(n){return n?i:e})(t)}function qi(t,e){if(t&&t.__esModule)return t;if(t===null||gi(t)!=="object"&&typeof t!="function")return{default:t};var i=zi(e);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}function tr(t,e,i){var n=.5*i[0],s=.5*i[1],l=.5*i[2],c=e[0],d=e[1],f=e[2],_=e[3];return t[0]=c,t[1]=d,t[2]=f,t[3]=_,t[4]=n*_+s*f-l*d,t[5]=s*_+l*c-n*f,t[6]=l*_+n*d-s*c,t[7]=-n*c-s*d-l*f,t}function mr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function gs(t,e,i){var n=e[0],s=e[1],l=e[2],c=e[3],d=i[4],f=i[5],_=i[6],y=i[7],v=e[4],C=e[5],A=e[6],M=e[7],I=i[0],P=i[1],D=i[2],V=i[3];return t[0]=n*V+c*I+s*D-l*P,t[1]=s*V+c*P+l*I-n*D,t[2]=l*V+c*D+n*P-s*I,t[3]=c*V-n*I-s*P-l*D,t[4]=n*y+c*d+s*_-l*f+v*V+M*I+C*D-A*P,t[5]=s*y+c*f+l*d-n*_+C*V+M*P+A*I-v*D,t[6]=l*y+c*_+n*f-s*d+A*V+M*D+v*P-C*I,t[7]=c*y-n*d-s*f-l*_+M*V-v*I-C*P-A*D,t}et.getReal=jt.copy,et.setReal=jt.copy,et.mul=gs;var k1=jt.dot;et.dot=k1;var B1=jt.length;et.length=B1,et.len=B1;var Qa=jt.squaredLength;et.squaredLength=Qa,et.sqrLen=Qa;var St={};function vl(t){return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vl(t)}Object.defineProperty(St,"__esModule",{value:!0}),St.create=j1,St.clone=function(t){var e=new Hn.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},St.fromValues=function(t,e){var i=new Hn.ARRAY_TYPE(2);return i[0]=t,i[1]=e,i},St.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},St.set=function(t,e,i){return t[0]=e,t[1]=i,t},St.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},St.subtract=N1,St.multiply=V1,St.divide=U1,St.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},St.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},St.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},St.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},St.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},St.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},St.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},St.distance=Z1,St.squaredDistance=$1,St.length=eo,St.squaredLength=to,St.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},St.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},St.normalize=function(t,e){var i=e[0],n=e[1],s=i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t},St.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},St.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},St.lerp=function(t,e,i,n){var s=e[0],l=e[1];return t[0]=s+n*(i[0]-s),t[1]=l+n*(i[1]-l),t},St.random=function(t,e){e=e||1;var i=2*Hn.RANDOM()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},St.transformMat2=function(t,e,i){var n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s,t[1]=i[1]*n+i[3]*s,t},St.transformMat2d=function(t,e,i){var n=e[0],s=e[1];return t[0]=i[0]*n+i[2]*s+i[4],t[1]=i[1]*n+i[3]*s+i[5],t},St.transformMat3=function(t,e,i){var n=e[0],s=e[1];return t[0]=i[0]*n+i[3]*s+i[6],t[1]=i[1]*n+i[4]*s+i[7],t},St.transformMat4=function(t,e,i){var n=e[0],s=e[1];return t[0]=i[0]*n+i[4]*s+i[12],t[1]=i[1]*n+i[5]*s+i[13],t},St.rotate=function(t,e,i,n){var s=e[0]-i[0],l=e[1]-i[1],c=Math.sin(n),d=Math.cos(n);return t[0]=s*d-l*c+i[0],t[1]=s*c+l*d+i[1],t},St.angle=function(t,e){var i=t[0],n=t[1],s=e[0],l=e[1],c=Math.sqrt(i*i+n*n)*Math.sqrt(s*s+l*l);return Math.acos(Math.min(Math.max(c&&(i*s+n*l)/c,-1),1))},St.zero=function(t){return t[0]=0,t[1]=0,t},St.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},St.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},St.equals=function(t,e){var i=t[0],n=t[1],s=e[0],l=e[1];return Math.abs(i-s)<=Hn.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-l)<=Hn.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))},St.forEach=St.sqrLen=St.sqrDist=St.dist=St.div=St.mul=St.sub=St.len=void 0;var Hn=function(t,e){if(t&&t.__esModule)return t;if(t===null||vl(t)!=="object"&&typeof t!="function")return{default:t};var i=F1(void 0);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}(Mi);function F1(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(F1=function(n){return n?i:e})(t)}function j1(){var t=new Hn.ARRAY_TYPE(2);return Hn.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function N1(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function V1(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function U1(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function Z1(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function $1(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}function eo(t){return Math.hypot(t[0],t[1])}function to(t){var e=t[0],i=t[1];return e*e+i*i}St.len=eo,St.sub=N1,St.mul=V1,St.div=U1,St.dist=Z1,St.sqrDist=$1,St.sqrLen=to;var Cl=function(){var t=j1();return function(e,i,n,s,l,c){var d,f;for(i||(i=2),n||(n=0),f=s?Math.min(s*i+n,e.length):e.length,d=n;d<f;d+=i)t[0]=e[d],t[1]=e[d+1],l(t,t,c),e[d]=t[0],e[d+1]=t[1];return e}}();function bl(t){return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bl(t)}St.forEach=Cl,Object.defineProperty(Ai,"__esModule",{value:!0}),a.aB=Ai.vec4=a.$=Ai.vec3=Ai.vec2=Ai.quat2=a.aw=Ai.quat=a.ae=Ai.mat4=a.bE=Ai.mat3=Ai.mat2d=a.aD=Ai.mat2=Ai.glMatrix=void 0;var w3=Er(Mi);Ai.glMatrix=w3;var A3=Er(pi);a.aD=Ai.mat2=A3;var ra=Er(li);Ai.mat2d=ra;var Nt=Er(ri);a.bE=Ai.mat3=Nt;var Eh=Er(gt);a.ae=Ai.mat4=Eh;var Ih=Er(pt);a.aw=Ai.quat=Ih;var Ph=Er(et);Ai.quat2=Ph;var T3=Er(St);Ai.vec2=T3;var Oh=Er(yt);a.$=Ai.vec3=Oh;var G1=Er(ft);function io(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,i=new WeakMap;return(io=function(n){return n?i:e})(t)}function Er(t,e){if(t&&t.__esModule)return t;if(t===null||bl(t)!=="object"&&typeof t!="function")return{default:t};var i=io(e);if(i&&i.has(t))return i.get(t);var n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in t)if(l!=="default"&&Object.prototype.hasOwnProperty.call(t,l)){var c=s?Object.getOwnPropertyDescriptor(t,l):null;c&&(c.get||c.set)?Object.defineProperty(n,l,c):n[l]=t[l]}return n.default=t,i&&i.set(t,n),n}a.aB=Ai.vec4=G1;var M3=S3;function S3(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=n}S3.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,n=0;n<8;n++){var s=this.sampleCurveX(i)-t;if(Math.abs(s)<e)return i;var l=this.sampleCurveDerivativeX(i);if(Math.abs(l)<1e-6)break;i-=s/l}var c=0,d=1;for(i=t,n=0;n<20&&(s=this.sampleCurveX(i),!(Math.abs(s-t)<e));n++)t>s?c=i:d=i,i=.5*(d-c)+c;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var q1=dn(M3),ro=ys;function ys(t,e){this.x=t,this.y=e}ys.prototype={clone:function(){return new ys(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),n=Math.sin(t),s=e.y+n*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-n*(this.y-e.y),this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ys.convert=function(t){return t instanceof ys?t:Array.isArray(t)?new ys(t[0],t[1]):t};var Ze=dn(ro);function na(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!na(t[i],e[i]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!na(t[i],e[i]))return!1;return!0}return t===e}const E3=Math.PI/180,sa=180/Math.PI;function Lt(t){return t*E3}function vr(t){return t*sa}const no=[[0,0],[1,0],[1,1],[0,1]];function wl(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}function Al(t,e,i,n){const s=new q1(t,e,i,n);return function(l){return s.solve(l)}}const nn=Al(.25,.1,.25,1);function Pt(t,e,i){return Math.min(i,Math.max(e,t))}function W1(t,e,i){return(i=Pt((i-t)/(e-t),0,1))*i*(3-2*i)}function aa(t,e,i){const n=i-e,s=((t-e)%n+n)%n+e;return s===e?i:s}function so(t,e,i){if(!t.length)return i(null,[]);let n=t.length;const s=new Array(t.length);let l=null;t.forEach((c,d)=>{e(c,(f,_)=>{f&&(l=f),s[d]=_,--n==0&&i(l,s)})})}function H1(t){const e=[];for(const i in t)e.push(t[i]);return e}function ir(t,...e){for(const i of e)for(const n in i)t[n]=i[n];return t}let I3=1;function Tl(){return I3++}function oa(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function xs(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function X1(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Ml(t,e){t.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function ao(t,e){return t.indexOf(e,t.length-e.length)!==-1}function oo(t,e,i){const n={};for(const s in t)n[s]=e.call(this,t[s],s,t);return n}function rr(t,e,i){const n={};for(const s in t)e.call(this,t[s],s,t)&&(n[s]=t[s]);return n}function Cr(t){return Array.isArray(t)?t.map(Cr):typeof t=="object"&&t?oo(t,Cr):t}const nr={};function Di(t){nr[t]||(typeof console<"u"&&console.warn(t),nr[t]=!0)}function Xn(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function zh(t){let e=0;for(let i,n,s=0,l=t.length,c=l-1;s<l;c=s++)i=t[s],n=t[c],e+=(n.x-i.x)*(i.y+n.y);return e}function la([t,e,i]){const n=Lt(e+90),s=Lt(i);return{x:t*Math.cos(n)*Math.sin(s),y:t*Math.sin(n)*Math.sin(s),z:t*Math.cos(s),azimuthal:e,polar:i}}function ca(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function lo(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,n,s,l)=>{const c=s||l;return e[n]=!c||c.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Y1,co,Yn,uo,Jn,ho,po=null;function Sl(t){try{const e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Kn(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function El(t,e,i,n){for(;e<i;){const s=e+i>>1;t[s]<n?e=s+1:i=s}return e}function Il(t,e,i,n){for(;e<i;){const s=e+i>>1;t[s]<=n?e=s+1:i=s}return e}function P3(t){return t>0?1/(1.001-t):1+t}function O3(t){return t>0?1-1/(1.001-t):-t}function J1(){return Y1==null&&(Y1=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Y1}const sr={now:()=>uo!==void 0?uo:performance.now(),setNow(t){uo=t},restoreNow(){uo=void 0},frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:i,height:n}=t;Jn||(Jn=document.createElement("canvas"));const s=Jn.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return(i>Jn.width||n>Jn.height)&&(Jn.width=i,Jn.height=n),s.clearRect(-e,-e,i+2*e,n+2*e),s.drawImage(t,0,0,i,n),s.getImageData(-e,-e,i+2*e,n+2*e)},resolveURL:t=>(co||(co=document.createElement("a")),co.href=t,co.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Yn==null&&(Yn=window.matchMedia("(prefers-reduced-motion: reduce)")),Yn.matches)},hasCanvasFingerprintNoise(){if(ho!==void 0)return ho;if(!J1())return ho=!1,!1;const t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0});let i=0;for(let s=0;s<t.width;++s)e.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,e.fillRect(s,0,1,1);const n=e.getImageData(0,0,t.width,t.height);i=0;for(let s=0;s<n.data.length;++s)if(s%4!=3&&i++!==n.data[s])return ho=!0,!0;return ho=!1,!1}};function z3(t,e){const i=t.indexOf("?");if(i<0)return`${t}?${new URLSearchParams(e).toString()}`;const n=new URLSearchParams(t.slice(i));for(const s in e)n.set(s,e[s]);return`${t.slice(0,i)}?${n.toString()}`}function K1(t,e={persistentParams:[]}){const i=t.indexOf("?");if(i<0)return t;const n=new URLSearchParams,s=new URLSearchParams(t.slice(i));for(const c of e.persistentParams){const d=s.get(c);d&&n.set(c,d)}const l=n.toString();return`${t.slice(0,i)}${l.length>0?`?${l}`:""}`}const D3="mapbox-tiles";let Q1=500,ec=50;const R3=["language","worldview","jobid"];let pn,Pl;function L3(){try{return caches}catch{}}function fo(){const t=L3();t&&!pn&&(pn=t.open(D3))}let Ol=1/0;const zl={supported:!1,testSupport:function(t){!Dl&&ua&&(k3?tc(t):mo=t)}};let mo,ua,Dl=!1,k3=!1;const B3=typeof self<"u"?self:{};function tc(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,ua),t.isContextLost())return;zl.supported=!0}catch{}t.deleteTexture(e),Dl=!0}B3.document&&(ua=B3.document.createElement("img"),ua.onload=function(){mo&&tc(mo),mo=null,k3=!0},ua.onerror=function(){Dl=!0,mo=null},ua.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _o={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(_o);class Rl extends Error{constructor(e,i,n){i===401&&It(n)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ic=ca()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,fn=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(ic())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(n,s){const l=new AbortController,c=new Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,referrer:ic(),referrerPolicy:n.referrerPolicy,signal:l.signal});let d=!1,f=!1;const _=(y=c.url).indexOf("sku=")>0&&It(y);var y;n.type==="json"&&c.headers.set("Accept","application/json");const v=(A,M,I)=>{if(f)return;if(A&&A.message!=="SecurityError"&&Di(A.toString()),M&&I)return C(M);const P=Date.now();fetch(c).then(D=>{if(D.ok){const V=_?D.clone():null;return C(D,V,P)}return s(new Rl(D.statusText,D.status,n.url))}).catch(D=>{D.name!=="AbortError"&&s(new Error(`${D.message} ${n.url}`))})},C=(A,M,I)=>{(n.type==="arrayBuffer"?A.arrayBuffer():n.type==="json"?A.json():A.text()).then(P=>{f||(M&&I&&function(D,V,N){if(fo(),!pn)return;const U=lo(V.headers.get("Cache-Control")||"");if(U["no-store"])return;const X={status:V.status,statusText:V.statusText,headers:new Headers};V.headers.forEach((le,pe)=>X.headers.set(pe,le)),U["max-age"]&&X.headers.set("Expires",new Date(N+1e3*U["max-age"]).toUTCString());const Y=X.headers.get("Expires");if(!Y||new Date(Y).getTime()-N<42e4)return;let ee=K1(D.url,{persistentParams:R3});if(V.status===206){const le=D.headers.get("Range");if(!le)return;X.status=200,ee=z3(ee,{range:le})}(function(le,pe){if(Pl===void 0)try{new Response(new ReadableStream),Pl=!0}catch{Pl=!1}Pl?pe(le.body):le.blob().then(pe)})(V,le=>{const pe=new Response((xe=V.status)!==200&&xe!==404&&[101,103,204,205,304].includes(xe)?null:le,X);var xe;fo(),pn&&pn.then(fe=>fe.put(ee,pe)).catch(fe=>Di(fe.message))})}(c,M,I),d=!0,s(null,P,A.headers.get("Cache-Control"),A.headers.get("Expires")))}).catch(P=>{f||s(new Error(P.message))})};return _?function(A,M){if(fo(),!pn)return M(null);pn.then(I=>{let P=K1(A.url,{persistentParams:R3});const D=A.headers.get("Range");D&&(P=z3(P,{range:D})),I.match(P).then(V=>{const N=function(U){if(!U)return!1;const X=new Date(U.headers.get("Expires")||0),Y=lo(U.headers.get("Cache-Control")||"");return X>Date.now()&&!Y["no-cache"]}(V);I.delete(P),N&&I.put(P,V.clone()),M(null,V,N)}).catch(M)}).catch(M)}(c,v):v(null,null),{cancel:()=>{f=!0,d||l.abort()}}}(t,e);if(ca()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(n,s){const l=new XMLHttpRequest;l.open(n.method||"GET",n.url,!0),n.type==="arrayBuffer"&&(l.responseType="arraybuffer");for(const c in n.headers)l.setRequestHeader(c,n.headers[c]);return n.type==="json"&&(l.responseType="text",l.setRequestHeader("Accept","application/json")),l.withCredentials=n.credentials==="include",l.onerror=()=>{s(new Error(l.statusText))},l.onload=()=>{if((l.status>=200&&l.status<300||l.status===0)&&l.response!==null){let c=l.response;if(n.type==="json")try{c=JSON.parse(l.response)}catch(d){return s(d)}s(null,c,l.getResponseHeader("Cache-Control"),l.getResponseHeader("Expires"))}else s(new Rl(l.statusText,l.status,n.url))},l.send(n.body),{cancel:()=>l.abort()}}(t,e)},vs=function(t,e){return fn(ir(t,{type:"arrayBuffer"}),e)};function Dh(t){const e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}const F3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let go,ha;go=[],ha=0;const yo=function(t,e){if(zl.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ha>=st.MAX_PARALLEL_IMAGE_REQUESTS){const l={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return go.push(l),l}ha++;let i=!1;const n=()=>{if(!i)for(i=!0,ha--;go.length&&ha<st.MAX_PARALLEL_IMAGE_REQUESTS;){const l=go.shift(),{requestParameters:c,callback:d,cancelled:f}=l;f||(l.cancel=yo(c,d).cancel)}},s=vs(t,(l,c,d,f)=>{n(),l?e(l):c&&(self.createImageBitmap?function(_,y){const v=new Blob([new Uint8Array(_)],{type:"image/png"});createImageBitmap(v).then(C=>{y(null,C)}).catch(C=>{y(new Error(`Could not load image because of ${C.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(c,(_,y)=>e(_,y,d,f)):function(_,y){const v=new Image;v.onload=()=>{y(null,v),URL.revokeObjectURL(v.src),v.onload=null,requestAnimationFrame(()=>{v.src=F3})},v.onerror=()=>y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const C=new Blob([new Uint8Array(_)],{type:"image/png"});v.src=_.byteLength?URL.createObjectURL(C):F3}(c,(_,y)=>e(_,y,d,f)))});return{cancel:()=>{s.cancel(),n()}}},rc="01",nc="NO_ACCESS_TOKEN",Rh=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Gr(t){const e=t.match(Rh);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Cs(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const sc="mapbox.eventData";function j3(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class bs{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=j3(st.ACCESS_TOKEN);let n="";return n=i&&i.u?btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(s,l)=>String.fromCharCode(+("0x"+l)))):st.ACCESS_TOKEN||"",e?`${sc}.${e}:${n}`:`${sc}:${n}`}fetchEventData(){const e=Sl("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{const s=localStorage.getItem(i);s&&(this.eventData=JSON.parse(s));const l=localStorage.getItem(n);l&&(this.anonId=l)}catch{Di("Unable to read from LocalStorage")}}saveEventData(){const e=Sl("localStorage"),i=this.getStorageKey(),n=this.getStorageKey("uuid"),s=this.anonId;if(e&&s)try{localStorage.setItem(n,s),Object.keys(this.eventData).length>=1&&localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Di("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,n,s){if(!st.EVENTS_URL)return;const l=Gr(st.EVENTS_URL);l.params.push(`access_token=${s||st.ACCESS_TOKEN||""}`);const c={event:this.type,created:new Date(e).toISOString()},d=i?ir(c,i):c,f={url:Cs(l),headers:{"Content-Type":"text/plain"},body:JSON.stringify([d])};this.pendingRequest=function(_,y){return fn(ir(_,{method:"POST"}),y)}(f,_=>{this.pendingRequest=null,n(_),this.saveEventData(),this.processRequests(s)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const N3=new class extends bs{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){st.EVENTS_URL&&st.ACCESS_TOKEN&&Array.isArray(t)&&t.some(i=>_i(i)||It(i))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=j3(st.ACCESS_TOKEN),i=e?e.u:st.ACCESS_TOKEN;let n=i!==this.eventData.tokenU;X1(this.anonId)||(this.anonId=oa(),n=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const l=new Date(this.eventData.lastSuccess),c=new Date(s),d=(s-this.eventData.lastSuccess)/864e5;n=n||d>=1||d<-1||l.getDate()!==c.getDate()}else n=!0;n?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:mi,skuId:rc,"enabled.telemetry":!1,userId:this.anonId},l=>{l||(this.eventData.lastSuccess=s,this.eventData.tokenU=i)},t):this.processRequests()}},ac=N3.postTurnstileEvent.bind(N3),da=new class extends bs{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,i,n){this.skuToken=e,this.errorCb=n,st.EVENTS_URL&&(i||st.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(nc)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),X1(this.anonId)||(this.anonId=oa()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:mi,skuId:rc,skuToken:this.skuToken,userId:this.anonId},n=>{n?this.errorCb(n):e&&(this.success[e]=!0)},t))}remove(){this.errorCb=null}},V3=da.postMapLoadEvent.bind(da),xo=new class extends bs{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let e=this.mapInstanceIdMap.get(t);return e||(e=oa(),this.mapInstanceIdMap.set(t,e)),e}getEventId(t){const e=this.eventIdPerMapInstanceMap.get(t)||0;return this.eventIdPerMapInstanceMap.set(t,e+1),e}postStyleLoadEvent(t,e){const{map:i,style:n,importedStyles:s}=e;if(!st.EVENTS_URL||!t&&!st.ACCESS_TOKEN)return;const l=this.getMapInstanceId(i),c={mapInstanceId:l,eventId:this.getEventId(l),style:n};s.length&&(c.importedStyles=s),this.queueRequest({timestamp:Date.now(),payload:c},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,payload:i}=this.queue.shift();this.postEvent(e,i,()=>{},t)}},U3=xo.postStyleLoadEvent.bind(xo),Z3=new class extends bs{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){st.EVENTS_URL&&(t||st.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:i}=this.queue.shift(),n=function(s){const l=performance.getEntriesByType("resource"),c=performance.getEntriesByType("mark"),d=function(A){const M={};if(A){for(const I in A)if(I!=="other")for(const P of A[I]){const D=`${I}ResolveRangeMin`,V=`${I}ResolveRangeMax`,N=`${I}RequestCount`,U=`${I}RequestCachedCount`;M[D]=Math.min(M[D]||1/0,P.startTime),M[V]=Math.max(M[V]||-1/0,P.responseEnd);const X=Y=>{M[Y]===void 0&&(M[Y]=0),++M[Y]};P.transferSize!==void 0&&P.transferSize===0&&X(U),X(N)}}return M}(function(A,M){const I={};if(A)for(const P of A){const D=M(P);I[D]===void 0&&(I[D]=[]),I[D].push(P)}return I}(l,$a)),f=window.devicePixelRatio,_=navigator.connection||navigator.mozConnection||navigator.webkitConnection,y=_?_.effectiveType:void 0,v={counters:[],metadata:[],attributes:[]},C=(A,M,I)=>{I!=null&&A.push({name:M,value:I.toString()})};for(const A in d)C(v.counters,A,d[A]);if(s.interactionRange[0]!==1/0&&s.interactionRange[1]!==-1/0&&(C(v.counters,"interactionRangeMin",s.interactionRange[0]),C(v.counters,"interactionRangeMax",s.interactionRange[1])),c)for(const A of Object.keys(pr)){const M=pr[A],I=c.find(P=>P.name===M);I&&C(v.counters,M,I.startTime)}return C(v.counters,"visibilityHidden",s.visibilityHidden),C(v.attributes,"style",function(A){if(A)for(const M of A){const I=M.name.split("?")[0];if(Kr(I)){const P=I.split("/").slice(-2);if(P.length===2)return`mapbox://styles/${P[0]}/${P[1]}`}}}(l)),C(v.attributes,"terrainEnabled",s.terrainEnabled?"true":"false"),C(v.attributes,"fogEnabled",s.fogEnabled?"true":"false"),C(v.attributes,"projection",s.projection),C(v.attributes,"zoom",s.zoom),C(v.metadata,"devicePixelRatio",f),C(v.metadata,"connectionEffectiveType",y),C(v.metadata,"navigatorUserAgent",navigator.userAgent),C(v.metadata,"screenWidth",window.screen.width),C(v.metadata,"screenHeight",window.screen.height),C(v.metadata,"windowWidth",window.innerWidth),C(v.metadata,"windowHeight",window.innerHeight),C(v.metadata,"mapWidth",s.width/f),C(v.metadata,"mapHeight",s.height/f),C(v.metadata,"webglRenderer",s.renderer),C(v.metadata,"webglVendor",s.vendor),C(v.metadata,"sdkVersion",mi),C(v.metadata,"sdkIdentifier","mapbox-gl-js"),v}(i);for(const s of n.metadata);for(const s of n.counters);for(const s of n.attributes);this.postEvent(e,n,()=>{},t)}},Lh=Z3.postPerformanceEvent.bind(Z3),vo=new class extends bs{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,i,n){if(!st.API_URL||!st.SESSION_PATH)return;const s=Gr(st.API_URL+st.SESSION_PATH);s.params.push(`sku=${e||""}`),s.params.push(`access_token=${n||st.ACCESS_TOKEN||""}`);const l={url:Cs(s),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(c,d){return fn(ir(c,{method:"GET"}),d)}(l,c=>{this.pendingRequest=null,i(c),this.saveEventData(),this.processRequests(n)})}getSessionAPI(t,e,i,n){this.skuToken=e,this.errorCb=n,st.SESSION_PATH&&st.API_URL&&(i||st.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(nc)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,n=>{n?this.errorCb(n):e&&(this.success[e]=!0)},t)}remove(){this.errorCb=null}},oc=vo.getSessionAPI.bind(vo),Co=new Set;var ws={exports:{}},pa={exports:function(t,e){var i,n,s,l,c,d,f,_;for(n=t.length-(i=3&t.length),s=e,c=3432918353,d=461845907,_=0;_<n;)f=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24,++_,s=27492+(65535&(l=5*(65535&(s=(s^=f=(65535&(f=(f=(65535&f)*c+(((f>>>16)*c&65535)<<16)&4294967295)<<15|f>>>17))*d+(((f>>>16)*d&65535)<<16)&4294967295)<<13|s>>>19))+((5*(s>>>16)&65535)<<16)&4294967295))+((58964+(l>>>16)&65535)<<16);switch(f=0,i){case 3:f^=(255&t.charCodeAt(_+2))<<16;case 2:f^=(255&t.charCodeAt(_+1))<<8;case 1:s^=f=(65535&(f=(f=(65535&(f^=255&t.charCodeAt(_)))*c+(((f>>>16)*c&65535)<<16)&4294967295)<<15|f>>>17))*d+(((f>>>16)*d&65535)<<16)&4294967295}return s^=t.length,s=2246822507*(65535&(s^=s>>>16))+((2246822507*(s>>>16)&65535)<<16)&4294967295,s=3266489909*(65535&(s^=s>>>13))+((3266489909*(s>>>16)&65535)<<16)&4294967295,(s^=s>>>16)>>>0}},kh={exports:function(t,e){for(var i,n=t.length,s=e^n,l=0;n>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(l)|(255&t.charCodeAt(++l))<<8|(255&t.charCodeAt(++l))<<16|(255&t.charCodeAt(++l))<<24))+((1540483477*(i>>>16)&65535)<<16),s=1540483477*(65535&s)+((1540483477*(s>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++l;switch(n){case 3:s^=(255&t.charCodeAt(l+2))<<16;case 2:s^=(255&t.charCodeAt(l+1))<<8;case 1:s=1540483477*(65535&(s^=255&t.charCodeAt(l)))+((1540483477*(s>>>16)&65535)<<16)}return s=1540483477*(65535&(s^=s>>>13))+((1540483477*(s>>>16)&65535)<<16),(s^=s>>>15)>>>0}},$3=pa.exports,Bh=kh.exports;ws.exports=$3,ws.exports.murmur3=$3,ws.exports.murmur2=Bh;var Ll=dn(ws.exports);class mn{constructor(e,...i){ir(this,i[0]||{}),this.type=e}}class bo extends mn{constructor(e,i={}){super("error",ir({error:e},i))}}function kl(t,e,i){i[t]&&i[t].indexOf(e)!==-1||(i[t]=i[t]||[],i[t].push(e))}function lc(t,e,i){if(i&&i[t]){const n=i[t].indexOf(e);n!==-1&&i[t].splice(n,1)}}class As{on(e,i){return this._listeners=this._listeners||{},kl(e,i,this._listeners),this}off(e,i){return lc(e,i,this._listeners),lc(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},kl(e,i,this._oneTimeListeners),this):new Promise(n=>this.once(e,n))}fire(e,i){const n=typeof e=="string"?new mn(e,i):e,s=n.type;if(this.listens(s)){n.target=this;const l=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const f of l)f.call(this,n);const c=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const f of c)lc(s,f,this._oneTimeListeners),f.call(this,n);const d=this._eventedParent;d&&(ir(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),d.fire(n))}else n instanceof bo&&console.error(n.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}a.G=void 0;var G3={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Bl(t){return(t=Math.round(t))<0?0:t>255?255:t}function cc(t){return Bl(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Fl(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function uc(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{a.G={}.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in G3)return G3[i].slice();if(i[0]==="#")return i.length===4?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:i.length===7&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var n=i.indexOf("("),s=i.indexOf(")");if(n!==-1&&s+1===i.length){var l=i.substr(0,n),c=i.substr(n+1,s-(n+1)).split(","),d=1;switch(l){case"rgba":if(c.length!==4)return null;d=Fl(c.pop());case"rgb":return c.length!==3?null:[cc(c[0]),cc(c[1]),cc(c[2]),d];case"hsla":if(c.length!==4)return null;d=Fl(c.pop());case"hsl":if(c.length!==3)return null;var f=(parseFloat(c[0])%360+360)%360/360,_=Fl(c[1]),y=Fl(c[2]),v=y<=.5?y*(_+1):y+_-y*_,C=2*y-v;return[Bl(255*uc(C,v,f+1/3)),Bl(255*uc(C,v,f)),Bl(255*uc(C,v,f-1/3)),d];default:return null}}return null}}catch{}class Yt{constructor(e,i,n,s=1){this.r=e,this.g=i,this.b=n,this.a=s}static parse(e){if(!e)return;if(e instanceof Yt)return e;if(typeof e!="string")return;const i=a.G(e);return i?new Yt(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,n,s]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(n)},${s})`}toRenderColor(e){const{r:i,g:n,b:s,a:l}=this;return new Fh(e,i,n,s,l)}}class Fh{constructor(e,i,n,s,l){if(e){const c=e.image.height,d=c*c;i=l===0?0:i/l*(c-1),n=l===0?0:n/l*(c-1),s=l===0?0:s/l*(c-1);const f=Math.floor(i),_=Math.floor(n),y=Math.floor(s),v=Math.ceil(i),C=Math.ceil(n),A=Math.ceil(s),M=i-f,I=n-_,P=s-y,D=e.image.data,V=4*(f+_*d+y*c),N=4*(f+_*d+A*c),U=4*(f+C*d+y*c),X=4*(f+C*d+A*c),Y=4*(v+_*d+y*c),ee=4*(v+_*d+A*c),le=4*(v+C*d+y*c),pe=4*(v+C*d+A*c);if(V<0||pe>=D.length)throw new Error("out of range");this.r=lt(lt(lt(D[V],D[N],P),lt(D[U],D[X],P),I),lt(lt(D[Y],D[ee],P),lt(D[le],D[pe],P),I),M)/255*l,this.g=lt(lt(lt(D[V+1],D[N+1],P),lt(D[U+1],D[X+1],P),I),lt(lt(D[Y+1],D[ee+1],P),lt(D[le+1],D[pe+1],P),I),M)/255*l,this.b=lt(lt(lt(D[V+2],D[N+2],P),lt(D[U+2],D[X+2],P),I),lt(lt(D[Y+2],D[ee+2],P),lt(D[le+2],D[pe+2],P),I),M)/255*l,this.a=l}else this.r=i,this.g=n,this.b=s,this.a=l}toArray(){const{r:e,g:i,b:n,a:s}=this;return s===0?[0,0,0,0]:[255*e/s,255*i/s,255*n/s,s]}toArray01(){const{r:e,g:i,b:n,a:s}=this;return s===0?[0,0,0,0]:[e/s,i/s,n/s,s]}toArray01Scaled(e){const{r:i,g:n,b:s,a:l}=this;return l===0?[0,0,0]:[i/l*e,n/l*e,s/l*e]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:n,a:s}=this;return[e,i,n,s]}toArray01Linear(){const{r:e,g:i,b:n,a:s}=this;return s===0?[0,0,0,0]:[Math.pow(e/s,2.2),Math.pow(i/s,2.2),Math.pow(n/s,2.2),s]}}function lt(t,e,i){return t*(1-i)+e*i}function hc(t,e,i){return t.map((n,s)=>lt(n,e[s],i))}Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1),Yt.blue=new Yt(0,0,1,1);var wo=Object.freeze({__proto__:null,array:hc,color:function(t,e,i){return new Yt(lt(t.r,e.r,i),lt(t.g,e.g,i),lt(t.b,e.b,i),lt(t.a,e.a,i))},number:lt});function fa(t,...e){for(const i of e)for(const n in i)t[n]=i[n];return t}class _n extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class dc{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[n,s]of i)this.bindings[n]=s}concat(e){return new dc(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Ir={kind:"null"},Ye={kind:"number"},Vt={kind:"string"},Kt={kind:"boolean"},qr={kind:"color"},ma={kind:"object"},Wt={kind:"value"},jl={kind:"collator"},_a={kind:"formatted"},Ts={kind:"resolvedImage"};function ar(t,e){return{kind:"array",itemType:t,N:e}}function Si(t){if(t.kind==="array"){const e=Si(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const pc=[Ir,Ye,Vt,Kt,qr,_a,ma,ar(Wt),Ts];function Ao(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Ao(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const i of pc)if(!Ao(i,e))return null}}return`Expected ${Si(t)} but found ${Si(e)} instead.`}function Wr(t,e){return e.some(i=>i.kind===t.kind)}function To(t,e){return e.some(i=>i==="null"?t===null:i==="array"?Array.isArray(t):i==="object"?t&&!Array.isArray(t)&&typeof t=="object":i===typeof t)}class Nl{constructor(e,i,n){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vl{constructor(e,i,n,s,l){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=n,this.fontStack=s,this.textColor=l}}class _r{constructor(e){this.sections=e}static fromString(e){return new _r([new Vl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof _r?e:_r.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.namePrimary]);continue}e.push(i.text);const n={};i.fontStack&&(n["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(n["font-scale"]=i.scale),i.textColor&&(n["text-color"]=["rgba"].concat(i.textColor.toRenderColor(null).toArray())),e.push(n)}return e}}class Pr{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,i){return e?new Pr({namePrimary:e,nameSecondary:i,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function q3(t,e,i,n){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?n===void 0||typeof n=="number"&&n>=0&&n<=1?null:`Invalid rgba value [${[t,e,i,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof n=="number"?[t,e,i,n]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ga(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Yt||t instanceof Nl||t instanceof _r||t instanceof Pr)return!0;if(Array.isArray(t)){for(const e of t)if(!ga(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!ga(t[e]))return!1;return!0}return!1}function Vi(t){if(t===null)return Ir;if(typeof t=="string")return Vt;if(typeof t=="boolean")return Kt;if(typeof t=="number")return Ye;if(t instanceof Yt)return qr;if(t instanceof Nl)return jl;if(t instanceof _r)return _a;if(t instanceof Pr)return Ts;if(Array.isArray(t)){const e=t.length;let i;for(const n of t){const s=Vi(n);if(i){if(i===s)continue;i=Wt;break}i=s}return ar(i||Wt,e)}return ma}function sn(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Yt||t instanceof _r||t instanceof Pr?t.toString():JSON.stringify(t)}class an{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ga(e[1]))return i.error("invalid value");const n=e[1];let s=Vi(n);const l=i.expectedType;return s.kind!=="array"||s.N!==0||!l||l.kind!=="array"||typeof l.N=="number"&&l.N!==0||(s=l),new an(s,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Yt?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof _r?this.value.serialize():this.value}}class Zi{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const fc={string:Vt,number:Ye,boolean:Kt,object:ma};class Or{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let n,s=1;const l=e[0];if(l==="array"){let d,f;if(e.length>2){const _=e[1];if(typeof _!="string"||!(_ in fc)||_==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);d=fc[_],s++}else d=Wt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);f=e[2],s++}n=ar(d,f)}else n=fc[l];const c=[];for(;s<e.length;s++){const d=i.parse(e[s],s,Wt);if(!d)return null;c.push(d)}return new Or(n,c)}evaluate(e){for(let i=0;i<this.args.length;i++){const n=this.args[i].evaluate(e);if(!Ao(this.type,Vi(n)))return n;if(i===this.args.length-1)throw new Zi(`The expression ${JSON.stringify(this.args[i].serialize())} evaluated to ${Si(Vi(n))} but was expected to be of type ${Si(this.type)}.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const n=e.itemType;if(n.kind==="string"||n.kind==="number"||n.kind==="boolean"){i.push(n.kind);const s=e.N;(typeof s=="number"||this.args.length>1)&&i.push(s)}}return i.concat(this.args.map(n=>n.serialize()))}}class Ms{constructor(e){this.type=_a,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&typeof n=="object")return i.error("First argument must be an image or text section.");const s=[];let l=!1;for(let c=1;c<=e.length-1;++c){const d=e[c];if(l&&typeof d=="object"&&!Array.isArray(d)){l=!1;let f=null;if(d["font-scale"]&&(f=i.parse(d["font-scale"],1,Ye),!f))return null;let _=null;if(d["text-font"]&&(_=i.parse(d["text-font"],1,ar(Vt)),!_))return null;let y=null;if(d["text-color"]&&(y=i.parse(d["text-color"],1,qr),!y))return null;const v=s[s.length-1];v.scale=f,v.font=_,v.textColor=y}else{const f=i.parse(e[c],1,Wt);if(!f)return null;const _=f.type.kind;if(_!=="string"&&_!=="value"&&_!=="null"&&_!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");l=!0,s.push({content:f,scale:null,font:null,textColor:null})}}return new Ms(s)}evaluate(e){return new _r(this.sections.map(i=>{const n=i.content.evaluate(e);return Vi(n)===Ts?new Vl("",n,null,null,null):new Vl(sn(n),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const n={};i.scale&&(n["font-scale"]=i.scale.serialize()),i.font&&(n["text-font"]=i.font.serialize()),i.textColor&&(n["text-color"]=i.textColor.serialize()),e.push(n)}return e}}class Mn{constructor(e,i){this.type=Ts,this.inputPrimary=e,this.inputSecondary=i}static parse(e,i){if(e.length<2)return i.error("Expected two or more arguments.");const n=i.parse(e[1],1,Vt);if(!n)return i.error("No image name provided.");if(e.length===2)return new Mn(n);const s=i.parse(e[2],1,Vt);return s?new Mn(n,s):i.error("Secondary image variant is not a string.")}evaluate(e){const i=Pr.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(i.namePrimary)>-1,i.nameSecondary&&i.available&&e.availableImages&&(i.available=e.availableImages.indexOf(i.nameSecondary)>-1)),i}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Qn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}const jh={"to-boolean":Kt,"to-color":qr,"to-number":Ye,"to-string":Vt};class Sn{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const n=e[0],s=[];let l=Ir;if(n==="to-array"){if(!Array.isArray(e[1]))return null;const c=e[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);l=ar(i.expectedType.itemType,c)}else{if(!(c>0&&ga(e[1][0])))return null;l=ar(Vi(e[1][0]),c)}for(let d=0;d<c;d++){const f=e[1][d];let _;if(Qn(f)==="array")_=i.parse(f,void 0,l.itemType);else{const y=Qn(f);if(y!==l.itemType.kind)return i.error(`Expected ${l.itemType.kind} but found ${y}.`);_=i.registry.literal.parse(["literal",f===void 0?null:f],i)}if(!_)return null;s.push(_)}}else{if((n==="to-boolean"||n==="to-string")&&e.length!==2)return i.error("Expected one argument.");l=jh[n];for(let c=1;c<e.length;c++){const d=i.parse(e[c],c,Wt);if(!d)return null;s.push(d)}}return new Sn(l,s)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let i,n;for(const s of this.args){if(i=s.evaluate(e),n=null,i instanceof Yt)return i;if(typeof i=="string"){const l=e.parseColor(i);if(l)return l}else if(Array.isArray(i)&&(n=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:q3(i[0],i[1],i[2],i[3]),!n))return new Yt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Zi(n||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const n of this.args){if(i=n.evaluate(e),i===null)return 0;const s=Number(i);if(!isNaN(s))return s}throw new Zi(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?_r.fromString(sn(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Pr.fromString(sn(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(i=>i.evaluate(e)):sn(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ms([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Mn(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Nh=["Unknown","Point","LineString","Polygon"];class mc{constructor(e,i){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=i}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Nh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:n,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*i-e[0])+this.featureDistanceData.bearing[1]*(s*i-e[1])}return 0}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=Yt.parse(e)),i}getConfig(e){return this.options?this.options.get(e):null}}class wr{constructor(e,i,n,s,l){this.name=e,this.type=i,this._evaluate=n,this.args=s,this._overloadIndex=l}evaluate(e){if(!this._evaluate){const i=wr.definitions[this.name];this._evaluate=Array.isArray(i)?i[2]:i.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const n=e[0],s=wr.definitions[n];if(!s)return i.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const l=Array.isArray(s)?s[0]:s.type,c=Array.isArray(s)?[[s[1],s[2]]]:s.overloads,d=[];let f=null,_=-1;for(const[y,v]of c){if(Array.isArray(y)&&y.length!==e.length-1)continue;d.push(y),_++,f=new cu(i.registry,i.path,null,i.scope,void 0,i._scope,i.options);const C=[];let A=!1;for(let M=1;M<e.length;M++){const I=e[M],P=Array.isArray(y)?y[M-1]:y.type,D=f.parse(I,1+C.length,P);if(!D){A=!0;break}C.push(D)}if(!A)if(Array.isArray(y)&&y.length!==C.length)f.error(`Expected ${y.length} arguments, but found ${C.length} instead.`);else{for(let M=0;M<C.length;M++){const I=Array.isArray(y)?y[M]:y.type,P=C[M];f.concat(M+1).checkSubtype(I,P.type)}if(f.errors.length===0)return new wr(n,l,v,C,_)}}if(d.length===1)i.errors.push(...f.errors);else{const y=(d.length?d:c.map(([C])=>C)).map(Vh).join(" | "),v=[];for(let C=1;C<e.length;C++){const A=i.parse(e[C],1+v.length);if(!A)return null;v.push(Si(A.type))}i.error(`Expected arguments of type ${y}, but found (${v.join(", ")}) instead.`)}return null}static register(e,i){wr.definitions=i;for(const n in i)e[n]=wr}}function Vh(t){return Array.isArray(t)?`(${t.map(Si).join(", ")})`:`(${Si(t.type)}...)`}class Mo{constructor(e,i,n){this.type=jl,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const n=e[1];if(typeof n!="object"||Array.isArray(n))return i.error("Collator options argument must be an object.");const s=i.parse(n["case-sensitive"]!==void 0&&n["case-sensitive"],1,Kt);if(!s)return null;const l=i.parse(n["diacritic-sensitive"]!==void 0&&n["diacritic-sensitive"],1,Kt);if(!l)return null;let c=null;return n.locale&&(c=i.parse(n.locale,1,Vt),!c)?null:new Mo(s,l,c)}evaluate(e){return new Nl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}function Jt(t,e,i=0,n=t.length-1,s=W3){for(;n>i;){if(n-i>600){const f=n-i+1,_=e-i+1,y=Math.log(f),v=.5*Math.exp(2*y/3),C=.5*Math.sqrt(y*v*(f-v)/f)*(_-f/2<0?-1:1);Jt(t,e,Math.max(i,Math.floor(e-_*v/f+C)),Math.min(n,Math.floor(e+(f-_)*v/f+C)),s)}const l=t[e];let c=i,d=n;for(ya(t,i,e),s(t[n],l)>0&&ya(t,i,n);c<d;){for(ya(t,c,d),c++,d--;s(t[c],l)<0;)c++;for(;s(t[d],l)>0;)d--}s(t[i],l)===0?ya(t,i,d):(d++,ya(t,d,n)),d<=e&&(i=d+1),e<=d&&(n=d-1)}}function ya(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function W3(t,e){return t<e?-1:t>e?1:0}function Uh(t){let e=0;for(let i,n,s=0,l=t.length,c=l-1;s<l;c=s++)i=t[s],n=t[c],e+=(n.x-i.x)*(i.y+n.y);return e}function So(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function es(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ul(t,e,i){const n=t[0]-e[0],s=t[1]-e[1],l=t[0]-i[0],c=t[1]-i[1];return n*c-l*s==0&&n*l<=0&&s*c<=0}function En(t,e,i=!1){let n=!1;for(let d=0,f=e.length;d<f;d++){const _=e[d];for(let y=0,v=_.length,C=v-1;y<v;C=y++){const A=_[C],M=_[y];if(Ul(t,A,M))return i;(l=A)[1]>(s=t)[1]!=(c=M)[1]>s[1]&&s[0]<(c[0]-l[0])*(s[1]-l[1])/(c[1]-l[1])+l[0]&&(n=!n)}}var s,l,c;return n}function H3(t,e,i,n){const s=n[0]-i[0],l=n[1]-i[1],c=(t[0]-i[0])*l-s*(t[1]-i[1]),d=(e[0]-i[0])*l-s*(e[1]-i[1]);return c>0&&d<0||c<0&&d>0}function Eo(t,e,i,n){return(s=[n[0]-i[0],n[1]-i[1]])[0]*(l=[e[0]-t[0],e[1]-t[1]])[1]-s[1]*l[0]!=0&&!(!H3(t,e,i,n)||!H3(i,n,t,e));var s,l}const or=8192;function Zh(t,e){const i=(180+t[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,s=Math.pow(2,e.z);return[Math.round(i*s*or),Math.round(n*s*or)]}function X3(t,e){for(let i=0;i<e.length;i++)if(En(t,e[i]))return!0;return!1}function Io(t,e,i){for(const n of i)for(let s=0,l=n.length,c=l-1;s<l;c=s++)if(Eo(t,e,n[c],n[s]))return!0;return!1}function Zl(t,e){for(let i=0;i<t.length;++i)if(!En(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Io(t[i],t[i+1],e))return!1;return!0}function $h(t,e){for(let i=0;i<e.length;i++)if(Zl(t,e[i]))return!0;return!1}function _c(t,e,i){const n=[];for(let s=0;s<t.length;s++){const l=[];for(let c=0;c<t[s].length;c++){const d=Zh(t[s][c],i);So(e,d),l.push(d)}n.push(l)}return n}function Y3(t,e,i){const n=[];for(let s=0;s<t.length;s++){const l=_c(t[s],e,i);n.push(l)}return n}function gc(t,e,i,n){if(t[0]<i[0]||t[0]>i[2]){const s=.5*n;let l=t[0]-i[0]>s?-n:i[0]-t[0]>s?n:0;l===0&&(l=t[0]-i[2]>s?-n:i[2]-t[0]>s?n:0),t[0]+=l}So(e,t)}function $l(t,e,i,n){const s=Math.pow(2,n.z)*or,l=[n.x*or,n.y*or],c=[];if(!t)return c;for(const d of t)for(const f of d){const _=[f.x+l[0],f.y+l[1]];gc(_,e,i,s),c.push(_)}return c}function J3(t,e,i,n){const s=Math.pow(2,n.z)*or,l=[n.x*or,n.y*or],c=[];if(!t)return c;for(const f of t){const _=[];for(const y of f){const v=[y.x+l[0],y.y+l[1]];So(e,v),_.push(v)}c.push(_)}if(e[2]-e[0]<=s/2){(d=e)[0]=d[1]=1/0,d[2]=d[3]=-1/0;for(const f of c)for(const _ of f)gc(_,e,i,s)}var d;return c}class gn{constructor(e,i){this.type=Kt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ga(e[1])){const n=e[1];if(n.type==="FeatureCollection")for(let s=0;s<n.features.length;++s){const l=n.features[s].geometry.type;if(l==="Polygon"||l==="MultiPolygon")return new gn(n,n.features[s].geometry)}else if(n.type==="Feature"){const s=n.geometry.type;if(s==="Polygon"||s==="MultiPolygon")return new gn(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new gn(n,n)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(i,n){const s=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],c=i.canonicalID();if(!c)return!1;if(n.type==="Polygon"){const d=_c(n.coordinates,l,c),f=$l(i.geometry(),s,l,c);if(!es(s,l))return!1;for(const _ of f)if(!En(_,d))return!1}if(n.type==="MultiPolygon"){const d=Y3(n.coordinates,l,c),f=$l(i.geometry(),s,l,c);if(!es(s,l))return!1;for(const _ of f)if(!X3(_,d))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(i,n){const s=[1/0,1/0,-1/0,-1/0],l=[1/0,1/0,-1/0,-1/0],c=i.canonicalID();if(!c)return!1;if(n.type==="Polygon"){const d=_c(n.coordinates,l,c),f=J3(i.geometry(),s,l,c);if(!es(s,l))return!1;for(const _ of f)if(!Zl(_,d))return!1}if(n.type==="MultiPolygon"){const d=Y3(n.coordinates,l,c),f=J3(i.geometry(),s,l,c);if(!es(s,l))return!1;for(const _ of f)if(!$h(_,d))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Gl={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},K3=1/298.257223563,Q3=K3*(2-K3),Po=Math.PI/180;class Oo{static fromTile(e,i,n){const s=Math.PI*(1-2*(e+.5)/Math.pow(2,i)),l=Math.atan(.5*(Math.exp(s)-Math.exp(-s)))/Po;return new Oo(l,n)}static get units(){return Gl}constructor(e,i){if(e===void 0)throw new Error("No latitude given.");if(i&&!Gl[i])throw new Error(`Unknown unit ${i}. Use one of: ${Object.keys(Gl).join(", ")}`);const n=6378.137*Po*(i?Gl[i]:1),s=Math.cos(e*Po),l=1/(1-Q3*(1-s*s)),c=Math.sqrt(l);this.kx=n*c*s,this.ky=n*c*l*(1-Q3)}distance(e,i){const n=zr(e[0]-i[0])*this.kx,s=(e[1]-i[1])*this.ky;return Math.sqrt(n*n+s*s)}bearing(e,i){const n=zr(i[0]-e[0])*this.kx;return Math.atan2(n,(i[1]-e[1])*this.ky)/Po}destination(e,i,n){const s=n*Po;return this.offset(e,Math.sin(s)*i,Math.cos(s)*i)}offset(e,i,n){return[e[0]+i/this.kx,e[1]+n/this.ky]}lineDistance(e){let i=0;for(let n=0;n<e.length-1;n++)i+=this.distance(e[n],e[n+1]);return i}area(e){let i=0;for(let n=0;n<e.length;n++){const s=e[n];for(let l=0,c=s.length,d=c-1;l<c;d=l++)i+=zr(s[l][0]-s[d][0])*(s[l][1]+s[d][1])*(n?-1:1)}return Math.abs(i)/2*this.kx*this.ky}along(e,i){let n=0;if(i<=0)return e[0];for(let s=0;s<e.length-1;s++){const l=e[s],c=e[s+1],d=this.distance(l,c);if(n+=d,n>i)return yc(l,c,(i-(n-d))/d)}return e[e.length-1]}pointToSegmentDistance(e,i,n){let[s,l]=i,c=zr(n[0]-s)*this.kx,d=(n[1]-l)*this.ky;if(c!==0||d!==0){const f=(zr(e[0]-s)*this.kx*c+(e[1]-l)*this.ky*d)/(c*c+d*d);f>1?(s=n[0],l=n[1]):f>0&&(s+=c/this.kx*f,l+=d/this.ky*f)}return c=zr(e[0]-s)*this.kx,d=(e[1]-l)*this.ky,Math.sqrt(c*c+d*d)}pointOnLine(e,i){let n=1/0,s=e[0][0],l=e[0][1],c=0,d=0;for(let f=0;f<e.length-1;f++){let _=e[f][0],y=e[f][1],v=zr(e[f+1][0]-_)*this.kx,C=(e[f+1][1]-y)*this.ky,A=0;v===0&&C===0||(A=(zr(i[0]-_)*this.kx*v+(i[1]-y)*this.ky*C)/(v*v+C*C),A>1?(_=e[f+1][0],y=e[f+1][1]):A>0&&(_+=v/this.kx*A,y+=C/this.ky*A)),v=zr(i[0]-_)*this.kx,C=(i[1]-y)*this.ky;const M=v*v+C*C;M<n&&(n=M,s=_,l=y,c=f,d=A)}return{point:[s,l],index:c,t:Math.max(0,Math.min(1,d))}}lineSlice(e,i,n){let s=this.pointOnLine(n,e),l=this.pointOnLine(n,i);if(s.index>l.index||s.index===l.index&&s.t>l.t){const _=s;s=l,l=_}const c=[s.point],d=s.index+1,f=l.index;!eu(n[d],c[0])&&d<=f&&c.push(n[d]);for(let _=d+1;_<=f;_++)c.push(n[_]);return eu(n[f],l.point)||c.push(l.point),c}lineSliceAlong(e,i,n){let s=0;const l=[];for(let c=0;c<n.length-1;c++){const d=n[c],f=n[c+1],_=this.distance(d,f);if(s+=_,s>e&&l.length===0&&l.push(yc(d,f,(e-(s-_))/_)),s>=i)return l.push(yc(d,f,(i-(s-_))/_)),l;s>e&&l.push(f)}return l}bufferPoint(e,i){const n=i/this.ky,s=i/this.kx;return[e[0]-s,e[1]-n,e[0]+s,e[1]+n]}bufferBBox(e,i){const n=i/this.ky,s=i/this.kx;return[e[0]-s,e[1]-n,e[2]+s,e[3]+n]}insideBBox(e,i){return zr(e[0]-i[0])>=0&&zr(e[0]-i[2])<=0&&e[1]>=i[1]&&e[1]<=i[3]}}function eu(t,e){return t[0]===e[0]&&t[1]===e[1]}function yc(t,e,i){const n=zr(e[0]-t[0]);return[t[0]+n*i,t[1]+(e[1]-t[1])*i]}function zr(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}class ts{constructor(e=[],i=(n,s)=>n<s?-1:n>s?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:n}=this,s=i[e];for(;e>0;){const l=e-1>>1,c=i[l];if(n(s,c)>=0)break;i[e]=c,e=l}i[e]=s}_down(e){const{data:i,compare:n}=this,s=this.length>>1,l=i[e];for(;e<s;){let c=1+(e<<1);const d=c+1;if(d<this.length&&n(i[d],i[c])<0&&(c=d),n(i[c],l)>=0)break;i[e]=i[c],e=c}i[e]=l}}var je=8192;function tu(t,e){return e.dist-t.dist}const zo=100,xc=50;function iu(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function ql(t){return t[1]-t[0]+1}function In(t,e){const i=t[1]>=t[0]&&t[1]<e;return i||console.warn("Distance Expression: Index is out of range"),i}function vc(t,e){if(t[0]>t[1])return[null,null];const i=ql(t);if(e){if(i===2)return[t,null];const n=Math.floor(i/2);return[[t[0],t[0]+n],[t[0]+n,t[1]]]}{if(i===1)return[t,null];const n=Math.floor(i/2)-1;return[[t[0],t[0]+n],[t[0]+n+1,t[1]]]}}function Dr(t,e){const i=[1/0,1/0,-1/0,-1/0];if(!In(e,t.length))return i;for(let n=e[0];n<=e[1];++n)So(i,t[n]);return i}function Wl(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0;i<t.length;++i)for(let n=0;n<t[i].length;++n)So(e,t[i][n]);return e}function xa(t,e,i){if(iu(t)||iu(e))return NaN;let n=0,s=0;return t[2]<e[0]&&(n=e[0]-t[2]),t[0]>e[2]&&(n=t[0]-e[2]),t[1]>e[3]&&(s=t[1]-e[3]),t[3]<e[1]&&(s=e[1]-t[3]),i.distance([0,0],[n,s])}function ru(t){return 360*t-180}function nu(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Rr(t,e){const i=Math.pow(2,e.z),n=(t.y/je+e.y)/i;return[ru((t.x/je+e.x)/i),nu(n)]}function su(t,e){const i=[];for(let n=0;n<t.length;++n)i.push(Rr(t[n],e));return i}function au(t,e,i){const n=i.pointOnLine(e,t).point;return i.distance(t,n)}function Cc(t,e,i,n,s){const l=i.slice(n[0],n[1]+1);let c=1/0;for(let d=e[0];d<=e[1];++d)if((c=Math.min(c,au(t[d],l,s)))===0)return 0;return c}function va(t,e,i,n,s){const l=Math.min(s.pointToSegmentDistance(t,i,n),s.pointToSegmentDistance(e,i,n)),c=Math.min(s.pointToSegmentDistance(i,t,e),s.pointToSegmentDistance(n,t,e));return Math.min(l,c)}function Gh(t,e,i,n,s){if(!In(e,t.length)||!In(n,i.length))return NaN;let l=1/0;for(let c=e[0];c<e[1];++c)for(let d=n[0];d<n[1];++d){if(Eo(t[c],t[c+1],i[d],i[d+1]))return 0;l=Math.min(l,va(t[c],t[c+1],i[d],i[d+1],s))}return l}function qh(t,e,i,n,s){if(!In(e,t.length)||!In(n,i.length))return NaN;let l=1/0;for(let c=e[0];c<=e[1];++c)for(let d=n[0];d<=n[1];++d)if((l=Math.min(l,s.distance(t[c],i[d])))===0)return l;return l}function Wh(t,e,i){if(En(t,e,!0))return 0;let n=1/0;for(const s of e){const l=s.length;if(l<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(s[0]!==s[l-1]&&(n=Math.min(n,i.pointToSegmentDistance(t,s[l-1],s[0])))===0||(n=Math.min(n,au(t,s,i)))===0)return n}return n}function Hh(t,e,i,n){if(!In(e,t.length))return NaN;for(let l=e[0];l<=e[1];++l)if(En(t[l],i,!0))return 0;let s=1/0;for(let l=e[0];l<e[1];++l)for(const c of i)for(let d=0,f=c.length,_=f-1;d<f;_=d++){if(Eo(t[l],t[l+1],c[_],c[d]))return 0;s=Math.min(s,va(t[l],t[l+1],c[_],c[d],n))}return s}function ou(t,e){for(const i of t)for(let n=0;n<=i.length-1;++n)if(En(i[n],e,!0))return!0;return!1}function Hl(t,e,i,n=1/0){const s=Wl(t),l=Wl(e);if(n!==1/0&&xa(s,l,i)>=n)return n;if(es(s,l)){if(ou(t,e))return 0}else if(ou(e,t))return 0;let c=n;for(const d of t)for(let f=0,_=d.length,y=_-1;f<_;y=f++)for(const v of e)for(let C=0,A=v.length,M=A-1;C<A;M=C++){if(Eo(d[y],d[f],v[M],v[C]))return 0;c=Math.min(c,va(d[y],d[f],v[M],v[C],i))}return c}function Ss(t,e,i,n,s,l,c){if(l===null||c===null)return;const d=xa(Dr(n,l),Dr(s,c),i);d<e&&t.push({dist:d,range1:l,range2:c})}function Lr(t,e,i,n,s=1/0){let l=Math.min(n.distance(t[0],i[0][0]),s);if(l===0)return l;const c=new ts([{dist:0,range1:[0,t.length-1],range2:[0,0]}],tu),d=e?xc:zo,f=Wl(i);for(;c.length;){const _=c.pop();if(_.dist>=l)continue;const y=_.range1;if(ql(y)<=d){if(!In(y,t.length))return NaN;if(e){const v=Hh(t,y,i,n);if((l=Math.min(l,v))===0)return l}else for(let v=y[0];v<=y[1];++v){const C=Wh(t[v],i,n);if((l=Math.min(l,C))===0)return l}}else{const v=vc(y,e);if(v[0]!==null){const C=xa(Dr(t,v[0]),f,n);C<l&&c.push({dist:C,range1:v[0],range2:[0,0]})}if(v[1]!==null){const C=xa(Dr(t,v[1]),f,n);C<l&&c.push({dist:C,range1:v[1],range2:[0,0]})}}}return l}function Do(t,e,i,n,s,l=1/0){let c=Math.min(l,s.distance(t[0],i[0]));if(c===0)return c;const d=new ts([{dist:0,range1:[0,t.length-1],range2:[0,i.length-1]}],tu),f=e?xc:zo,_=n?xc:zo;for(;d.length;){const y=d.pop();if(y.dist>=c)continue;const v=y.range1,C=y.range2;if(ql(v)<=f&&ql(C)<=_){if(!In(v,t.length)||!In(C,i.length))return NaN;if(e&&n?c=Math.min(c,Gh(t,v,i,C,s)):e||n?e&&!n?c=Math.min(c,Cc(i,C,t,v,s)):!e&&n&&(c=Math.min(c,Cc(t,v,i,C,s))):c=Math.min(c,qh(t,v,i,C,s)),c===0)return c}else{const A=vc(v,e),M=vc(C,n);Ss(d,c,s,t,i,A[0],M[0]),Ss(d,c,s,t,i,A[0],M[1]),Ss(d,c,s,t,i,A[1],M[0]),Ss(d,c,s,t,i,A[1],M[1])}}return c}function bc(t,e,i,n,s=1/0){let l=s;const c=Dr(t,[0,t.length-1]);for(const d of i)if(!(l!==1/0&&xa(c,Dr(d,[0,d.length-1]),n)>=l)&&(l=Math.min(l,Do(t,e,d,!0,n,l)),l===0))return l;return l}function Xl(t,e,i,n,s=1/0){let l=s;const c=Dr(t,[0,t.length-1]);for(const d of i){if(l!==1/0&&xa(c,Wl(d),n)>=l)continue;const f=Lr(t,e,d,n,l);if(isNaN(f))return f;if((l=Math.min(l,f))===0)return l}return l}function wc(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class Es{constructor(e,i){this.type=Ye,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(ga(e[1])){const n=e[1];if(n.type==="FeatureCollection"){for(let s=0;s<n.features.length;++s)if(wc(n.features[s].geometry.type))return new Es(n,n.features[s].geometry)}else if(n.type==="Feature"){if(wc(n.geometry.type))return new Es(n,n.geometry)}else if(wc(n.type))return new Es(n,n)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const i=e.geometry(),n=e.canonicalID();if(i!=null&&n!=null){if(e.geometryType()==="Point")return function(s,l,c){const d=[];for(const _ of s)for(const y of _)d.push(Rr(y,l));const f=new Oo(d[0][1],"meters");return c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString"?Do(d,!1,c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",f):c.type==="MultiLineString"?bc(d,!1,c.coordinates,f):c.type==="Polygon"||c.type==="MultiPolygon"?Xl(d,!1,c.type==="Polygon"?[c.coordinates]:c.coordinates,f):null}(i,n,this.geometries);if(e.geometryType()==="LineString")return function(s,l,c){const d=[];for(const _ of s){const y=[];for(const v of _)y.push(Rr(v,l));d.push(y)}const f=new Oo(d[0][0][1],"meters");if(c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString")return bc(c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",d,f);if(c.type==="MultiLineString"){let _=1/0;for(let y=0;y<c.coordinates.length;y++){const v=bc(c.coordinates[y],!0,d,f,_);if(isNaN(v))return v;if((_=Math.min(_,v))===0)return _}return _}if(c.type==="Polygon"||c.type==="MultiPolygon"){let _=1/0;for(let y=0;y<d.length;y++){const v=Xl(d[y],!0,c.type==="Polygon"?[c.coordinates]:c.coordinates,f,_);if(isNaN(v))return v;if((_=Math.min(_,v))===0)return _}return _}return null}(i,n,this.geometries);if(e.geometryType()==="Polygon")return function(s,l,c){const d=[];for(const _ of function(y,v){const C=y.length;if(C<=1)return[y];const A=[];let M,I;for(let P=0;P<C;P++){const D=Uh(y[P]);D!==0&&(y[P].area=Math.abs(D),I===void 0&&(I=D<0),I===D<0?(M&&A.push(M),M=[y[P]]):M.push(y[P]))}return M&&A.push(M),A}(s)){const y=[];for(let v=0;v<_.length;++v)y.push(su(_[v],l));d.push(y)}const f=new Oo(d[0][0][0][1],"meters");if(c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString")return Xl(c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",d,f);if(c.type==="MultiLineString"){let _=1/0;for(let y=0;y<c.coordinates.length;y++){const v=Xl(c.coordinates[y],!0,d,f,_);if(isNaN(v))return v;if((_=Math.min(_,v))===0)return _}return _}return c.type==="Polygon"||c.type==="MultiPolygon"?function(_,y,v){let C=1/0;for(const A of _)for(const M of y){const I=Hl(A,M,v,C);if(isNaN(I))return I;if((C=Math.min(C,I))===0)return C}return C}(c.type==="Polygon"?[c.coordinates]:c.coordinates,d,f):null}(i,n,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Ro(t,e){switch(t){case"string":return sn(e);case"number":return+e;case"boolean":return!!e;case"color":return Yt.parse(e);case"formatted":return _r.fromString(sn(e));case"resolvedImage":return Pr.fromString(sn(e))}return e}function lu(t,e,i,n){return n!==void 0&&(t=n*Math.round(t/n)),e!==void 0&&t<e&&(t=e),i!==void 0&&t>i&&(t=i),t}class is{constructor(e,i,n){this.type=e,this.key=i,this.scope=n}static parse(e,i){let n=i.expectedType;if(n==null&&(n=Wt),e.length<2||e.length>3)return i.error("Invalid number of arguments for 'config' expression.");const s=i.parse(e[1],1);if(!(s instanceof an))return i.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){const l=i.parse(e[2],2);return l instanceof an?new is(n,sn(s.value),sn(l.value)):i.error("Scope of 'config' expression must be a string literal.")}return new is(n,sn(s.value))}evaluate(e){const i=[this.key,this.scope,e.scope].filter(Boolean).join(""),n=e.getConfig(i);if(!n)return null;const{type:s,value:l,values:c,minValue:d,maxValue:f,stepValue:_}=n,y=n.default.evaluate(e);let v=y;if(l){const C=e.scope;e.scope=(C||"").split("").slice(1).join(""),v=l.evaluate(e),e.scope=C}return s&&(v=Ro(s,v)),v===void 0||d===void 0&&f===void 0&&_===void 0||(typeof v=="number"?v=lu(v,d,f,_):Array.isArray(v)&&(v=v.map(C=>typeof C=="number"?lu(C,d,f,_):C))),l!==void 0&&v!==void 0&&c&&!c.includes(v)&&(v=y,s&&(v=Ro(s,v))),(s&&s!==this.type||v!==void 0&&Vi(v)!==this.type)&&(v=Ro(this.type.kind,v)),v}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.key),e}}function Lo(t){if(t instanceof wr&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof gn||t instanceof Es)return!1;let e=!0;return t.eachChild(i=>{e&&!Lo(i)&&(e=!1)}),e}function Yl(t){if(t instanceof wr&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(i=>{e&&!Yl(i)&&(e=!1)}),e}function ko(t){if(t instanceof is)return new Set([t.key]);let e=new Set;return t.eachChild(i=>{e=new Set([...e,...ko(i)])}),e}function Bo(t,e){if(t instanceof wr&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild(n=>{i&&!Bo(n,e)&&(i=!1)}),i}class Fo{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const n=e[1];return i.scope.has(n)?new Fo(n,i.scope.get(n)):i.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Jl{constructor(e,i=[],n,s=new dc,l=[],c,d){this.registry=e,this.path=i,this.key=i.map(f=>`[${f}]`).join(""),this.scope=s,this.errors=l,this.expectedType=n,this._scope=c,this.options=d}parse(e,i,n,s,l={}){return i||n?this.concat(i,n,s)._parse(e,l):this._parse(e,l)}_parse(e,i){function n(s,l,c){return c==="assert"?new Or(l,[s]):c==="coerce"?new Sn(l,[s]):s}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const s=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(s){let l=s.parse(e,this);if(!l)return null;if(this.expectedType){const c=this.expectedType,d=l.type;if(c.kind!=="string"&&c.kind!=="number"&&c.kind!=="boolean"&&c.kind!=="object"&&c.kind!=="array"||d.kind!=="value")if(c.kind!=="color"&&c.kind!=="formatted"&&c.kind!=="resolvedImage"||d.kind!=="value"&&d.kind!=="string"){if(this.checkSubtype(c,d))return null}else l=n(l,c,i.typeAnnotation||"coerce");else l=n(l,c,i.typeAnnotation||"assert")}if(!(l instanceof an)&&l.type.kind!=="resolvedImage"&&jo(l)){const c=new mc(this._scope,this.options);try{l=new an(l.type,l.evaluate(c))}catch(d){return this.error(d.message),null}}return l}return Sn.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,n){const s=typeof e=="number"?this.path.concat(e):this.path,l=n?this.scope.concat(n):this.scope;return new Jl(this.registry,s,i||null,l,this.errors,this._scope,this.options)}error(e,...i){const n=`${this.key}${i.map(s=>`[${s}]`).join("")}`;this.errors.push(new _n(n,e))}checkSubtype(e,i){const n=Ao(e,i);return n&&this.error(n),n}}var cu=Jl;function jo(t){if(t instanceof Fo)return jo(t.boundExpression);if(t instanceof wr&&t.name==="error"||t instanceof Mo||t instanceof gn||t instanceof Es||t instanceof is)return!1;const e=t instanceof Sn||t instanceof Or;let i=!0;return t.eachChild(n=>{i=e?i&&jo(n):i&&n instanceof an}),!!i&&Lo(t)&&Bo(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Is(t,e){const i=t.length-1;let n,s,l=0,c=i,d=0;for(;l<=c;)if(d=Math.floor((l+c)/2),n=t[d],s=t[d+1],n<=e){if(d===i||e<s)return d;l=d+1}else{if(!(n>e))throw new Zi("Input is not a number.");c=d-1}return 0}class Ca{constructor(e,i,n){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[s,l]of n)this.labels.push(s),this.outputs.push(l)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const n=i.parse(e[1],1,Ye);if(!n)return null;const s=[];let l=null;i.expectedType&&i.expectedType.kind!=="value"&&(l=i.expectedType);for(let c=1;c<e.length;c+=2){const d=c===1?-1/0:e[c],f=e[c+1],_=c,y=c+1;if(typeof d!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_);if(s.length&&s[s.length-1][0]>=d)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_);const v=i.parse(f,y,l);if(!v)return null;l=l||v.type,s.push([d,v])}return new Ca(l,n,s)}evaluate(e){const i=this.labels,n=this.outputs;if(i.length===1)return n[0].evaluate(e);const s=this.input.evaluate(e);if(s<=i[0])return n[0].evaluate(e);const l=i.length;return s>=i[l-1]?n[l-1].evaluate(e):n[Is(i,s)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}const uu=.95047,Ac=1.08883,hu=4/29,rs=6/29,du=3*rs*rs,Xh=rs*rs*rs,Yh=Math.PI/180,Jh=180/Math.PI;function Kl(t){return t>Xh?Math.pow(t,1/3):t/du+hu}function Tc(t){return t>rs?t*t*t:du*(t-hu)}function Mc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Sc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pu(t){const e=Sc(t.r),i=Sc(t.g),n=Sc(t.b),s=Kl((.4124564*e+.3575761*i+.1804375*n)/uu),l=Kl((.2126729*e+.7151522*i+.072175*n)/1);return{l:116*l-16,a:500*(s-l),b:200*(l-Kl((.0193339*e+.119192*i+.9503041*n)/Ac)),alpha:t.a}}function fu(t){let e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=1*Tc(e),i=uu*Tc(i),n=Ac*Tc(n),new Yt(Mc(3.2404542*i-1.5371385*e-.4985314*n),Mc(-.969266*i+1.8760108*e+.041556*n),Mc(.0556434*i-.2040259*e+1.0572252*n),t.alpha)}function Kh(t,e,i){const n=e-t;return t+i*(n>180||n<-180?n-360*Math.round(n/360):n)}const No={forward:pu,reverse:fu,interpolate:function(t,e,i){return{l:lt(t.l,e.l,i),a:lt(t.a,e.a,i),b:lt(t.b,e.b,i),alpha:lt(t.alpha,e.alpha,i)}}},Vo={forward:function(t){const{l:e,a:i,b:n}=pu(t),s=Math.atan2(n,i)*Jh;return{h:s<0?s+360:s,c:Math.sqrt(i*i+n*n),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Yh,i=t.c;return fu({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:Kh(t.h,e.h,i),c:lt(t.c,e.c,i),l:lt(t.l,e.l,i),alpha:lt(t.alpha,e.alpha,i)}}};var Uo=Object.freeze({__proto__:null,hcl:Vo,lab:No});class kr{constructor(e,i,n,s,l){this.type=e,this.operator=i,this.interpolation=n,this.input=s,this.labels=[],this.outputs=[];for(const[c,d]of l)this.labels.push(c),this.outputs.push(d)}static interpolationFactor(e,i,n,s){let l=0;if(e.name==="exponential")l=Ec(i,e.base,n,s);else if(e.name==="linear")l=Ec(i,1,n,s);else if(e.name==="cubic-bezier"){const c=e.controlPoints;l=new q1(c[0],c[1],c[2],c[3]).solve(Ec(i,1,n,s))}return l}static parse(e,i){let[n,s,l,...c]=e;if(!Array.isArray(s)||s.length===0)return i.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){const _=s[1];if(typeof _!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:_}}else{if(s[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(s[0])}`,1,0);{const _=s.slice(1);if(_.length!==4||_.some(y=>typeof y!="number"||y<0||y>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:_}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(l=i.parse(l,2,Ye),!l)return null;const d=[];let f=null;n==="interpolate-hcl"||n==="interpolate-lab"?f=qr:i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);for(let _=0;_<c.length;_+=2){const y=c[_],v=c[_+1],C=_+3,A=_+4;if(typeof y!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=y)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',C);const M=i.parse(v,A,f);if(!M)return null;f=f||M.type,d.push([y,M])}return f.kind==="number"||f.kind==="color"||f.kind==="array"&&f.itemType.kind==="number"&&typeof f.N=="number"?new kr(f,n,s,l,d):i.error(`Type ${Si(f)} is not interpolatable.`)}evaluate(e){const i=this.labels,n=this.outputs;if(i.length===1)return n[0].evaluate(e);const s=this.input.evaluate(e);if(s<=i[0])return n[0].evaluate(e);const l=i.length;if(s>=i[l-1])return n[l-1].evaluate(e);const c=Is(i,s),d=kr.interpolationFactor(this.interpolation,s,i[c],i[c+1]),f=n[c].evaluate(e),_=n[c+1].evaluate(e);return this.operator==="interpolate"?wo[this.type.kind.toLowerCase()](f,_,d):this.operator==="interpolate-hcl"?Vo.reverse(Vo.interpolate(Vo.forward(f),Vo.forward(_),d)):No.reverse(No.interpolate(No.forward(f),No.forward(_),d))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let n=0;n<this.labels.length;n++)i.push(this.labels[n],this.outputs[n].serialize());return i}}function Ec(t,e,i,n){const s=n-i,l=t-i;return s===0?0:e===1?l/s:(Math.pow(e,l)-1)/(Math.pow(e,s)-1)}class Ps{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let n=null;const s=i.expectedType;s&&s.kind!=="value"&&(n=s);const l=[];for(const d of e.slice(1)){const f=i.parse(d,1+l.length,n,void 0,{typeAnnotation:"omit"});if(!f)return null;n=n||f.type,l.push(f)}const c=s&&l.some(d=>Ao(s,d.type));return new Ps(c?Wt:n,l)}evaluate(e){let i,n=null,s=0;for(const l of this.args){if(s++,n=l.evaluate(e),n&&n instanceof Pr&&!n.available&&(i||(i=n),n=null,s===this.args.length))return i;if(n!==null)break}return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class Ql{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const n=[];for(let l=1;l<e.length-1;l+=2){const c=e[l];if(typeof c!="string")return i.error(`Expected string, but found ${typeof c} instead.`,l);if(/[^a-zA-Z0-9_]/.test(c))return i.error("Variable names must contain only alphanumeric characters or '_'.",l);const d=i.parse(e[l+1],l+1);if(!d)return null;n.push([c,d])}const s=i.parse(e[e.length-1],e.length-1,i.expectedType,n);return s?new Ql(n,s):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,n]of this.bindings)e.push(i,n.serialize());return e.push(this.result.serialize()),e}}class e1{constructor(e,i,n){this.type=e,this.index=i,this.input=n}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=i.parse(e[1],1,Ye),s=i.parse(e[2],2,ar(i.expectedType||Wt));return n&&s?new e1(s.type.itemType,n,s):null}evaluate(e){const i=this.index.evaluate(e),n=this.input.evaluate(e);if(i<0)throw new Zi(`Array index out of bounds: ${i} < 0.`);if(i>=n.length)throw new Zi(`Array index out of bounds: ${i} > ${n.length-1}.`);if(i!==Math.floor(i))throw new Zi(`Array index must be an integer, but found ${i} instead.`);return n[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Ic{constructor(e,i){this.type=Kt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=i.parse(e[1],1,Wt),s=i.parse(e[2],2,Wt);return n&&s?Wr(n.type,[Kt,Vt,Ye,Ir,Wt])?new Ic(n,s):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Si(n.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(n==null)return!1;if(!To(i,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${Si(Vi(i))} instead.`);if(!To(n,["string","array"]))throw new Zi(`Expected second argument to be of type array or string, but found ${Si(Vi(n))} instead.`);return n.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Zo{constructor(e,i,n){this.type=Ye,this.needle=e,this.haystack=i,this.fromIndex=n}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=i.parse(e[1],1,Wt),s=i.parse(e[2],2,Wt);if(!n||!s)return null;if(!Wr(n.type,[Kt,Vt,Ye,Ir,Wt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Si(n.type)} instead`);if(e.length===4){const l=i.parse(e[3],3,Ye);return l?new Zo(n,s,l):null}return new Zo(n,s)}evaluate(e){const i=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!To(i,["boolean","string","number","null"]))throw new Zi(`Expected first argument to be of type boolean, string, number or null, but found ${Si(Vi(i))} instead.`);if(!To(n,["string","array"]))throw new Zi(`Expected second argument to be of type array or string, but found ${Si(Vi(n))} instead.`);if(this.fromIndex){const s=this.fromIndex.evaluate(e);return n.indexOf(i,s)}return n.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class t1{constructor(e,i,n,s,l,c){this.inputType=e,this.type=i,this.input=n,this.cases=s,this.outputs=l,this.otherwise=c}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let n,s;i.expectedType&&i.expectedType.kind!=="value"&&(s=i.expectedType);const l={},c=[];for(let _=2;_<e.length-1;_+=2){let y=e[_];const v=e[_+1];Array.isArray(y)||(y=[y]);const C=i.concat(_);if(y.length===0)return C.error("Expected at least one branch label.");for(const M of y){if(typeof M!="number"&&typeof M!="string")return C.error("Branch labels must be numbers or strings.");if(typeof M=="number"&&Math.abs(M)>Number.MAX_SAFE_INTEGER)return C.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof M=="number"&&Math.floor(M)!==M)return C.error("Numeric branch labels must be integer values.");if(n){if(C.checkSubtype(n,Vi(M)))return null}else n=Vi(M);if(l[String(M)]!==void 0)return C.error("Branch labels must be unique.");l[String(M)]=c.length}const A=i.parse(v,_,s);if(!A)return null;s=s||A.type,c.push(A)}const d=i.parse(e[1],1,Wt);if(!d)return null;const f=i.parse(e[e.length-1],e.length-1,s);return f?d.type.kind!=="value"&&i.concat(1).checkSubtype(n,d.type)?null:new t1(n,s,d,l,c,f):null}evaluate(e){const i=this.input.evaluate(e);return(Vi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),n=[],s={};for(const c of i){const d=s[this.cases[c]];d===void 0?(s[this.cases[c]]=n.length,n.push([this.cases[c],[c]])):n[d][1].push(c)}const l=c=>this.inputType.kind==="number"?Number(c):c;for(const[c,d]of n)e.push(d.length===1?l(d[0]):d.map(l)),e.push(this.outputs[c].serialize());return e.push(this.otherwise.serialize()),e}}class i1{constructor(e,i,n){this.type=e,this.branches=i,this.otherwise=n}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let n;i.expectedType&&i.expectedType.kind!=="value"&&(n=i.expectedType);const s=[];for(let c=1;c<e.length-1;c+=2){const d=i.parse(e[c],c,Kt);if(!d)return null;const f=i.parse(e[c+1],c+1,n);if(!f)return null;s.push([d,f]),n=n||f.type}const l=i.parse(e[e.length-1],e.length-1,n);return l?new i1(n,s,l):null}evaluate(e){for(const[i,n]of this.branches)if(i.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,n]of this.branches)e(i),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class $o{constructor(e,i,n,s){this.type=e,this.input=i,this.beginIndex=n,this.endIndex=s}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=i.parse(e[1],1,Wt),s=i.parse(e[2],2,Ye);if(!n||!s)return null;if(!Wr(n.type,[ar(Wt),Vt,Wt]))return i.error(`Expected first argument to be of type array or string, but found ${Si(n.type)} instead`);if(e.length===4){const l=i.parse(e[3],3,Ye);return l?new $o(n.type,n,s,l):null}return new $o(n.type,n,s)}evaluate(e){const i=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!To(i,["string","array"]))throw new Zi(`Expected first argument to be of type array or string, but found ${Si(Vi(i))} instead.`);if(this.endIndex){const s=this.endIndex.evaluate(e);return i.slice(n,s)}return i.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function r1(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function n1(t,e,i,n){return n.compare(e,i)===0}function ba(t,e,i){const n=t!=="=="&&t!=="!=";return class _4{constructor(l,c,d){this.type=Kt,this.lhs=l,this.rhs=c,this.collator=d,this.hasUntypedArgument=l.type.kind==="value"||c.type.kind==="value"}static parse(l,c){if(l.length!==3&&l.length!==4)return c.error("Expected two or three arguments.");const d=l[0];let f=c.parse(l[1],1,Wt);if(!f)return null;if(!r1(d,f.type))return c.concat(1).error(`"${d}" comparisons are not supported for type '${Si(f.type)}'.`);let _=c.parse(l[2],2,Wt);if(!_)return null;if(!r1(d,_.type))return c.concat(2).error(`"${d}" comparisons are not supported for type '${Si(_.type)}'.`);if(f.type.kind!==_.type.kind&&f.type.kind!=="value"&&_.type.kind!=="value")return c.error(`Cannot compare types '${Si(f.type)}' and '${Si(_.type)}'.`);n&&(f.type.kind==="value"&&_.type.kind!=="value"?f=new Or(_.type,[f]):f.type.kind!=="value"&&_.type.kind==="value"&&(_=new Or(f.type,[_])));let y=null;if(l.length===4){if(f.type.kind!=="string"&&_.type.kind!=="string"&&f.type.kind!=="value"&&_.type.kind!=="value")return c.error("Cannot use collator to compare non-string types.");if(y=c.parse(l[3],3,jl),!y)return null}return new _4(f,_,y)}evaluate(l){const c=this.lhs.evaluate(l),d=this.rhs.evaluate(l);if(n&&this.hasUntypedArgument){const f=Vi(c),_=Vi(d);if(f.kind!==_.kind||f.kind!=="string"&&f.kind!=="number")throw new Zi(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${f.kind}, ${_.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const f=Vi(c),_=Vi(d);if(f.kind!=="string"||_.kind!=="string")return e(l,c,d)}return this.collator?i(l,c,d,this.collator.evaluate(l)):e(l,c,d)}eachChild(l){l(this.lhs),l(this.rhs),this.collator&&l(this.collator)}outputDefined(){return!0}serialize(){const l=[t];return this.eachChild(c=>{l.push(c.serialize())}),l}}}const Qh=ba("==",function(t,e,i){return e===i},n1),mu=ba("!=",function(t,e,i){return e!==i},function(t,e,i,n){return!n1(0,e,i,n)}),e2=ba("<",function(t,e,i){return e<i},function(t,e,i,n){return n.compare(e,i)<0}),t2=ba(">",function(t,e,i){return e>i},function(t,e,i,n){return n.compare(e,i)>0}),i2=ba("<=",function(t,e,i){return e<=i},function(t,e,i,n){return n.compare(e,i)<=0}),r2=ba(">=",function(t,e,i){return e>=i},function(t,e,i,n){return n.compare(e,i)>=0});class Pc{constructor(e,i,n,s,l,c){this.type=Vt,this.number=e,this.locale=i,this.currency=n,this.unit=s,this.minFractionDigits=l,this.maxFractionDigits=c}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const n=i.parse(e[1],1,Ye);if(!n)return null;const s=e[2];if(typeof s!="object"||Array.isArray(s))return i.error("NumberFormat options argument must be an object.");let l=null;if(s.locale&&(l=i.parse(s.locale,1,Vt),!l))return null;let c=null;if(s.currency&&(c=i.parse(s.currency,1,Vt),!c))return null;let d=null;if(s.unit&&(d=i.parse(s.unit,1,Vt),!d))return null;let f=null;if(s["min-fraction-digits"]&&(f=i.parse(s["min-fraction-digits"],1,Ye),!f))return null;let _=null;return s["max-fraction-digits"]&&(_=i.parse(s["max-fraction-digits"],1,Ye),!_)?null:new Pc(n,l,c,d,f,_)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Oc{constructor(e){this.type=Ye,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const n=i.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Si(n.type)} instead.`):new Oc(n):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Zi(`Expected value to be of type string or array, but found ${Si(Vi(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}function _u(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const wa={"==":Qh,"!=":mu,">":t2,"<":e2,">=":r2,"<=":i2,array:Or,at:e1,boolean:Or,case:i1,coalesce:Ps,collator:Mo,format:Ms,image:Mn,in:Ic,"index-of":Zo,interpolate:kr,"interpolate-hcl":kr,"interpolate-lab":kr,length:Oc,let:Ql,literal:an,match:t1,number:Or,"number-format":Pc,object:Or,slice:$o,step:Ca,string:Or,"to-boolean":Sn,"to-color":Sn,"to-number":Sn,"to-string":Sn,var:Fo,within:gn,distance:Es,config:is};function gu(t,[e,i,n,s]){e=e.evaluate(t),i=i.evaluate(t),n=n.evaluate(t);const l=s?s.evaluate(t):1,c=q3(e,i,n,l);if(c)throw new Zi(c);return new Yt(e/255*l,i/255*l,n/255*l,l)}function n2(t,[e,i,n,s]){e=e.evaluate(t),i=i.evaluate(t),n=n.evaluate(t);const l=s?s.evaluate(t):1,c=function(_,y,v,C){return typeof _=="number"&&_>=0&&_<=360?typeof y=="number"&&y>=0&&y<=100&&typeof v=="number"&&v>=0&&v<=100?C===void 0||typeof C=="number"&&C>=0&&C<=1?null:`Invalid hsla value [${[_,y,v,C].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof C=="number"?[_,y,v,C]:[_,y,v]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof C=="number"?[_,y,v,C]:[_,y,v]).join(", ")}]: 'h' must be between 0 and 360.`}(e,i,n,l);if(c)throw new Zi(c);const d=`hsla(${e}, ${i}%, ${n}%, ${l})`,f=Yt.parse(d);if(!f)throw new Zi(`Failed to parse HSLA color: ${d}`);return f}function u(t,e){return t in e}function r(t,e){const i=e[t];return i===void 0?null:i}function o(t){return{type:t}}function h(t){return{result:"success",value:t}}function p(t){return{result:"error",value:t}}function m(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function g(t){return t["property-type"]==="data-driven"}function x(t){return m(t.expression,"measure-light")}function b(t){return m(t.expression,"zoom")}function w(t){return!!t.expression&&t.expression.interpolated}function T(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function E(t){return t}function O(t,e){const i=e.type==="color",n=t.stops&&typeof t.stops[0][0]=="object",s=n||!(n||t.property!==void 0),l=t.type||(w(e)?"exponential":"interval");if(i&&((t=fa({},t)).stops&&(t.stops=t.stops.map(_=>[_[0],Yt.parse(_[1])])),t.default=Yt.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!Uo[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let c,d,f;if(l==="exponential")c=B;else if(l==="interval")c=k;else if(l==="categorical"){c=L,d=Object.create(null);for(const _ of t.stops)d[_[0]]=_[1];f=typeof t.stops[0][0]}else{if(l!=="identity")throw new Error(`Unknown function type "${l}"`);c=F}if(n){const _={},y=[];for(let A=0;A<t.stops.length;A++){const M=t.stops[A],I=M[0].zoom;_[I]===void 0&&(_[I]={zoom:I,type:t.type,property:t.property,default:t.default,stops:[]},y.push(I)),_[I].stops.push([M[0].value,M[1]])}const v=[];for(const A of y)v.push([_[A].zoom,O(_[A],e)]);const C={name:"linear"};return{kind:"composite",interpolationType:C,interpolationFactor:kr.interpolationFactor.bind(void 0,C),zoomStops:v.map(A=>A[0]),evaluate:({zoom:A},M)=>B({stops:v,base:t.base},e,A).evaluate(A,M)}}if(s){const _=l==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:_,interpolationFactor:kr.interpolationFactor.bind(void 0,_),zoomStops:t.stops.map(y=>y[0]),evaluate:({zoom:y})=>c(t,e,y,d,f)}}return{kind:"source",evaluate(_,y){const v=y&&y.properties?y.properties[t.property]:void 0;return v===void 0?z(t.default,e.default):c(t,e,v,d,f)}}}function z(t,e,i){return t!==void 0?t:e!==void 0?e:i!==void 0?i:void 0}function L(t,e,i,n,s){return z(typeof i===s?n[i]:void 0,t.default,e.default)}function k(t,e,i){if(Qn(i)!=="number")return z(t.default,e.default);const n=t.stops.length;if(n===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];const s=Is(t.stops.map(l=>l[0]),i);return t.stops[s][1]}function B(t,e,i){const n=t.base!==void 0?t.base:1;if(Qn(i)!=="number")return z(t.default,e.default);const s=t.stops.length;if(s===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[s-1][0])return t.stops[s-1][1];const l=Is(t.stops.map(y=>y[0]),i),c=function(y,v,C,A){const M=A-C,I=y-C;return M===0?0:v===1?I/M:(Math.pow(v,I)-1)/(Math.pow(v,M)-1)}(i,n,t.stops[l][0],t.stops[l+1][0]),d=t.stops[l][1],f=t.stops[l+1][1];let _=wo[e.type]||E;if(t.colorSpace&&t.colorSpace!=="rgb"){const y=Uo[t.colorSpace];_=(v,C)=>y.reverse(y.interpolate(y.forward(v),y.forward(C),c))}return typeof d.evaluate=="function"?{evaluate(...y){const v=d.evaluate.apply(void 0,y),C=f.evaluate.apply(void 0,y);if(v!==void 0&&C!==void 0)return _(v,C,c)}}:_(d,f,c)}function F(t,e,i){return e.type==="color"?i=Yt.parse(i):e.type==="formatted"?i=_r.fromString(i.toString()):e.type==="resolvedImage"?i=Pr.fromString(i.toString()):Qn(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),z(i,t.default,e.default)}wr.register(wa,{error:[{kind:"error"},[Vt],(t,[e])=>{throw new Zi(e.evaluate(t))}],typeof:[Vt,[Wt],(t,[e])=>Si(Vi(e.evaluate(t)))],"to-rgba":[ar(Ye,4),[qr],(t,[e])=>e.evaluate(t).toRenderColor(null).toArray()],rgb:[qr,[Ye,Ye,Ye],gu],rgba:[qr,[Ye,Ye,Ye,Ye],gu],hsl:[qr,[Ye,Ye,Ye],n2],hsla:[qr,[Ye,Ye,Ye,Ye],n2],has:{type:Kt,overloads:[[[Vt],(t,[e])=>u(e.evaluate(t),t.properties())],[[Vt,ma],(t,[e,i])=>u(e.evaluate(t),i.evaluate(t))]]},get:{type:Wt,overloads:[[[Vt],(t,[e])=>r(e.evaluate(t),t.properties())],[[Vt,ma],(t,[e,i])=>r(e.evaluate(t),i.evaluate(t))]]},"feature-state":[Wt,[Vt],(t,[e])=>r(e.evaluate(t),t.featureState||{})],properties:[ma,[],t=>t.properties()],"geometry-type":[Vt,[],t=>t.geometryType()],id:[Wt,[],t=>t.id()],zoom:[Ye,[],t=>t.globals.zoom],pitch:[Ye,[],t=>t.globals.pitch||0],"distance-from-center":[Ye,[],t=>t.distanceFromCenter()],"measure-light":[Ye,[Vt],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[Ye,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ye,[],t=>t.globals.lineProgress||0],"raster-value":[Ye,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[Ye,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[Ye,[],t=>t.globals.skyRadialProgress||0],accumulated:[Wt,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[Ye,o(Ye),(t,e)=>{let i=0;for(const n of e)i+=n.evaluate(t);return i}],"*":[Ye,o(Ye),(t,e)=>{let i=1;for(const n of e)i*=n.evaluate(t);return i}],"-":{type:Ye,overloads:[[[Ye,Ye],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[Ye],(t,[e])=>-e.evaluate(t)]]},"/":[Ye,[Ye,Ye],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[Ye,[Ye,Ye],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[Ye,[],()=>Math.LN2],pi:[Ye,[],()=>Math.PI],e:[Ye,[],()=>Math.E],"^":[Ye,[Ye,Ye],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[Ye,[Ye],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ye,[Ye],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ye,[Ye],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ye,[Ye],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ye,[Ye],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ye,[Ye],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ye,[Ye],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ye,[Ye],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ye,[Ye],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ye,[Ye],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ye,o(Ye),(t,e)=>Math.min(...e.map(i=>i.evaluate(t)))],max:[Ye,o(Ye),(t,e)=>Math.max(...e.map(i=>i.evaluate(t)))],abs:[Ye,[Ye],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ye,[Ye],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ye,[Ye],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ye,[Ye],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Kt,[Vt,Wt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[Kt,[Wt],(t,[e])=>t.id()===e.value],"filter-type-==":[Kt,[Vt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Kt,[Vt,Wt],(t,[e,i])=>{const n=t.properties()[e.value],s=i.value;return typeof n==typeof s&&n<s}],"filter-id-<":[Kt,[Wt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i<n}],"filter->":[Kt,[Vt,Wt],(t,[e,i])=>{const n=t.properties()[e.value],s=i.value;return typeof n==typeof s&&n>s}],"filter-id->":[Kt,[Wt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i>n}],"filter-<=":[Kt,[Vt,Wt],(t,[e,i])=>{const n=t.properties()[e.value],s=i.value;return typeof n==typeof s&&n<=s}],"filter-id-<=":[Kt,[Wt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i<=n}],"filter->=":[Kt,[Vt,Wt],(t,[e,i])=>{const n=t.properties()[e.value],s=i.value;return typeof n==typeof s&&n>=s}],"filter-id->=":[Kt,[Wt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i>=n}],"filter-has":[Kt,[Wt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Kt,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Kt,[ar(Vt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Kt,[ar(Wt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Kt,[Vt,ar(Wt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Kt,[Vt,ar(Wt)],(t,[e,i])=>function(n,s,l,c){for(;l<=c;){const d=l+c>>1;if(s[d]===n)return!0;s[d]>n?c=d-1:l=d+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Kt,overloads:[[[Kt,Kt],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[o(Kt),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[o(Kt),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[Kt,[Kt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Kt,[Vt],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[Vt,[Vt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Vt,[Vt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Vt,o(Wt),(t,e)=>e.map(i=>sn(i.evaluate(t))).join("")],"resolved-locale":[Vt,[jl],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[Ye,[Ye,Ye,Wt],(t,e)=>{const[i,n,s]=e.map(c=>c.evaluate(t));if(i>n||i===n)return i;let l;if(typeof s=="string")l=function(c){let d=0;if(c.length===0)return d;for(let f=0;f<c.length;f++)d=(d<<5)-d+c.charCodeAt(f),d|=0;return d}(s);else{if(typeof s!="number")throw new Zi(`Invalid seed input: ${s}`);l=s}return i+_u(l)()*(n-i)}]});class ${constructor(e,i,n,s){this.expression=e,this._warningHistory={},this._evaluator=new mc(n,s),this._defaultValue=i?function(l){return l.type==="color"&&(T(l.default)||Array.isArray(l.default))?new Yt(0,0,0,0):l.type==="color"?Yt.parse(l.default)||null:l.default===void 0?null:l.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(e,i,n,s,l,c,d,f){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=n,this._evaluator.canonical=s||null,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=c,this._evaluator.featureTileCoord=d||null,this._evaluator.featureDistanceData=f||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,n,s,l,c,d,f){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=n||null,this._evaluator.canonical=s||null,this._evaluator.availableImages=l||null,this._evaluator.formattedSection=c||null,this._evaluator.featureTileCoord=d||null,this._evaluator.featureDistanceData=f||null;try{const _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Zi(`Expected value to be one of ${Object.keys(this._enumValues).map(y=>JSON.stringify(y)).join(", ")}, but found ${JSON.stringify(_)} instead.`);return _}catch(_){return this._warningHistory[_.message]||(this._warningHistory[_.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${_.message}`)),this._defaultValue}}}function G(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in wa}function Z(t,e,i,n){const s=new cu(wa,[],e?function(c){const d={color:qr,string:Vt,number:Ye,enum:Vt,boolean:Kt,formatted:_a,resolvedImage:Ts};return c.type==="array"?ar(d[c.value]||Wt,c.length):d[c.type]}(e):void 0,void 0,void 0,i,n),l=s.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?h(new $(l,e,i,n)):p(s.errors)}class K{constructor(e,i,n){this.kind=e,this._styleExpression=i,this.isLightConstant=n,this.isStateDependent=e!=="constant"&&!Yl(i.expression),this.configDependencies=ko(i.expression)}evaluateWithoutErrorHandling(e,i,n,s,l,c){return this._styleExpression.evaluateWithoutErrorHandling(e,i,n,s,l,c)}evaluate(e,i,n,s,l,c){return this._styleExpression.evaluate(e,i,n,s,l,c)}}class W{constructor(e,i,n,s,l){this.kind=e,this.zoomStops=n,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Yl(i.expression),this.isLightConstant=l,this.configDependencies=ko(i.expression),this.interpolationType=s}evaluateWithoutErrorHandling(e,i,n,s,l,c){return this._styleExpression.evaluateWithoutErrorHandling(e,i,n,s,l,c)}evaluate(e,i,n,s,l,c){return this._styleExpression.evaluate(e,i,n,s,l,c)}interpolationFactor(e,i,n){return this.interpolationType?kr.interpolationFactor(this.interpolationType,e,i,n):0}}function H(t,e,i,n){if((t=Z(t,e,i,n)).result==="error")return t;const s=t.value.expression,l=Lo(s);if(!l&&!g(e))return p([new _n("","data expressions not supported")]);const c=Bo(s,["zoom","pitch","distance-from-center"]);if(!c&&!b(e))return p([new _n("","zoom expressions not supported")]);const d=Bo(s,["measure-light"]);if(!d&&!x(e))return p([new _n("","measure-light expression not supported")]);const f=e.expression&&e.expression.relaxZoomRestriction,_=re(s);return _||c||f?_ instanceof _n?p([_]):_ instanceof kr&&!w(e)?p([new _n("",'"interpolate" expressions cannot be used with this property')]):h(_?new W(l?"camera":"composite",t.value,_.labels,_ instanceof kr?_.interpolation:void 0,d):new K(l?"constant":"source",t.value,d)):p([new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class te{constructor(e,i){this._parameters=e,this._specification=i,fa(this,O(this._parameters,this._specification))}static deserialize(e){return new te(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function re(t){let e=null;if(t instanceof Ql)e=re(t.result);else if(t instanceof Ps){for(const i of t.args)if(e=re(i),e)break}else(t instanceof Ca||t instanceof kr)&&t.input instanceof wr&&t.input.name==="zoom"&&(e=t);return e instanceof _n||t.eachChild(i=>{const n=re(i);n instanceof _n?e=n:e&&n&&e!==n&&(e=new _n("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var he=J,ne=3;function J(t,e,i){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var s=new Int32Array(this.arrayBuffer);t=s[0],this.d=(e=s[1])+2*(i=s[2]);for(var l=0;l<this.d*this.d;l++){var c=s[ne+l],d=s[ne+l+1];n.push(c===d?null:s.subarray(c,d))}var f=s[ne+n.length+1];this.keys=s.subarray(s[ne+n.length],f),this.bboxes=s.subarray(f),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var _=0;_<this.d*this.d;_++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var y=i/e*t;this.min=-y,this.max=t+y}J.prototype.insert=function(t,e,i,n,s){this._forEachCell(e,i,n,s,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(s)},J.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},J.prototype._insertCell=function(t,e,i,n,s,l){this.cells[s].push(l)},J.prototype.query=function(t,e,i,n,s){var l=this.min,c=this.max;if(t<=l&&e<=l&&c<=i&&c<=n&&!s)return Array.prototype.slice.call(this.keys);var d=[];return this._forEachCell(t,e,i,n,this._queryCell,d,{},s),d},J.prototype._queryCell=function(t,e,i,n,s,l,c,d){var f=this.cells[s];if(f!==null)for(var _=this.keys,y=this.bboxes,v=0;v<f.length;v++){var C=f[v];if(c[C]===void 0){var A=4*C;(d?d(y[A+0],y[A+1],y[A+2],y[A+3]):t<=y[A+2]&&e<=y[A+3]&&i>=y[A+0]&&n>=y[A+1])?(c[C]=!0,l.push(_[C])):c[C]=!1}}},J.prototype._forEachCell=function(t,e,i,n,s,l,c,d){for(var f=this._convertToCellCoord(t),_=this._convertToCellCoord(e),y=this._convertToCellCoord(i),v=this._convertToCellCoord(n),C=f;C<=y;C++)for(var A=_;A<=v;A++){var M=this.d*A+C;if((!d||d(this._convertFromCellCoord(C),this._convertFromCellCoord(A),this._convertFromCellCoord(C+1),this._convertFromCellCoord(A+1)))&&s.call(this,t,e,i,n,M,l,c,d))return}},J.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},J.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},J.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=ne+this.cells.length+1+1,i=0,n=0;n<this.cells.length;n++)i+=this.cells[n].length;var s=new Int32Array(e+i+this.keys.length+this.bboxes.length);s[0]=this.extent,s[1]=this.n,s[2]=this.padding;for(var l=e,c=0;c<t.length;c++){var d=t[c];s[ne+c]=l,s.set(d,l),l+=d.length}return s[ne+t.length]=l,s.set(this.keys,l),s[ne+t.length+1]=l+=this.keys.length,s.set(this.bboxes,l),l+=this.bboxes.length,s.buffer};var ge=dn(he);const me={};function oe(t,e,i={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writable:!1}),me[e]={klass:t,omit:i.omit||[]}}oe(Object,"Object"),ge.serialize=function(t,e){const i=t.toArrayBuffer();return e&&e.add(i),{buffer:i}},ge.deserialize=function(t){return new ge(t.buffer)},Object.defineProperty(ge,"name",{value:"Grid"}),oe(ge,"Grid"),oe(Yt,"Color"),oe(Error,"Error"),oe(_r,"Formatted"),oe(Vl,"FormattedSection"),oe(Rl,"AJAXError"),oe(Pr,"ResolvedImage"),oe(te,"StylePropertyFunction"),oe($,"StyleExpression",{omit:["_evaluator"]}),oe(W,"ZoomDependentExpression"),oe(K,"ZoomConstantExpression"),oe(wr,"CompoundExpression",{omit:["_evaluate"]});for(const t in wa)me[wa[t]._classRegistryKey]||oe(wa[t],`Expression${t}`);function Pe(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Me(t){return self.ImageBitmap&&t instanceof ImageBitmap}function de(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Pe(t)||Me(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.add(i.buffer),i}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const n of t)i.push(de(n,e));return i}if(t instanceof Map){const i={$name:"Map"};for(const[n,s]of t.entries())i[n]=de(s);return i}if(t instanceof Set){const i={$name:"Set"};let n=0;for(const s of t.values())i[++n]=de(s);return i}if(typeof t=="object"){const i=t.constructor,n=i._classRegistryKey;if(!n)throw new Error(`can't serialize object of unregistered class ${n}`);const s=i.serialize?i.serialize(t,e):{};if(!i.serialize){for(const l in t)t.hasOwnProperty(l)&&(me[n].omit.indexOf(l)>=0||(s[l]=de(t[l],e)));t instanceof Error&&(s.message=t.message)}if(s.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(s.$name=n),s}throw new Error("can't serialize object of type "+typeof t)}function Ce(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Pe(t)||Me(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Ce);if(typeof t=="object"){const e=t.$name||"Object";if(e==="Map"){const s=new Map;for(const l of Object.keys(t))l!=="$name"&&s.set(l,Ce(t[l]));return s}if(e==="Set"){const s=new Set;for(const l of Object.keys(t))l!=="$name"&&s.add(Ce(t[l]));return s}const{klass:i}=me[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const n=Object.create(i.prototype);for(const s of Object.keys(t))s!=="$name"&&(n[s]=Ce(t[s]));return n}throw new Error("can't deserialize object of type "+typeof t)}const se={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function Se(t){for(const e of t)if($e(e.charCodeAt(0)))return!0;return!1}function Ie(t){for(const e of t)if(!Ue(e.charCodeAt(0)))return!1;return!0}function Ue(t){return!(se.Arabic(t)||se["Arabic Supplement"](t)||se["Arabic Extended-A"](t)||se["Arabic Presentation Forms-A"](t)||se["Arabic Presentation Forms-B"](t))}function $e(t){return!(t!==746&&t!==747&&(t<4352||!(se["Bopomofo Extended"](t)||se.Bopomofo(t)||se["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||se["CJK Compatibility Ideographs"](t)||se["CJK Compatibility"](t)||se["CJK Radicals Supplement"](t)||se["CJK Strokes"](t)||!(!se["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||se["CJK Unified Ideographs Extension A"](t)||se["CJK Unified Ideographs"](t)||se["Enclosed CJK Letters and Months"](t)||se["Hangul Compatibility Jamo"](t)||se["Hangul Jamo Extended-A"](t)||se["Hangul Jamo Extended-B"](t)||se["Hangul Jamo"](t)||se["Hangul Syllables"](t)||se.Hiragana(t)||se["Ideographic Description Characters"](t)||se.Kanbun(t)||se["Kangxi Radicals"](t)||se["Katakana Phonetic Extensions"](t)||se.Katakana(t)&&t!==12540||!(!se["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!se["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||se["Unified Canadian Aboriginal Syllabics"](t)||se["Unified Canadian Aboriginal Syllabics Extended"](t)||se["Vertical Forms"](t)||se["Yijing Hexagram Symbols"](t)||se["Yi Syllables"](t)||se["Yi Radicals"](t))))}function Je(t){return!($e(t)||function(e){return!!(se["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||se["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||se["Letterlike Symbols"](e)||se["Number Forms"](e)||se["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||se["Control Pictures"](e)&&e!==9251||se["Optical Character Recognition"](e)||se["Enclosed Alphanumerics"](e)||se["Geometric Shapes"](e)||se["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||se["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||se["CJK Symbols and Punctuation"](e)||se.Katakana(e)||se["Private Use Area"](e)||se["CJK Compatibility Forms"](e)||se["Small Form Variants"](e)||se["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function qe(t){return t>=1424&&t<=2303||se["Arabic Presentation Forms-A"](t)||se["Arabic Presentation Forms-B"](t)}function ot(t,e){return!(!e&&qe(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||se.Khmer(t))}function Ct(t){for(const e of t)if(qe(e.charCodeAt(0)))return!0;return!1}const ct="deferred",Tt="loading",kt="loaded";let hi=null,ai="unavailable",Bt=null;const ni=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(ai="error"),hi&&hi(t)};function Et(){Ot.fire(new mn("pluginStateChange",{pluginStatus:ai,pluginURL:Bt}))}const Ot=new As,bt=function(){return ai},$t=function(){if(ai!==ct||!Bt)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ai=Tt,Et(),Bt&&vs({url:Bt},t=>{t?ni(t):(ai=kt,Et())})},zt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ai===kt||zt.applyArabicShaping!=null,isLoading:()=>ai===Tt,setState(t){ai=t.pluginStatus,Bt=t.pluginURL},isParsed:()=>zt.applyArabicShaping!=null&&zt.processBidirectionalText!=null&&zt.processStyledBidirectionalText!=null,getPluginURL:()=>Bt};class dt{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(i,n){for(const s of i)if(!ot(s.charCodeAt(0),n))return!1;return!0}(e,zt.isLoaded())}}class Ri{constructor(e,i,n,s){this.property=e,this.value=i,this.expression=function(l,c,d,f){if(T(l))return new te(l,c);if(G(l)||Array.isArray(l)&&l.length>0){const _=H(l,c,d,f);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));return _.value}{let _=l;return typeof l=="string"&&c.type==="color"&&(_=Yt.parse(l)),{kind:"constant",configDependencies:new Set,evaluate:()=>_}}}(i===void 0?e.specification.default:i,e.specification,n,s)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,n){return this.property.possiblyEvaluate(this,e,i,n)}}class Li{constructor(e,i,n){this.property=e,this.value=new Ri(e,void 0,i,n)}transitioned(e,i){return new cr(this.property,this.value,i,ir({},e.transition,this.transition),e.now)}untransitioned(){return new cr(this.property,this.value,null,{},0)}}class lr{constructor(e,i,n){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=i,this._options=n,this.configDependencies=new Set}getValue(e){return Cr(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Li(this._values[e].property,this._scope,this._options)),this._values[e].value=new Ri(this._values[e].property,i===null?void 0:Cr(i),this._scope,this._options),this._values[e].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].value.expression.configDependencies]))}setTransitionOrValue(e,i){i&&(this._options=i);const n=this._properties.properties;if(e)for(const s in e){const l=e[s];if(ao(s,"-transition")){const c=s.slice(0,-11);n[c]&&this.setTransition(c,l)}else n.hasOwnProperty(s)&&this.setValue(s,l)}}getTransition(e){return Cr(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Li(this._values[e].property)),this._values[e].transition=Cr(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const n=this.getValue(i);n!==void 0&&(e[i]=n);const s=this.getTransition(i);s!==void 0&&(e[`${i}-transition`]=s)}return e}transitioned(e,i){const n=new Ji(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].transitioned(e,i._values[s]);return n}untransitioned(){const e=new Ji(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class cr{constructor(e,i,n,s,l){const c=s.delay||0,d=s.duration||0;l=l||0,this.property=e,this.value=i,this.begin=l+c,this.end=this.begin+d,e.specification.transition&&(s.delay||s.duration)&&(this.prior=n)}possiblyEvaluate(e,i,n){const s=e.now||0,l=this.value.possiblyEvaluate(e,i,n),c=this.prior;if(c){if(s>this.end)return this.prior=null,l;if(this.value.isDataDriven())return this.prior=null,l;if(s<this.begin)return c.possiblyEvaluate(e,i,n);{const d=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(e,i,n),l,wl(d))}}return l}}class Ji{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,n){const s=new Ki(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].possiblyEvaluate(e,i,n);return s}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ur{constructor(e,i,n){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=i,this._options=n,this.configDependencies=new Set}getValue(e){return Cr(this._values[e].value)}setValue(e,i){this._values[e]=new Ri(this._values[e].property,i===null?void 0:Cr(i),this._scope,this._options),this._values[e].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].expression.configDependencies]))}serialize(){const e={};for(const i of Object.keys(this._values)){const n=this.getValue(i);n!==void 0&&(e[i]=n)}return e}possiblyEvaluate(e,i,n){const s=new Ki(this._properties);for(const l of Object.keys(this._values))s._values[l]=this._values[l].possiblyEvaluate(e,i,n);return s}}class Wi{constructor(e,i,n){this.property=e,this.value=i,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,n,s){return this.property.evaluate(this.value,this.parameters,e,i,n,s)}}class Ki{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Le{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,n){const s=wo[this.specification.type];return s?s(e,i,n):e}}class Qe{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,n,s){return new Wi(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},n,s)}:e.expression,i)}interpolate(e,i,n){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new Wi(this,{kind:"constant",value:void 0},e.parameters);const s=wo[this.specification.type];return s?new Wi(this,{kind:"constant",value:s(e.value.value,i.value.value,n)},e.parameters):e}evaluate(e,i,n,s,l,c){return e.kind==="constant"?e.value:e.evaluate(i,n,s,l,c)}}class gr{constructor(e){this.specification=e}possiblyEvaluate(e,i,n,s){return!!e.expression.evaluate(i,null,{},n,s)}interpolate(){return!1}}class ci{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new dt(0,{});for(const n in e){const s=e[n];s.specification.overridable&&this.overridableProperties.push(n);const l=this.defaultPropertyValues[n]=new Ri(s,void 0),c=this.defaultTransitionablePropertyValues[n]=new Li(s);this.defaultTransitioningPropertyValues[n]=c.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=l.possiblyEvaluate(i)}}}oe(Qe,"DataDrivenProperty"),oe(Le,"DataConstantProperty"),oe(gr,"ColorRampProperty");var _e=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-line-alignment":{"type":"enum","values":{"inside":1,"outside":1,"center":1},"default":"center","property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Pn(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function on(t){if(Array.isArray(t))return t.map(on);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=on(t[i]);return e}return Pn(t)}function On(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!On(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function zn(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};On(t)||(t=Aa(t));const i=t;let n=!0;try{n=function(_){if(!ns(_))return _;let y=on(_);return a1(y),y=s1(y),y}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const s=_e[`filter_${e}`],l=Z(n,s);let c=null;if(l.result==="error")throw new Error(l.value.map(_=>`${_.key}: ${_.message}`).join(", "));c=(_,y,v)=>l.value.evaluate(_,y,{},v);let d=null,f=null;if(n!==i){const _=Z(i,s);if(_.result==="error")throw new Error(_.value.map(y=>`${y.key}: ${y.message}`).join(", "));d=(y,v,C,A,M)=>_.value.evaluate(y,v,{},C,void 0,void 0,A,M),f=!Lo(_.value.expression)}return{filter:c,dynamicFilter:d||void 0,needGeometry:o1(n),needFeature:!!f}}function s1(t){if(!Array.isArray(t))return t;const e=function(i){if(zc.has(i[0])){for(let n=1;n<i.length;n++)if(ns(i[n]))return!0}return i}(t);return e===!0?e:e.map(i=>s1(i))}function a1(t){let e=!1;const i=[];if(t[0]==="case"){for(let n=1;n<t.length-1;n+=2)e=e||ns(t[n]),i.push(t[n+1]);i.push(t[t.length-1])}else if(t[0]==="match"){e=e||ns(t[1]);for(let n=2;n<t.length-1;n+=2)i.push(t[n+1]);i.push(t[t.length-1])}else if(t[0]==="step"){e=e||ns(t[1]);for(let n=1;n<t.length-1;n+=2)i.push(t[n+1])}e&&(t.length=0,t.push("any",...i));for(let n=1;n<t.length;n++)a1(t[n])}function ns(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<t.length;i++)if(ns(t[i]))return!0;return!1}const zc=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Os(t,e){return t<e?-1:t>e?1:0}function o1(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(o1(t[e]))return!0;return!1}function Aa(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?s2(t[1],t[2],"=="):e==="!="?yu(s2(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?s2(t[1],t[2],e):e==="any"?(i=t.slice(1),["any"].concat(i.map(Aa))):e==="all"?["all"].concat(t.slice(1).map(Aa)):e==="none"?["all"].concat(t.slice(1).map(Aa).map(yu)):e==="in"?J0(t[1],t.slice(2)):e==="!in"?yu(J0(t[1],t.slice(2))):e==="has"?K0(t[1]):e!=="!has"||yu(K0(t[1]));var i}function s2(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function J0(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Os)]]:["filter-in-small",t,["literal",e]]}}function K0(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function yu(t){return["!",t]}const xu="";function Q0(t,e){return e?`${t}${xu}${e}`:t}const ed="-transition",g4=new Set(["fill","line","background","hillshade","raster"]);class Br extends As{constructor(e,i,n,s,l){if(super(),this.id=e.id,this.fqid=Q0(this.id,n),this.type=e.type,this.scope=n,this.lut=s,this.options=l,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),e.slot&&(this.slot=e.slot),i.layout&&(this._unevaluatedLayout=new ur(i.layout,this.scope,l),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),i.paint)){this._transitionablePaint=new lr(i.paint,this.scope,l);for(const c in e.paint)this.setPaintProperty(c,e.paint[c]);for(const c in e.layout)this.setLayoutProperty(c,e.layout[c]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ki(i.paint)}}onAdd(e){}onRemove(e){}isDraped(e){return g4.has(this.type)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i){if(this.type==="custom"&&e==="visibility")return void(this.visibility=i);const n=this._unevaluatedLayout;n._properties.properties[e]&&(n.setValue(e,i),this.configDependencies=new Set([...this.configDependencies,...n.configDependencies]),e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(e){return ao(e,ed)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i){const n=this._transitionablePaint,s=n._properties.properties;if(ao(e,ed)){const v=e.slice(0,-11);return s[v]&&n.setTransition(v,i||void 0),!1}if(!s[e])return!1;const l=n._values[e],c=l.value.isDataDriven(),d=l.value;n.setValue(e,i),this.configDependencies=new Set([...this.configDependencies,...n.configDependencies]),this._handleSpecialPaintPropertyUpdate(e);const f=n._values[e].value,_=f.isDataDriven(),y=ao(e,"pattern")||e==="line-dasharray";return _||c||y||this._handleOverridablePaintPropertyUpdate(e,d,f)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,i,n){return null}_handleOverridablePaintPropertyUpdate(e,i,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){return rr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,i)=>!(e===void 0||i==="layout"&&!Object.keys(e).length||i==="paint"&&!Object.keys(e).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Wi&&g(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=zn(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,i,n,s,l,c,d,f,_){}queryIntersectsMatchingFeature(e,i,n,s){}}const y4={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Dc{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class xi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ei(t,e=1){let i=0,n=0;return{members:t.map(s=>{const l=y4[s.type].BYTES_PER_ELEMENT,c=i=td(i,Math.max(e,l)),d=s.components||1;return n=Math.max(n,l),i+=l*d,{name:s.name,type:s.type,components:d,offset:c}}),size:td(i,Math.max(n,e)),alignment:e}}function td(t,e){return Math.ceil(t/e)*e}class Dn extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,i)}emplace(e,i,n){const s=2*e;return this.int16[s+0]=i,this.int16[s+1]=n,e}}Dn.prototype.bytesPerElement=4,oe(Dn,"StructArrayLayout2i4");class vu extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,i,n)}emplace(e,i,n,s){const l=3*e;return this.int16[l+0]=i,this.int16[l+1]=n,this.int16[l+2]=s,e}}vu.prototype.bytesPerElement=6,oe(vu,"StructArrayLayout3i6");class zs extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,n,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,n,s)}emplace(e,i,n,s,l){const c=4*e;return this.int16[c+0]=i,this.int16[c+1]=n,this.int16[c+2]=s,this.int16[c+3]=l,e}}zs.prototype.bytesPerElement=8,oe(zs,"StructArrayLayout4i8");class a2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,i,n,s,l)}emplace(e,i,n,s,l,c){const d=5*e;return this.int16[d+0]=i,this.int16[d+1]=n,this.int16[d+2]=s,this.int16[d+3]=l,this.int16[d+4]=c,e}}a2.prototype.bytesPerElement=10,oe(a2,"StructArrayLayout5i10");class o2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,n,s,l,c,d)}emplace(e,i,n,s,l,c,d,f){const _=6*e,y=12*e,v=3*e;return this.int16[_+0]=i,this.int16[_+1]=n,this.uint8[y+4]=s,this.uint8[y+5]=l,this.uint8[y+6]=c,this.uint8[y+7]=d,this.float32[v+2]=f,e}}o2.prototype.bytesPerElement=12,oe(o2,"StructArrayLayout2i4ub1f12");class Ta extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,n,s)}emplace(e,i,n,s,l){const c=4*e;return this.float32[c+0]=i,this.float32[c+1]=n,this.float32[c+2]=s,this.float32[c+3]=l,e}}Ta.prototype.bytesPerElement=16,oe(Ta,"StructArrayLayout4f16");class Ma extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,i,n)}emplace(e,i,n,s){const l=3*e;return this.float32[l+0]=i,this.float32[l+1]=n,this.float32[l+2]=s,e}}Ma.prototype.bytesPerElement=12,oe(Ma,"StructArrayLayout3f12");class Sa extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,i,n,s,l)}emplace(e,i,n,s,l,c){const d=6*e,f=3*e;return this.uint16[d+0]=i,this.uint16[d+1]=n,this.uint16[d+2]=s,this.uint16[d+3]=l,this.float32[f+2]=c,e}}Sa.prototype.bytesPerElement=12,oe(Sa,"StructArrayLayout4ui1f12");class Cu extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,n,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,n,s)}emplace(e,i,n,s,l){const c=4*e;return this.uint16[c+0]=i,this.uint16[c+1]=n,this.uint16[c+2]=s,this.uint16[c+3]=l,e}}Cu.prototype.bytesPerElement=8,oe(Cu,"StructArrayLayout4ui8");class bu extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,n,s,l,c)}emplace(e,i,n,s,l,c,d){const f=6*e;return this.int16[f+0]=i,this.int16[f+1]=n,this.int16[f+2]=s,this.int16[f+3]=l,this.int16[f+4]=c,this.int16[f+5]=d,e}}bu.prototype.bytesPerElement=12,oe(bu,"StructArrayLayout6i12");class l2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d,f,_,y,v,C){const A=this.length;return this.resize(A+1),this.emplace(A,e,i,n,s,l,c,d,f,_,y,v,C)}emplace(e,i,n,s,l,c,d,f,_,y,v,C,A){const M=12*e;return this.int16[M+0]=i,this.int16[M+1]=n,this.int16[M+2]=s,this.int16[M+3]=l,this.uint16[M+4]=c,this.uint16[M+5]=d,this.uint16[M+6]=f,this.uint16[M+7]=_,this.int16[M+8]=y,this.int16[M+9]=v,this.int16[M+10]=C,this.int16[M+11]=A,e}}l2.prototype.bytesPerElement=24,oe(l2,"StructArrayLayout4i4ui4i24");class c2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,n,s,l,c)}emplace(e,i,n,s,l,c,d){const f=10*e,_=5*e;return this.int16[f+0]=i,this.int16[f+1]=n,this.int16[f+2]=s,this.float32[_+2]=l,this.float32[_+3]=c,this.float32[_+4]=d,e}}c2.prototype.bytesPerElement=20,oe(c2,"StructArrayLayout3i3f20");class u2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}u2.prototype.bytesPerElement=4,oe(u2,"StructArrayLayout1ul4");class Ea extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,i)}emplace(e,i,n){const s=2*e;return this.uint16[s+0]=i,this.uint16[s+1]=n,e}}Ea.prototype.bytesPerElement=4,oe(Ea,"StructArrayLayout2ui4");class h2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d,f,_,y,v,C,A){const M=this.length;return this.resize(M+1),this.emplace(M,e,i,n,s,l,c,d,f,_,y,v,C,A)}emplace(e,i,n,s,l,c,d,f,_,y,v,C,A,M){const I=20*e,P=10*e;return this.int16[I+0]=i,this.int16[I+1]=n,this.int16[I+2]=s,this.int16[I+3]=l,this.int16[I+4]=c,this.float32[P+3]=d,this.float32[P+4]=f,this.float32[P+5]=_,this.float32[P+6]=y,this.int16[I+14]=v,this.uint32[P+8]=C,this.uint16[I+18]=A,this.uint16[I+19]=M,e}}h2.prototype.bytesPerElement=40,oe(h2,"StructArrayLayout5i4f1i1ul2ui40");class wu extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,n,s,l,c,d)}emplace(e,i,n,s,l,c,d,f){const _=8*e;return this.int16[_+0]=i,this.int16[_+1]=n,this.int16[_+2]=s,this.int16[_+4]=l,this.int16[_+5]=c,this.int16[_+6]=d,this.int16[_+7]=f,e}}wu.prototype.bytesPerElement=16,oe(wu,"StructArrayLayout3i2i2i16");class d2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,i,n,s,l)}emplace(e,i,n,s,l,c){const d=4*e,f=8*e;return this.float32[d+0]=i,this.float32[d+1]=n,this.float32[d+2]=s,this.int16[f+6]=l,this.int16[f+7]=c,e}}d2.prototype.bytesPerElement=16,oe(d2,"StructArrayLayout2f1f2i16");class p2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,n,s)}emplace(e,i,n,s,l){const c=12*e,d=3*e;return this.uint8[c+0]=i,this.uint8[c+1]=n,this.float32[d+1]=s,this.float32[d+2]=l,e}}p2.prototype.bytesPerElement=12,oe(p2,"StructArrayLayout2ub2f12");class Hi extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,i,n)}emplace(e,i,n,s){const l=3*e;return this.uint16[l+0]=i,this.uint16[l+1]=n,this.uint16[l+2]=s,e}}Hi.prototype.bytesPerElement=6,oe(Hi,"StructArrayLayout3ui6");class f2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X){const Y=this.length;return this.resize(Y+1),this.emplace(Y,e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X)}emplace(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X,Y){const ee=30*e,le=15*e,pe=60*e;return this.int16[ee+0]=i,this.int16[ee+1]=n,this.int16[ee+2]=s,this.float32[le+2]=l,this.float32[le+3]=c,this.uint16[ee+8]=d,this.uint16[ee+9]=f,this.uint32[le+5]=_,this.uint32[le+6]=y,this.uint32[le+7]=v,this.uint16[ee+16]=C,this.uint16[ee+17]=A,this.uint16[ee+18]=M,this.float32[le+10]=I,this.float32[le+11]=P,this.uint8[pe+48]=D,this.uint8[pe+49]=V,this.uint8[pe+50]=N,this.uint32[le+13]=U,this.int16[ee+28]=X,this.uint8[pe+58]=Y,e}}f2.prototype.bytesPerElement=60,oe(f2,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class m2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X,Y,ee,le,pe,xe,fe,we,De,Ae,ke,be){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X,Y,ee,le,pe,xe,fe,we,De,Ae,ke,be)}emplace(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D,V,N,U,X,Y,ee,le,pe,xe,fe,we,De,Ae,ke,be,Ee){const Fe=20*e,Te=40*e,Ve=80*e;return this.float32[Fe+0]=i,this.float32[Fe+1]=n,this.int16[Te+4]=s,this.int16[Te+5]=l,this.int16[Te+6]=c,this.int16[Te+7]=d,this.int16[Te+8]=f,this.int16[Te+9]=_,this.int16[Te+10]=y,this.int16[Te+11]=v,this.int16[Te+12]=C,this.uint16[Te+13]=A,this.uint16[Te+14]=M,this.uint16[Te+15]=I,this.uint16[Te+16]=P,this.uint16[Te+17]=D,this.uint16[Te+18]=V,this.uint16[Te+19]=N,this.uint16[Te+20]=U,this.uint16[Te+21]=X,this.uint16[Te+22]=Y,this.uint16[Te+23]=ee,this.uint16[Te+24]=le,this.uint16[Te+25]=pe,this.uint16[Te+26]=xe,this.uint16[Te+27]=fe,this.uint32[Fe+14]=we,this.float32[Fe+15]=De,this.float32[Fe+16]=Ae,this.float32[Fe+17]=ke,this.float32[Fe+18]=be,this.uint8[Ve+76]=Ee,e}}m2.prototype.bytesPerElement=80,oe(m2,"StructArrayLayout2f9i15ui1ul4f1ub80");class l1 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}l1.prototype.bytesPerElement=4,oe(l1,"StructArrayLayout1f4");class Go extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,e,i,n,s,l)}emplace(e,i,n,s,l,c){const d=5*e;return this.float32[d+0]=i,this.float32[d+1]=n,this.float32[d+2]=s,this.float32[d+3]=l,this.float32[d+4]=c,e}}Go.prototype.bytesPerElement=20,oe(Go,"StructArrayLayout5f20");class _2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,n,s,l,c,d)}emplace(e,i,n,s,l,c,d,f){const _=7*e;return this.float32[_+0]=i,this.float32[_+1]=n,this.float32[_+2]=s,this.float32[_+3]=l,this.float32[_+4]=c,this.float32[_+5]=d,this.float32[_+6]=f,e}}_2.prototype.bytesPerElement=28,oe(_2,"StructArrayLayout7f28");class g2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,n,s){const l=this.length;return this.resize(l+1),this.emplace(l,e,i,n,s)}emplace(e,i,n,s,l){const c=6*e;return this.uint32[3*e+0]=i,this.uint16[c+2]=n,this.uint16[c+3]=s,this.uint16[c+4]=l,e}}g2.prototype.bytesPerElement=12,oe(g2,"StructArrayLayout1ul3ui12");class Rc extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}Rc.prototype.bytesPerElement=2,oe(Rc,"StructArrayLayout1ui2");class Lc extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const n=this.length;return this.resize(n+1),this.emplace(n,e,i)}emplace(e,i,n){const s=2*e;return this.float32[s+0]=i,this.float32[s+1]=n,e}}Lc.prototype.bytesPerElement=8,oe(Lc,"StructArrayLayout2f8");class y2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P)}emplace(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D){const V=16*e;return this.float32[V+0]=i,this.float32[V+1]=n,this.float32[V+2]=s,this.float32[V+3]=l,this.float32[V+4]=c,this.float32[V+5]=d,this.float32[V+6]=f,this.float32[V+7]=_,this.float32[V+8]=y,this.float32[V+9]=v,this.float32[V+10]=C,this.float32[V+11]=A,this.float32[V+12]=M,this.float32[V+13]=I,this.float32[V+14]=P,this.float32[V+15]=D,e}}y2.prototype.bytesPerElement=64,oe(y2,"StructArrayLayout16f64");class Au extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,n,s,l,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,n,s,l,c,d)}emplace(e,i,n,s,l,c,d,f){const _=10*e,y=5*e;return this.uint16[_+0]=i,this.uint16[_+1]=n,this.uint16[_+2]=s,this.uint16[_+3]=l,this.float32[y+2]=c,this.float32[y+3]=d,this.float32[y+4]=f,e}}Au.prototype.bytesPerElement=20,oe(Au,"StructArrayLayout4ui3f20");class x2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.int16[1*e+0]=i,e}}x2.prototype.bytesPerElement=2,oe(x2,"StructArrayLayout1i2");class v2 extends xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint8[1*e+0]=i,e}}v2.prototype.bytesPerElement=1,oe(v2,"StructArrayLayout1ub1");class id extends Dc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}id.prototype.size=40;class C2 extends h2{get(e){return new id(this,e)}}oe(C2,"CollisionBoxArray");class rd extends Dc{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}rd.prototype.size=60;class nd extends f2{get(e){return new rd(this,e)}}oe(nd,"PlacedSymbolArray");class sd extends Dc{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}sd.prototype.size=80;class ad extends m2{get(e){return new sd(this,e)}}oe(ad,"SymbolInstanceArray");class od extends l1{getoffsetX(e){return this.float32[1*e+0]}}oe(od,"GlyphOffsetArray");class ld extends Dn{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}oe(ld,"SymbolLineVertexArray");class cd extends Dc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}cd.prototype.size=12;class ud extends g2{get(e){return new cd(this,e)}}oe(ud,"FeatureIndexArray");class hd extends Ea{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}oe(hd,"FillExtrusionCentroidArray");class dd extends Dc{get a_join_normal_inside_polygon0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside_polygon1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside_polygon2(){return this._structArray.int16[this._pos2+2]}get a_join_normal_inside_polygon3(){return this._structArray.int16[this._pos2+3]}}dd.prototype.size=8;class pd extends zs{get(e){return new dd(this,e)}}oe(pd,"FillExtrusionWallArray");const x4=ei([{name:"a_pos",components:2,type:"Int16"}],4),v4=ei([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class wi{constructor(e=[]){this.segments=e}_prepareSegment(e,i,n,s){let l=this.segments[this.segments.length-1];return e>wi.MAX_VERTEX_ARRAY_LENGTH&&Di(`Max vertices per segment is ${wi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!l||l.vertexLength+e>wi.MAX_VERTEX_ARRAY_LENGTH||l.sortKey!==s)&&(l={vertexOffset:i,primitiveOffset:n,vertexLength:0,primitiveLength:0},s!==void 0&&(l.sortKey=s),this.segments.push(l)),l}prepareSegment(e,i,n,s){return this._prepareSegment(e,i.length,n.length,s)}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,n,s){return new wi([{vertexOffset:e,primitiveOffset:i,vertexLength:n,primitiveLength:s,vaos:{},sortKey:0}])}}function fd(t,e){return 256*(t=Pt(Math.floor(t),0,255))+Pt(Math.floor(e),0,255)}wi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,oe(wi,"SegmentVector");const C4=ei([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),b4=ei([{name:"a_dash",components:4,type:"Uint16"}]);class kc{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,i,n,s){this.ids.push(md(e)),this.positions.push(i,n,s)}eachPosition(e,i){const n=md(e);let s=0,l=this.ids.length-1;for(;s<l;){const c=s+l>>1;this.ids[c]>=n?l=c:s=c+1}for(;this.ids[s]===n;)i(this.positions[3*s],this.positions[3*s+1],this.positions[3*s+2]),s++}static serialize(e,i){const n=new Float64Array(e.ids),s=new Uint32Array(e.positions);return b2(n,s,0,n.length-1),i&&(i.add(n.buffer),i.add(s.buffer)),{ids:n,positions:s}}static deserialize(e){const i=new kc;let n;i.ids=e.ids,i.positions=e.positions;for(const s of i.ids)s!==n&&i.uniqueIds.push(s),n=s;return i.indexed=!0,i}}function md(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Ll(String(t))}function b2(t,e,i,n){for(;i<n;){const s=t[i+n>>1];let l=i-1,c=n+1;for(;;){do l++;while(t[l]<s);do c--;while(t[c]>s);if(l>=c)break;Tu(t,l,c),Tu(e,3*l,3*c),Tu(e,3*l+1,3*c+1),Tu(e,3*l+2,3*c+2)}c-i<n-c?(b2(t,e,i,c),i=c+1):(b2(t,e,c+1,n),n=c)}}function Tu(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}oe(kc,"FeaturePositionMap");class Ds{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}set(e,i,n){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Mu extends Ds{constructor(e){super(e),this.current=0}set(e,i,n){this.fetchUniformLocation(e,i)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}}class Ar extends Ds{constructor(e){super(e),this.current=0}set(e,i,n){this.fetchUniformLocation(e,i)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Rs extends Ds{constructor(e){super(e),this.current=[0,0]}set(e,i,n){this.fetchUniformLocation(e,i)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}}class w2 extends Ds{constructor(e){super(e),this.current=[0,0,0]}set(e,i,n){this.fetchUniformLocation(e,i)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}}class A2 extends Ds{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,n){this.fetchUniformLocation(e,i)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}class _d extends Ds{constructor(e){super(e),this.current=Yt.transparent.toRenderColor(null)}set(e,i,n){this.fetchUniformLocation(e,i)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}const w4=new Float32Array(16);class Bc extends Ds{constructor(e){super(e),this.current=w4}set(e,i,n){if(this.fetchUniformLocation(e,i)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let s=1;s<16;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}}const A4=new Float32Array(9),T4=new Float32Array(4);class T2 extends Ds{constructor(e){super(e),this.current=T4}set(e,i,n){if(this.fetchUniformLocation(e,i)){for(let s=0;s<4;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}}function M2(t){return[fd(255*t.r,255*t.g),fd(255*t.b,255*t.a)]}class Fc{constructor(e,i,n,s){this.value=e,this.uniformNames=i.map(l=>`u_${l}`),this.type=n,this.context=s}setUniform(e,i,n,s,l){const c=s.constantOr(this.value);i.set(e,l,c instanceof Yt?c.toRenderColor(this.context.lut):c)}getBinding(e,i){return this.type==="color"?new _d(e):new Ar(e)}}class c1{constructor(e,i){this.uniformNames=i.map(n=>`u_${n}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,n,s,l){const c=l==="u_pattern"||l==="u_dash"?this.pattern:l==="u_pixel_ratio"?this.pixelRatio:null;c&&i.set(e,l,c)}getBinding(e,i){return i==="u_pattern"||i==="u_dash"?new A2(e):new Ar(e)}}class Ls{constructor(e,i,n,s){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=i.map(l=>({name:`a_${l}`,type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new s}populatePaintArray(e,i,n,s,l,c,d){const f=this.paintVertexArray.length,_=this.expression.evaluate(new dt(0,{brightness:c}),i,{},l,s,d);this.paintVertexArray.resize(e),this._setPaintValue(f,e,_,this.context)}updatePaintArray(e,i,n,s,l,c,d){const f=this.expression.evaluate({zoom:0,brightness:d},n,s,void 0,l);this._setPaintValue(e,i,f,this.context)}_setPaintValue(e,i,n,s){if(this.type==="color"){const l=M2(n.toRenderColor(s.lut));for(let c=e;c<i;c++)this.paintVertexArray.emplace(c,l[0],l[1])}else{for(let l=e;l<i;l++)this.paintVertexArray.emplace(l,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Rn{constructor(e,i,n,s,l,c){this.expression=e,this.uniformNames=i.map(d=>`u_${d}_t`),this.type=n,this.useIntegerZoom=s,this.context=l,this.maxValue=0,this.paintVertexAttributes=i.map(d=>({name:`a_${d}`,type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new c}populatePaintArray(e,i,n,s,l,c,d){const f=this.expression.evaluate(new dt(this.context.zoom,{brightness:c}),i,{},l,s,d),_=this.expression.evaluate(new dt(this.context.zoom+1,{brightness:c}),i,{},l,s,d),y=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(y,e,f,_,this.context)}updatePaintArray(e,i,n,s,l,c,d){const f=this.expression.evaluate({zoom:this.context.zoom,brightness:d},n,s,void 0,l),_=this.expression.evaluate({zoom:this.context.zoom+1,brightness:d},n,s,void 0,l);this._setPaintValue(e,i,f,_,this.context)}_setPaintValue(e,i,n,s,l){if(this.type==="color"){const c=M2(n.toRenderColor(l.lut)),d=M2(n.toRenderColor(l.lut));for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,c[0],c[1],d[0],d[1])}else{for(let c=e;c<i;c++)this.paintVertexArray.emplace(c,n,s);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,n,s,l){const c=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,d=Pt(this.expression.interpolationFactor(c,this.context.zoom,this.context.zoom+1),0,1);i.set(e,l,d)}getBinding(e,i){return new Ar(e)}}class Ia{constructor(e,i,n,s,l){this.expression=e,this.layerId=l,this.paintVertexAttributes=(n==="array"?b4:C4).members;for(let c=0;c<i.length;++c);this.paintVertexArray=new s}populatePaintArray(e,i,n,s){const l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(l,e,i.patterns&&i.patterns[this.layerId],n)}updatePaintArray(e,i,n,s,l,c,d){this._setPaintValues(e,i,n.patterns&&n.patterns[this.layerId],c)}_setPaintValues(e,i,n,s){if(!s||!n)return;const l=s[n];if(!l)return;const{tl:c,br:d,pixelRatio:f}=l;for(let _=e;_<i;_++)this.paintVertexArray.emplace(_,c[0],c[1],d[0],d[1],f)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qo{constructor(e,i,n=()=>!0){this.binders={},this._buffers=[],this.context=i;const s=[];for(const l in e.paint._values){const c=e.paint.get(l);if(!n(l)||!(c instanceof Wi&&g(c.property.specification)))continue;const d=S4(l,e.type),f=c.value,_=c.property.specification.type,y=!!c.property.useIntegerZoom,v=l==="line-dasharray"||l.endsWith("pattern"),C=l==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(f.kind!=="constant"||C)if(f.kind==="source"||C||v){const A=gd(l,_,"source");this.binders[l]=v?new Ia(f,d,_,A,e.id):new Ls(f,d,_,A),s.push(`/a_${l}`)}else{const A=gd(l,_,"composite");this.binders[l]=new Rn(f,d,_,y,i,A),s.push(`/z_${l}`)}else this.binders[l]=v?new c1(f.value,d):new Fc(f.value,d,_,i),s.push(`/u_${l}`)}this.cacheKey=s.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Ls||i instanceof Rn?i.maxValue:0}populatePaintArrays(e,i,n,s,l,c,d){for(const f in this.binders){const _=this.binders[f];_.context=this.context,(_ instanceof Ls||_ instanceof Rn||_ instanceof Ia)&&_.populatePaintArray(e,i,n,s,l,c,d)}}setConstantPatternPositions(e){for(const i in this.binders){const n=this.binders[i];n instanceof c1&&n.setConstantPatternPositions(e)}}updatePaintArrays(e,i,n,s,l,c,d,f){let _=!1;const y=Object.keys(e),v=y.length!==0,C=v?y:i.uniqueIds;this.context.lut=l.lut;for(const A in this.binders){const M=this.binders[A];if(M.context=this.context,(M instanceof Ls||M instanceof Rn||M instanceof Ia)&&(M.expression.isStateDependent===!0||M.expression.isLightConstant===!1)){const I=l.paint.get(A);M.expression=I.value;for(const P of C){const D=e[P.toString()];i.eachPosition(P,(V,N,U)=>{const X=s.feature(V);M.updatePaintArray(N,U,X,D,c,d,f)})}if(!v)for(const P of n.uniqueIds){const D=e[P.toString()];n.eachPosition(P,(V,N,U)=>{const X=s.feature(V);M.updatePaintArray(N,U,X,D,c,d,f)})}_=!0}}return _}defines(){const e=[];for(const i in this.binders){const n=this.binders[i];(n instanceof Fc||n instanceof c1)&&e.push(...n.uniformNames.map(s=>`#define HAS_UNIFORM_${s}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const n=this.binders[i];if(n instanceof Ls||n instanceof Rn||n instanceof Ia)for(let s=0;s<n.paintVertexAttributes.length;s++)e.push(n.paintVertexAttributes[s].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const n=this.binders[i];if(n instanceof Fc||n instanceof c1||n instanceof Rn)for(const s of n.uniformNames)e.push(s)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Fc||s instanceof c1||s instanceof Rn)for(const l of s.uniformNames)i.push({name:l,property:n,binding:s.getBinding(e,l)})}return i}setUniforms(e,i,n,s,l){for(const{name:c,property:d,binding:f}of n)this.binders[d].setUniform(e,f,l,s.get(d),c)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof Ls||i instanceof Rn||i instanceof Ia)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const n=this.binders[i];(n instanceof Ls||n instanceof Rn||n instanceof Ia)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Ls||i instanceof Rn||i instanceof Ia)&&i.destroy()}}}class Pa{constructor(e,i,n=()=>!0){this.programConfigurations={};for(const s of e)this.programConfigurations[s.id]=new qo(s,i,n);this.needsUpload=!1,this._featureMap=new kc,this._featureMapWithoutIds=new kc,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,i,n,s,l,c,d,f){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,i,s,l,c,d,f);i.id!==void 0?this._featureMap.add(i.id,n,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,n,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,n,s,l,c){for(const d of n)this.needsUpload=this.programConfigurations[d.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,i,d,s,l,c||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const M4={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function S4(t,e){return M4[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const E4={"line-pattern":{source:Sa,composite:Sa},"fill-pattern":{source:Sa,composite:Sa},"fill-extrusion-pattern":{source:Sa,composite:Sa},"line-dasharray":{source:Cu,composite:Cu}},I4={color:{source:Lc,composite:Ta},number:{source:l1,composite:Lc}};function gd(t,e,i){const n=E4[t];return n&&n[i]||I4[e][i]}oe(Fc,"ConstantBinder"),oe(c1,"PatternConstantBinder"),oe(Ls,"SourceExpressionBinder"),oe(Ia,"PatternCompositeBinder"),oe(Rn,"CompositeExpressionBinder"),oe(qo,"ProgramConfiguration",{omit:["_buffers"]}),oe(Pa,"ProgramConfigurationSet");const Tr=je/Math.PI/2,S2=5,yd=6,P4=16383,u1=64,E2=[u1,32,16],yn=-Tr,xn=Tr;function h1(t,e,i,n=Tr){return i=Lt(i),[t*Math.sin(i)*n,-e*n,t*Math.cos(i)*n]}function Wo(t,e,i){return h1(Math.cos(Lt(t)),Math.sin(Lt(t)),e,i)}const d1=63710088e-1,I2=2*Math.PI*d1;class Ht{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ht(aa(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,n=this.lat*i,s=e.lat*i,l=Math.sin(n)*Math.sin(s)+Math.cos(n)*Math.cos(s)*Math.cos((e.lng-this.lng)*i);return d1*Math.acos(Math.min(l,1))}toBounds(e=0){const i=360*e/40075017,n=i/Math.cos(Math.PI/180*this.lat);return new Oa({lng:this.lng-n,lat:this.lat-i},{lng:this.lng+n,lat:this.lat+i})}toEcef(e){return Wo(this.lat,this.lng,Tr+e*Tr/d1)}static convert(e){if(e instanceof Ht)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Ht(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Ht(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Oa{constructor(e,i){if(e)if(i)this.setSouthWest(e).setNorthEast(i);else if(e.length===4){const n=e;this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]])}else{const n=e;this.setSouthWest(n[0]).setNorthEast(n[1])}}setNorthEast(e){return this._ne=e instanceof Ht?new Ht(e.lng,e.lat):Ht.convert(e),this}setSouthWest(e){return this._sw=e instanceof Ht?new Ht(e.lng,e.lat):Ht.convert(e),this}extend(e){const i=this._sw,n=this._ne;let s,l;if(e instanceof Ht)s=e,l=e;else{if(!(e instanceof Oa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Oa.convert(e)):this.extend(Ht.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Ht.convert(e)):this;if(s=e._sw,l=e._ne,!s||!l)return this}return i||n?(i.lng=Math.min(s.lng,i.lng),i.lat=Math.min(s.lat,i.lat),n.lng=Math.max(l.lng,n.lng),n.lat=Math.max(l.lat,n.lat)):(this._sw=new Ht(s.lng,s.lat),this._ne=new Ht(l.lng,l.lat)),this}getCenter(){return new Ht((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ht(this.getWest(),this.getNorth())}getSouthEast(){return new Ht(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:n}=Ht.convert(e);let s=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(s=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&s}static convert(e){return!e||e instanceof Oa?e:new Oa(e)}}var xd={};(function(t,e){(function(i){function n(l,c,d){var f=s(256*l,256*(c=Math.pow(2,d)-c-1),d),_=s(256*(l+1),256*(c+1),d);return f[0]+","+f[1]+","+_[0]+","+_[1]}function s(l,c,d){var f=2*Math.PI*6378137/256/Math.pow(2,d);return[l*f-2*Math.PI*6378137/2,c*f-2*Math.PI*6378137/2]}i.getURL=function(l,c,d,f,_,y){return y=y||{},l+"?"+["bbox="+n(d,f,_),"format="+(y.format||"image/png"),"service="+(y.service||"WMS"),"version="+(y.version||"1.1.1"),"request="+(y.request||"GetMap"),"srs="+(y.srs||"EPSG:3857"),"width="+(y.width||256),"height="+(y.height||256),"layers="+c].join("&")},i.getTileBBox=n,i.getMercCoords=s,Object.defineProperty(i,"__esModule",{value:!0})})(e)})(0,xd);var O4=xd;class Ho{constructor(e,i,n){this.z=e,this.x=i,this.y=n,this.key=p1(0,e,e,i,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const n=O4.getTileBBox(this.x,this.y,this.z),s=function(l,c,d){let f,_="";for(let y=l;y>0;y--)f=1<<y-1,_+=(c&f?1:0)+(d&f?2:0);return _}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",s).replace("{bbox-epsg-3857}",n)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vd{constructor(e,i){this.wrap=e,this.canonical=i,this.key=p1(e,i.z,i.z,i.x,i.y)}}class $i{constructor(e,i,n,s,l){this.overscaledZ=e,this.wrap=i,this.canonical=new Ho(n,+s,+l),this.key=i===0&&e===n?this.canonical.key:p1(i,e,n,s,l)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new $i(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $i(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return p1(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-e;return p1(this.wrap*+i,e,e,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new $i(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,n=2*this.canonical.x,s=2*this.canonical.y;return[new $i(i,this.wrap,i,n,s),new $i(i,this.wrap,i,n+1,s),new $i(i,this.wrap,i,n,s+1),new $i(i,this.wrap,i,n+1,s+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new $i(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new $i(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function p1(t,e,i,n,s){const l=1<<Math.min(i,22);let c=l*(s%l)+n%l;return t&&i<22&&(c+=l*l*((t<0?-2*t-1:2*t)%(1<<2*(22-i)))),16*(32*c+i)+(e-i)}const z4=[t=>{let e=t.canonical.x-1,i=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,i--),new $i(t.overscaledZ,i,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,i=t.wrap;return e===1<<t.canonical.z&&(e=0,i++),new $i(t.overscaledZ,i,t.canonical.z,e,t.canonical.y)},t=>new $i(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(t.canonical.y===0?1<<t.canonical.z:t.canonical.y)-1),t=>new $i(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];oe(Ho,"CanonicalTileID"),oe($i,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const D4=0,R4=25.5;function P2(t){return I2*Math.cos(t*Math.PI/180)}function ss(t){return(180+t)/360}function as(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Mr(t,e){return t/P2(e)}function Fr(t){return 360*t-180}function Qi(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Cd(t,e){return t*P2(Qi(e))}const ki=85.051129;function bd(t){return Math.cos(Lt(Pt(t,-ki,ki)))}function Xo(t,e){const i=Pt(e,D4,R4),n=Math.pow(2,i);return bd(t)*I2/(512*n)}function wd(t){return 1/Math.cos(t*Math.PI/180)}function Su(t,e=0){const i=Math.exp(Math.PI*(1-(t.y+e/je)/(1<<t.z)*2));return 80150034*i/(i*i+1)/je/(1<<t.z)}class yr{constructor(e,i,n=0){this.x=+e,this.y=+i,this.z=+n}static fromLngLat(e,i=0){const n=Ht.convert(e);return new yr(ss(n.lng),as(n.lat),Mr(i,n.lat))}toLngLat(){return new Ht(Fr(this.x),Qi(this.y))}toAltitude(){return Cd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/I2*wd(Qi(this.y))}}function O2(t,e,i,n,s,l,c,d,f){const _=(e+n)/2,y=(i+s)/2,v=new Ze(_,y);d(v),function(C,A,M,I,P,D){const V=M-P,N=I-D;return Math.abs((I-A)*V-(M-C)*N)/Math.hypot(V,N)}(v.x,v.y,l.x,l.y,c.x,c.y)>=f?(O2(t,e,i,_,y,l,v,d,f),O2(t,_,y,n,s,v,c,d,f)):t.push(c)}function Ad(t,e,i){let n=t[0],s=n.x,l=n.y;e(n);const c=[n];for(let d=1;d<t.length;d++){const f=t[d],{x:_,y}=f;e(f),O2(c,s,l,_,y,n,f,e,i),s=_,l=y,n=f}return c}function z2(t,e,i,n){if(n(e,i)){const s=e.add(i)._mult(.5);z2(t,e,s,n),z2(t,s,i,n)}else t.push(i)}function L4(t,e){let i=t[0];const n=[i];for(let s=1;s<t.length;s++){const l=t[s];z2(n,i,l,e),i=l}return n}const D2=Math.pow(2,14)-1,Td=-D2-1;function k4(t,e){const i=Math.round(t.x*e),n=Math.round(t.y*e);return t.x=Pt(i,Td,D2),t.y=Pt(n,Td,D2),(i<t.x||i>t.x+1||n<t.y||n>t.y+1)&&Di("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Ln(t,e,i){const n=t.loadGeometry(),s=t.extent,l=je/s;if(e&&i&&i.projection.isReprojectedInTileSpace){const c=1<<e.z,{scale:d,x:f,y:_,projection:y}=i,v=C=>{const A=Fr((e.x+C.x/s)/c),M=Qi((e.y+C.y/s)/c),I=y.project(A,M);C.x=(I.x*d-f)*s,C.y=(I.y*d-_)*s};for(let C=0;C<n.length;C++)if(t.type!==1)n[C]=Ad(n[C],v,1);else{const A=[];for(const M of n[C])M.x<0||M.x>=s||M.y<0||M.y>=s||(v(M),A.push(M));n[C]=A}}for(const c of n)for(const d of c)k4(d,l);return n}function ks(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Ln(t):[]}}function Eu(t,e,i,n,s){t.emplaceBack(2*e+(n+1)/2,2*i+(s+1)/2)}function Iu(t,e,i){t.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class R2{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Dn,this.indexArray=new Hi,this.segments=new wi,this.programConfigurations=new Pa(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}updateFootprints(e,i){}populate(e,i,n,s){const l=this.layers[0],c=[];let d=null;l.type==="circle"&&(d=l.layout.get("circle-sort-key"));for(const{feature:_,id:y,index:v,sourceLayerIndex:C}of e){const A=this.layers[0]._featureFilter.needGeometry,M=ks(_,A);if(!this.layers[0]._featureFilter.filter(new dt(this.zoom),M,n))continue;const I=d?d.evaluate(M,{},n):void 0,P={id:y,properties:_.properties,type:_.type,sourceLayerIndex:C,index:v,geometry:A?M.geometry:Ln(_,n,s),patterns:{},sortKey:I};c.push(P)}d&&c.sort((_,y)=>_.sortKey-y.sortKey);let f=null;s.projection.name==="globe"&&(this.globeExtVertexArray=new bu,f=s.projection);for(const _ of c){const{geometry:y,index:v,sourceLayerIndex:C}=_,A=e[v].feature;this.addFeature(_,y,v,i.availableImages,n,f,i.brightness),i.featureIndex.insert(A,y,v,C,this.index)}}update(e,i,n,s,l){const c=Object.keys(e).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,c?this.stateDependentLayers:this.layers,n,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,x4.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,v4.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,n,s,l,c,d){for(const f of i)for(const _ of f){const y=_.x,v=_.y;if(y<0||y>=je||v<0||v>=je)continue;if(c){const M=c.projectTilePoint(y,v,l),I=c.upVector(l,y,v),P=this.globeExtVertexArray;Iu(P,M,I),Iu(P,M,I),Iu(P,M,I),Iu(P,M,I)}const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),A=C.vertexLength;Eu(this.layoutVertexArray,y,v,-1,-1),Eu(this.layoutVertexArray,y,v,1,-1),Eu(this.layoutVertexArray,y,v,1,1),Eu(this.layoutVertexArray,y,v,-1,1),this.indexArray.emplaceBack(A,A+1,A+2),this.indexArray.emplaceBack(A,A+2,A+3),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},s,l,d)}}function L2(t,e){for(let i=0;i<t.length;i++)if(za(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(za(t,e[i]))return!0;return!!k2(t,e)}function B4(t,e,i){return!!za(t,e)||!!B2(e,t,i)}function Md(t,e){if(t.length===1)return Ed(e,t[0]);for(let i=0;i<e.length;i++){const n=e[i];for(let s=0;s<n.length;s++)if(za(t,n[s]))return!0}for(let i=0;i<t.length;i++)if(Ed(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(k2(t,e[i]))return!0;return!1}function F4(t,e,i){if(t.length>1){if(k2(t,e))return!0;for(let n=0;n<e.length;n++)if(B2(e[n],t,i))return!0}for(let n=0;n<t.length;n++)if(B2(t[n],e,i))return!0;return!1}function k2(t,e){if(t.length===0||e.length===0)return!1;for(let i=0;i<t.length-1;i++){const n=t[i],s=t[i+1];for(let l=0;l<e.length-1;l++)if(j4(n,s,e[l],e[l+1]))return!0}return!1}function j4(t,e,i,n){return Xn(t,i,n)!==Xn(e,i,n)&&Xn(t,e,i)!==Xn(t,e,n)}function B2(t,e,i){const n=i*i;if(e.length===1)return t.distSqr(e[0])<n;for(let s=1;s<e.length;s++)if(Sd(t,e[s-1],e[s])<n)return!0;return!1}function Sd(t,e,i){const n=e.distSqr(i);if(n===0)return t.distSqr(e);const s=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return t.distSqr(s<0?e:s>1?i:i.sub(e)._mult(s)._add(e))}function Ed(t,e){let i,n,s,l=!1;for(let c=0;c<t.length;c++){i=t[c];for(let d=0,f=i.length-1;d<i.length;f=d++)n=i[d],s=i[f],n.y>e.y!=s.y>e.y&&e.x<(s.x-n.x)*(e.y-n.y)/(s.y-n.y)+n.x&&(l=!l)}return l}function za(t,e){let i=!1;for(let n=0,s=t.length-1;n<t.length;s=n++){const l=t[n],c=t[s];l.y>e.y!=c.y>e.y&&e.x<(c.x-l.x)*(e.y-l.y)/(c.y-l.y)+l.x&&(i=!i)}return i}function Id(t,e,i,n,s){for(const c of t)if(e<=c.x&&i<=c.y&&n>=c.x&&s>=c.y)return!0;const l=[new Ze(e,i),new Ze(e,s),new Ze(n,s),new Ze(n,i)];if(t.length>2){for(const c of l)if(za(t,c))return!0}for(let c=0;c<t.length-1;c++)if(N4(t[c],t[c+1],l))return!0;return!1}function N4(t,e,i){const n=i[0],s=i[2];if(t.x<n.x&&e.x<n.x||t.x>s.x&&e.x>s.x||t.y<n.y&&e.y<n.y||t.y>s.y&&e.y>s.y)return!1;const l=Xn(t,e,i[0]);return l!==Xn(t,e,i[1])||l!==Xn(t,e,i[2])||l!==Xn(t,e,i[3])}function f1(t,e,i,n,s,l){let c=e.y-t.y,d=t.x-e.x;if(l=l||0){const f=c*c+d*d;if(f===0)return!0;const _=Math.sqrt(f);c/=_,d/=_}return!((i.x-t.x)*c+(i.y-t.y)*d-l<0||(n.x-t.x)*c+(n.y-t.y)*d-l<0||(s.x-t.x)*c+(s.y-t.y)*d-l<0)}function F2(t,e,i,n,s,l,c){return!(f1(t,e,n,s,l,c)||f1(e,i,n,s,l,c)||f1(i,t,n,s,l,c)||f1(n,s,t,e,i,c)||f1(s,l,t,e,i,c)||f1(l,n,t,e,i,c))}function m1(t,e,i){const n=e.paint.get(t).value;return n.kind==="constant"?n.value:i.programConfigurations.get(e.id).getMaxValue(t)}function Pu(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Pd(t,e,i,n,s){if(!e[0]&&!e[1])return t;const l=Ze.convert(e)._mult(s);i==="viewport"&&l._rotate(-n);const c=[];for(let d=0;d<t.length;d++)c.push(t[d].sub(l));return c}function Od(t,e,i,n){const s=Ze.convert(t)._mult(n);return e==="viewport"&&s._rotate(-i),s}let zd,Dd;oe(R2,"CircleBucket",{omit:["layers"]});class j2{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,n){const s=a.$.dot(i,this.dir);if(Math.abs(s)<1e-6)return!1;const l=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/s;return n[0]=this.pos[0]+this.dir[0]*l,n[1]=this.pos[1]+this.dir[1]*l,n[2]=this.pos[2]+this.dir[2]*l,!0}closestPointOnSphere(e,i,n){if(a.$.equals(this.pos,e)||i===0)return n[0]=n[1]=n[2]=0,!1;const[s,l,c]=this.dir,d=this.pos[0]-e[0],f=this.pos[1]-e[1],_=this.pos[2]-e[2],y=s*s+l*l+c*c,v=2*(d*s+f*l+_*c),C=v*v-4*y*(d*d+f*f+_*_-i*i);if(C<0){const A=Math.max(-v/2,0),M=d+s*A,I=f+l*A,P=_+c*A,D=Math.hypot(M,I,P);return n[0]=M*i/D,n[1]=I*i/D,n[2]=P*i/D,!1}{const A=(-v-Math.sqrt(C))/(2*y);if(A<0){const M=Math.hypot(d,f,_);return n[0]=d*i/M,n[1]=f*i/M,n[2]=_*i/M,!1}return n[0]=d+s*A,n[1]=f+l*A,n[2]=_+c*A,!0}}}class N2{constructor(e,i,n,s,l){this.TL=e,this.TR=i,this.BR=n,this.BL=s,this.horizon=l}static fromInvProjectionMatrix(e,i,n){const s=[-1,1,1],l=[1,1,1],c=[1,-1,1],d=[-1,-1,1],f=a.$.transformMat4(s,s,e),_=a.$.transformMat4(l,l,e),y=a.$.transformMat4(c,c,e),v=a.$.transformMat4(d,d,e);return new N2(f,_,y,v,i/n)}}function jc(t,e,i){let n=1/0,s=-1/0;const l=[];for(const c of t){a.$.sub(l,c,e);const d=a.$.dot(l,i);n=Math.min(n,d),s=Math.max(s,d)}return[n,s]}function Rd(t,e){let i=!0;for(let n=0;n<t.planes.length;n++){const s=t.planes[n];let l=0;for(let c=0;c<e.length;c++)l+=a.$.dot(s,e[c])+s[3]>=0;if(l===0)return 0;l!==e.length&&(i=!1)}return i?2:1}function Ld(t,e){for(const i of t.projections){const n=jc(e,t.points[0],i.axis);if(i.projection[1]<n[0]||i.projection[0]>n[1])return 0}return 1}function kd(t,e){let i=0;const n=[0,0,0,0];for(let s=0;s<t.length;s++)n[0]=t[s][0],n[1]=t[s][1],n[2]=t[s][2],n[3]=1,a.aB.dot(n,e)>=0&&i++;return i}class V2{constructor(e,i){this.points=e||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=vi.fromPoints(this.points),this.projections=[],this.frustumEdges=[a.$.sub([],this.points[2],this.points[3]),a.$.sub([],this.points[0],this.points[3]),a.$.sub([],this.points[4],this.points[0]),a.$.sub([],this.points[5],this.points[1]),a.$.sub([],this.points[6],this.points[2]),a.$.sub([],this.points[7],this.points[3])];for(const n of this.frustumEdges){const s=[0,-n[2],n[1]],l=[n[2],0,-n[0]];this.projections.push({axis:s,projection:jc(this.points,this.points[0],s)}),this.projections.push({axis:l,projection:jc(this.points,this.points[0],l)})}}static fromInvProjectionMatrix(e,i,n,s){const l=Math.pow(2,n),c=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(_=>{const y=a.aB.transformMat4([],_,e),v=1/y[3]/i*l;return a.aB.mul(y,y,[v,v,s?1/y[3]:v,v])}),d=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(_=>{const y=a.$.sub([],c[_[0]],c[_[1]]),v=a.$.sub([],c[_[2]],c[_[1]]),C=a.$.normalize([],a.$.cross([],y,v)),A=-a.$.dot(C,c[_[1]]);return C.concat(A)}),f=[];for(let _=0;_<c.length;_++)f.push([c[_][0],c[_][1],c[_][2]]);return new V2(f,d)}intersectsPrecise(e,i,n){for(let s=0;s<i.length;s++)if(!kd(e,i[s]))return 0;for(let s=0;s<this.planes.length;s++)if(!kd(e,this.planes[s]))return 0;for(const s of n)for(const l of this.frustumEdges){const c=a.$.cross([],s,l),d=a.$.length(c);if(d===0)continue;a.$.scale(c,c,1/d);const f=jc(this.points,this.points[0],c),_=jc(e,this.points[0],c);if(f[0]>_[1]||_[0]>f[1])return 0}return 1}containsPoint(e){for(const i of this.planes){const n=i[3];if(a.$.dot([i[0],i[1],i[2]],e)+n<0)return!1}return!0}}class vi{static fromPoints(e){const i=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];for(const s of e)a.$.min(i,i,s),a.$.max(n,n,s);return new vi(i,n)}static fromTileIdAndHeight(e,i,n){const s=1<<e.canonical.z,l=e.canonical.x,c=e.canonical.y;return new vi([l/s,c/s,i],[(l+1)/s,(c+1)/s,n])}static applyTransform(e,i){const n=e.getCorners();for(let s=0;s<n.length;++s)a.$.transformMat4(n[s],n[s],i);return vi.fromPoints(n)}static applyTransformFast(e,i){const n=[i[12],i[13],i[14]],s=[...n];for(let l=0;l<3;l++)for(let c=0;c<3;c++){const d=i[4*c+l],f=d*e.min[c],_=d*e.max[c];n[l]+=Math.min(f,_),s[l]+=Math.max(f,_)}return new vi(n,s)}static projectAabbCorners(e,i){const n=e.getCorners();for(let s=0;s<n.length;++s)a.$.transformMat4(n[s],n[s],i);return n}constructor(e,i){this.min=e,this.max=i,this.center=a.$.scale([],a.$.add([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],n=a.$.clone(this.min),s=a.$.clone(this.max);for(let l=0;l<i.length;l++)n[l]=i[l]?this.min[l]:this.center[l],s[l]=i[l]?this.center[l]:this.max[l];return s[2]=this.max[2],new vi(n,s)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?Rd(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?Rd(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,i){return i||this.intersects(e)?Ld(e,this.getCorners()):0}intersectsPreciseFlat(e,i){return i||this.intersectsFlat(e)?Ld(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let i=0;i<3;++i)if(this.min[i]>e.max[i]||e.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e.min[i]),this.max[i]=Math.max(this.max[i],e.max[i])}encapsulatePoint(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e[i]),this.max[i]=Math.max(this.max[i],e[i])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}oe(vi,"Aabb");const V4=ei([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ou}=V4,Bd=ei([{name:"a_pos_3",components:3,type:"Int16"}]);var Nc=ei([{name:"a_pos",type:"Int16",components:2}]);function zu(t){return t*Tr/d1}const U4=[new vi([yn,yn,yn],[xn,xn,xn]),new vi([yn,yn,yn],[0,0,xn]),new vi([0,yn,yn],[xn,0,xn]),new vi([yn,0,yn],[0,xn,xn]),new vi([0,0,yn],[xn,xn,xn])];function Fd(t,e,i,n=!0){const s=a.$.scale([],t._camera.position,t.worldSize),l=[e,i,1,1];a.aB.transformMat4(l,l,t.pixelMatrixInverse),a.aB.scale(l,l,1/l[3]);const c=a.$.sub([],l,s),d=a.$.normalize([],c),f=t.globeMatrix,_=[f[12],f[13],f[14]],y=a.$.sub([],_,s),v=a.$.length(y),C=a.$.normalize([],y),A=t.worldSize/(2*Math.PI),M=a.$.dot(C,d),I=Math.asin(A/v);if(I<Math.acos(M)){if(!n)return null;const fe=[],we=[];a.$.scale(fe,d,v/M),a.$.normalize(we,a.$.sub(we,fe,y)),a.$.normalize(d,a.$.add(d,y,a.$.scale(d,we,Math.tan(I)*v)))}const P=[];new j2(s,d).closestPointOnSphere(_,A,P);const D=a.$.normalize([],Kn(f,0)),V=a.$.normalize([],Kn(f,1)),N=a.$.normalize([],Kn(f,2)),U=a.$.dot(D,P),X=a.$.dot(V,P),Y=a.$.dot(N,P),ee=vr(Math.asin(-X/A));let le=vr(Math.atan2(U,Y));le=t.center.lng+function(fe,we){const De=(we-fe+180)%360-180;return De<-180?De+360:De}(t.center.lng,le);const pe=ss(le),xe=Pt(as(ee),0,1);return new yr(pe,xe)}class Z4{constructor(e,i,n){this.a=a.$.sub([],e,n),this.b=a.$.sub([],i,n),this.center=n;const s=a.$.normalize([],this.a),l=a.$.normalize([],this.b);this.angle=Math.acos(a.$.dot(s,l))}}function U2(t,e){if(t.angle===0)return null;let i;return i=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),i<0||i>1?null:function(n,s,l,c){const d=Math.sin(l);return n*(Math.sin((1-c)*l)/d)+s*(Math.sin(c*l)/d)}(t.a[e],t.b[e],t.angle,Pt(i,0,1))+t.center[e]}function os(t){if(t.z<=1)return U4[t.z+2*t.y+t.x];const e=Z2(Du(t));return vi.fromPoints(e)}function Bs(t,e,i){return a.$.scale(t,t,1-i),a.$.scaleAndAdd(t,t,e,i)}function jd(t,e){const i=Fs(e.zoom);if(i===0)return os(t);const n=Du(t),s=Z2(n),l=ss(n.getWest())*e.worldSize,c=ss(n.getEast())*e.worldSize,d=as(n.getNorth())*e.worldSize,f=as(n.getSouth())*e.worldSize,_=[l,d,0],y=[c,d,0],v=[l,f,0],C=[c,f,0],A=a.ae.invert([],e.globeMatrix);return a.$.transformMat4(_,_,A),a.$.transformMat4(y,y,A),a.$.transformMat4(v,v,A),a.$.transformMat4(C,C,A),s[0]=Bs(s[0],v,i),s[1]=Bs(s[1],C,i),s[2]=Bs(s[2],y,i),s[3]=Bs(s[3],_,i),vi.fromPoints(s)}function Nd(t,e,i){for(const n of t)a.$.transformMat4(n,n,e),a.$.scale(n,n,i)}function Vd(t,e,i,n){const s=e/t.worldSize,l=t.globeMatrix;if(i.z<=1){const pe=os(i).getCorners();return Nd(pe,l,s),vi.fromPoints(pe)}const c=Du(i,n),d=Z2(c,Tr+zu(t._tileCoverLift));Nd(d,l,s);const f=Number.MAX_VALUE,_=[-f,-f,-f],y=[f,f,f];if(c.contains(t.center)){for(const fe of d)a.$.min(y,y,fe),a.$.max(_,_,fe);_[2]=0;const pe=t.point,xe=[pe.x*s,pe.y*s,0];return a.$.min(y,y,xe),a.$.max(_,_,xe),new vi(y,_)}if(t._tileCoverLift>0){for(const pe of d)a.$.min(y,y,pe),a.$.max(_,_,pe);return new vi(y,_)}const v=[l[12]*s,l[13]*s,l[14]*s],C=c.getCenter(),A=Pt(t.center.lat,-ki,ki),M=Pt(C.lat,-ki,ki),I=ss(t.center.lng),P=as(A);let D=I-ss(C.lng);const V=P-as(M);D>.5?D-=1:D<-.5&&(D+=1);let N=0;if(Math.abs(D)>Math.abs(V))N=D>=0?1:3;else{N=V>=0?0:2;const pe=[l[4]*s,l[5]*s,l[6]*s],xe=-Math.sin(Lt(V>=0?c.getSouth():c.getNorth()))*Tr;a.$.scaleAndAdd(v,v,pe,xe)}const U=d[N],X=d[(N+1)%4],Y=new Z4(U,X,v),ee=[U2(Y,0)||U[0],U2(Y,1)||U[1],U2(Y,2)||U[2]],le=Fs(t.zoom);if(le>0){const pe=function({x:fe,y:we,z:De},Ae,ke,be,Ee){const Fe=1/(1<<De);let Te=fe*Fe,Ve=Te+Fe,Be=we*Fe,Re=Be+Fe,rt=0;const tt=(Te+Ve)/2-be;return tt>.5?rt=-1:tt<-.5&&(rt=1),Te=((Te+rt)*Ae-(be*=Ae))*ke+be,Ve=((Ve+rt)*Ae-be)*ke+be,Be=(Be*Ae-(Ee*=Ae))*ke+Ee,Re=(Re*Ae-Ee)*ke+Ee,[[Te,Re,0],[Ve,Re,0],[Ve,Be,0],[Te,Be,0]]}(i,e,t._pixelsPerMercatorPixel,I,P);for(let fe=0;fe<d.length;fe++)Bs(d[fe],pe[fe],le);const xe=a.$.add([],pe[N],pe[(N+1)%4]);a.$.scale(xe,xe,.5),Bs(ee,xe,le)}for(const pe of d)a.$.min(y,y,pe),a.$.max(_,_,pe);return y[2]=Math.min(U[2],X[2]),a.$.min(y,y,ee),a.$.max(_,_,ee),new vi(y,_)}function Du({x:t,y:e,z:i},n=!1){const s=1/(1<<i),l=new Ht(Fr(t*s),e===(1<<i)-1&&n?-90:Qi((e+1)*s)),c=new Ht(Fr((t+1)*s),e===0&&n?90:Qi(e*s));return new Oa(l,c)}function Z2(t,e=Tr){const i=Lt(t.getNorth()),n=Lt(t.getSouth()),s=Math.cos(i),l=Math.cos(n),c=Math.sin(i),d=Math.sin(n),f=t.getWest(),_=t.getEast();return[h1(l,d,f,e),h1(l,d,_,e),h1(s,c,_,e),h1(s,c,f,e)]}function Vc(t,e,i,n){const s=1<<i.z,l=(t/je+i.x)/s;return Wo(Qi((e/je+i.y)/s),Fr(l),n)}function Ru({min:t,max:e}){return P4/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const Ud=new Float64Array(16);function Uc(t){const e=Ru(t),i=a.ae.fromScaling(Ud,[e,e,e]);return a.ae.translate(i,i,a.$.negate([],t.min))}function $2(t){const e=a.ae.fromTranslation(Ud,t.min),i=1/Ru(t);return a.ae.scale(e,e,[i,i,i])}function G2(t){const e=je/(2*Math.PI);return t/(2*Math.PI)/e}function Zd(t,e){return je/(512*Math.pow(2,t))*Ru(os(e))}function $d(t,e,i,n,s){const l=G2(i),c=[t,e,-i/(2*Math.PI)],d=a.ae.identity(new Float64Array(16));return a.ae.translate(d,d,c),a.ae.scale(d,d,[l,l,l]),a.ae.rotateX(d,d,Lt(-s)),a.ae.rotateY(d,d,Lt(-n)),d}function Fs(t){return W1(S2,yd,t)}function Gd(t,e){const i=Wo(e.lat,e.lng),n=function(l){const c=Wo(l._center.lat,l._center.lng),d=a.$.fromValues(0,1,0);let f=a.$.cross([],d,c);const _=a.ae.fromRotation([],-l.angle,c);f=a.$.transformMat4(f,f,_),a.ae.fromRotation(_,-l._pitch,f);const y=a.$.normalize([],c);return a.$.scale(y,y,zu(l.cameraToCenterDistance/l.pixelsPerMeter)),a.$.transformMat4(y,y,_),a.$.add([],c,y)}(t),s=a.$.subtract([],n,i);return a.$.angle(s,i)}function q2(t,e){return Gd(t,e)>Math.PI/2*1.01}const qd=Lt(85),$4=Math.cos(qd),G4=Math.sin(qd),q4=a.ae.create(),Wd=t=>{const e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function Hd(t,e,i,n,s,l,c,d,f){if(l&&t.queryGeometry.isAboveHorizon)return!1;l&&(f*=t.pixelToTileUnitsFactor);const _=t.tileID.canonical,y=i.projection.upVectorScale(_,i.center.lat,i.worldSize).metersToTile;for(const v of e)for(const C of v){const A=C.add(d),M=s&&i.elevation?i.elevation.exaggeration()*s.getElevationAt(A.x,A.y,!0):0,I=i.projection.projectTilePoint(A.x,A.y,_);if(M>0){const N=i.projection.upVector(_,A.x,A.y);I.x+=N[0]*y*M,I.y+=N[1]*y*M,I.z+=N[2]*y*M}const P=l?A:W4(I.x,I.y,I.z,n),D=l?t.tilespaceRays.map(N=>X4(N,M)):t.queryGeometry.screenGeometry,V=a.aB.transformMat4([],[I.x,I.y,I.z,1],n);if(!c&&l?f*=V[3]/i.cameraToCenterDistance:c&&!l&&(f*=i.cameraToCenterDistance/V[3]),l){const N=Qi((C.y/je+_.y)/(1<<_.z));f/=i.projection.pixelsPerMeter(N,1)/Mr(1,N)}if(B4(D,P,f))return!0}return!1}function W4(t,e,i,n){const s=a.aB.transformMat4([],[t,e,i,1],n);return new Ze(s[0]/s[3],s[1]/s[3])}const Xd=a.$.fromValues(0,0,0),H4=a.$.fromValues(0,0,1);function X4(t,e){const i=a.$.create();return Xd[2]=e,t.intersectsPlane(Xd,H4,i),new Ze(i[0],i[1])}class Yd extends R2{}function Jd(t,{width:e,height:i},n,s){if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==e*i*n)throw new RangeError("mismatched image size")}else s=new Uint8Array(e*i*n);return t.width=e,t.height=i,t.data=s,t}function Kd(t,e,i){const{width:n,height:s}=e;n===t.width&&s===t.height||(W2(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,n),height:Math.min(t.height,s)},i,null),t.width=n,t.height=s,t.data=e.data)}function W2(t,e,i,n,s,l,c,d){if(s.width===0||s.height===0)return e;if(s.width>t.width||s.height>t.height||i.x>t.width-s.width||i.y>t.height-s.height)throw new RangeError("out of range source coordinates for image copy");if(s.width>e.width||s.height>e.height||n.x>e.width-s.width||n.y>e.height-s.height)throw new RangeError("out of range destination coordinates for image copy");const f=t.data,_=e.data,y=l===4&&d;for(let v=0;v<s.height;v++){const C=((i.y+v)*t.width+i.x)*l,A=((n.y+v)*e.width+n.x)*l;if(y)for(let M=0;M<s.width;M++){const I=C+M*l+3,P=A+M*l;_[P+0]=255,_[P+1]=255,_[P+2]=255,_[P+3]=f[I]}else if(c)for(let M=0;M<s.width;M++){const I=C+M*l,P=A+M*l,D=f[I+3],V=new Yt(f[I+0]/255*D,f[I+1]/255*D,f[I+2]/255*D,D).toRenderColor(c).toArray();_[P+0]=V[0],_[P+1]=V[1],_[P+2]=V[2],_[P+3]=V[3]}else for(let M=0;M<s.width*l;M++)_[A+M]=f[C+M]}return e}oe(Yd,"HeatmapBucket",{omit:["layers"]});class Da{constructor(e,i){Jd(this,e,1,i)}resize(e){Kd(this,new Da(e),1)}clone(){return new Da({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,n,s,l){W2(e,i,n,s,l,1,null)}}class ln{constructor(e,i){Jd(this,e,4,i)}resize(e){Kd(this,new ln(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new ln({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,n,s,l,c,d){W2(e,i,n,s,l,4,c,d)}}class Qd{constructor(e,i){this.width=e.width,this.height=e.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}let ep,tp,ip,rp;function Zc(t){const e={},i=t.resolution||256,n=t.clips?t.clips.length:1,s=t.image||new ln({width:i,height:n}),l=(c,d,f)=>{e[t.evaluationKey]=f;const _=t.expression.evaluate(e);_&&(s.data[c+d+0]=Math.floor(255*_.r/_.a),s.data[c+d+1]=Math.floor(255*_.g/_.a),s.data[c+d+2]=Math.floor(255*_.b/_.a),s.data[c+d+3]=Math.floor(255*_.a))};if(t.clips)for(let c=0,d=0;c<n;++c,d+=4*i)for(let f=0,_=0;f<i;f++,_+=4){const y=f/(i-1),{start:v,end:C}=t.clips[c];l(d,_,v*(1-y)+C*y)}else for(let c=0,d=0;c<i;c++,d+=4)l(0,d,c/(i-1));return s}oe(Da,"AlphaImage"),oe(ln,"RGBAImage");const Y4=ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:J4}=Y4;function $c(t,e,i=2){const n=e&&e.length,s=n?e[0]*i:t.length;let l=np(t,0,s,i,!0);const c=[];if(!l||l.next===l.prev)return c;let d,f,_;if(n&&(l=function(y,v,C,A){const M=[];for(let I=0,P=v.length;I<P;I++){const D=np(y,v[I]*A,I<P-1?v[I+1]*A:y.length,A,!1);D===D.next&&(D.steiner=!0),M.push(s6(D))}M.sort(i6);for(let I=0;I<M.length;I++)C=r6(M[I],C);return C}(t,e,l,i)),t.length>80*i){d=1/0,f=1/0;let y=-1/0,v=-1/0;for(let C=i;C<s;C+=i){const A=t[C],M=t[C+1];A<d&&(d=A),M<f&&(f=M),A>y&&(y=A),M>v&&(v=M)}_=Math.max(y-d,v-f),_=_!==0?32767/_:0}return Gc(l,c,i,d,f,_,0),c}function np(t,e,i,n,s){let l;if(s===function(c,d,f,_){let y=0;for(let v=d,C=f-_;v<f;v+=_)y+=(c[C]-c[v])*(c[v+1]+c[C+1]),C=v;return y}(t,e,i,n)>0)for(let c=e;c<i;c+=n)l=op(c/n|0,t[c],t[c+1],l);else for(let c=i-n;c>=e;c-=n)l=op(c/n|0,t[c],t[c+1],l);return l&&Lu(l,l.next)&&(Wc(l),l=l.next),l}function Yo(t,e){if(!t)return t;e||(e=t);let i,n=t;do if(i=!1,n.steiner||!Lu(n,n.next)&&Gi(n.prev,n,n.next)!==0)n=n.next;else{if(Wc(n),n=e=n.prev,n===n.next)break;i=!0}while(i||n!==e);return e}function Gc(t,e,i,n,s,l,c){if(!t)return;!c&&l&&function(f,_,y,v){let C=f;do C.z===0&&(C.z=H2(C.x,C.y,_,y,v)),C.prevZ=C.prev,C.nextZ=C.next,C=C.next;while(C!==f);C.prevZ.nextZ=null,C.prevZ=null,function(A){let M,I=1;do{let P,D=A;A=null;let V=null;for(M=0;D;){M++;let N=D,U=0;for(let Y=0;Y<I&&(U++,N=N.nextZ,N);Y++);let X=I;for(;U>0||X>0&&N;)U!==0&&(X===0||!N||D.z<=N.z)?(P=D,D=D.nextZ,U--):(P=N,N=N.nextZ,X--),V?V.nextZ=P:A=P,P.prevZ=V,V=P;D=N}V.nextZ=null,I*=2}while(M>1)}(C)}(t,n,s,l);let d=t;for(;t.prev!==t.next;){const f=t.prev,_=t.next;if(l?Q4(t,n,s,l):K4(t))e.push(f.i,t.i,_.i),Wc(t),t=_.next,d=_.next;else if((t=_)===d){c?c===1?Gc(t=e6(Yo(t),e),e,i,n,s,l,2):c===2&&t6(t,e,i,n,s,l):Gc(Yo(t),e,i,n,s,l,1);break}}}function K4(t){const e=t.prev,i=t,n=t.next;if(Gi(e,i,n)>=0)return!1;const s=e.x,l=i.x,c=n.x,d=e.y,f=i.y,_=n.y,y=s<l?s<c?s:c:l<c?l:c,v=d<f?d<_?d:_:f<_?f:_,C=s>l?s>c?s:c:l>c?l:c,A=d>f?d>_?d:_:f>_?f:_;let M=n.next;for(;M!==e;){if(M.x>=y&&M.x<=C&&M.y>=v&&M.y<=A&&_1(s,d,l,f,c,_,M.x,M.y)&&Gi(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function Q4(t,e,i,n){const s=t.prev,l=t,c=t.next;if(Gi(s,l,c)>=0)return!1;const d=s.x,f=l.x,_=c.x,y=s.y,v=l.y,C=c.y,A=d<f?d<_?d:_:f<_?f:_,M=y<v?y<C?y:C:v<C?v:C,I=d>f?d>_?d:_:f>_?f:_,P=y>v?y>C?y:C:v>C?v:C,D=H2(A,M,e,i,n),V=H2(I,P,e,i,n);let N=t.prevZ,U=t.nextZ;for(;N&&N.z>=D&&U&&U.z<=V;){if(N.x>=A&&N.x<=I&&N.y>=M&&N.y<=P&&N!==s&&N!==c&&_1(d,y,f,v,_,C,N.x,N.y)&&Gi(N.prev,N,N.next)>=0||(N=N.prevZ,U.x>=A&&U.x<=I&&U.y>=M&&U.y<=P&&U!==s&&U!==c&&_1(d,y,f,v,_,C,U.x,U.y)&&Gi(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;N&&N.z>=D;){if(N.x>=A&&N.x<=I&&N.y>=M&&N.y<=P&&N!==s&&N!==c&&_1(d,y,f,v,_,C,N.x,N.y)&&Gi(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;U&&U.z<=V;){if(U.x>=A&&U.x<=I&&U.y>=M&&U.y<=P&&U!==s&&U!==c&&_1(d,y,f,v,_,C,U.x,U.y)&&Gi(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function e6(t,e){let i=t;do{const n=i.prev,s=i.next.next;!Lu(n,s)&&sp(n,i,i.next,s)&&qc(n,s)&&qc(s,n)&&(e.push(n.i,i.i,s.i),Wc(i),Wc(i.next),i=t=s),i=i.next}while(i!==t);return Yo(i)}function t6(t,e,i,n,s,l){let c=t;do{let d=c.next.next;for(;d!==c.prev;){if(c.i!==d.i&&a6(c,d)){let f=ap(c,d);return c=Yo(c,c.next),f=Yo(f,f.next),Gc(c,e,i,n,s,l,0),void Gc(f,e,i,n,s,l,0)}d=d.next}c=c.next}while(c!==t)}function i6(t,e){return t.x-e.x}function r6(t,e){const i=function(s,l){let c=l;const d=s.x,f=s.y;let _,y=-1/0;do{if(f<=c.y&&f>=c.next.y&&c.next.y!==c.y){const I=c.x+(f-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(I<=d&&I>y&&(y=I,_=c.x<c.next.x?c:c.next,I===d))return _}c=c.next}while(c!==l);if(!_)return null;const v=_,C=_.x,A=_.y;let M=1/0;c=_;do{if(d>=c.x&&c.x>=C&&d!==c.x&&_1(f<A?d:y,f,C,A,f<A?y:d,f,c.x,c.y)){const I=Math.abs(f-c.y)/(d-c.x);qc(c,s)&&(I<M||I===M&&(c.x>_.x||c.x===_.x&&n6(_,c)))&&(_=c,M=I)}c=c.next}while(c!==v);return _}(t,e);if(!i)return e;const n=ap(i,t);return Yo(n,n.next),Yo(i,i.next)}function n6(t,e){return Gi(t.prev,t,e.prev)<0&&Gi(e.next,t,t.next)<0}function H2(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function s6(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function _1(t,e,i,n,s,l,c,d){return(s-c)*(e-d)>=(t-c)*(l-d)&&(t-c)*(n-d)>=(i-c)*(e-d)&&(i-c)*(l-d)>=(s-c)*(n-d)}function a6(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,n){let s=i;do{if(s.i!==i.i&&s.next.i!==i.i&&s.i!==n.i&&s.next.i!==n.i&&sp(s,s.next,i,n))return!0;s=s.next}while(s!==i);return!1}(t,e)&&(qc(t,e)&&qc(e,t)&&function(i,n){let s=i,l=!1;const c=(i.x+n.x)/2,d=(i.y+n.y)/2;do s.y>d!=s.next.y>d&&s.next.y!==s.y&&c<(s.next.x-s.x)*(d-s.y)/(s.next.y-s.y)+s.x&&(l=!l),s=s.next;while(s!==i);return l}(t,e)&&(Gi(t.prev,t,e.prev)||Gi(t,e.prev,e))||Lu(t,e)&&Gi(t.prev,t,t.next)>0&&Gi(e.prev,e,e.next)>0)}function Gi(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Lu(t,e){return t.x===e.x&&t.y===e.y}function sp(t,e,i,n){const s=Bu(Gi(t,e,i)),l=Bu(Gi(t,e,n)),c=Bu(Gi(i,n,t)),d=Bu(Gi(i,n,e));return s!==l&&c!==d||!(s!==0||!ku(t,i,e))||!(l!==0||!ku(t,n,e))||!(c!==0||!ku(i,t,n))||!(d!==0||!ku(i,e,n))}function ku(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Bu(t){return t>0?1:t<0?-1:0}function qc(t,e){return Gi(t.prev,t,t.next)<0?Gi(t,e,t.next)>=0&&Gi(t,t.prev,e)>=0:Gi(t,e,t.prev)<0||Gi(t,t.next,e)<0}function ap(t,e){const i=X2(t.i,t.x,t.y),n=X2(e.i,e.x,e.y),s=t.next,l=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,l.next=n,n.prev=l,n}function op(t,e,i,n){const s=X2(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Wc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function X2(t,e,i){return{i:t,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Fu(t,e){const i=t.length;if(i<=1)return[t];const n=[];let s,l;for(let c=0;c<i;c++){const d=zh(t[c]);d!==0&&(t[c].area=Math.abs(d),l===void 0&&(l=d<0),l===d<0?(s&&n.push(s),s=[t[c]]):s.push(t[c]))}if(s&&n.push(s),e>1)for(let c=0;c<n.length;c++)n[c].length<=e||(Jt(n[c],e,1,n[c].length-1,o6),n[c]=n[c].slice(0,e));return n}function o6(t,e){return e.area-t.area}function Y2(t,e,i){const n=i.patternDependencies;let s=!1;for(const l of e){const c=l.paint.get(`${t}-pattern`);c.isConstant()||(s=!0);const d=c.constantOr(null);d&&(s=!0,n[d]=!0)}return s}function J2(t,e,i,n,s){const l=s.patternDependencies;for(const c of e){const d=c.paint.get(`${t}-pattern`).value;if(d.kind!=="constant"){let f=d.evaluate({zoom:n},i,{},s.availableImages);f=f&&f.name?f.name:f,l[f]=!0,i.patterns[c.id]=f}}return i}class ju{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dn,this.indexArray=new Hi,this.indexArray2=new Ea,this.programConfigurations=new Pa(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new wi,this.segments2=new wi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}updateFootprints(e,i){}populate(e,i,n,s){this.hasPattern=Y2("fill",this.layers,i);const l=this.layers[0].layout.get("fill-sort-key"),c=[];for(const{feature:d,id:f,index:_,sourceLayerIndex:y}of e){const v=this.layers[0]._featureFilter.needGeometry,C=ks(d,v);if(!this.layers[0]._featureFilter.filter(new dt(this.zoom),C,n))continue;const A=l?l.evaluate(C,{},n,i.availableImages):void 0,M={id:f,properties:d.properties,type:d.type,sourceLayerIndex:y,index:_,geometry:v?C.geometry:Ln(d,n,s),patterns:{},sortKey:A};c.push(M)}l&&c.sort((d,f)=>d.sortKey-f.sortKey);for(const d of c){const{geometry:f,index:_,sourceLayerIndex:y}=d;if(this.hasPattern){const v=J2("fill",this.layers,d,this.zoom,i);this.patternFeatures.push(v)}else this.addFeature(d,f,_,n,{},i.availableImages,i.brightness);i.featureIndex.insert(e[_].feature,f,_,y,this.index)}}update(e,i,n,s,l){const c=Object.keys(e).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,c?this.stateDependentLayers:this.layers,n,s,l)}addFeatures(e,i,n,s,l,c){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,n,s,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,J4),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,n,s,l,c=[],d){for(const f of Fu(i,500)){let _=0;for(const I of f)_+=I.length;const y=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),v=y.vertexLength,C=[],A=[];for(const I of f){if(I.length===0)continue;I!==f[0]&&A.push(C.length/2);const P=this.segments2.prepareSegment(I.length,this.layoutVertexArray,this.indexArray2),D=P.vertexLength;this.layoutVertexArray.emplaceBack(I[0].x,I[0].y),this.indexArray2.emplaceBack(D+I.length-1,D),C.push(I[0].x),C.push(I[0].y);for(let V=1;V<I.length;V++)this.layoutVertexArray.emplaceBack(I[V].x,I[V].y),this.indexArray2.emplaceBack(D+V-1,D+V),C.push(I[V].x),C.push(I[V].y);P.vertexLength+=I.length,P.primitiveLength+=I.length}const M=$c(C,A);for(let I=0;I<M.length;I+=3)this.indexArray.emplaceBack(v+M[I],v+M[I+1],v+M[I+2]);y.vertexLength+=_,y.primitiveLength+=M.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,l,c,s,d)}}let lp,cp,up,hp;oe(ju,"FillBucket",{omit:["layers","patternFeatures"]});class K2{constructor(e,i,n,s){if(this.triangleCount=i.length/3,this.min=new Ze(0,0),this.max=new Ze(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0)return;const[l,c]=[e[0].clone(),e[0].clone()];for(let v=1;v<e.length;++v){const C=e[v];l.x=Math.min(l.x,C.x),l.y=Math.min(l.y,C.y),c.x=Math.max(c.x,C.x),c.y=Math.max(c.y,C.y)}if(s){const v=Math.ceil(Math.max(c.x-l.x,c.y-l.y)/s);n=Math.max(n,v)}if(n===0)return;this.min=l,this.max=c;const d=this.max.sub(this.min);d.x=Math.max(d.x,1),d.y=Math.max(d.y,1);const f=Math.max(d.x,d.y)/n;this.cellsX=Math.max(1,Math.ceil(d.x/f)),this.cellsY=Math.max(1,Math.ceil(d.y/f)),this.xScale=1/f,this.yScale=1/f;const _=[];for(let v=0;v<this.triangleCount;v++){const C=e[i[3*v+0]].sub(this.min),A=e[i[3*v+1]].sub(this.min),M=e[i[3*v+2]].sub(this.min),I=ls(Math.floor(Math.min(C.x,A.x,M.x)),this.xScale,this.cellsX),P=ls(Math.floor(Math.max(C.x,A.x,M.x)),this.xScale,this.cellsX),D=ls(Math.floor(Math.min(C.y,A.y,M.y)),this.yScale,this.cellsY),V=ls(Math.floor(Math.max(C.y,A.y,M.y)),this.yScale,this.cellsY),N=new Ze(0,0),U=new Ze(0,0),X=new Ze(0,0),Y=new Ze(0,0);for(let ee=D;ee<=V;++ee){N.y=U.y=ee*f,X.y=Y.y=(ee+1)*f;for(let le=I;le<=P;++le)N.x=X.x=le*f,U.x=Y.x=(le+1)*f,(F2(C,A,M,N,U,Y)||F2(C,A,M,N,Y,X))&&_.push({cellIdx:ee*this.cellsX+le,triIdx:v})}}if(_.length===0)return;_.sort((v,C)=>v.cellIdx-C.cellIdx||v.triIdx-C.triIdx);let y=0;for(;y<_.length;){const v=_[y].cellIdx,C={start:this.payload.length,len:0};for(;y<_.length&&_[y].cellIdx===v;)++C.len,this.payload.push(_[y++].triIdx);this.cells[v]=C}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,i){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;const n=ls(e.x-this.min.x,this.xScale,this.cellsX),s=ls(e.y-this.min.y,this.yScale,this.cellsY),l=this.cells[s*this.cellsX+n];if(l){this._lazyInitLookup();for(let c=0;c<l.len;c++){const d=this.payload[l.start+c],f=Math.floor(d/8),_=1<<d%8;if(!(this.lookup[f]&_)&&(this.lookup[f]|=_,i.push(d),i.length===this.triangleCount))return}}}query(e,i,n){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>i.x||e.y>this.max.y||this.min.y>i.y)return;this._lazyInitLookup();const s=ls(e.x-this.min.x,this.xScale,this.cellsX),l=ls(i.x-this.min.x,this.xScale,this.cellsX),c=ls(e.y-this.min.y,this.yScale,this.cellsY),d=ls(i.y-this.min.y,this.yScale,this.cellsY);for(let f=c;f<=d;f++)for(let _=s;_<=l;_++){const y=this.cells[f*this.cellsX+_];if(y)for(let v=0;v<y.len;v++){const C=this.payload[y.start+v],A=Math.floor(C/8),M=1<<C%8;if(!(this.lookup[A]&M)&&(this.lookup[A]|=M,n.push(C),n.length===this.triangleCount))return}}}}function ls(t,e,i){return Math.max(0,Math.min(i-1,Math.floor(t*e)))}oe(K2,"TriangleGridIndex");class dp{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.footprints=[]}updateFootprints(e,i){for(const n of this.footprints)i.push({footprint:n,id:e})}populate(e,i,n,s){const l=[];for(const{feature:c,id:d,index:f,sourceLayerIndex:_}of e){const y=this.layers[0]._featureFilter.needGeometry,v=ks(c,y);if(!this.layers[0]._featureFilter.filter(new dt(this.zoom),v,n))continue;const C={id:d,properties:c.properties,type:c.type,sourceLayerIndex:_,index:f,geometry:y?v.geometry:Ln(c,n,s),patterns:{}};l.push(C)}for(const c of l){const{geometry:d,index:f,sourceLayerIndex:_}=c;this.addFeature(c,d,f,n,{},i.availableImages,i.brightness),i.featureIndex.insert(e[f].feature,d,f,_,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(e){}update(e,i,n,s,l){}destroy(){}addFeature(e,i,n,s,l,c=[],d){for(const f of Fu(i,2)){const _=[],y=[],v=[],C=new Ze(1/0,1/0),A=new Ze(-1/0,-1/0);for(const P of f)if(P.length!==0){P!==f[0]&&v.push(y.length/2);for(let D=0;D<P.length;D++)y.push(P[D].x),y.push(P[D].y),_.push(P[D]),C.x=Math.min(C.x,P[D].x),C.y=Math.min(C.y,P[D].y),A.x=Math.max(A.x,P[D].x),A.y=Math.max(A.y,P[D].y)}const M=$c(y,v),I=new K2(_,M,8,256);this.footprints.push({vertices:_,indices:M,grid:I,min:C,max:A})}}}oe(dp,"ClipBucket",{omit:["layers"]});const l6=ei([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),c6=ei([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),u6=ei([{name:"a_centroid_pos",components:2,type:"Uint16"}]),h6=ei([{name:"a_join_normal_inside_polygon",components:4,type:"Int16"}]),d6=ei([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),p6=ei([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:f6}=l6;var Nu={},m6=ro,pp=g1;function g1(t,e,i,n,s){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=s,t.readFields(_6,this,e)}function _6(t,e,i){t==1?e.id=i.readVarint():t==2?function(n,s){for(var l=n.readVarint()+n.pos;n.pos<l;){var c=s._keys[n.readVarint()],d=s._values[n.readVarint()];s.properties[c]=d}}(i,e):t==3?e.type=i.readVarint():t==4&&(e._geometry=i.pos)}function g6(t){for(var e,i,n=0,s=0,l=t.length,c=l-1;s<l;c=s++)n+=((i=t[c]).x-(e=t[s]).x)*(e.y+i.y);return n}g1.types=["Unknown","Point","LineString","Polygon"],g1.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,n=1,s=0,l=0,c=0,d=[];t.pos<i;){if(s<=0){var f=t.readVarint();n=7&f,s=f>>3}if(s--,n===1||n===2)l+=t.readSVarint(),c+=t.readSVarint(),n===1&&(e&&d.push(e),e=[]),e.push(new m6(l,c));else{if(n!==7)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&d.push(e),d},g1.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,s=0,l=0,c=1/0,d=-1/0,f=1/0,_=-1/0;t.pos<e;){if(n<=0){var y=t.readVarint();i=7&y,n=y>>3}if(n--,i===1||i===2)(s+=t.readSVarint())<c&&(c=s),s>d&&(d=s),(l+=t.readSVarint())<f&&(f=l),l>_&&(_=l);else if(i!==7)throw new Error("unknown command "+i)}return[c,f,d,_]},g1.prototype.toGeoJSON=function(t,e,i){var n,s,l=this.extent*Math.pow(2,i),c=this.extent*t,d=this.extent*e,f=this.loadGeometry(),_=g1.types[this.type];function y(A){for(var M=0;M<A.length;M++){var I=A[M];A[M]=[360*(I.x+c)/l-180,360/Math.PI*Math.atan(Math.exp((180-360*(I.y+d)/l)*Math.PI/180))-90]}}switch(this.type){case 1:var v=[];for(n=0;n<f.length;n++)v[n]=f[n][0];y(f=v);break;case 2:for(n=0;n<f.length;n++)y(f[n]);break;case 3:for(f=function(A){var M=A.length;if(M<=1)return[A];for(var I,P,D=[],V=0;V<M;V++){var N=g6(A[V]);N!==0&&(P===void 0&&(P=N<0),P===N<0?(I&&D.push(I),I=[A[V]]):I.push(A[V]))}return I&&D.push(I),D}(f),n=0;n<f.length;n++)for(s=0;s<f[n].length;s++)y(f[n][s])}f.length===1?f=f[0]:_="Multi"+_;var C={type:"Feature",geometry:{type:_,coordinates:f},properties:this.properties};return"id"in this&&(C.id=this.id),C};var y6=pp,fp=mp;function mp(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(x6,this,e),this.length=this._features.length}function x6(t,e,i){t===15?e.version=i.readVarint():t===1?e.name=i.readString():t===5?e.extent=i.readVarint():t===2?e._features.push(i.pos):t===3?e._keys.push(i.readString()):t===4&&e._values.push(function(n){for(var s=null,l=n.readVarint()+n.pos;n.pos<l;){var c=n.readVarint()>>3;s=c===1?n.readString():c===2?n.readFloat():c===3?n.readDouble():c===4?n.readVarint64():c===5?n.readVarint():c===6?n.readSVarint():c===7?n.readBoolean():null}return s}(i))}mp.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new y6(this._pbf,e,this.extent,this._keys,this._values)};var v6=fp;function C6(t,e,i){if(t===3){var n=new v6(i,i.readVarint()+i.pos);n.length&&(e[n.name]=n)}}var Q2=Nu.VectorTile=function(t,e){this.layers=t.readFields(C6,{},e)},Vu=Nu.VectorTileFeature=pp;Nu.VectorTileLayer=fp;class Jo extends Ze{constructor(e,i,n){super(e,i),this.z=n}}class _p extends Jo{constructor(e,i,n,s){super(e,i,n),this.w=s}}function Uu(t,e,i,n){const s=[],l=n===0?(c,d,f,_,y,v)=>{c.push(new Ze(v,f+(v-d)/(_-d)*(y-f)))}:(c,d,f,_,y,v)=>{c.push(new Ze(d+(v-f)/(y-f)*(_-d),v))};for(const c of t){const d=[];for(const f of c){if(f.length<=2)continue;const _=[];for(let C=0;C<f.length-1;C++){const A=f[C].x,M=f[C].y,I=f[C+1].x,P=f[C+1].y,D=n===0?A:M,V=n===0?I:P;D<e?V>e&&l(_,A,M,I,P,e):D>i?V<i&&l(_,A,M,I,P,i):_.push(f[C]),V<e&&D>=e&&l(_,A,M,I,P,e),V>i&&D<=i&&l(_,A,M,I,P,i)}let y=f[f.length-1];const v=n===0?y.x:y.y;v>=e&&v<=i&&_.push(y),_.length&&(y=_[_.length-1],_[0].x===y.x&&_[0].y===y.y||_.push(_[0]),d.push(_))}d.length&&s.push(d)}return s}function gp(t,e,i,n){const s=i==="x"?"y":"x",l=(n-t[i])/(e[i]-t[i]);t[s]=t[s]+(e[s]-t[s])*l,t[i]=n,t.hasOwnProperty("z")&&(t.z=lt(t.z,e.z,l)),t.hasOwnProperty("w")&&(t.w=lt(t.w,e.w,l))}function yp(t,e,i,n){const s=i,l=n;for(const c of["x","y"]){let d=t,f=e;d[c]>=f[c]&&(d=e,f=t),d[c]<s&&f[c]>s&&gp(d,f,c,s),d[c]<l&&f[c]>l&&gp(f,d,c,l)}}const Zu=Number.MAX_SAFE_INTEGER;function xp(t,e,i,n){return t.order<e||t.order===Zu||!(t.clipMask&i)||function(s,l){return l.length!==0&&l.find(c=>c===s)===void 0}(n,t.clipScope)}function $u(t,e){return t.x-e.x||t.y-e.y}function vp(t,e){return $u(t.min,e.min)===0&&$u(t.max,e.max)===0}function e0(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function t0(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i].sourceId!==e[i].sourceId||!vp(t[i],e[i])||t[i].order!==e[i].order||t[i].clipMask!==e[i].clipMask||!na(t[i].clipScope,e[i].clipScope))return!1;return!0}function Cp(t,e,i){const n=1/je,s=1/(1<<i.canonical.z),l=(e.x*n+i.canonical.x)*s+i.wrap,c=(e.y*n+i.canonical.y)*s;return{min:new Ze((t.x*n+i.canonical.x)*s+i.wrap,(t.y*n+i.canonical.y)*s),max:new Ze(l,c)}}function b6(t,e,i){const n=1<<i.canonical.z,s=((e.x-i.wrap)*n-i.canonical.x)*je,l=(e.y*n-i.canonical.y)*je;return{min:new Ze(((t.x-i.wrap)*n-i.canonical.x)*je,(t.y*n-i.canonical.y)*je),max:new Ze(s,l)}}function bp(t,e,i,n,s,l,c){const d=t.indices,f=t.vertices,_=[];for(let y=n;y<n+s;y+=3){const v=e[i[y+0]+l],C=e[i[y+1]+l],A=e[i[y+2]+l],M=Math.min(v.x,C.x,A.x),I=Math.max(v.x,C.x,A.x),P=Math.min(v.y,C.y,A.y),D=Math.max(v.y,C.y,A.y);_.length=0,t.grid.query(new Ze(M,P),new Ze(I,D),_);for(let V=0;V<_.length;V++){const N=_[V];if(F2(f[d[3*N+0]],f[d[3*N+1]],f[d[3*N+2]],v,C,A,c))return!0}}return!1}function wp(t,e,i,n){if(!t||!i)return!1;let s=t.vertices;if(!e.canonical.equals(n.canonical)||e.wrap!==n.wrap){if(i.vertices.length<t.vertices.length)return wp(i,n,t,e);const l=e.canonical,c=n.canonical,d=Math.pow(2,c.z-l.z);s=t.vertices.map(f=>new Ze((f.x+l.x*je)*d-c.x*je,(f.y+l.y*je)*d-c.y*je))}return bp(i,s,t.indices,0,t.indices.length,0,0)}function Ap(t,e,i,n){const s=Math.pow(2,n.z-i.z);return new Ze((t+i.x*je)*s-n.x*je,(e+i.y*je)*s-n.y*je)}function Tp(t,e){const i=[];e.footprint.grid.queryPoint(t,i);const n=e.footprint.indices,s=e.footprint.vertices;for(let l=0;l<i.length;l++){const c=i[l];if(za([s[n[3*c+0]],s[n[3*c+1]],s[n[3*c+2]]],t))return!0}return!1}class Mp{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const n=this.toIdx(e,i);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Sp(t,e,i,n){let s=0,l=Number.MAX_VALUE;for(let c=0;c<3;c++)if(Math.abs(n[c])<1e-15){if(i[c]<t[c]||i[c]>e[c])return null}else{const d=1/n[c];let f=(t[c]-i[c])*d,_=(e[c]-i[c])*d;if(f>_){const y=f;f=_,_=y}if(f>s&&(s=f),_<l&&(l=_),s>l)return null}return s}function Ep(t,e,i,n,s,l,c,d,f,_,y){const v=n-t,C=s-e,A=l-i,M=c-t,I=d-e,P=f-i,D=y[1]*P-y[2]*I,V=y[2]*M-y[0]*P,N=y[0]*I-y[1]*M,U=v*D+C*V+A*N;if(Math.abs(U)<1e-15)return null;const X=1/U,Y=_[0]-t,ee=_[1]-e,le=_[2]-i,pe=(Y*D+ee*V+le*N)*X;if(pe<0||pe>1)return null;const xe=ee*A-le*C,fe=le*v-Y*A,we=Y*C-ee*v,De=(y[0]*xe+y[1]*fe+y[2]*we)*X;return De<0||pe+De>1?null:(M*xe+I*fe+P*we)*X}function Ip(t,e,i){return(t-e)/(i-e)}function Pp(t,e,i,n,s,l,c,d,f){const _=1<<i,y=l-n,v=c-s,C=(t+1)/_*y+n,A=(e+0)/_*v+s,M=(e+1)/_*v+s;d[0]=(t+0)/_*y+n,d[1]=A,f[0]=C,f[1]=M}class Op{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(l){const c=Math.ceil(Math.log2(l.dim/8)),d=[];let f=Math.ceil(Math.pow(2,c));const _=1/f,y=(A,M,I,P,D)=>{const V=P?1:0,N=(A+1)*I-V,U=M*I,X=(M+1)*I-V;D[0]=A*I,D[1]=U,D[2]=N,D[3]=X};let v=new Mp(f);const C=[];for(let A=0;A<f*f;A++){y(A%f,Math.floor(A/f),_,!1,C);const M=Ra(C[0],C[1],l),I=Ra(C[2],C[1],l),P=Ra(C[2],C[3],l),D=Ra(C[0],C[3],l);v.minimums.push(Math.min(M,I,P,D)),v.maximums.push(Math.max(M,I,P,D)),v.leaves.push(1)}for(d.push(v),f/=2;f>=1;f/=2){const A=d[d.length-1];v=new Mp(f);for(let M=0;M<f*f;M++){y(M%f,Math.floor(M/f),2,!0,C);const I=A.getElevation(C[0],C[1]),P=A.getElevation(C[2],C[1]),D=A.getElevation(C[2],C[3]),V=A.getElevation(C[0],C[3]),N=A.isLeaf(C[0],C[1]),U=A.isLeaf(C[2],C[1]),X=A.isLeaf(C[2],C[3]),Y=A.isLeaf(C[0],C[3]),ee=Math.min(I.min,P.min,D.min,V.min),le=Math.max(I.max,P.max,D.max,V.max),pe=N&&U&&X&&Y;v.maximums.push(le),v.minimums.push(ee),v.leaves.push(le-ee<=5&&pe?1:0)}d.push(v)}return d}(this.dem),n=i.length-1,s=i[n];this._addNode(s.minimums[0],s.maximums[0],s.leaves[0]),this._construct(i,0,0,n,0)}raycastRoot(e,i,n,s,l,c,d=1){return Sp([e,i,-100],[n,s,this.maximums[0]*d],l,c)}raycast(e,i,n,s,l,c,d=1){if(!this.nodeCount)return null;const f=this.raycastRoot(e,i,n,s,l,c,d);if(f==null)return null;const _=[],y=[],v=[],C=[],A=[{idx:0,t:f,nodex:0,nodey:0,depth:0}];for(;A.length>0;){const{idx:M,t:I,nodex:P,nodey:D,depth:V}=A.pop();if(this.leaves[M]){Pp(P,D,V,e,i,n,s,v,C);const U=1<<V,X=(P+0)/U,Y=(P+1)/U,ee=(D+0)/U,le=(D+1)/U,pe=Ra(X,ee,this.dem)*d,xe=Ra(Y,ee,this.dem)*d,fe=Ra(Y,le,this.dem)*d,we=Ra(X,le,this.dem)*d,De=Ep(v[0],v[1],pe,C[0],v[1],xe,C[0],C[1],fe,l,c),Ae=Ep(C[0],C[1],fe,v[0],C[1],we,v[0],v[1],pe,l,c),ke=Math.min(De!==null?De:Number.MAX_VALUE,Ae!==null?Ae:Number.MAX_VALUE);if(ke!==Number.MAX_VALUE)return ke;{const be=a.$.scaleAndAdd([],l,c,I);if(zp(pe,xe,we,fe,Ip(be[0],v[0],C[0]),Ip(be[1],v[1],C[1]))>=be[2])return I}continue}let N=0;for(let U=0;U<this._siblingOffset.length;U++){Pp((P<<1)+this._siblingOffset[U][0],(D<<1)+this._siblingOffset[U][1],V+1,e,i,n,s,v,C),v[2]=-100,C[2]=this.maximums[this.childOffsets[M]+U]*d;const X=Sp(v,C,l,c);if(X!=null){const Y=X;_[U]=Y;let ee=!1;for(let le=0;le<N&&!ee;le++)Y>=_[y[le]]&&(y.splice(le,0,U),ee=!0);ee||(y[N]=U),N++}}for(let U=0;U<N;U++){const X=y[U];A.push({idx:this.childOffsets[M]+X,t:_[X],nodex:(P<<1)+this._siblingOffset[X][0],nodey:(D<<1)+this._siblingOffset[X][1],depth:V+1})}}return null}_addNode(e,i,n){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,n,s,l){if(e[s].isLeaf(i,n)===1)return;this.childOffsets[l]||(this.childOffsets[l]=this.nodeCount);const c=s-1,d=e[c];let f=0,_=0;for(let y=0;y<this._siblingOffset.length;y++){const v=2*i+this._siblingOffset[y][0],C=2*n+this._siblingOffset[y][1],A=d.getElevation(v,C),M=d.isLeaf(v,C),I=this._addNode(A.min,A.max,M);M&&(f|=1<<y),_||(_=I)}for(let y=0;y<this._siblingOffset.length;y++)f&1<<y||this._construct(e,2*i+this._siblingOffset[y][0],2*n+this._siblingOffset[y][1],c,_+y)}}function zp(t,e,i,n,s,l){return lt(lt(t,i,l),lt(e,n,l),s)}function Ra(t,e,i){const n=i.dim,s=Pt(t*n-.5,0,n-1),l=Pt(e*n-.5,0,n-1),c=Math.floor(s),d=Math.floor(l),f=Math.min(c+1,n-1),_=Math.min(d+1,n-1);return zp(i.get(c,d),i.get(f,d),i.get(c,_),i.get(f,_),s-c,l-d)}const w6={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function A6(t,e,i){return(256*t*256+256*e+i)/10-1e4}function T6(t,e,i){return 256*t+e+i/256-32768}class Gu{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,n,s=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(n&&n!=="mapbox"&&n!=="terrarium")return Di(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const l=this.dim=i.height-2,c=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.floatView=new Float32Array(i.data.buffer),this.borderReady=s,this._modifiedForSources={},!s){for(let f=0;f<l;f++)c[this._idx(-1,f)]=c[this._idx(0,f)],c[this._idx(l,f)]=c[this._idx(l-1,f)],c[this._idx(f,-1)]=c[this._idx(f,0)],c[this._idx(f,l)]=c[this._idx(f,l-1)];c[this._idx(-1,-1)]=c[this._idx(0,0)],c[this._idx(l,-1)]=c[this._idx(l-1,0)],c[this._idx(-1,l)]=c[this._idx(0,l-1)],c[this._idx(l,l)]=c[this._idx(l-1,l-1)]}const d=n==="terrarium"?T6:A6;for(let f=0;f<c.length;++f){const _=4*f;this.floatView[f]=d(this.pixels[_],this.pixels[_+1],this.pixels[_+2])}this._timestamp=sr.now()}_buildQuadTree(){this._tree=new Op(this)}get(e,i,n=!1){n&&(e=Pt(e,-1,this.dim),i=Pt(i,-1,this.dim));const s=this._idx(e,i);return this.floatView[s]}set(e,i,n){const s=this._idx(e,i),l=this.floatView[s];return this.floatView[s]=n,n-l}static getUnpackVector(e){return w6[e]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const n=[0,0,0,0],s=Gu.getUnpackVector(i);let l=Math.floor((e+s[3])/s[2]);return n[2]=l%256,l=Math.floor(l/256),n[1]=l%256,l=Math.floor(l/256),n[0]=l,n}getPixels(){return new Qd({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let s=i*this.dim,l=i*this.dim+this.dim,c=n*this.dim,d=n*this.dim+this.dim;switch(i){case-1:s=l-1;break;case 1:l=s+1}switch(n){case-1:c=d-1;break;case 1:d=c+1}const f=-i*this.dim,_=-n*this.dim;for(let y=c;y<d;y++)for(let v=s;v<l;v++){const C=4*this._idx(v,y),A=4*this._idx(v+f,y+_);this.pixels[C+0]=e.pixels[A+0],this.pixels[C+1]=e.pixels[A+1],this.pixels[C+2]=e.pixels[A+2],this.pixels[C+3]=e.pixels[A+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}oe(Gu,"DEMData"),oe(Op,"DemMinMaxQuadTree",{omit:["dem"]});class y1{constructor(e,i,n){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=n}static create(e,i,n){const s=n||e.findDEMTileFor(i);if(!s||!s.dem)return;const l=s.dem,c=s.tileID,d=1<<i.canonical.z-c.canonical.z;return new y1(s,l.dim/je/d,[(i.canonical.x/d-c.canonical.x)*l.dim,(i.canonical.y/d-c.canonical.y)*l.dim])}tileCoordToPixel(e,i){const n=i*this._scale+this._offset[1],s=Math.floor(e*this._scale+this._offset[0]),l=Math.floor(n);return new Ze(s,l)}getElevationAt(e,i,n,s){const l=e*this._scale+this._offset[0],c=i*this._scale+this._offset[1],d=Math.floor(l),f=Math.floor(c),_=this._dem;return s=!!s,n?lt(lt(_.get(d,f,s),_.get(d,f+1,s),c-f),lt(_.get(d+1,f,s),_.get(d+1,f+1,s),c-f),l-d):_.get(d,f,s)}getElevationAtPixel(e,i,n){return this._dem.get(e,i,!!n)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Mr(1,e)*this._dem.stride}}const Dp={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},M6=Vu.types,S6=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-line-alignment"],E6=["fill-extrusion-flood-light-ground-radius"],I6=Math.pow(2,13),P6=Math.pow(2,15)-1,Rp=new Ze(0,1),La=2147483648;function Hc(t,e,i,n,s,l,c,d){t.emplaceBack((e<<1)+c,(i<<1)+l,(Math.floor(n*I6)<<1)+s,Math.round(d))}function Xc(t,e,i,n){t.emplaceBack(e.x*je,e.y*je,i?0:1,n?1:0)}function qu(t,e,i,n,s,l){t.emplaceBack(e.x,e.y,(i.x<<1)+n,(i.y<<1)+s,l)}function Yc(t,e,i){t.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Lp{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class kp{constructor(){this.centroidXY=new Ze(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Ze(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Ze(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Ze(this.max.x-this.min.x,this.max.y-this.min.y)}}class Bp{constructor(){this.acc=new Ze(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,i){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=i.x,e.min.y=e.max.y=i.y)}appendEdge(e,i,n){this.accCount++,this.acc._add(i);let s=!!this.borders;i.x<e.min.x?(e.min.x=i.x,s=!0):i.x>e.max.x&&(e.max.x=i.x,s=!0),i.y<e.min.y?(e.min.y=i.y,s=!0):i.y>e.max.y&&(e.max.y=i.y,s=!0),((i.x===0||i.x===je)&&i.x===n.x)!=((i.y===0||i.y===je)&&i.y===n.y)&&this.processBorderOverlap(i,n),s&&this.checkBorderIntersection(i,n)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,lt(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>je!=e.x>je&&this.addBorderIntersection(1,lt(i.y,e.y,(je-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,lt(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>je!=e.y>je&&this.addBorderIntersection(3,lt(i.x,e.x,(je-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[e];i<n[0]&&(n[0]=i),i>n[1]&&(n[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const n=e.x===0?0:1;this.addBorderIntersection(n,i.y),this.addBorderIntersection(n,e.y)}else{const n=e.y===0?2:3;this.addBorderIntersection(n,i.x),this.addBorderIntersection(n,e.x)}}centroid(){return this.accCount===0?new Ze(0,0):new Ze(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0):0}}function Fp(t,e){const i=t.add(e)._unit(),n=Pt(t.x*i.x+t.y*i.y,-1,1);var s,l,c;return s=Math.acos(n),Math.min(4,Math.max(-4,Math.tan(s)))/4*P6*((l=t).x*(c=e).y-l.y*c.x<0?-1:1)}const O6=[t=>t.x<0,t=>t.x>je,t=>t.y<0,t=>t.y>je];function z6(t,e,i,n){const s=[4];if(n===0)return s;i._mult(n);const l=t.sub(i),c=e.sub(i),d=[t,e,l,c];for(let f=0;f<4;f++)for(const _ of d)if(O6[f](_)){s.push(f);break}return s}class jp{constructor(e){this.vertexArray=new a2,this.indexArray=new Hi,this.programConfigurations=new Pa(e.layers,{zoom:e.zoom,lut:e.lut},i=>E6.includes(i)),this._segments=new wi,this.hiddenByLandmarkVertexArray=new v2,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new wi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,i,n,s=!1){const l=e.length;if(l>2){let c=Math.max(0,this._segments.get().length-1);const d=this._segments._prepareSegment(4*l,this.vertexArray.length,2*this._segmentToGroundQuads[c].length);let f;c!==this._segments.get().length-1&&(c++,this._segmentToGroundQuads[c]=[],this._segmentToRegionTriCounts[c]=[0,0,0,0,0]);{const _=e[0],y=e[1];f=Fp(_.sub(e[l-1])._perp()._unit(),y.sub(_)._perp()._unit())}for(let _=0;_<l;_++){const y=_===l-1?0:_+1,v=e[_],C=e[y],A=e[y===l-1?0:y+1],M=C.sub(v)._perp()._unit(),I=Fp(M,A.sub(C)._perp()._unit()),P=f,D=I;if(i0(v,C,i)||s&&Up(v,i)&&Up(C,i)){f=I;continue}const V=d.vertexLength;qu(this.vertexArray,v,C,1,1,P),qu(this.vertexArray,v,C,1,0,P),qu(this.vertexArray,v,C,0,1,D),qu(this.vertexArray,v,C,0,0,D),d.vertexLength+=4;const N=z6(v,C,M,n);for(const U of N)this._segmentToGroundQuads[c].push({id:V,region:U}),this._segmentToRegionTriCounts[c][U]+=2,d.primitiveLength+=2;f=I}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),i=e.length;for(let n=0;n<i;n++)this._segmentToGroundQuads[n].sort((s,l)=>s.region-l.region);for(let n=0;n<i;n++){const s=this._segmentToGroundQuads[n],l=e[n],c=this._segmentToRegionTriCounts[n];c.reduce((f,_)=>f+_,0);let d=0;for(let f=0;f<=4;f++){const _=c[f];if(_!==0){let y=this.regionSegments[f];y||(y=this.regionSegments[f]=new wi);const v={vertexOffset:l.vertexOffset,primitiveOffset:l.primitiveOffset+d,vertexLength:l.vertexLength,primitiveLength:_};y.get().push(v)}d+=_}for(let f=0;f<s.length;f++){const _=s[f].id;this.indexArray.emplaceBack(_,_+1,_+3),this.indexArray.emplaceBack(_,_+3,_+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,i,n,s,l,c){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,i,n,s,l,c)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,c6.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,i,n,s,l,c){this.hasData()&&this.programConfigurations.updatePaintArrays(e,i,n,s,l,c)}updateHiddenByLandmark(e){if(!this.hasData())return;const i=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const n=e.flags&La?1:0;for(let s=e.groundVertexArrayOffset;s<i;++s)this.hiddenByLandmarkVertexArray.emplace(s,n);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,d6.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const i=this.regionSegments[e];i&&i.destroy()}}}}class Wu{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Hi,this.footprintVertices=new Dn,this.footprintSegments=[],this.layoutVertexArray=new zs,this.centroidVertexArray=new hd,this.wallVertexArray=new pd,this.indexArray=new Hi,this.programConfigurations=new Pa(e.layers,{zoom:e.zoom,lut:e.lut},i=>S6.includes(i)),this.segments=new wi,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new jp(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(e,i){}populate(e,i,n,s){this.features=[],this.hasPattern=Y2("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=Su(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:l,id:c,index:d,sourceLayerIndex:f}of e){const _=this.layers[0]._featureFilter.needGeometry,y=ks(l,_);if(!this.layers[0]._featureFilter.filter(new dt(this.zoom),y,n))continue;const v={id:c,sourceLayerIndex:f,index:d,geometry:_?y.geometry:Ln(l,n,s),properties:l.properties,type:l.type,patterns:{}},C=this.layoutVertexArray.length;if(this.hasPattern)this.features.push(J2("fill-extrusion",this.layers,v,this.zoom,i));else if(this.wallMode)for(const A of v.geometry)this.addFeature(v,[A],d,n,{},i.availableImages,s,i.brightness);else this.addFeature(v,v.geometry,d,n,{},i.availableImages,s,i.brightness);i.featureIndex.insert(l,v.geometry,d,f,this.index,C)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,i,n,s,l,c){for(const d of this.features){const{geometry:f}=d;if(this.wallMode)for(const _ of f)this.addFeature(d,[_],d.index,i,n,s,l,c);else this.addFeature(d,f,d.index,i,n,s,l,c)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,i,n,s,l){const c=Object.keys(e).length!==0;if(c&&!this.stateDependentLayers.length)return;const d=c?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,i,d,n,s,l),this.groundEffect.update(e,i,d,n,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,f6),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.wallVertexBuffer=e.createVertexBuffer(this.wallVertexArray,h6.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,p6.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,u6.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,n,s,l,c,d,f){const _=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,y=[new Ze(0,0),new Ze(je,je)],v=d.projection,C=v.name==="globe",A=this.wallMode||M6[e.type]==="Polygon",M=new Bp;M.centroidDataIndex=this.centroidData.length;const I=new kp,P=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},s)<=0,D=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},s);let V;if(I.height=D,I.vertexArrayOffset=this.layoutVertexArray.length,I.groundVertexArrayOffset=this.groundEffect.vertexArray.length,C&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new bu),this.wallMode){if(C)return void Di("Non zero fill-extrusion-line-width is not yet supported on globe.");if(i.length!==1)return;V=function(xe){const fe=xe[0].x===xe[xe.length-1].x&&xe[0].y===xe[xe.length-1].y;(function(tt){let He=0;const Ne=tt.length;for(let ht=0;ht<Ne;ht++)He+=(tt[(ht+1)%Ne].x-tt[ht].x)*(tt[(ht+1)%Ne].y+tt[ht].y);return He>=0})(xe)||(xe=xe.reverse());const De={isPolygon:fe,geometry:[],joinNormals:[]},Ae=[],ke=[],be=[];let Ee=xe.length;if(Ee<(fe?3:2))return De;for(;Ee>=2&&xe[Ee-1].equals(xe[Ee-2]);)Ee--;let Fe,Te,Ve,Be,Re,rt=0;for(;rt<Ee-1&&xe[rt].equals(xe[rt+1]);)rt++;fe&&(Fe=xe[Ee-2],Re=xe[rt].sub(Fe)._unit()._perp());for(let tt=rt;tt<Ee;tt++){if(Ve=tt===Ee-1?fe?xe[rt+1]:void 0:xe[tt+1],Ve&&xe[tt].equals(Ve))continue;Re&&(Be=Re),Fe&&(Te=Fe),Fe=xe[tt],Re=Ve?Ve.sub(Fe)._unit()._perp():Be,Be=Be||Re;const He=Be.add(Re);He.x===0&&He.y===0||He._unit();const Ne=He.x*Re.x+He.y*Re.y,ht=Ne!==0?1/Ne:1/0,it=Be.x*Re.y-Be.y*Re.x>0;let Ke="miter";Ke==="miter"&&ht>2&&(Ke="bevel");const mt=(xt,_t,Mt,Ft)=>{const Rt=new Ze(xt.x,xt.y),oi=new Ze(xt.x,xt.y);Rt.x-=_t.x*Ft,Rt.y-=_t.y*Ft,oi.x-=_t.x*Math.max(Mt,1),oi.y-=_t.y*Math.max(Mt,1),be.push(_t),Ae.push(Rt),ke.push(oi)};if(Ke==="miter")He._mult(ht),mt(Fe,He,1,0);else{const xt=-Math.sqrt(ht*ht-1),_t=it?xt:0,Mt=it?0:xt;Te&&mt(Fe,Be,_t,Mt),Ve&&mt(Fe,Re,_t,Mt)}}return De.geometry=[...Ae,...ke.reverse(),Ae[0]],De.joinNormals=[...be,...be.reverse(),be[be.length-1]],De}(i[0]),i=[V.geometry]}const N=(xe,fe)=>xe<(fe.length-1)/2||xe===fe.length-1,U=this.wallMode?[i]:Fu(i,500);for(let xe=U.length-1;xe>=0;xe--){const fe=U[xe];(fe.length===0||(X=fe[0]).every(we=>we.x<=0)||X.every(we=>we.x>=je)||X.every(we=>we.y<=0)||X.every(we=>we.y>=je))&&U.splice(xe,1)}var X;let Y;if(C)Y=qp(U,y,s);else{Y=[];for(const xe of U)Y.push({polygon:xe,bounds:y})}const ee=A?this.edgeRadius:0,le=ee>0&&this.zoom<17,pe=(xe,fe)=>{if(xe.length===0)return!1;const we=xe[xe.length-1];return fe.x===we.x&&fe.y===we.y};for(const{polygon:xe,bounds:fe}of Y){let we=0,De=0;for(const Ee of xe)A&&!Ee[0].equals(Ee[Ee.length-1])&&Ee.push(Ee[0]),De+=A?Ee.length-1:Ee.length;const Ae=this.segments.prepareSegment((A?5:4)*De,this.layoutVertexArray,this.indexArray);I.footprintSegIdx<0&&(I.footprintSegIdx=this.footprintSegments.length),I.polygonSegIdx<0&&(I.polygonSegIdx=this.polygonSegments.length);const ke={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},be=new Lp;if(be.vertexOffset=this.footprintVertices.length,be.indexOffset=3*this.footprintIndices.length,be.ringIndices=[],A){const Ee=[],Fe=[];we=Ae.vertexLength;for(let Ve=0;Ve<xe.length;Ve++){const Be=xe[Ve];Be.length&&Ve!==0&&Fe.push(Ee.length/2);const Re=[];let rt,tt;rt=Be[1].sub(Be[0])._perp()._unit(),be.ringIndices.push(Be.length-1);for(let He=1;He<Be.length;He++){const Ne=Be[He],ht=Be[He===Be.length-1?1:He+1],it=Ne.clone();if(ee){tt=ht.sub(Ne)._perp()._unit();const Ke=rt.add(tt)._unit(),mt=ee*Math.min(4,1/(rt.x*Ke.x+rt.y*Ke.y));it.x+=mt*Ke.x,it.y+=mt*Ke.y,it.x=Math.round(it.x),it.y=Math.round(it.y),rt=tt}if(!P||ee!==0&&!le||pe(Re,it)||Re.push(it),Hc(this.layoutVertexArray,it.x,it.y,0,0,1,1,0),this.wallMode){const Ke=N(He,Be);Xc(this.wallVertexArray,V.joinNormals[He],Ke,V.isPolygon)}Ae.vertexLength++,this.footprintVertices.emplaceBack(Ne.x,Ne.y),Ee.push(Ne.x,Ne.y),C&&Yc(this.layoutVertexExtArray,v.projectTilePoint(it.x,it.y,s),v.upVector(s,it.x,it.y))}P&&(ee===0||le)&&(Re.length!==0&&pe(Re,Re[0])&&Re.pop(),this.groundEffect.addData(Re,fe,_))}const Te=$c(Ee,Fe);for(let Ve=0;Ve<Te.length;Ve+=3)this.footprintIndices.emplaceBack(be.vertexOffset+Te[Ve+0],be.vertexOffset+Te[Ve+1],be.vertexOffset+Te[Ve+2]),this.indexArray.emplaceBack(we+Te[Ve],we+Te[Ve+2],we+Te[Ve+1]),Ae.primitiveLength++;be.indexCount+=Te.length,be.vertexCount+=this.footprintVertices.length-be.vertexOffset}for(let Ee=0;Ee<xe.length;Ee++){const Fe=xe[Ee];M.startRing(I,Fe[0]);let Te=Fe.length>4&&Zp(Fe[Fe.length-2],Fe[0],Fe[1]),Ve=ee?D6(Fe[Fe.length-2],Fe[0],Fe[1],ee):0;const Be=[];let Re,rt,tt;rt=Fe[1].sub(Fe[0])._perp()._unit();let He=!0;for(let Ne=1,ht=0;Ne<Fe.length;Ne++){let it=Fe[Ne-1],Ke=Fe[Ne];const mt=Fe[Ne===Fe.length-1?1:Ne+1];if(M.appendEdge(I,Ke,it),i0(Ke,it,fe)){ee&&(rt=mt.sub(Ke)._perp()._unit(),He=!He);continue}const xt=Ke.sub(it)._perp(),_t=xt.x/(Math.abs(xt.x)+Math.abs(xt.y)),Mt=xt.y>0?1:0,Ft=it.dist(Ke);if(ht+Ft>32768&&(ht=0),ee){tt=mt.sub(Ke)._perp()._unit();let vt=Vp(it,Ke,mt,Np(rt,tt),ee);isNaN(vt)&&(vt=0);const ti=Ke.sub(it)._unit();it=it.add(ti.mult(Ve))._round(),Ke=Ke.add(ti.mult(-vt))._round(),Ve=vt,rt=tt,P&&this.zoom>=17&&(pe(Be,it)||Be.push(it),pe(Be,Ke)||Be.push(Ke))}const Rt=Ae.vertexLength,oi=Fe.length>4&&Zp(it,Ke,mt);let ui=$p(ht,Te,He);if(Hc(this.layoutVertexArray,it.x,it.y,_t,Mt,0,0,ui),Hc(this.layoutVertexArray,it.x,it.y,_t,Mt,0,1,ui),this.wallMode){const vt=N(Ne-1,Fe),ti=V.joinNormals[Ne-1];Xc(this.wallVertexArray,ti,!vt,V.isPolygon),Xc(this.wallVertexArray,ti,!vt,V.isPolygon)}if(ht+=Ft,ui=$p(ht,oi,!He),Te=oi,Hc(this.layoutVertexArray,Ke.x,Ke.y,_t,Mt,0,0,ui),Hc(this.layoutVertexArray,Ke.x,Ke.y,_t,Mt,0,1,ui),this.wallMode){const vt=N(Ne,Fe),ti=V.joinNormals[Ne];Xc(this.wallVertexArray,ti,!vt,V.isPolygon),Xc(this.wallVertexArray,ti,!vt,V.isPolygon)}if(Ae.vertexLength+=4,this.indexArray.emplaceBack(Rt+0,Rt+1,Rt+2),this.indexArray.emplaceBack(Rt+1,Rt+3,Rt+2),Ae.primitiveLength+=2,ee){const vt=we+(Ne===1?Fe.length-2:Ne-2),ti=Ne===1?we:vt+1;if(this.indexArray.emplaceBack(Rt+1,vt,Rt+3),this.indexArray.emplaceBack(vt,ti,Rt+3),Ae.primitiveLength+=2,Re===void 0&&(Re=Rt),!i0(mt,Fe[Ne],fe)){const ii=Ne===Fe.length-1?Re:Ae.vertexLength;this.indexArray.emplaceBack(Rt+2,Rt+3,ii),this.indexArray.emplaceBack(Rt+3,ii+1,ii),this.indexArray.emplaceBack(Rt+3,ti,ii+1),Ae.primitiveLength+=3}He=!He}if(C){const vt=this.layoutVertexExtArray,ti=v.projectTilePoint(it.x,it.y,s),ii=v.projectTilePoint(Ke.x,Ke.y,s),fi=v.upVector(s,it.x,it.y),Ei=v.upVector(s,Ke.x,Ke.y);Yc(vt,ti,fi),Yc(vt,ti,fi),Yc(vt,ii,Ei),Yc(vt,ii,Ei)}}A&&(we+=Fe.length-1),P&&ee&&this.zoom>=17&&(Be.length!==0&&pe(Be,Be[0])&&Be.pop(),this.groundEffect.addData(Be,fe,_,ee>0))}this.footprintSegments.push(be),ke.triangleCount=this.indexArray.length-ke.triangleArrayOffset,this.polygonSegments.push(ke),++I.footprintSegLen,++I.polygonSegLen}if(I.vertexCount=this.layoutVertexArray.length-I.vertexArrayOffset,I.groundVertexCount=this.groundEffect.vertexArray.length-I.groundVertexArrayOffset,I.vertexCount!==0){if(I.centroidXY=M.borders?Rp:this.encodeCentroid(M,I),this.centroidData.push(I),M.borders){this.featuresOnBorder.push(M);const xe=this.featuresOnBorder.length-1;for(let fe=0;fe<M.borders.length;fe++)M.borders[fe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[fe].push(xe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,l,c,s,f),this.groundEffect.addPaintPropertiesData(e,n,l,c,s,f),this.maxHeight=Math.max(this.maxHeight,D)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((i,n)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[n].borders[e][0])}splitToSubtiles(){const e=[];for(let d=0;d<this.centroidData.length;d++){const f=this.centroidData[d],_=+(f.min.y+f.max.y>je),y=2*_+(+(f.min.x+f.max.x>je)^_);for(let v=0;v<f.polygonSegLen;v++){const C=f.polygonSegIdx+v;e.push({centroidIdx:d,subtile:y,polygonSegmentIdx:C,triangleSegmentIdx:this.polygonSegments[C].triangleSegIdx})}}const i=new Hi;e.sort((d,f)=>d.triangleSegmentIdx===f.triangleSegmentIdx?d.subtile-f.subtile:d.triangleSegmentIdx-f.triangleSegmentIdx);let n=0,s=0,l=0;for(const d of e){if(d.triangleSegmentIdx!==n)break;l++}const c=e.length;for(;s!==e.length;){n=e[s].triangleSegmentIdx;let d=0,f=s,_=s;for(let y=f;y<l&&e[y].subtile===d;y++)_++;for(;f!==l;){const y=e[f];d=y.subtile;const v=this.centroidData[y.centroidIdx].min.clone(),C=this.centroidData[y.centroidIdx].max.clone(),A={vertexOffset:this.segments.segments[n].vertexOffset,primitiveOffset:i.length,vertexLength:this.segments.segments[n].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let M=f;M<_;M++){const I=e[M],P=this.polygonSegments[I.polygonSegmentIdx],D=this.centroidData[I.centroidIdx].min,V=this.centroidData[I.centroidIdx].max,N=this.indexArray.uint16;for(let U=P.triangleArrayOffset;U<P.triangleArrayOffset+P.triangleCount;U++)i.emplaceBack(N[3*U],N[3*U+1],N[3*U+2]);A.primitiveLength+=P.triangleCount,v.x=Math.min(v.x,D.x),v.y=Math.min(v.y,D.y),C.x=Math.max(C.x,V.x),C.y=Math.max(C.y,V.y)}A.primitiveLength>0&&this.triangleSubSegments.push({segment:A,min:v,max:C}),f=_;for(let M=f;M<l&&e[M].subtile===e[f].subtile;M++)_++}s=l;for(let y=s;y<c&&e[y].triangleSegmentIdx===e[s].triangleSegmentIdx;y++)l++}i._trim(),this.indexArray=i}getVisibleSegments(e,i,n){const s=new wi;if(this.wallMode){for(const I of this.triangleSubSegments)s.segments.push(I.segment);return s}let l=0,c=0;const d=1<<e.canonical.z;if(i){const I=i.getMinMaxForTile(e);I&&(l=I.min,c=I.max)}c+=this.maxHeight;const f=e.toUnwrapped();let _;const y=[f.canonical.x/d+f.wrap,f.canonical.y/d],v=[(f.canonical.x+1)/d+f.wrap,(f.canonical.y+1)/d],C=(I,P,D)=>[I[0]*(1-D[0])+P[0]*D[0],I[1]*(1-D[1])+P[1]*D[1]],A=[],M=[];for(const I of this.triangleSubSegments){A[0]=I.min.x/je,A[1]=I.min.y/je,M[0]=I.max.x/je,M[1]=I.max.y/je;const P=C(y,v,A),D=C(y,v,M);if(new vi([P[0],P[1],l],[D[0],D[1],c]).intersectsPrecise(n)===0){_&&(s.segments.push(_),_=void 0);continue}const V=I.segment;_&&_.vertexOffset!==V.vertexOffset&&(s.segments.push(_),_=void 0),_?(_.vertexLength+=V.vertexLength,_.primitiveLength+=V.primitiveLength):_={vertexOffset:V.vertexOffset,primitiveLength:V.primitiveLength,vertexLength:V.vertexLength,primitiveOffset:V.primitiveOffset,sortKey:void 0,vaos:{}}}return _&&s.segments.push(_),s}encodeCentroid(e,i){const n=e.centroid(),s=i.span(),l=Math.min(7,Math.round(s.x*this.tileToMeter/10)),c=Math.min(7,Math.round(s.y*this.tileToMeter/10));return new Ze(Pt(n.x,1,je-1)<<3|l,Pt(n.y,1,je-1)<<3|c)}encodeBorderCentroid(e){if(!e.borders)return new Ze(0,0);const i=e.borders,n=Number.MAX_VALUE;if(i[0][0]!==n||i[1][0]!==n){const s=i[0][0]!==n?0:1;return new Ze(6|(i[0][0]!==n?0:65528),(i[s][0]+i[s][1])/2<<3|6)}{const s=i[2][0]!==n?2:3;return new Ze((i[s][0]+i[s][1])/2<<3|6,6|(i[2][0]!==n?0:65528))}}showCentroid(e){const i=this.centroidData[e.centroidDataIndex];i.flags&=La,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const i=e.vertexArrayOffset,n=e.vertexCount+e.vertexArrayOffset,s=e.flags&La?Rp:e.centroidXY,l=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==s.y||l!==s.x){for(let c=i;c<n;++c)this.centroidVertexArray.emplace(c,s.x,s.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,i,n){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const s=i.getReplacementRegionsForTile(e.toUnwrapped());if(t0(this.activeReplacements,s))return;if(this.activeReplacements=s,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const c of this.centroidData)c.flags&=2147483647;const l=[];for(const c of this.activeReplacements){if(c.order<n)continue;const d=Math.pow(2,c.footprintTileId.canonical.z-e.canonical.z);for(const f of this.centroidData)if(!(f.flags&La||c.min.x>f.max.x||f.min.x>c.max.x||c.min.y>f.max.y||f.min.y>c.max.y))for(let _=0;_<f.footprintSegLen;_++){const y=this.footprintSegments[f.footprintSegIdx+_];if(l.length=0,R6(this.footprintVertices,y.vertexOffset,y.vertexCount,c.footprintTileId.canonical,e.canonical,l),bp(c.footprint,l,this.footprintIndices.uint16,y.indexOffset,y.indexCount,-y.vertexOffset,-d)){f.flags|=La;break}}}for(const c of this.centroidData)this.writeCentroidToBuffer(c);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,i,n){let s=!1;for(let l=0;l<n.footprintSegLen;l++){const c=this.footprintSegments[n.footprintSegIdx+l];let d=0;for(const f of c.ringIndices){for(let _=d,y=f+d-1;_<f+d;y=_++){const v=this.footprintVertices.int16[2*(_+c.vertexOffset)+0],C=this.footprintVertices.int16[2*(_+c.vertexOffset)+1],A=this.footprintVertices.int16[2*(y+c.vertexOffset)+1];C>i!=A>i&&e<(this.footprintVertices.int16[2*(y+c.vertexOffset)+0]-v)*(i-C)/(A-C)+v&&(s=!s)}d=f}}return s}getHeightAtTileCoord(e,i){let n=Number.NEGATIVE_INFINITY,s=!0;const l=4*(e+je)*je+(i+je);if(this.partLookup.hasOwnProperty(l)){const c=this.partLookup[l];return c?{height:c.height,hidden:!!(c.flags&La)}:void 0}for(const c of this.centroidData)e>c.max.x||c.min.x>e||i>c.max.y||c.min.y>i||this.footprintContainsPoint(e,i,c)&&c&&c.height>n&&(n=c.height,this.partLookup[l]=c,s=!!(c.flags&La));if(n!==Number.NEGATIVE_INFINITY)return{height:n,hidden:s};this.partLookup[l]=void 0}}function Np(t,e){const i=t.add(e)._unit();return t.x*i.x+t.y*i.y}function D6(t,e,i,n){const s=e.sub(t)._perp()._unit(),l=i.sub(e)._perp()._unit();return Vp(t,e,i,Np(s,l),n)}function Vp(t,e,i,n,s){const l=Math.sqrt(1-n*n);return Math.min(t.dist(e)/3,e.dist(i)/3,s*l/n)}function i0(t,e,i){return t.x<i[0].x&&e.x<i[0].x||t.x>i[1].x&&e.x>i[1].x||t.y<i[0].y&&e.y<i[0].y||t.y>i[1].y&&e.y>i[1].y}function Up(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function Zp(t,e,i){if(t.x<0||t.x>=je||e.x<0||e.x>=je||i.x<0||i.x>=je)return!1;const n=i.sub(e),s=n.perp(),l=t.sub(e);return(n.x*l.x+n.y*l.y)/Math.sqrt((n.x*n.x+n.y*n.y)*(l.x*l.x+l.y*l.y))>-.866&&s.x*l.x+s.y*l.y<0}function $p(t,e,i){const n=e?2|t:-3&t;return i?1|n:-2&n}function Gp(){const t=Math.PI/32,e=Math.tan(t),i=d1;return i*Math.sqrt(1+2*e*e)-i}function qp(t,e,i){const n=1<<i.z,s=Fr(i.x/n),l=Fr((i.x+1)/n),c=Qi(i.y/n),d=Qi((i.y+1)/n);return function(f,_,y,v,C=0,A){const M=[];if(!f.length||!y||!v)return M;const I=(Y,ee)=>{for(const le of Y)M.push({polygon:le,bounds:ee})},P=Math.ceil(Math.log2(y)),D=Math.ceil(Math.log2(v)),V=P-D,N=[];for(let Y=0;Y<Math.abs(V);Y++)N.push(V>0?0:1);for(let Y=0;Y<Math.min(P,D);Y++)N.push(0),N.push(1);let U=f;if(U=Uu(U,_[0].y-C,_[1].y+C,1),U=Uu(U,_[0].x-C,_[1].x+C,0),!U.length)return M;const X=[];for(N.length?X.push({polygons:U,bounds:_,depth:0}):I(U,_);X.length;){const Y=X.pop(),ee=Y.depth,le=N[ee],pe=Y.bounds[0],xe=Y.bounds[1],fe=le===0?pe.x:pe.y,we=le===0?xe.x:xe.y,De=A?A(le,fe,we):.5*(fe+we),Ae=Uu(Y.polygons,fe-C,De+C,le),ke=Uu(Y.polygons,De-C,we+C,le);if(Ae.length){const be=[pe,new Ze(le===0?De:xe.x,le===1?De:xe.y)];N.length>ee+1?X.push({polygons:Ae,bounds:be,depth:ee+1}):I(Ae,be)}if(ke.length){const be=[new Ze(le===0?De:pe.x,le===1?De:pe.y),xe];N.length>ee+1?X.push({polygons:ke,bounds:be,depth:ee+1}):I(ke,be)}}return M}(t,e,Math.ceil((l-s)/11.25),Math.ceil((c-d)/11.25),1,(f,_,y)=>{if(f===0)return .5*(_+y);{const v=Qi((i.y+_/je)/n);return(as(.5*(Qi((i.y+y/je)/n)+v))*n-i.y)*je}})}function R6(t,e,i,n,s,l){const c=Math.pow(2,n.z-s.z);for(let d=0;d<i;d++){let f=t.int16[2*(d+e)+0],_=t.int16[2*(d+e)+1];f=(f+s.x*je)*c-n.x*je,_=(_+s.y*je)*c-n.y*je,l.push(new Ze(f,_))}}let Wp,Hp;function Jc(t,e){return t.x*e.x+t.y*e.y}function Xp(t,e){if(t.length===1){let i=0;const n=e[i++];let s;for(;!s||n.equals(s);)if(s=e[i++],!s)return 1/0;for(;i<e.length;i++){const l=e[i],c=t[0],d=s.sub(n),f=l.sub(n),_=c.sub(n),y=Jc(d,d),v=Jc(d,f),C=Jc(f,f),A=Jc(_,d),M=Jc(_,f),I=y*C-v*v,P=(C*A-v*M)/I,D=(y*M-v*A)/I,V=n.z*(1-P-D)+s.z*P+l.z*D;if(isFinite(V))return V}return 1/0}{let i=1/0;for(const n of e)i=Math.min(i,n.z);return i}}function Yp(t,e,i,n,s,l,c,d){const f=c*s.getElevationAt(t,e,!0,!0),_=l[0]!==0,y=_?l[1]===0?c*(l[0]/7-450):c*function(v,C,A){const M=Math.floor(C[0]/8),I=Math.floor(C[1]/8),P=10*(C[0]-8*M),D=10*(C[1]-8*I),V=v.getElevationAt(M,I,!0,!0),N=v.getMeterToDEM(A),U=Math.floor(.5*(P*N-1)),X=Math.floor(.5*(D*N-1)),Y=v.tileCoordToPixel(M,I),ee=2*U+1,le=2*X+1,pe=function(ke,be,Ee,Fe,Te){return[ke.getElevationAtPixel(be,Ee,!0),ke.getElevationAtPixel(be+Te,Ee,!0),ke.getElevationAtPixel(be,Ee+Te,!0),ke.getElevationAtPixel(be+Fe,Ee+Te,!0)]}(v,Y.x-U,Y.y-X,ee,le),xe=Math.abs(pe[0]-pe[1]),fe=Math.abs(pe[2]-pe[3]),we=Math.abs(pe[0]-pe[2])+Math.abs(pe[1]-pe[3]),De=Math.min(.25,.5*N*(xe+fe)/ee),Ae=Math.min(.25,.5*N*we/le);return V+Math.max(De*P,Ae*D)}(s,l,d):f;return{base:f+(i===0)?-1:i,top:_?Math.max(y+n,f+i+2):f+n}}oe(Wu,"FillExtrusionBucket",{omit:["layers","features"]}),oe(kp,"PartData"),oe(Lp,"FootprintSegment"),oe(Bp,"BorderCentroidData"),oe(jp,"GroundEffect");const L6=ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:k6}=L6,B6=ei([{name:"a_packed",components:4,type:"Float32"}]),{members:F6}=B6,j6=ei([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:N6}=j6,V6=ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),U6=ei([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Z6=ei([{name:"a_projected_pos",components:4,type:"Float32"}],4);ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Jp=ei([{name:"a_z_offset",components:1,type:"Float32"}],4),$6=ei([{name:"a_texb",components:2,type:"Uint16"}]),G6=ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),q6=ei([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);ei([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Kp=ei([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),W6=ei([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ei([{name:"triangle",components:3,type:"Uint16"}]),ei([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ei([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ei([{type:"Float32",name:"offsetX"}]),ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class Qp{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Da({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const n=this.getKey(e,i);return this.positions[n]}trim(){const e=this.width,i=this.height=xs(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,n){const s=[];let l=e.length%2==1?-e[e.length-1]*n:0,c=e[0]*n,d=!0;s.push({left:l,right:c,isDash:d,zeroLength:e[0]===0});let f=e[0];for(let _=1;_<e.length;_++){d=!d;const y=e[_];l=f*n,f+=y,c=f*n,s.push({left:l,right:c,isDash:d,zeroLength:y===0})}return s}addRoundDash(e,i,n){const s=i/2;for(let l=-n;l<=n;l++){const c=this.width*(this.nextRow+n+l);let d=0,f=e[d];for(let _=0;_<this.width;_++){_/f.right>1&&(f=e[++d]);const y=Math.abs(_-f.left),v=Math.abs(_-f.right),C=Math.min(y,v);let A;const M=l/n*(s+1);if(f.isDash){const I=s-Math.abs(M);A=Math.sqrt(C*C+I*I)}else A=s-Math.sqrt(C*C+M*M);this.image.data[c+_]=Math.max(0,Math.min(255,A+128))}}}addRegularDash(e,i){for(let f=e.length-1;f>=0;--f){const _=e[f],y=e[f+1];_.zeroLength?e.splice(f,1):y&&y.isDash===_.isDash&&(y.left=_.left,e.splice(f,1))}const n=e[0],s=e[e.length-1];n.isDash===s.isDash&&(n.left=s.left-this.width,s.right=n.right+this.width);const l=this.width*this.nextRow;let c=0,d=e[c];for(let f=0;f<this.width;f++){f/d.right>1&&(d=e[++c]);const _=Math.abs(f-d.left),y=Math.abs(f-d.right),v=Math.min(_,y);this.image.data[l+f]=Math.max(0,Math.min(255,(d.isDash?v:-v)+i+128))}}addDash(e,i){const n=this.getKey(e,i);if(this.positions[n])return this.positions[n];const s=i==="round",l=s?7:0,c=2*l+1;if(this.nextRow+c>this.height)return Di("LineAtlas out of space"),null;e.length===0&&e.push(1);let d=0;for(let y=0;y<e.length;y++)e[y]<0&&(Di("Negative value is found in line dasharray, replacing values with 0"),e[y]=0),d+=e[y];if(d!==0){const y=this.width/d,v=this.getDashRanges(e,this.width,y);s?this.addRoundDash(v,y,l):this.addRegularDash(v,i==="square"?.5*y:0)}const f=this.nextRow+l;this.nextRow+=c;const _={tl:[f,l],br:[d,0]};return this.positions[n]=_,_}}oe(Qp,"LineAtlas");const H6=Vu.types,X6=Math.cos(Math.PI/180*37.5),Y6=Math.cos(Math.PI/180*5);class Hu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new o2,this.layoutVertexArray2=new Ta,this.patternVertexArray=new Ma,this.indexArray=new Hi,this.programConfigurations=new Pa(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new wi,this.maxLineLength=0,this.zOffsetVertexArray=new l1,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.tessellationStep=e.tessellationStep?e.tessellationStep:je/64}updateFootprints(e,i){}populate(e,i,n,s){this.hasPattern=Y2("line",this.layers,i);const l=this.layers[0].layout.get("line-sort-key"),c=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!c.isConstant()||!!c.constantOr(0);const d=[];for(const{feature:v,id:C,index:A,sourceLayerIndex:M}of e){const I=this.layers[0]._featureFilter.needGeometry,P=ks(v,I);if(!this.layers[0]._featureFilter.filter(new dt(this.zoom),P,n))continue;const D=l?l.evaluate(P,{},n):void 0,V={id:C,properties:v.properties,type:v.type,sourceLayerIndex:M,index:A,geometry:I?P.geometry:Ln(v,n,s),patterns:{},sortKey:D};d.push(V)}l&&d.sort((v,C)=>v.sortKey-C.sortKey);const{lineAtlas:f,featureIndex:_}=i,y=this.addConstantDashes(f);for(const v of d){const{geometry:C,index:A,sourceLayerIndex:M}=v;if(y&&this.addFeatureDashes(v,f),this.hasPattern){const I=J2("line",this.layers,v,this.zoom,i);this.patternFeatures.push(I)}else this.addFeature(v,C,A,n,f.positions,i.availableImages,i.brightness);_.insert(e[A].feature,C,A,M,this.index)}}addConstantDashes(e){let i=!1;for(const n of this.layers){const s=n.paint.get("line-dasharray").value,l=n.layout.get("line-cap").value;if(s.kind!=="constant"||l.kind!=="constant")i=!0;else{const c=l.value,d=s.value;if(!d)continue;e.addDash(d,c)}}return i}addFeatureDashes(e,i){const n=this.zoom;for(const s of this.layers){const l=s.paint.get("line-dasharray").value,c=s.layout.get("line-cap").value;if(l.kind==="constant"&&c.kind==="constant")continue;let d,f;if(l.kind==="constant"){if(d=l.value,!d)continue}else d=l.evaluate({zoom:n},e);f=c.kind==="constant"?c.value:c.evaluate({zoom:n},e),i.addDash(d,f),e.patterns[s.id]=i.getKey(d,f)}}update(e,i,n,s,l){const c=Object.keys(e).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,i,c?this.stateDependentLayers:this.layers,n,s,l)}addFeatures(e,i,n,s,l,c){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,n,s,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,F6)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,N6)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,Jp.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,k6),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,n,s,l,c,d){const f=this.layers[0].layout,_=f.get("line-join").evaluate(e,{}),y=f.get("line-cap").evaluate(e,{}),v=f.get("line-miter-limit"),C=f.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const A of i)this.addLine(A,e,s,_,y,v,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,l,c,s,d)}addLine(e,i,n,s,l,c,d){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const f={zoom:this.zoom,lineProgress:void 0},_=this.layers[0].layout,y=s==="none";if(this.patternJoinNone=this.hasPattern&&y,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Y=0;Y<e.length-1;Y++)this.totalDistance+=e[Y].dist(e[Y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=H6[i.type]==="Polygon";let C=e.length;for(;C>=2&&e[C-1].equals(e[C-2]);)C--;let A=0;for(;A<C-1&&e[A].equals(e[A+1]);)A++;if(C<(v?3:2))return;s==="bevel"&&(c=1.05);const M=this.overscaling<=16?15*je/(512*this.overscaling):0,I=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let P,D,V,N,U,X;this.e1=this.e2=-1,v&&(P=e[C-2],U=e[A].sub(P)._unit()._perp());for(let Y=A;Y<C;Y++){if(V=Y===C-1?v?e[A+1]:void 0:e[Y+1],V&&e[Y].equals(V))continue;if(U&&(N=U),P&&(D=P),P=e[Y],this.hasZOffset){const be=_.get("line-z-offset").value;if(be.kind==="constant")X=be.value;else{if(this.lineClips){const Ee=this.totalDistance/(this.lineClips.end-this.lineClips.start);f.lineProgress=(Ee*this.lineClips.start+this.distance+(D?D.dist(P):0))/Ee}else Di(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),f.lineProgress=0;X=be.evaluate(f,i)}X=X||0}U=V?V.sub(P)._unit()._perp():N,N=N||U;const ee=D&&V;let le=ee?s:v||y?"butt":l;const pe=N.x*U.x+N.y*U.y;if(y){const be=function(Ee){if(Ee.patternJoinNone){const Fe=Ee.segmentPoints.length/2,Te=Ee.lineSoFar-Ee.segmentStart;for(let Ve=0;Ve<Fe;++Ve){const Be=Ee.segmentPoints[2*Ve+1],Re=Math.round(Ee.segmentPoints[2*Ve])+.5+.25*Be;Ee.patternVertexArray.emplaceBack(Re,Te,Ee.segmentStart),Ee.patternVertexArray.emplaceBack(Re,Te,Ee.segmentStart)}Ee.segmentPoints.length=0}Ee.e1=Ee.e2=-1};if(ee&&pe<Y6){this.updateDistance(D,P),this.addCurrentVertex(P,N,1,1,I,X),be(this),this.addCurrentVertex(P,U,-1,-1,I,X);continue}if(D){if(!V){this.updateDistance(D,P),this.addCurrentVertex(P,N,1,1,I,X),be(this);continue}le="miter"}}let xe=N.add(U);xe.x===0&&xe.y===0||xe._unit();const fe=xe.x*U.x+xe.y*U.y,we=fe!==0?1/fe:1/0,De=2*Math.sqrt(2-2*fe),Ae=fe<X6&&D&&V,ke=N.x*U.y-N.y*U.x>0;if(Ae&&Y>A){const be=P.dist(D);if(be>2*M){const Ee=P.sub(P.sub(D)._mult(M/be)._round());this.updateDistance(D,Ee),this.addCurrentVertex(Ee,N,0,0,I,X),D=Ee}}if(ee&&le==="round"&&(we<d?le="miter":we<=2&&(le="fakeround")),le==="miter"&&we>c&&(le="bevel"),le==="bevel"&&(we>2&&(le="flipbevel"),we<c&&(le="miter")),D&&this.updateDistance(D,P),le==="miter")xe._mult(we),this.addCurrentVertex(P,xe,0,0,I,X);else if(le==="flipbevel"){if(we>100)xe=U.mult(-1);else{const be=we*N.add(U).mag()/N.sub(U).mag();xe._perp()._mult(be*(ke?-1:1))}this.addCurrentVertex(P,xe,0,0,I,X),this.addCurrentVertex(P,xe.mult(-1),0,0,I,X)}else if(le==="bevel"||le==="fakeround"){const be=-Math.sqrt(we*we-1),Ee=ke?be:0,Fe=ke?0:be;if(D&&this.addCurrentVertex(P,N,Ee,Fe,I,X),le==="fakeround"){const Te=Math.round(180*De/Math.PI/20);for(let Ve=1;Ve<Te;Ve++){let Be=Ve/Te;if(Be!==.5){const rt=Be-.5;Be+=Be*rt*(Be-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*rt*rt+(.848013+pe*(.215638*pe-1.06021)))}const Re=U.sub(N)._mult(Be)._add(N)._unit()._mult(ke?-1:1);this.addHalfVertex(P,Re.x,Re.y,!1,ke,0,I,X)}}V&&this.addCurrentVertex(P,U,-Ee,-Fe,I,X)}else le==="butt"?this.addCurrentVertex(P,xe,0,0,I,X):le==="square"?(D||this.addCurrentVertex(P,xe,-1,-1,I,X),this.addCurrentVertex(P,xe,0,0,I,X),D&&this.addCurrentVertex(P,xe,1,1,I,X)):le==="round"&&(D&&(this.addCurrentVertex(P,N,0,0,I,X),this.addCurrentVertex(P,N,1,1,I,X,!0)),V&&(this.addCurrentVertex(P,U,-1,-1,I,X,!0),this.addCurrentVertex(P,U,0,0,I,X)));if(Ae&&Y<C-1){const be=P.dist(V);if(be>2*M){const Ee=P.add(V.sub(P)._mult(M/be)._round());this.updateDistance(P,Ee),this.addCurrentVertex(Ee,U,0,0,I,X),P=Ee}}}}addVerticesTo(e,i,n,s,l,c,d,f,_,y){const v=(i.w-e.w)/this.tessellationStep|0;if(v>1){this.lineSoFar=e.w;const C=(i.x-e.x)/v,A=(i.y-e.y)/v,M=(i.z-e.z)/v,I=(i.w-e.w)/v;for(let P=1;P<v;++P)e.x+=C,e.y+=A,e.z+=M,this.lineSoFar+=I,this.addHalfVertex(e,n,s,y,!1,d,_,e.z),this.addHalfVertex(e,l,c,y,!0,-f,_,e.z)}this.lineSoFar=i.w,this.addHalfVertex(i,n,s,y,!1,d,_,i.z),this.addHalfVertex(i,l,c,y,!0,-f,_,i.z)}addCurrentVertex(e,i,n,s,l,c,d=!1){const f=i.x+i.y*n,_=i.y-i.x*n,y=i.y*s-i.x,v=-i.y-i.x*s;if(c!=null){const A=je+10,M=c,I=new _p(e.x,e.y,M,this.lineSoFar),P=ef(e,-10,A),D=this.lineSoFar;if(this.currentVertex)if(P){const V=this.currentVertexIsOutside,N=this.currentVertex,U=new _p(e.x,e.y,M,this.lineSoFar);yp(N,U,-10,A),ef(U,-10,A)||(V&&(this.e1=this.e2=-1,this.lineSoFar=N.w,this.addHalfVertex(N,f,_,d,!1,n,l,N.z),this.addHalfVertex(N,y,v,d,!0,-s,l,N.z)),this.addVerticesTo(N,U,f,_,y,v,n,s,l,d))}else{const V=this.currentVertex;this.currentVertexIsOutside&&(yp(V,I,-10,A),this.e1=this.e2=-1,this.lineSoFar=V.w,this.addHalfVertex(V,f,_,d,!1,n,l,V.z),this.addHalfVertex(V,y,v,d,!0,-s,l,V.z)),this.addVerticesTo(V,I,f,_,y,v,n,s,l,d)}else P||(this.addHalfVertex(e,f,_,d,!1,n,l,c),this.addHalfVertex(e,y,v,d,!0,-s,l,c));this.currentVertex=I,this.currentVertexIsOutside=P,this.lineSoFar=D}else this.addHalfVertex(e,f,_,d,!1,n,l,c),this.addHalfVertex(e,y,v,d,!0,-s,l,c)}addHalfVertex({x:e,y:i},n,s,l,c,d,f,_){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),c||this.segmentPoints.push(this.lineSoFar-this.segmentStart,d)),this.layoutVertexArray.emplaceBack((e<<1)+(l?1:0),(i<<1)+(c?1:0),Math.round(63*n)+128,Math.round(63*s)+128,1+(d===0?0:d<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const y=f.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,y),f.primitiveLength++),c?this.e2=y:this.e1=y,_!=null&&this.zOffsetVertexArray.emplaceBack(_)}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}function ef(t,e,i){return t.x<e||t.x>i||t.y<e||t.y>i}let tf,rf;function nf(t,e,i){return e*(je/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}function sf(t,e){return 1/nf(t,1,e.tileZoom)}function af(t,e,i,n){return t.translatePosMatrix(n||e.tileID.projMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}oe(Hu,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const of=t=>{const e=[];lf(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const i=t.paint.get("line-trim-offset");i[0]===0&&i[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),t.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER");const n=t.layout.get("line-join").constantOr("miter")==="none",s=!!t.paint.get("line-pattern").constantOr(1);return n&&s&&e.push("LINE_JOIN_NONE"),e};function lf(t){const e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}class cf{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const n=e[i];this._stringToNumber[n]=i,this._numberToString[i]=n}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}var J6={read:function(t,e,i,n,s){var l,c,d=8*s-n-1,f=(1<<d)-1,_=f>>1,y=-7,v=i?s-1:0,C=i?-1:1,A=t[e+v];for(v+=C,l=A&(1<<-y)-1,A>>=-y,y+=d;y>0;l=256*l+t[e+v],v+=C,y-=8);for(c=l&(1<<-y)-1,l>>=-y,y+=n;y>0;c=256*c+t[e+v],v+=C,y-=8);if(l===0)l=1-_;else{if(l===f)return c?NaN:1/0*(A?-1:1);c+=Math.pow(2,n),l-=_}return(A?-1:1)*c*Math.pow(2,l-n)},write:function(t,e,i,n,s,l){var c,d,f,_=8*l-s-1,y=(1<<_)-1,v=y>>1,C=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=n?0:l-1,M=n?1:-1,I=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(d=isNaN(e)?1:0,c=y):(c=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-c))<1&&(c--,f*=2),(e+=c+v>=1?C/f:C*Math.pow(2,1-v))*f>=2&&(c++,f/=2),c+v>=y?(d=0,c=y):c+v>=1?(d=(e*f-1)*Math.pow(2,s),c+=v):(d=e*Math.pow(2,v-1)*Math.pow(2,s),c=0));s>=8;t[i+A]=255&d,A+=M,d/=256,s-=8);for(c=c<<s|d,_+=s;_>0;t[i+A]=255&c,A+=M,c/=256,_-=8);t[i+A-M]|=128*I}},uf=Ci,Xu=J6;function Ci(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ci.Varint=0,Ci.Fixed64=1,Ci.Bytes=2,Ci.Fixed32=5;var r0=4294967296,hf=1/r0,df=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function js(t){return t.type===Ci.Bytes?t.readVarint()+t.pos:t.pos+1}function x1(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function pf(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var s=i.pos-1;s>=t;s--)i.buf[s+n]=i.buf[s]}function K6(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Q6(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function e9(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function t9(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function i9(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function r9(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function n9(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function s9(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function a9(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Yu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function v1(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function ff(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Ci.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),s=n>>3,l=this.pos;this.type=7&n,t(s,e,this),this.pos===l&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Yu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ff(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Yu(this.buf,this.pos)+Yu(this.buf,this.pos+4)*r0;return this.pos+=8,t},readSFixed64:function(){var t=Yu(this.buf,this.pos)+ff(this.buf,this.pos+4)*r0;return this.pos+=8,t},readFloat:function(){var t=Xu.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Xu.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(s,l,c){var d,f,_=c.buf;if(d=(112&(f=_[c.pos++]))>>4,f<128||(d|=(127&(f=_[c.pos++]))<<3,f<128)||(d|=(127&(f=_[c.pos++]))<<10,f<128)||(d|=(127&(f=_[c.pos++]))<<17,f<128)||(d|=(127&(f=_[c.pos++]))<<24,f<128)||(d|=(1&(f=_[c.pos++]))<<31,f<128))return x1(s,d,l);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&df?function(i,n,s){return df.decode(i.subarray(n,s))}(this.buf,e,t):function(i,n,s){for(var l="",c=n;c<s;){var d,f,_,y=i[c],v=null,C=y>239?4:y>223?3:y>191?2:1;if(c+C>s)break;C===1?y<128&&(v=y):C===2?(192&(d=i[c+1]))==128&&(v=(31&y)<<6|63&d)<=127&&(v=null):C===3?(f=i[c+2],(192&(d=i[c+1]))==128&&(192&f)==128&&((v=(15&y)<<12|(63&d)<<6|63&f)<=2047||v>=55296&&v<=57343)&&(v=null)):C===4&&(f=i[c+2],_=i[c+3],(192&(d=i[c+1]))==128&&(192&f)==128&&(192&_)==128&&((v=(15&y)<<18|(63&d)<<12|(63&f)<<6|63&_)<=65535||v>=1114112)&&(v=null)),v===null?(v=65533,C=1):v>65535&&(v-=65536,l+=String.fromCharCode(v>>>10&1023|55296),v=56320|1023&v),l+=String.fromCharCode(v),c+=C}return l}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ci.Bytes)return t.push(this.readVarint(e));var i=js(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ci.Bytes)return t.push(this.readSVarint());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ci.Bytes)return t.push(this.readBoolean());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ci.Bytes)return t.push(this.readFloat());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ci.Bytes)return t.push(this.readDouble());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ci.Bytes)return t.push(this.readFixed32());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ci.Bytes)return t.push(this.readSFixed32());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ci.Bytes)return t.push(this.readFixed64());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ci.Bytes)return t.push(this.readSFixed64());var e=js(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ci.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ci.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ci.Fixed32)this.pos+=4;else{if(e!==Ci.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),v1(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),v1(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),v1(this.buf,-1&t,this.pos),v1(this.buf,Math.floor(t*hf),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),v1(this.buf,-1&t,this.pos),v1(this.buf,Math.floor(t*hf),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var n,s;if(e>=0?(n=e%4294967296|0,s=e/4294967296|0):(s=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,s=s+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(l,c,d){d.buf[d.pos++]=127&l|128,l>>>=7,d.buf[d.pos++]=127&l|128,l>>>=7,d.buf[d.pos++]=127&l|128,l>>>=7,d.buf[d.pos++]=127&l|128,d.buf[d.pos]=127&(l>>>=7)}(n,0,i),function(l,c){var d=(7&l)<<4;c.buf[c.pos++]|=d|((l>>>=3)?128:0),l&&(c.buf[c.pos++]=127&l|((l>>>=7)?128:0),l&&(c.buf[c.pos++]=127&l|((l>>>=7)?128:0),l&&(c.buf[c.pos++]=127&l|((l>>>=7)?128:0),l&&(c.buf[c.pos++]=127&l|((l>>>=7)?128:0),l&&(c.buf[c.pos++]=127&l)))))}(s,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(n,s,l){for(var c,d,f=0;f<s.length;f++){if((c=s.charCodeAt(f))>55295&&c<57344){if(!d){c>56319||f+1===s.length?(n[l++]=239,n[l++]=191,n[l++]=189):d=c;continue}if(c<56320){n[l++]=239,n[l++]=191,n[l++]=189,d=c;continue}c=d-55296<<10|c-56320|65536,d=null}else d&&(n[l++]=239,n[l++]=191,n[l++]=189,d=null);c<128?n[l++]=c:(c<2048?n[l++]=c>>6|192:(c<65536?n[l++]=c>>12|224:(n[l++]=c>>18|240,n[l++]=c>>12&63|128),n[l++]=c>>6&63|128),n[l++]=63&c|128)}return l}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&pf(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Xu.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Xu.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&pf(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,Ci.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,K6,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Q6,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,i9,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,e9,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,t9,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,r9,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,n9,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,s9,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,a9,e)},writeBytesField:function(t,e){this.writeTag(t,Ci.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ci.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ci.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ci.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ci.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ci.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ci.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ci.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ci.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ci.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var Kc=dn(uf);const o9=["id","tile","layer","source","sourceLayer","state"];class mf{constructor(e,i,n,s,l){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=n,this._y=s,this.properties=e.properties,this.id=l}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const i of o9)this[i]!==void 0&&(e[i]=this[i]);return e}}class l9{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,n){const s=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][s]=this.stateChanges[e][s]||{},ir(this.stateChanges[e][s],n),this.deletedStates[e]===null){this.deletedStates[e]={};for(const l in this.state[e])l!==s&&(this.deletedStates[e][l]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][s]===null){this.deletedStates[e][s]={};for(const l in this.state[e][s])n[l]||(this.deletedStates[e][s][l]=null)}else for(const l in n)this.deletedStates[e]&&this.deletedStates[e][s]&&this.deletedStates[e][s][l]===null&&delete this.deletedStates[e][s][l]}removeFeatureState(e,i,n){if(this.deletedStates[e]===null)return;const s=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&i!==void 0)this.deletedStates[e][s]!==null&&(this.deletedStates[e][s]=this.deletedStates[e][s]||{},this.deletedStates[e][s][n]=null);else if(i!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][s])for(n in this.deletedStates[e][s]={},this.stateChanges[e][s])this.deletedStates[e][s][n]=null;else this.deletedStates[e][s]=null;else this.deletedStates[e]=null}getState(e,i){const n=String(i),s=ir({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const l=this.deletedStates[e][i];if(l===null)return{};for(const c in l)delete s[c]}return s}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const n={};for(const s in this.stateChanges){this.state[s]=this.state[s]||{};const l={};for(const c in this.stateChanges[s])this.state[s][c]||(this.state[s][c]={}),ir(this.state[s][c],this.stateChanges[s][c]),l[c]=this.state[s][c];n[s]=l}for(const s in this.deletedStates){this.state[s]=this.state[s]||{};const l={};if(this.deletedStates[s]===null)for(const c in this.state[s])l[c]={},this.state[s][c]={};else for(const c in this.deletedStates[s]){if(this.deletedStates[s][c]===null)this.state[s][c]={};else if(this.state[s][c])for(const d of Object.keys(this.deletedStates[s][c]))delete this.state[s][c][d];l[c]=this.state[s][c]}n[s]=n[s]||{},ir(n[s],l)}if(this.stateChanges={},this.deletedStates={},Object.keys(n).length!==0)for(const s in e)e[s].setFeatureState(n,i)}}class _f{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ge(je,16,0),this.featureIndexArray=new ud,this.promoteId=i,this.is3DTile=!1}insert(e,i,n,s,l,c=0,d=0){const f=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,s,l,c);const _=this.grid;for(let y=0;y<i.length;y++){const v=i[y],C=[1/0,1/0,-1/0,-1/0];for(let A=0;A<v.length;A++){const M=v[A];C[0]=Math.min(C[0],M.x),C[1]=Math.min(C[1],M.y),C[2]=Math.max(C[2],M.x),C[3]=Math.max(C[3],M.y)}d!==0&&(C[0]-=d,C[1]-=d,C[2]+=d,C[3]+=d),C[0]<je&&C[1]<je&&C[2]>=0&&C[3]>=0&&_.insert(f,C[0],C[1],C[2],C[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Q2(new Kc(this.rawTileData)).layers,this.sourceLayerCoder=new cf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,n,s){this.loadVTLayers();const l=e.params||{},c=zn(l.filter),d=e.tileResult,f=e.transform,_=d.bufferedTilespaceBounds,y=this.grid.query(_.min.x,_.min.y,_.max.x,_.max.y,(M,I,P,D)=>Id(d.bufferedTilespaceGeometry,M,I,P,D));y.sort(c9);let v=null;f.elevation&&y.length>0&&(v=y1.create(f.elevation,this.tileID));const C={};let A;for(let M=0;M<y.length;M++){const I=y[M];if(I===A)continue;A=I;const P=this.featureIndexArray.get(I);let D=null;if(this.is3DTile){const V=this.bucketLayerIDs[0][0],N=i[V];if(N.type!=="model")continue;const{queryFeature:U,intersectionZ:X}=N.queryIntersectsMatchingFeature(d,P.featureIndex,c,f);U&&this.appendToResult(C,V,P.featureIndex,U,X)}else this.loadMatchingFeature(C,P,c,l.layers,l.availableImages,i,n,s,(V,N,U,X=0)=>(D||(D=Ln(V,this.tileID.canonical,e.tileTransform)),N.queryIntersectsFeature(d,V,U,D,this.z,e.transform,e.pixelPosMatrix,v,X)))}return C}loadMatchingFeature(e,i,n,s,l,c,d,f,_){const{featureIndex:y,bucketIndex:v,sourceLayerIndex:C,layoutVertexArrayOffset:A}=i,M=this.bucketLayerIDs[v];if(s&&!function(V,N){for(let U=0;U<V.length;U++)if(N.indexOf(V[U])>=0)return!0;return!1}(s,M))return;const I=this.sourceLayerCoder.decode(C),P=this.vtLayers[I].feature(y);if(n.needGeometry){const V=ks(P,!0);if(!n.filter(new dt(this.tileID.overscaledZ),V,this.tileID.canonical))return}else if(!n.filter(new dt(this.tileID.overscaledZ),P))return;const D=this.getId(P,I);for(let V=0;V<M.length;V++){const N=M[V];if(s&&s.indexOf(N)<0)continue;const U=c[N];if(!U)continue;let X={};D!==void 0&&f&&(X=f.getState(U.sourceLayer||"_geojsonTileLayer",D));const Y=!_||_(P,U,X,A);if(!Y)continue;const ee=new mf(P,this.z,this.x,this.y,D),le=ir({},d[N]);le.paint=gf(le.paint,U.paint,P,X,l),le.layout=gf(le.layout,U.layout,P,X,l),ee.layer=le,this.appendToResult(e,N,y,ee,Y)}}appendToResult(e,i,n,s,l){let c=e[i];c===void 0&&(c=e[i]=[]),c.push({featureIndex:n,feature:s,intersectionZ:l})}lookupSymbolFeatures(e,i,n,s,l,c,d,f){const _={};this.loadVTLayers();const y=zn(l);for(const v of e)this.loadMatchingFeature(_,{bucketIndex:n,sourceLayerIndex:s,featureIndex:v,layoutVertexArrayOffset:0},y,c,d,f,i);return _}loadFeature(e){const{featureIndex:i,sourceLayerIndex:n}=e;this.loadVTLayers();const s=this.sourceLayerCoder.decode(n),l=this.vtFeatures[s];if(l[i])return l[i];const c=this.vtLayers[s].feature(i);return l[i]=c,c}hasLayer(e){for(const i of this.bucketLayerIDs)for(const n of i)if(e===n)return!0;return!1}getId(e,i){let n=e.id;if(this.promoteId){const s=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];s!=null&&(n=e.properties[s]),typeof n=="boolean"&&(n=Number(n))}return n}}function gf(t,e,i,n,s){return oo(t,(l,c)=>{const d=e instanceof Ki?e.get(c):null;return d&&d.evaluate?d.evaluate(i,n,s):d})}function c9(t,e){return e-t}oe(_f,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var hr=24;const kn=128;function n0(t,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new dt(t+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:n,interpolationType:s}=i;let l=0;for(;l<n.length&&n[l]<=t;)l++;l=Math.max(0,l-1);let c=l;for(;c<n.length&&n[c]<t+1;)c++;c=Math.min(n.length-1,c);const d=n[l],f=n[c];return i.kind==="composite"?{kind:"composite",minZoom:d,maxZoom:f,interpolationType:s}:{kind:"camera",minZoom:d,maxZoom:f,minSize:i.evaluate(new dt(d)),maxSize:i.evaluate(new dt(f)),interpolationType:s}}}function Ju(t,{uSize:e,uSizeT:i},{lowerSize:n,upperSize:s}){return t.kind==="source"?n/kn:t.kind==="composite"?lt(n/kn,s/kn,i):e}function C1(t,e){let i=0,n=0;if(t.kind==="constant")n=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:s,minZoom:l,maxZoom:c}=t,d=s?Pt(kr.interpolationFactor(s,e,l,c),0,1):0;t.kind==="camera"?n=lt(t.minSize,t.maxSize,d):i=d}return{uSizeT:i,uSize:n}}var u9=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:kn,evaluateSizeForFeature:Ju,evaluateSizeForZoom:C1,getSizeData:n0});function h9(t,e,i){return t.sections.forEach(n=>{n.text=function(s,l,c){const d=l.layout.get("text-transform").evaluate(c,{});return d==="uppercase"?s=s.toLocaleUpperCase():d==="lowercase"&&(s=s.toLocaleLowerCase()),zt.applyArabicShaping&&(s=zt.applyArabicShaping(s)),s}(n.text,e,i)}),t}const Qc={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function d9(t){return t==="︶"||t==="﹈"||t==="︸"||t==="﹄"||t==="﹂"||t==="︾"||t==="︼"||t==="︺"||t==="︘"||t==="﹀"||t==="︐"||t==="︓"||t==="︔"||t==="｀"||t==="￣"||t==="︑"||t==="︒"}function p9(t){return t==="︵"||t==="﹇"||t==="︷"||t==="﹃"||t==="﹁"||t==="︽"||t==="︻"||t==="︹"||t==="︗"||t==="︿"}const s0=3;function f9(t,e,i){e.glyphs=[],t===1&&i.readMessage(m9,e)}function m9(t,e,i){if(t===3){const{id:n,bitmap:s,width:l,height:c,left:d,top:f,advance:_}=i.readMessage(_9,{});e.glyphs.push({id:n,bitmap:new Da({width:l+2*s0,height:c+2*s0},s),metrics:{width:l,height:c,left:d,top:f,advance:_}})}else t===4?e.ascender=i.readSVarint():t===5&&(e.descender=i.readSVarint())}function _9(t,e,i){t===1?e.id=i.readVarint():t===2?e.bitmap=i.readBytes():t===3?e.width=i.readVarint():t===4?e.height=i.readVarint():t===5?e.left=i.readSVarint():t===6?e.top=i.readSVarint():t===7&&(e.advance=i.readVarint())}const yf=s0,cn={horizontal:1,vertical:2,horizontalOnly:3};class e3{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const n=new e3;return n.scale=e||1,n.fontStack=i,n}static forImage(e){const i=new e3;return i.imageName=e,i}}class b1{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const n=new b1;for(let s=0;s<e.sections.length;s++){const l=e.sections[s];l.image?n.addImageSection(l):n.addTextSection(l,i)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(i,n){let s="";for(let l=0;l<i.length;l++){const c=i.charCodeAt(l+1)||null,d=i.charCodeAt(l-1)||null;s+=!n&&(c&&Je(c)&&!Qc[i[l+1]]||d&&Je(d)&&!Qc[i[l-1]])||!Qc[i[l]]?i[l]:Qc[i[l]]}return s}(this.text,e)}trim(){let e=0;for(let n=0;n<this.text.length&&Ku[this.text.charCodeAt(n)];n++)e++;let i=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&Ku[this.text.charCodeAt(n)];n--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const n=new b1;return n.text=this.text.substring(e,i),n.sectionIndex=this.sectionIndex.slice(e,i),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(e3.forText(e.scale,e.fontStack||i));const n=this.sections.length-1;for(let s=0;s<e.text.length;++s)this.sectionIndex.push(n)}addImageSection(e){const i=e.image?e.image.namePrimary:"";if(i.length===0)return void Di("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCodePoint(n),this.sections.push(e3.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Di("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function a0(t,e,i,n,s,l,c,d,f,_,y,v,C,A,M){const I=b1.fromFeature(t,s);v===cn.vertical&&I.verticalizePunctuation(C);let P=[];const D=function(Y,ee,le,pe,xe,fe){if(!Y)return[];const we=[],De=function(Ee,Fe,Te,Ve,Be,Re){let rt=0;for(let tt=0;tt<Ee.length();tt++){const He=Ee.getSection(tt);rt+=xf(Ee.getCodePoint(tt),He,Ve,Be,Fe,Re)}return rt/Math.max(1,Math.ceil(rt/Te))}(Y,ee,le,pe,xe,fe),Ae=Y.text.indexOf("​")>=0;let ke=0;for(let Ee=0;Ee<Y.length();Ee++){const Fe=Y.getSection(Ee),Te=Y.getCodePoint(Ee);if(Ku[Te]||(ke+=xf(Te,Fe,pe,xe,ee,fe)),Ee<Y.length()-1){const Ve=!((be=Te)<11904||!(se["Bopomofo Extended"](be)||se.Bopomofo(be)||se["CJK Compatibility Forms"](be)||se["CJK Compatibility Ideographs"](be)||se["CJK Compatibility"](be)||se["CJK Radicals Supplement"](be)||se["CJK Strokes"](be)||se["CJK Symbols and Punctuation"](be)||se["CJK Unified Ideographs Extension A"](be)||se["CJK Unified Ideographs"](be)||se["Enclosed CJK Letters and Months"](be)||se["Halfwidth and Fullwidth Forms"](be)||se.Hiragana(be)||se["Ideographic Description Characters"](be)||se["Kangxi Radicals"](be)||se["Katakana Phonetic Extensions"](be)||se.Katakana(be)||se["Vertical Forms"](be)||se["Yi Radicals"](be)||se["Yi Syllables"](be)));(g9[Te]||Ve||Fe.imageName)&&we.push(Cf(Ee+1,ke,De,we,y9(Te,Y.getCodePoint(Ee+1),Ve&&Ae),!1))}}var be;return bf(Cf(Y.length(),ke,De,we,0,!0))}(I,_,l,e,n,A),{processBidirectionalText:V,processStyledBidirectionalText:N}=zt;if(V&&I.sections.length===1){const Y=V(I.toString(),D);for(const ee of Y){const le=new b1;le.text=ee,le.sections=I.sections;for(let pe=0;pe<ee.length;pe++)le.sectionIndex.push(0);P.push(le)}}else if(N){const Y=N(I.text,I.sectionIndex,D);for(const ee of Y){const le=new b1;le.text=ee[0],le.sectionIndex=ee[1],le.sections=I.sections,P.push(le)}}else P=function(Y,ee){const le=[],pe=Y.text;let xe=0;for(const fe of ee)le.push(Y.substring(xe,fe)),xe=fe;return xe<pe.length&&le.push(Y.substring(xe,pe.length)),le}(I,D);const U=[],X={positionedLines:U,text:I.toString(),top:y[1],bottom:y[1],left:y[0],right:y[0],writingMode:v,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Y,ee,le,pe,xe,fe,we,De,Ae,ke,be,Ee){let Fe=0,Te=0,Ve=0;const Be=De==="right"?1:De==="left"?0:.5;let Re=!1;for(const it of xe){const Ke=it.getSections();for(const mt of Ke){if(mt.imageName)continue;const xt=ee[mt.fontStack];if(xt&&(Re=xt.ascender!==void 0&&xt.descender!==void 0,!Re))break}if(!Re)break}let rt=0;for(const it of xe){it.trim();const Ke=it.getMaxScale(),mt=(Ke-1)*hr,xt={positionedGlyphs:[],lineOffset:0};Y.positionedLines[rt]=xt;const _t=xt.positionedGlyphs;let Mt=0;if(!it.length()){Te+=fe,++rt;continue}let Ft=0,Rt=0;for(let ui=0;ui<it.length();ui++){const vt=it.getSection(ui),ti=it.getSectionIndex(ui),ii=it.getCodePoint(ui);let fi=vt.scale,Ei=null,Fi=null,Ii=null,Ti=hr,Xi=0;const Ui=!(Ae===cn.horizontal||!be&&!$e(ii)||be&&(Ku[ii]||(tt=ii,se.Arabic(tt)||se["Arabic Supplement"](tt)||se["Arabic Extended-A"](tt)||se["Arabic Presentation Forms-A"](tt)||se["Arabic Presentation Forms-B"](tt))));if(vt.imageName){const dr=pe[vt.imageName];if(!dr)continue;Ii=vt.imageName,Y.iconsInText=Y.iconsInText||!0,Fi=dr.paddedRect;const di=dr.displaySize;fi=fi*hr/Ee,Ei={width:di[0],height:di[1],left:0,top:-yf,advance:Ui?di[1]:di[0],localGlyph:!1},Xi=Re?-Ei.height*fi:Ke*hr-17-di[1]*fi,Ti=Ei.advance;const jr=(Ui?di[0]:di[1])*fi-hr*Ke;jr>0&&jr>Mt&&(Mt=jr)}else{const dr=le[vt.fontStack];if(!dr)continue;dr[ii]&&(Fi=dr[ii]);const di=ee[vt.fontStack];if(!di)continue;const jr=di.glyphs[ii];if(!jr)continue;if(Ei=jr.metrics,Ti=ii!==8203?hr:0,Re){const Un=di.ascender!==void 0?Math.abs(di.ascender):0,wn=di.descender!==void 0?Math.abs(di.descender):0,An=(Un+wn)*fi;Ft<An&&(Ft=An,Rt=(Un-wn)/2*fi),Xi=-Un*fi}else Xi=(Ke-fi)*hr-17}Ui?(Y.verticalizable=!0,_t.push({glyph:ii,imageName:Ii,x:Fe,y:Te+Xi,vertical:Ui,scale:fi,localGlyph:Ei.localGlyph,fontStack:vt.fontStack,sectionIndex:ti,metrics:Ei,rect:Fi}),Fe+=Ti*fi+ke):(_t.push({glyph:ii,imageName:Ii,x:Fe,y:Te+Xi,vertical:Ui,scale:fi,localGlyph:Ei.localGlyph,fontStack:vt.fontStack,sectionIndex:ti,metrics:Ei,rect:Fi}),Fe+=Ei.advance*fi+ke)}_t.length!==0&&(Ve=Math.max(Fe-ke,Ve),Re?wf(_t,Be,Mt,Rt,fe*Ke/2):wf(_t,Be,Mt,0,fe/2)),Fe=0;const oi=fe*Ke+Mt;xt.lineOffset=Math.max(Mt,mt),Te+=oi,++rt}var tt;const He=Te,{horizontalAlign:Ne,verticalAlign:ht}=o0(we);(function(it,Ke,mt,xt,_t,Mt){const Ft=(Ke-mt)*_t,Rt=-Mt*xt;for(const oi of it)for(const ui of oi.positionedGlyphs)ui.x+=Ft,ui.y+=Rt})(Y.positionedLines,Be,Ne,ht,Ve,He),Y.top+=-ht*He,Y.bottom=Y.top+He,Y.left+=-Ne*Ve,Y.right=Y.left+Ve,Y.hasBaseline=Re}(X,e,i,n,P,c,d,f,v,_,C,M),!function(Y){for(const ee of Y)if(ee.positionedGlyphs.length!==0)return!1;return!0}(U)&&X}const Ku={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},g9={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xf(t,e,i,n,s,l){if(e.imageName){const c=n[e.imageName];return c?c.displaySize[0]*e.scale*hr/l+s:0}{const c=i[e.fontStack],d=c&&c.glyphs[t];return d?d.metrics.advance*e.scale+s:0}}function vf(t,e,i,n){const s=Math.pow(t-e,2);return n?t<e?s/2:2*s:s+Math.abs(i)*i}function y9(t,e,i){let n=0;return t===10&&(n-=1e4),i&&(n+=150),t!==40&&t!==65288||(n+=50),e!==41&&e!==65289||(n+=50),n}function Cf(t,e,i,n,s,l){let c=null,d=vf(e,i,s,l);for(const f of n){const _=vf(e-f.x,i,s,l)+f.badness;_<=d&&(c=f,d=_)}return{index:t,x:e,priorBreak:c,badness:d}}function bf(t){return t?bf(t.priorBreak).concat(t.index):[]}function o0(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function wf(t,e,i,n,s){if(!(e||i||n||s))return;const l=t.length-1,c=t[l],d=(c.x+c.metrics.advance*c.scale)*e;for(let f=0;f<=l;f++)t[f].x-=d,t[f].y+=i+n+s}function x9(t,e,i,n){const{horizontalAlign:s,verticalAlign:l}=o0(n),c=i[0]-t.displaySize[0]*s,d=i[1]-t.displaySize[1]*l;return{imagePrimary:t,imageSecondary:e,top:d,bottom:d+t.displaySize[1],left:c,right:c+t.displaySize[0]}}function Af(t,e,i,n,s,l){const c=t.imagePrimary;let d;if(c.content){const P=c.content,D=c.pixelRatio||1;d=[P[0]/D,P[1]/D,c.displaySize[0]-P[2]/D,c.displaySize[1]-P[3]/D]}const f=e.left*l,_=e.right*l;let y,v,C,A;i==="width"||i==="both"?(A=s[0]+f-n[3],v=s[0]+_+n[1]):(A=s[0]+(f+_-c.displaySize[0])/2,v=A+c.displaySize[0]);const M=e.top*l,I=e.bottom*l;return i==="height"||i==="both"?(y=s[1]+M-n[0],C=s[1]+I+n[2]):(y=s[1]+(M+I-c.displaySize[1])/2,C=y+c.displaySize[1]),{imagePrimary:c,imageSecondary:void 0,top:y,right:v,bottom:C,left:A,collisionPadding:d}}class Ns extends Ze{constructor(e,i,n,s,l){super(e,i),this.angle=s,this.z=n,l!==void 0&&(this.segment=l)}clone(){return new Ns(this.x,this.y,this.z,this.angle,this.segment)}}function Tf(t,e,i,n,s){if(e.segment===void 0)return!0;let l=e,c=e.segment+1,d=0;for(;d>-i/2;){if(c--,c<0)return!1;d-=t[c].dist(l),l=t[c]}d+=t[c].dist(t[c+1]),c++;const f=[];let _=0;for(;d<i/2;){const y=t[c],v=t[c+1];if(!v)return!1;let C=t[c-1].angleTo(y)-y.angleTo(v);for(C=Math.abs((C+3*Math.PI)%(2*Math.PI)-Math.PI),f.push({distance:d,angleDelta:C}),_+=C;d-f[0].distance>n;)_-=f.shift().angleDelta;if(_>s)return!1;c++,d+=y.dist(v)}return!0}function Mf(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function Sf(t,e,i){return t?.6*e*i:0}function Ef(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function v9(t,e,i,n,s,l){const c=Sf(i,s,l),d=Ef(i,n)*l;let f=0;const _=Mf(t)/2;for(let y=0;y<t.length-1;y++){const v=t[y],C=t[y+1],A=v.dist(C);if(f+A>_){const M=(_-f)/A,I=lt(v.x,C.x,M),P=lt(v.y,C.y,M),D=new Ns(I,P,0,C.angleTo(v),y);return!c||Tf(t,D,d,c,e)?D:void 0}f+=A}}function C9(t,e,i,n,s,l,c,d,f){const _=Sf(n,l,c),y=Ef(n,s),v=y*c,C=t[0].x===0||t[0].x===f||t[0].y===0||t[0].y===f;return e-v<e/4&&(e=v+e/4),If(t,C?e/2*d%e:(y/2+2*l)*c*d%e,e,_,i,v,C,!1,f)}function If(t,e,i,n,s,l,c,d,f){const _=l/2,y=Mf(t);let v=0,C=e-i,A=[];for(let M=0;M<t.length-1;M++){const I=t[M],P=t[M+1],D=I.dist(P),V=P.angleTo(I);for(;C+i<v+D;){C+=i;const N=(C-v)/D,U=lt(I.x,P.x,N),X=lt(I.y,P.y,N);if(U>=0&&U<f&&X>=0&&X<f&&C-_>=0&&C+_<=y){const Y=new Ns(U,X,0,V,M);n&&!Tf(t,Y,l,n,s)||A.push(Y)}}v+=D}return d||A.length||c||(A=If(t,v/2,i,n,s,l,c,!0,f)),A}function Pf(t,e,i,n,s){const l=[];for(let c=0;c<t.length;c++){const d=t[c];let f;for(let _=0;_<d.length-1;_++){let y=d[_],v=d[_+1];y.x<e&&v.x<e||(y.x<e?y=new Ze(e,y.y+(e-y.x)/(v.x-y.x)*(v.y-y.y))._round():v.x<e&&(v=new Ze(e,y.y+(e-y.x)/(v.x-y.x)*(v.y-y.y))._round()),y.y<i&&v.y<i||(y.y<i?y=new Ze(y.x+(i-y.y)/(v.y-y.y)*(v.x-y.x),i)._round():v.y<i&&(v=new Ze(y.x+(i-y.y)/(v.y-y.y)*(v.x-y.x),i)._round()),y.x>=n&&v.x>=n||(y.x>=n?y=new Ze(n,y.y+(n-y.x)/(v.x-y.x)*(v.y-y.y))._round():v.x>=n&&(v=new Ze(n,y.y+(n-y.x)/(v.x-y.x)*(v.y-y.y))._round()),y.y>=s&&v.y>=s||(y.y>=s?y=new Ze(y.x+(s-y.y)/(v.y-y.y)*(v.x-y.x),s)._round():v.y>=s&&(v=new Ze(y.x+(s-y.y)/(v.y-y.y)*(v.x-y.x),s)._round()),f&&y.equals(f[f.length-1])||(f=[y],l.push(f)),f.push(v)))))}}return l}function Of(t){let e=0,i=0;for(const c of t)e+=c.w*c.h,i=Math.max(i,c.w);t.sort((c,d)=>d.h-c.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let s=0,l=0;for(const c of t)for(let d=n.length-1;d>=0;d--){const f=n[d];if(!(c.w>f.w||c.h>f.h)){if(c.x=f.x,c.y=f.y,l=Math.max(l,c.y+c.h),s=Math.max(s,c.x+c.w),c.w===f.w&&c.h===f.h){const _=n.pop();d<n.length&&(n[d]=_)}else c.h===f.h?(f.x+=c.w,f.w-=c.w):c.w===f.w?(f.y+=c.h,f.h-=c.h):(n.push({x:f.x+c.w,y:f.y,w:f.w-c.w,h:c.h}),f.y+=c.h,f.h-=c.h);break}}return{w:s,h:l,fill:e/(s*l)||0}}oe(Ns,"Anchor");const Hr=1;class l0{constructor(e,{pixelRatio:i,version:n,stretchX:s,stretchY:l,content:c}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=s,this.stretchY=l,this.content=c,this.version=n}get tl(){return[this.paddedRect.x+Hr,this.paddedRect.y+Hr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Hr,this.paddedRect.y+this.paddedRect.h-Hr]}get displaySize(){return[(this.paddedRect.w-2*Hr)/this.pixelRatio,(this.paddedRect.h-2*Hr)/this.pixelRatio]}}class zf{constructor(e,i,n){const s={},l={};this.haveRenderCallbacks=[];const c=[];this.addImages(e,s,c),this.addImages(i,l,c);const{w:d,h:f}=Of(c),_=new ln({width:d||1,height:f||1});for(const y in e){const v=e[y],C=s[y].paddedRect;ln.copy(v.data,_,{x:0,y:0},{x:C.x+Hr,y:C.y+Hr},v.data,n,v.sdf)}for(const y in i){const v=i[y],C=l[y].paddedRect,A=C.x+Hr,M=C.y+Hr,I=v.data.width,P=v.data.height;ln.copy(v.data,_,{x:0,y:0},{x:A,y:M},v.data,n),ln.copy(v.data,_,{x:0,y:P-1},{x:A,y:M-1},{width:I,height:1},n),ln.copy(v.data,_,{x:0,y:0},{x:A,y:M+P},{width:I,height:1},n),ln.copy(v.data,_,{x:I-1,y:0},{x:A-1,y:M},{width:1,height:P},n),ln.copy(v.data,_,{x:0,y:0},{x:A+I,y:M},{width:1,height:P},n)}this.image=_,this.iconPositions=s,this.patternPositions=l}addImages(e,i,n){for(const s in e){const l=e[s],c={x:0,y:0,w:l.data.width+2*Hr,h:l.data.height+2*Hr};n.push(c),i[s]=new l0(c,l),l.hasRenderCallback&&this.haveRenderCallbacks.push(s)}}patchUpdatedImages(e,i,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s,n)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,n);for(const s in e.getUpdatedImages(n))this.patchUpdatedImage(this.iconPositions[s],e.getImage(s,n),i),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s,n),i)}patchUpdatedImage(e,i,n){if(!e||!i||e.version===i.version)return;e.version=i.version;const[s,l]=e.tl,c=!!Object.keys(this.patternPositions).length;n.update(i.data,{useMipmap:c},{x:s,y:l})}}oe(l0,"ImagePosition"),oe(zf,"ImageAtlas");const t3=1e20;function Df(t,e,i,n,s,l,c,d,f){for(let _=e;_<e+n;_++)Rf(t,i*l+_,l,s,c,d,f);for(let _=i;_<i+s;_++)Rf(t,_*l+e,1,n,c,d,f)}function Rf(t,e,i,n,s,l,c){l[0]=0,c[0]=-t3,c[1]=t3,s[0]=t[e];for(let d=1,f=0,_=0;d<n;d++){s[d]=t[e+d*i];const y=d*d;do{const v=l[f];_=(s[d]-s[v]+y-v*v)/(d-v)/2}while(_<=c[f]&&--f>-1);f++,l[f]=d,c[f]=_,c[f+1]=t3}for(let d=0,f=0;d<n;d++){for(;c[f+1]<d;)f++;const _=l[f],y=d-_;t[e+d*i]=s[_]+y*y}}const Bn=2,c0={none:0,ideographs:1,all:2};class w1{constructor(e,i,n){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=n,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,i){this.urls[i]=e}getGlyphs(e,i,n){const s=[],l=this.urls[i]||st.GLYPHS_URL;for(const c in e)for(const d of e[c])s.push({stack:c,id:d});so(s,({stack:c,id:d},f)=>{let _=this.entries[c];_||(_=this.entries[c]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let y=_.glyphs[d];if(y!==void 0)return void f(null,{stack:c,id:d,glyph:y});if(y=this._tinySDF(_,c,d),y)return _.glyphs[d]=y,void f(null,{stack:c,id:d,glyph:y});const v=Math.floor(d/256);if(256*v>65535)return void f(new Error("glyphs > 65535 not supported"));if(_.ranges[v])return void f(null,{stack:c,id:d,glyph:y});let C=_.requests[v];C||(C=_.requests[v]=[],w1.loadGlyphRange(c,v,l,this.requestManager,(A,M)=>{if(M){_.ascender=M.ascender,_.descender=M.descender;for(const I in M.glyphs)this._doesCharSupportLocalGlyph(+I)||(_.glyphs[+I]=M.glyphs[+I]);_.ranges[v]=!0}for(const I of C)I(A,M);delete _.requests[v]})),C.push((A,M)=>{A?f(A):M&&f(null,{stack:c,id:d,glyph:M.glyphs[d]||null})})},(c,d)=>{if(c)n(c);else if(d){const f={};for(const{stack:_,id:y,glyph:v}of d)f[_]===void 0&&(f[_]={}),f[_].glyphs===void 0&&(f[_].glyphs={}),f[_].glyphs[y]=v&&{id:v.id,bitmap:v.bitmap.clone(),metrics:v.metrics},f[_].ascender=this.entries[_].ascender,f[_].descender=this.entries[_].descender;n(null,f)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==c0.none&&(this.localGlyphMode===c0.all?!!this.localFontFamily:!!this.localFontFamily&&(se["CJK Unified Ideographs"](e)||se["Hangul Syllables"](e)||se.Hiragana(e)||se.Katakana(e)||se["CJK Symbols and Punctuation"](e)||se["CJK Unified Ideographs Extension A"](e)||se["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,i,n){const s=this.localFontFamily;if(!s||!this._doesCharSupportLocalGlyph(n))return;let l=e.tinySDF;if(!l){let I="400";/bold/i.test(i)?I="900":/medium/i.test(i)?I="500":/light/i.test(i)&&(I="200"),l=e.tinySDF=new w1.TinySDF({fontFamily:s,fontWeight:I,fontSize:24*Bn,buffer:3*Bn,radius:8*Bn}),l.fontWeight=I}if(this.localGlyphs[l.fontWeight][n])return this.localGlyphs[l.fontWeight][n];const c=String.fromCodePoint(n),{data:d,width:f,height:_,glyphWidth:y,glyphHeight:v,glyphLeft:C,glyphTop:A,glyphAdvance:M}=l.draw(c);return this.localGlyphs[l.fontWeight][n]={id:n,bitmap:new Da({width:f,height:_},d),metrics:{width:y/Bn,height:v/Bn,left:C/Bn,top:A/Bn-27,advance:M/Bn,localGlyph:!0}}}}w1.loadGlyphRange=function(t,e,i,n,s){const l=256*e,c=l+255,d=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",`${l}-${c}`),_o.Glyphs);vs(d,(f,_)=>{if(f)s(f);else if(_){const y={},v=function(C){return new Kc(C).readFields(f9,{})}(_);for(const C of v.glyphs)y[C.id]=C;s(null,{glyphs:y,ascender:v.ascender,descender:v.descender})}})},w1.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:n=.25,fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:c="normal"}={}){this.buffer=e,this.cutoff=n,this.radius=i;const d=this.size=t+4*e,f=this._createCanvas(d),_=this.ctx=f.getContext("2d",{willReadFrequently:!0});_.font=`${c} ${l} ${t}px ${s}`,_.textBaseline="alphabetic",_.textAlign="left",_.fillStyle="black",this.gridOuter=new Float64Array(d*d),this.gridInner=new Float64Array(d*d),this.f=new Float64Array(d),this.z=new Float64Array(d+1),this.v=new Uint16Array(d)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:n,actualBoundingBoxLeft:s,actualBoundingBoxRight:l}=this.ctx.measureText(t),c=Math.ceil(i),d=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-s))),f=Math.min(this.size-this.buffer,c+Math.ceil(n)),_=d+2*this.buffer,y=f+2*this.buffer,v=Math.max(_*y,0),C=new Uint8ClampedArray(v),A={data:C,width:_,height:y,glyphWidth:d,glyphHeight:f,glyphTop:c,glyphLeft:0,glyphAdvance:e};if(d===0||f===0)return A;const{ctx:M,buffer:I,gridInner:P,gridOuter:D}=this;M.clearRect(I,I,d,f),M.fillText(t,I,I+c);const V=M.getImageData(I,I,d,f);D.fill(t3,0,v),P.fill(0,0,v);for(let N=0;N<f;N++)for(let U=0;U<d;U++){const X=V.data[4*(N*d+U)+3]/255;if(X===0)continue;const Y=(N+I)*_+U+I;if(X===1)D[Y]=0,P[Y]=t3;else{const ee=.5-X;D[Y]=ee>0?ee*ee:0,P[Y]=ee<0?ee*ee:0}}Df(D,0,0,_,y,_,this.f,this.v,this.z),Df(P,I,I,d,f,_,this.f,this.v,this.z);for(let N=0;N<v;N++){const U=Math.sqrt(D[N])-Math.sqrt(P[N]);C[N]=Math.round(255-255*(U/this.radius+this.cutoff))}return A}};const ka=Hr;function Lf(t,e,i,n){const s=[],l=t.imagePrimary,c=l.pixelRatio,d=l.paddedRect.w-2*ka,f=l.paddedRect.h-2*ka,_=t.right-t.left,y=t.bottom-t.top,v=l.stretchX||[[0,d]],C=l.stretchY||[[0,f]],A=(fe,we)=>fe+we[1]-we[0],M=v.reduce(A,0),I=C.reduce(A,0),P=d-M,D=f-I;let V=0,N=M,U=0,X=I,Y=0,ee=P,le=0,pe=D;if(l.content&&n){const fe=l.content;V=Qu(v,0,fe[0]),U=Qu(C,0,fe[1]),N=Qu(v,fe[0],fe[2]),X=Qu(C,fe[1],fe[3]),Y=fe[0]-V,le=fe[1]-U,ee=fe[2]-fe[0]-N,pe=fe[3]-fe[1]-X}const xe=(fe,we,De,Ae)=>{const ke=eh(fe.stretch-V,N,_,t.left),be=th(fe.fixed-Y,ee,fe.stretch,M),Ee=eh(we.stretch-U,X,y,t.top),Fe=th(we.fixed-le,pe,we.stretch,I),Te=eh(De.stretch-V,N,_,t.left),Ve=th(De.fixed-Y,ee,De.stretch,M),Be=eh(Ae.stretch-U,X,y,t.top),Re=th(Ae.fixed-le,pe,Ae.stretch,I),rt=new Ze(ke,Ee),tt=new Ze(Te,Ee),He=new Ze(Te,Be),Ne=new Ze(ke,Be),ht=new Ze(be/c,Fe/c),it=new Ze(Ve/c,Re/c),Ke=e*Math.PI/180;if(Ke){const Rt=Math.sin(Ke),oi=Math.cos(Ke),ui=[oi,-Rt,Rt,oi];rt._matMult(ui),tt._matMult(ui),Ne._matMult(ui),He._matMult(ui)}const mt=fe.stretch+fe.fixed,xt=De.stretch+De.fixed,_t=we.stretch+we.fixed,Mt=Ae.stretch+Ae.fixed,Ft=t.imageSecondary;return{tl:rt,tr:tt,bl:Ne,br:He,texPrimary:{x:l.paddedRect.x+ka+mt,y:l.paddedRect.y+ka+_t,w:xt-mt,h:Mt-_t},texSecondary:Ft?{x:Ft.paddedRect.x+ka+mt,y:Ft.paddedRect.y+ka+_t,w:xt-mt,h:Mt-_t}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ht,pixelOffsetBR:it,minFontScaleX:ee/c/_,minFontScaleY:pe/c/y,isSDF:i}};if(n&&(l.stretchX||l.stretchY)){const fe=kf(v,P,M),we=kf(C,D,I);for(let De=0;De<fe.length-1;De++){const Ae=fe[De],ke=fe[De+1];for(let be=0;be<we.length-1;be++)s.push(xe(Ae,we[be],ke,we[be+1]))}}else s.push(xe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:d+1},{fixed:0,stretch:f+1}));return s}function Qu(t,e,i){let n=0;for(const s of t)n+=Math.max(e,Math.min(i,s[1]))-Math.max(e,Math.min(i,s[0]));return n}function kf(t,e,i){const n=[{fixed:-ka,stretch:0}];for(const[s,l]of t){const c=n[n.length-1];n.push({fixed:s-c.stretch,stretch:c.stretch}),n.push({fixed:s-c.stretch,stretch:c.stretch+(l-s)})}return n.push({fixed:e+ka,stretch:i}),n}function eh(t,e,i,n){return t/e*i+n}function th(t,e,i,n){return t-e*i/n}function b9(t,e,i,n){const s=e+t.positionedLines[n].lineOffset;return n===0?i+s/2:i+(s+(e+t.positionedLines[n-1].lineOffset))/2}function w9(t,e=1,i=!1){let n=1/0,s=1/0,l=-1/0,c=-1/0;const d=t[0];for(let A=0;A<d.length;A++){const M=d[A];(!A||M.x<n)&&(n=M.x),(!A||M.y<s)&&(s=M.y),(!A||M.x>l)&&(l=M.x),(!A||M.y>c)&&(c=M.y)}const f=Math.min(l-n,c-s);let _=f/2;const y=new ts([],A9);if(f===0)return new Ze(n,s);for(let A=n;A<l;A+=f)for(let M=s;M<c;M+=f)y.push(new A1(A+_,M+_,_,t));let v=function(A){let M=0,I=0,P=0;const D=A[0];for(let V=0,N=D.length,U=N-1;V<N;U=V++){const X=D[V],Y=D[U],ee=X.x*Y.y-Y.x*X.y;I+=(X.x+Y.x)*ee,P+=(X.y+Y.y)*ee,M+=3*ee}return new A1(I/M,P/M,0,A)}(t),C=y.length;for(;y.length;){const A=y.pop();(A.d>v.d||!v.d)&&(v=A,i&&console.log("found best %d after %d probes",Math.round(1e4*A.d)/1e4,C)),A.max-v.d<=e||(_=A.h/2,y.push(new A1(A.p.x-_,A.p.y-_,_,t)),y.push(new A1(A.p.x+_,A.p.y-_,_,t)),y.push(new A1(A.p.x-_,A.p.y+_,_,t)),y.push(new A1(A.p.x+_,A.p.y+_,_,t)),C+=4)}return i&&(console.log(`num probes: ${C}`),console.log(`best distance: ${v.d}`)),v.p}function A9(t,e){return e.max-t.max}class A1{constructor(e,i,n,s){this.p=new Ze(e,i),this.h=n,this.d=function(l,c){let d=!1,f=1/0;for(let _=0;_<c.length;_++){const y=c[_];for(let v=0,C=y.length,A=C-1;v<C;A=v++){const M=y[v],I=y[A];M.y>l.y!=I.y>l.y&&l.x<(I.x-M.x)*(l.y-M.y)/(I.y-M.y)+M.x&&(d=!d),f=Math.min(f,Sd(l,M,I))}}return(d?1:-1)*Math.sqrt(f)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}}const u0=Number.POSITIVE_INFINITY,T9=Math.sqrt(2);function Bf(t,[e,i]){let n=0,s=0;if(i===u0){e<0&&(e=0);const l=e/T9;switch(t){case"top-right":case"top-left":s=l-7;break;case"bottom-right":case"bottom-left":s=7-l;break;case"bottom":s=7-e;break;case"top":s=e-7}switch(t){case"top-right":case"bottom-right":n=-l;break;case"top-left":case"bottom-left":n=l;break;case"left":n=e;break;case"right":n=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":s=i-7;break;case"bottom-right":case"bottom-left":case"bottom":s=7-i}switch(t){case"top-right":case"bottom-right":case"right":n=-e;break;case"top-left":case"bottom-left":case"left":n=e}}return[n,s]}function h0(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function M9(t,e,i,n,s,l,c,d,f,_,y,v,C,A,M){let I=l.textMaxSize.evaluate(e,{},v);I===void 0&&(I=c);const P=t.layers[0].layout,D=P.get("icon-offset").evaluate(e,{},v),V=jf(i.horizontal)||i.vertical,N=C.name==="globe",U=hr,X=c/U,Y=t.tilePixelRatio*I/U,ee=(ke=t.overscaling,t.zoom>18&&ke>2&&(ke>>=1),Math.max(je/(512*ke),1)*P.get("symbol-spacing")),le=P.get("text-padding")*t.tilePixelRatio,pe=P.get("icon-padding")*t.tilePixelRatio,xe=Lt(P.get("text-max-angle")),fe=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",we=P.get("icon-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",De=P.get("symbol-placement"),Ae=ee/2;var ke;const be=P.get("icon-text-fit").evaluate(e,{},v),Ee=P.get("icon-text-fit-padding").evaluate(e,{},v),Fe=be!=="none";let Te;t.hasAnyIconTextFit===!1&&Fe&&(t.hasAnyIconTextFit=!0),n&&Fe&&(t.allowVerticalPlacement&&i.vertical&&(Te=Af(n,i.vertical,be,Ee,D,X)),V&&(n=Af(n,V,be,Ee,D,X)));const Ve=(Be,Re,rt)=>{if(Re.x<0||Re.x>=je||Re.y<0||Re.y>=je)return;let tt=null;if(N){const{x:He,y:Ne,z:ht}=C.projectTilePoint(Re.x,Re.y,rt);tt={anchor:new Ns(He,Ne,ht,0,void 0),up:C.upVector(rt,Re.x,Re.y)}}(function(He,Ne,ht,it,Ke,mt,xt,_t,Mt,Ft,Rt,oi,ui,vt,ti,ii,fi,Ei,Fi,Ii,Ti,Xi,Ui,dr,di,jr,Un){const wn=He.addToLineVertexArray(Ne,it);let An,nl,Ua,sl,C3,t4,i4,r4=0,n4=0,s4=0,a4=0,N0=-1,V0=-1;const hs={};let o4=Ll("");const al=ht?ht.anchor:Ne,U0=Mt.layout.get("icon-text-fit").evaluate(Ti,{},di)!=="none";let Z0=0,$0=0;if(Mt._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Z0,$0]=Mt.layout.get("text-offset").evaluate(Ti,{},di).map(Yr=>Yr*hr):(Z0=Mt.layout.get("text-radial-offset").evaluate(Ti,{},di)*hr,$0=u0),He.allowVerticalPlacement&&Ke.vertical){const Yr=Ke.vertical;if(ti)t4=d0(Yr),_t&&(i4=d0(_t));else{const Jr=Mt.layout.get("text-rotate").evaluate(Ti,{},di)+90;Ua=ih(Ft,al,Ne,Rt,oi,ui,Yr,vt,Jr,ii),_t&&(sl=ih(Ft,al,Ne,Rt,oi,ui,_t,Ei,Jr))}}if(mt){const Yr=Mt.layout.get("icon-rotate").evaluate(Ti,{},di),Jr=Lf(mt,Yr,Ui,U0),D1=_t?Lf(_t,Yr,Ui,U0):void 0;nl=ih(Ft,al,Ne,Rt,oi,ui,mt,Ei,Yr),r4=4*Jr.length;const l4=He.iconSizeData;let ol=null;l4.kind==="source"?(ol=[kn*Mt.layout.get("icon-size").evaluate(Ti,{},di)],ol[0]>Ba&&Di(`${He.layerIds[0]}: Value for "icon-size" is >= ${i3}. Reduce your "icon-size".`)):l4.kind==="composite"&&(ol=[kn*Xi.compositeIconSizes[0].evaluate(Ti,{},di),kn*Xi.compositeIconSizes[1].evaluate(Ti,{},di)],(ol[0]>Ba||ol[1]>Ba)&&Di(`${He.layerIds[0]}: Value for "icon-size" is >= ${i3}. Reduce your "icon-size".`)),He.addSymbols(He.icon,Jr,ol,Ii,Fi,Ti,!1,ht,Ne,wn.lineStartIndex,wn.lineLength,-1,dr,di,jr,Un),N0=He.icon.placedSymbolArray.length-1,D1&&(n4=4*D1.length,He.addSymbols(He.icon,D1,ol,Ii,Fi,Ti,cn.vertical,ht,Ne,wn.lineStartIndex,wn.lineLength,-1,dr,di,jr,Un),V0=He.icon.placedSymbolArray.length-1)}for(const Yr in Ke.horizontal){const Jr=Ke.horizontal[Yr];An||(o4=Ll(Jr.text),ti?C3=d0(Jr):An=ih(Ft,al,Ne,Rt,oi,ui,Jr,vt,Mt.layout.get("text-rotate").evaluate(Ti,{},di),ii));const D1=Jr.positionedLines.length===1;if(s4+=Ff(He,ht,Ne,Jr,xt,Mt,ti,Ti,ii,wn,Ke.vertical?cn.horizontal:cn.horizontalOnly,D1?Object.keys(Ke.horizontal):[Yr],hs,N0,Xi,dr,di,jr),D1)break}Ke.vertical&&(a4+=Ff(He,ht,Ne,Ke.vertical,xt,Mt,ti,Ti,ii,wn,cn.vertical,["vertical"],hs,V0,Xi,dr,di,jr));let Za=-1;const G0=(Yr,Jr)=>Yr?Math.max(Yr,Jr):Jr;Za=G0(C3,Za),Za=G0(t4,Za),Za=G0(i4,Za);const N7=Za>-1?1:0;He.glyphOffsetArray.length>=65535&&Di("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ti.sortKey!==void 0&&He.addToSortKeyRanges(He.symbolInstances.length,Ti.sortKey),He.symbolInstances.emplaceBack(Ne.x,Ne.y,al.x,al.y,al.z,hs.right>=0?hs.right:-1,hs.center>=0?hs.center:-1,hs.left>=0?hs.left:-1,hs.vertical>=0?hs.vertical:-1,N0,V0,o4,An!==void 0?An:He.collisionBoxArray.length,An!==void 0?An+1:He.collisionBoxArray.length,Ua!==void 0?Ua:He.collisionBoxArray.length,Ua!==void 0?Ua+1:He.collisionBoxArray.length,nl!==void 0?nl:He.collisionBoxArray.length,nl!==void 0?nl+1:He.collisionBoxArray.length,sl||He.collisionBoxArray.length,sl?sl+1:He.collisionBoxArray.length,Rt,s4,a4,r4,n4,N7,0,Z0,$0,Za,0,U0?1:0)})(t,Re,tt,Be,i,n,s,Te,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,le,fe,f,0,pe,we,D,e,l,_,y,v,A,M)};if(De==="line")for(const Be of Pf(e.geometry,0,0,je,je)){const Re=C9(Be,ee,xe,i.vertical||V,n,U,Y,t.overscaling,je);for(const rt of Re)V&&S9(t,V.text,Ae,rt)||Ve(Be,rt,v)}else if(De==="line-center"){for(const Be of e.geometry)if(Be.length>1){const Re=v9(Be,xe,i.vertical||V,n,U,Y);Re&&Ve(Be,Re,v)}}else if(e.type==="Polygon")for(const Be of Fu(e.geometry,0)){const Re=w9(Be,16);Ve(Be[0],new Ns(Re.x,Re.y,0,0,void 0),v)}else if(e.type==="LineString")for(const Be of e.geometry)Ve(Be,new Ns(Be[0].x,Be[0].y,0,0,void 0),v);else if(e.type==="Point")for(const Be of e.geometry)for(const Re of Be)Ve([Re],new Ns(Re.x,Re.y,0,0,void 0),v)}const i3=255,Ba=i3*kn;function Ff(t,e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P,D){const V=function(X,Y,ee,le,pe,xe,fe,we){const De=[];if(Y.positionedLines.length===0)return De;const Ae=le.layout.get("text-rotate").evaluate(xe,{})*Math.PI/180,ke=function(Ve){const Be=Ve[0],Re=Ve[1],rt=Be*Re;return rt>0?[Be,-Re]:rt<0?[-Be,Re]:Be===0?[Re,Be]:[Re,-Be]}(ee);let be=Math.abs(Y.top-Y.bottom);for(const Ve of Y.positionedLines)be-=Ve.lineOffset;const Ee=Y.positionedLines.length,Fe=be/Ee;let Te=Y.top-ee[1];for(let Ve=0;Ve<Ee;++Ve){const Be=Y.positionedLines[Ve];Te=b9(Y,Fe,Te,Ve);for(const Re of Be.positionedGlyphs){if(!Re.rect)continue;const rt=Re.rect||{};let tt=yf+1,He=!0,Ne=1,ht=0;if(Re.imageName){const Ii=fe[Re.imageName];if(!Ii)continue;if(Ii.sdf){Di("SDF images are not supported in formatted text and will be ignored.");continue}He=!1,Ne=Ii.pixelRatio,tt=Hr/Ne}const it=(pe||we)&&Re.vertical,Ke=Re.metrics.advance*Re.scale/2,mt=Re.metrics,xt=Re.rect;if(xt===null)continue;we&&Y.verticalizable&&(ht=Re.imageName?Ke-Re.metrics.width*Re.scale/2:0);const _t=pe?[Re.x+Ke,Re.y]:[0,0];let Mt=[0,0],Ft=[0,0],Rt=!1;pe||(it?(Ft=[Re.x+Ke+ke[0],Re.y+ke[1]-ht],Rt=!0):Mt=[Re.x+Ke+ee[0],Re.y+ee[1]-ht]);const oi=xt.w*Re.scale/(Ne*(Re.localGlyph?Bn:1)),ui=xt.h*Re.scale/(Ne*(Re.localGlyph?Bn:1));let vt,ti,ii,fi;if(it){const Ii=Re.y-Te,Ti=new Ze(-Ke,Ke-Ii),Xi=-Math.PI/2,Ui=new Ze(...Ft);vt=new Ze(-Ke+Mt[0],Mt[1]),vt._rotateAround(Xi,Ti)._add(Ui),vt.x+=-Ii+Ke,vt.y-=(mt.left-tt)*Re.scale;const dr=Re.imageName?mt.advance*Re.scale:hr*Re.scale,di=String.fromCodePoint(Re.glyph);d9(di)?vt.x+=(1-tt)*Re.scale:p9(di)?vt.x+=dr-mt.height*Re.scale+(-tt-1)*Re.scale:vt.x+=Re.imageName||mt.width+2*tt===xt.w&&mt.height+2*tt===xt.h?(dr-ui)/2:(dr-(mt.height+2*tt)*Re.scale)/2,ti=new Ze(vt.x,vt.y-oi),ii=new Ze(vt.x+ui,vt.y),fi=new Ze(vt.x+ui,vt.y-oi)}else{const Ii=(mt.left-tt)*Re.scale-Ke+Mt[0],Ti=(-mt.top-tt)*Re.scale+Mt[1],Xi=Ii+oi,Ui=Ti+ui;vt=new Ze(Ii,Ti),ti=new Ze(Xi,Ti),ii=new Ze(Ii,Ui),fi=new Ze(Xi,Ui)}if(Ae){let Ii;Ii=pe?new Ze(0,0):Rt?new Ze(ke[0],ke[1]):new Ze(ee[0],ee[1]),vt._rotateAround(Ae,Ii),ti._rotateAround(Ae,Ii),ii._rotateAround(Ae,Ii),fi._rotateAround(Ae,Ii)}const Ei=new Ze(0,0),Fi=new Ze(0,0);De.push({tl:vt,tr:ti,bl:ii,br:fi,texPrimary:rt,texSecondary:void 0,writingMode:Y.writingMode,glyphOffset:_t,sectionIndex:Re.sectionIndex,isSDF:He,pixelOffsetTL:Ei,pixelOffsetBR:Fi,minFontScaleX:0,minFontScaleY:0})}}return De}(0,n,f,l,c,d,s,t.allowVerticalPlacement),N=t.textSizeData;let U=null;N.kind==="source"?(U=[kn*l.layout.get("text-size").evaluate(d,{},P)],U[0]>Ba&&Di(`${t.layerIds[0]}: Value for "text-size" is >= ${i3}. Reduce your "text-size".`)):N.kind==="composite"&&(U=[kn*M.compositeTextSizes[0].evaluate(d,{},P),kn*M.compositeTextSizes[1].evaluate(d,{},P)],(U[0]>Ba||U[1]>Ba)&&Di(`${t.layerIds[0]}: Value for "text-size" is >= ${i3}. Reduce your "text-size".`)),t.addSymbols(t.text,V,U,f,c,d,y,e,i,_.lineStartIndex,_.lineLength,A,I,P,D,!1);for(const X of v)C[X]=t.text.placedSymbolArray.length-1;return 4*V.length}function jf(t){for(const e in t)return t[e];return null}function ih(t,e,i,n,s,l,c,d,f,_){let y=c.top,v=c.bottom,C=c.left,A=c.right;const M=c.collisionPadding;if(M&&(C-=M[0],y-=M[1],A+=M[2],v+=M[3]),f){const I=new Ze(C,y),P=new Ze(A,y),D=new Ze(C,v),V=new Ze(A,v),N=Lt(f);let U=new Ze(0,0);_&&(U=new Ze(_[0],_[1])),I._rotateAround(N,U),P._rotateAround(N,U),D._rotateAround(N,U),V._rotateAround(N,U),C=Math.min(I.x,P.x,D.x,V.x),A=Math.max(I.x,P.x,D.x,V.x),y=Math.min(I.y,P.y,D.y,V.y),v=Math.max(I.y,P.y,D.y,V.y)}return t.emplaceBack(e.x,e.y,e.z,i.x,i.y,C,y,A,v,d,n,s,l),t.length-1}function d0(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function S9(t,e,i,n){const s=t.compareText;if(e in s){const l=s[e];for(let c=l.length-1;c>=0;c--)if(n.dist(l[c])<i)return!0}else s[e]=[];return s[e].push(n),!1}function Nf(t,e){const i=t.fovAboveCenter,n=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,s=(t._camera.position[2]*t.worldSize-n)/Math.cos(t._pitch),l=Math.sin(i)*s/Math.sin(Math.max(Math.PI/2-t._pitch-i,.01)),c=Math.sin(t._pitch)*l+s;return Math.min(1.01*c,s*(1/t._horizonShift))}function Ko(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const i=Math.pow(2,-t.z),n=t.x*i,s=(t.x+1)*i,l=t.y*i,c=(t.y+1)*i,d=Fr(n),f=Fr(s),_=Qi(l),y=Qi(c),v=e.project(d,_),C=e.project(f,_),A=e.project(f,y),M=e.project(d,y);let I=Math.min(v.x,C.x,A.x,M.x),P=Math.min(v.y,C.y,A.y,M.y),D=Math.max(v.x,C.x,A.x,M.x),V=Math.max(v.y,C.y,A.y,M.y);const N=i/16;function U(Y,ee,le,pe,xe,fe){const we=(le+xe)/2,De=(pe+fe)/2,Ae=e.project(Fr(we),Qi(De)),ke=Math.max(0,I-Ae.x,P-Ae.y,Ae.x-D,Ae.y-V);I=Math.min(I,Ae.x),D=Math.max(D,Ae.x),P=Math.min(P,Ae.y),V=Math.max(V,Ae.y),ke>N&&(U(Y,Ae,le,pe,we,De),U(Ae,ee,we,De,xe,fe))}U(v,C,n,l,s,l),U(C,A,s,l,s,c),U(A,M,s,c,n,c),U(M,v,n,c,n,l),I-=N,P-=N,D+=N,V+=N;const X=1/Math.max(D-I,V-P);return{scale:X,x:I*X,y:P*X,x2:D*X,y2:V*X,projection:e}}function Vf(t,{x:e,y:i},n=0){return new Ze(((e-n)*t.scale-t.x)*je,(i*t.scale-t.y)*je)}const E9=a.ae.identity(new Float32Array(16));class Fa{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Ht(0,0)}projectTilePoint(e,i,n){return{x:e,y:i,z:0}}locationPoint(e,i,n=!0){return e._coordinatePoint(e.locationCoordinate(i),n)}pixelsPerMeter(e,i){return Mr(1,e)*i}pixelSpaceConversion(e,i,n){return 1}farthestPixelDistance(e){return Nf(e,e.pixelsPerMeter)}pointCoordinate(e,i,n,s){const l=e.horizonLineFromTop(!1),c=new Ze(i,Math.max(l,n));return e.rayIntersectionCoordinate(e.pointRayIntersection(c,s))}pointCoordinate3D(e,i,n){const s=new Ze(i,n);if(e.elevation)return e.elevation.pointCoordinate(s);{const l=this.pointCoordinate(e,s.x,s.y,0);return[l.x,l.y,l.z]}}isPointAboveHorizon(e,i){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,i.x,i.y);const n=e.horizonLineFromTop();return i.y<n}createInversionMatrix(e,i){return E9}createTileMatrix(e,i,n){let s,l,c;const d=n.canonical,f=a.ae.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const _=Ko(d,this);s=1,l=_.x+n.wrap*_.scale,c=_.y,a.ae.scale(f,f,[s/_.scale,s/_.scale,e.pixelsPerMeter/i])}else s=i/e.zoomScale(d.z),l=(d.x+Math.pow(2,d.z)*n.wrap)*s,c=d.y*s;return a.ae.translate(f,f,[l,c,0]),a.ae.scale(f,f,[s/je,s/je,1]),f}upVector(e,i,n){return[0,0,1]}upVectorScale(e,i,n){return{metersToTile:1}}}class I9 extends Fa{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,n]=this.parallels=e.parallels||[29.5,45.5],s=Math.sin(Lt(i));this.n=(s+Math.sin(Lt(n)))/2,this.c=1+s*(2*this.n-s),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n,c:s,r0:l}=this,c=Lt(e-this.center[0]),d=Lt(i),f=Math.sqrt(s-2*n*Math.sin(d))/n;return{x:f*Math.sin(c*n),y:f*Math.cos(c*n)-l,z:0}}unproject(e,i){const{n,c:s,r0:l}=this,c=l+i;let d=Math.atan2(e,Math.abs(c))*Math.sign(c);c*n<0&&(d-=Math.PI*Math.sign(e)*Math.sign(c));const f=Lt(this.center[0])*n;d=aa(d,-Math.PI-f,Math.PI-f);const _=Pt(vr(d/n)+this.center[0],-180,180),y=Math.asin(Pt((s-(e*e+c*c)*n*n)/(2*n),-1,1)),v=Pt(vr(y),-ki,ki);return new Ht(_,v)}}const r3=1.340264,n3=-.081106,s3=893e-6,a3=.003796,rh=Math.sqrt(3)/2;class P9 extends Fa{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const n=Math.asin(rh*Math.sin(i)),s=n*n,l=s*s*s;return{x:.5*(e*Math.cos(n)/(rh*(r3+3*n3*s+l*(7*s3+9*a3*s)))/Math.PI+.5),y:1-.5*(n*(r3+n3*s+l*(s3+a3*s))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let n=i=(2*(1-i)-1)*Math.PI,s=n*n,l=s*s*s;for(let y,v,C,A=0;A<12&&(v=n*(r3+n3*s+l*(s3+a3*s))-i,C=r3+3*n3*s+l*(7*s3+9*a3*s),y=v/C,n=Pt(n-y,-Math.PI/3,Math.PI/3),s=n*n,l=s*s*s,!(Math.abs(y)<1e-12));++A);const c=rh*e*(r3+3*n3*s+l*(7*s3+9*a3*s))/Math.cos(n),d=Math.asin(Math.sin(n)/rh),f=Pt(180*c/Math.PI,-180,180),_=Pt(180*d/Math.PI,-ki,ki);return new Ht(f,_)}}class O9 extends Fa{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const n=360*(e-.5),s=Pt(360*(.5-i),-ki,ki);return new Ht(n,s)}}const T1=Math.PI/2;function nh(t){return Math.tan((T1+t)/2)}class z9 extends Fa{constructor(e){super(e),this.center=e.center||[0,30];const[i,n]=this.parallels=e.parallels||[30,30];let s=Lt(i),l=Lt(n);this.southernCenter=s+l<0,this.southernCenter&&(s=-s,l=-l);const c=Math.cos(s),d=nh(s);this.n=s===l?Math.sin(s):Math.log(c/Math.cos(l))/Math.log(nh(l)/d),this.f=c*Math.pow(nh(s),this.n)/this.n}project(e,i){i=Lt(i),this.southernCenter&&(i=-i),e=Lt(e-this.center[0]);const n=1e-6,{n:s,f:l}=this;l>0?i<-T1+n&&(i=-T1+n):i>T1-n&&(i=T1-n);const c=l/Math.pow(nh(i),s);let d=c*Math.sin(s*e),f=l-c*Math.cos(s*e);return d=.5*(d/Math.PI+.5),f=.5*(f/Math.PI+.5),{x:d,y:this.southernCenter?f:1-f,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n,f:s}=this,l=s-i,c=Math.sign(l),d=Math.sign(n)*Math.sqrt(e*e+l*l);let f=Math.atan2(e,Math.abs(l))*c;l*n<0&&(f-=Math.PI*Math.sign(e)*c);const _=Pt(vr(f/n)+this.center[0],-180,180),y=Pt(vr(2*Math.atan(Math.pow(s/d,1/n))-T1),-ki,ki);return new Ht(_,this.southernCenter?-y:y)}}class Uf extends Fa{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:ss(e),y:as(i),z:0}}unproject(e,i){const n=Fr(e),s=Qi(i);return new Ht(n,s)}}const Zf=Lt(ki);class D9 extends Fa{project(e,i){const n=(i=Lt(i))*i,s=n*n;return{x:.5*((e=Lt(e))*(.8707-.131979*n+s*(s*(.003971*n-.001529*s)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+n*(.015085+s*(.028874*n-.044475-.005916*s)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let n=i=(2*(1-i)-1)*Math.PI,s=25,l=0,c=n*n;do{c=n*n;const _=c*c;l=(n*(1.007226+c*(.015085+_*(.028874*c-.044475-.005916*_)))-i)/(1.007226+c*(.045255+_*(.259866*c-.311325-.005916*11*_))),n=Pt(n-l,-Zf,Zf)}while(Math.abs(l)>1e-6&&--s>0);c=n*n;const d=Pt(vr(e/(.8707+c*(c*(c*c*c*(.003971-.001529*c)-.013791)-.131979))),-180,180),f=vr(n);return new Ht(d,f)}}const $f=Lt(ki);class R9 extends Fa{project(e,i){i=Lt(i),e=Lt(e);const n=Math.cos(i),s=2/Math.PI,l=Math.acos(n*Math.cos(e/2)),c=Math.sin(l)/l,d=.5*(e*s+2*n*Math.sin(e/2)/c)||0,f=.5*(i+Math.sin(i)/c)||0;return{x:.5*(d/Math.PI+.5),y:1-.5*(f/Math.PI+1),z:0}}unproject(e,i){let n=e=(2*e-.5)*Math.PI,s=i=(2*(1-i)-1)*Math.PI,l=25;const c=1e-6;let d=0,f=0;do{const _=Math.cos(s),y=Math.sin(s),v=2*y*_,C=y*y,A=_*_,M=Math.cos(n/2),I=Math.sin(n/2),P=2*M*I,D=I*I,V=1-A*M*M,N=V?1/V:0,U=V?Math.acos(_*M)*Math.sqrt(1/V):0,X=.5*(2*U*_*I+2*n/Math.PI)-e,Y=.5*(U*y+s)-i,ee=.5*N*(A*D+U*_*M*C)+1/Math.PI,le=N*(P*v/4-U*y*I),pe=.125*N*(v*I-U*y*A*P),xe=.5*N*(C*M+U*D*_)+.5,fe=le*pe-xe*ee;d=(Y*le-X*xe)/fe,f=(X*pe-Y*ee)/fe,n=Pt(n-d,-Math.PI,Math.PI),s=Pt(s-f,-$f,$f)}while((Math.abs(d)>c||Math.abs(f)>c)&&--l>0);return new Ht(vr(n),vr(s))}}class Gf extends Fa{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Lt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:n,cosPhi:s}=this;return{x:Lt(e)*s*n+.5,y:-Math.sin(Lt(i))/s*n+.5,z:0}}unproject(e,i){const{scale:n,cosPhi:s}=this,l=-(i-.5)/n,c=Pt(vr((e-.5)/n)/s,-180,180),d=Math.asin(Pt(l*s,-1,1)),f=Pt(vr(d),-ki,ki);return new Ht(c,f)}}class L9 extends Uf{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,n){const s=Vc(e,i,n),l=Uc(os(n));return a.$.transformMat4(s,s,l),{x:s[0],y:s[1],z:s[2]}}locationPoint(e,i){const n=Wo(i.lat,i.lng),s=a.$.normalize([],n),l=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude,c=Mr(1,0)*je*l;a.$.scaleAndAdd(n,n,s,c);const d=a.ae.identity(new Float64Array(16));return a.ae.multiply(d,e.pixelMatrix,e.globeMatrix),a.$.transformMat4(n,n,d),new Ze(n[0],n[1])}pixelsPerMeter(e,i){return Mr(1,0)*i}pixelSpaceConversion(e,i,n){const s=Mr(1,e)*i,l=lt(Mr(1,45)*i,s,n);return this.pixelsPerMeter(e,i)/l}createTileMatrix(e,i,n){const s=$2(os(n.canonical));return a.ae.multiply(new Float64Array(16),e.globeMatrix,s)}createInversionMatrix(e,i){const{center:n}=e,s=Uc(os(i));return a.ae.rotateY(s,s,Lt(n.lng)),a.ae.rotateX(s,s,Lt(n.lat)),a.ae.scale(s,s,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(s)}pointCoordinate(e,i,n,s){return Fd(e,i,n,!0)||new yr(0,0)}pointCoordinate3D(e,i,n){const s=this.pointCoordinate(e,i,n,0);return[s.x,s.y,s.z]}isPointAboveHorizon(e,i){return!Fd(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(s,l){const c=s.cameraToCenterDistance,d=s._centerAltitude*l,f=s._camera,_=s._camera.forward(),y=a.$.add([],a.$.scale([],_,-c),[0,0,d]),v=s.worldSize/(2*Math.PI),C=[0,0,-v],A=s.width/s.height,M=Math.tan(s.fovAboveCenter),I=a.$.scale([],f.up(),M),P=a.$.scale([],f.right(),M*A),D=a.$.normalize([],a.$.add([],a.$.add([],_,I),P)),V=[];let N;if(new j2(y,D).closestPointOnSphere(C,v,V)){const U=a.$.add([],V,C),X=a.$.sub([],U,y);N=Math.cos(s.fovAboveCenter)*a.$.length(X)}else{const U=a.$.sub([],y,C),X=a.$.sub([],C,y);a.$.normalize(X,X);const Y=a.$.length(U)-v;N=Math.sqrt(Y*(Y+2*v));const ee=Math.acos(N/(v+Y))-Math.acos(a.$.dot(_,X));N*=Math.cos(ee)}return 1.01*N}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),n=Fs(e.zoom);if(n>0){const s=Nf(e,Mr(1,e.center.lat)*e.worldSize),l=e.worldSize/(2*Math.PI),c=Math.max(e.width,e.height)/e.worldSize*Math.PI;return lt(i,s+l*(1-Math.cos(c)),Math.pow(n,10))}return i}upVector(e,i,n){return Vc(i,n,e,1)}upVectorScale(e){return{metersToTile:zu(Ru(os(e)))}}}function qf(t){const e=t.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new Uf(t);case"equirectangular":return new O9(t);case"naturalEarth":return new D9(t);case"equalEarth":return new P9(t);case"winkelTripel":return new R9(t);case"albers":return i?new Gf(t):new I9(t);case"lambertConformalConic":return i?new Gf(t):new z9(t);case"globe":return new L9(t)}throw new Error(`Invalid projection name: ${t.name}`)}const k9=Vu.types,B9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sh(t,e,i,n,s,l,c,d,f,_,y,v,C){const A=d?Math.min(Ba,Math.round(d[0])):0,M=d?Math.min(Ba,Math.round(d[1])):0;t.emplaceBack(e,i,Math.round(32*n),Math.round(32*s),l,c,(A<<1)+(f?1:0),M,16*_,16*y,256*v,256*C)}function ah(t,e,i){t.emplaceBack(e,i)}function oh(t,e,i,n,s,l,c){t.emplaceBack(e,i,n,s,l,c)}function lh(t,e,i,n,s){t.emplaceBack(e,i,n,s),t.emplaceBack(e,i,n,s),t.emplaceBack(e,i,n,s),t.emplaceBack(e,i,n,s)}function F9(t){for(const e of t.sections)if(Ct(e.text))return!0;return!1}class p0{constructor(e){this.layoutVertexArray=new l2,this.indexArray=new Hi,this.programConfigurations=e,this.segments=new wi,this.dynamicLayoutVertexArray=new Ta,this.opacityVertexArray=new u2,this.placedSymbolArray=new nd,this.iconTransitioningVertexArray=new Ea,this.globeExtVertexArray=new c2,this.zOffsetVertexArray=new l1}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,i,n,s,l){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,V6.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Z6.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,B9,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,$6.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,U6.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||l)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,Jp.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||s)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}oe(p0,"SymbolBuffers");class f0{constructor(e,i,n){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new n,this.segments=new wi,this.collisionVertexArray=new p2,this.collisionVertexArrayExt=new Ta}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,G6.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,q6.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}oe(f0,"CollisionBuffers");class M1{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=a.ae.identity([]),this.placementViewportMatrix=a.ae.identity([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=n0(this.zoom,i["text-size"]),this.iconSizeData=n0(this.zoom,i["icon-size"]);const n=this.layers[0].layout,s=n.get("symbol-sort-key"),l=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey=l!=="viewport-y"&&s.constantOr(1)!==void 0,this.sortFeaturesByY=(l==="viewport-y"||l==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map(c=>cn[c]),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=n.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new p0(new Pa(this.layers,{zoom:this.zoom,lut:this.lut},e=>/^text/.test(e))),this.icon=new p0(new Pa(this.layers,{zoom:this.zoom,lut:this.lut},e=>/^icon/.test(e))),this.glyphOffsetArray=new od,this.lineVertexArray=new ld,this.symbolInstances=new ad}calculateGlyphDependencies(e,i,n,s,l){for(let c=0;c<e.length;c++){const d=e.codePointAt(c);if(d===void 0)break;if(i[d]=!0,s&&l&&d<=65535){const f=Qc[e.charAt(c)];f&&(i[f.charCodeAt(0)]=!0)}}}updateFootprints(e,i){}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=i.updateTime;const n=i.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!t0(this.activeReplacements,n)&&(this.activeReplacements=n,!0)}populate(e,i,n,s){const l=this.layers[0],c=l.layout,d=this.projection.name==="globe",f=c.get("text-font"),_=c.get("text-field"),y=c.get("icon-image"),v=(_.value.kind!=="constant"||_.value.value instanceof _r&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(f.value.kind!=="constant"||f.value.value.length>0),C=y.value.kind!=="constant"||!!y.value.value||Object.keys(y.parameters).length>0,A=c.get("symbol-sort-key");if(this.features=[],!v&&!C)return;const M=i.iconDependencies,I=i.glyphDependencies,P=i.availableImages,D=new dt(this.zoom);for(const{feature:V,id:N,index:U,sourceLayerIndex:X}of e){const Y=l._featureFilter.needGeometry,ee=ks(V,Y);if(!l._featureFilter.filter(D,ee,n))continue;if(Y||(ee.geometry=Ln(V,n,s)),d&&V.type!==1&&n.z<=5){const fe=ee.geometry,we=.98078528056,De=(Ae,ke)=>{const be=Vc(Ae.x,Ae.y,n,1),Ee=Vc(ke.x,ke.y,n,1);return a.$.dot(be,Ee)<we};for(let Ae=0;Ae<fe.length;Ae++)fe[Ae]=L4(fe[Ae],De)}let le,pe;if(v){const fe=l.getValueAndResolveTokens("text-field",ee,n,P),we=_r.factory(fe);F9(we)&&(this.hasRTLText=!0),(!this.hasRTLText||bt()==="unavailable"||this.hasRTLText&&zt.isParsed())&&(le=h9(we,l,ee))}if(C){const fe=l.getValueAndResolveTokens("icon-image",ee,n,P);pe=fe instanceof Pr?fe:Pr.fromString(fe)}if(!le&&!pe)continue;const xe=this.sortFeaturesByKey?A.evaluate(ee,{},n):void 0;if(this.features.push({id:N,text:le,icon:pe,index:U,sourceLayerIndex:X,geometry:ee.geometry,properties:V.properties,type:k9[V.type],sortKey:xe}),pe&&(M[pe.namePrimary]=!0,pe.nameSecondary&&(M[pe.nameSecondary]=!0)),le){const fe=f.evaluate(ee,{},n).join(","),we=c.get("text-rotation-alignment")==="map"&&c.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(cn.vertical)>=0;for(const De of le.sections)if(De.image)M[De.image.namePrimary]=!0;else{const Ae=Se(le.toString()),ke=De.fontStack||fe,be=I[ke]=I[ke]||{};this.calculateGlyphDependencies(De.text,be,we,this.allowVerticalPlacement,Ae)}}}c.get("symbol-placement")==="line"&&(this.features=function(V){const N={},U={},X=[];let Y=0;function ee(fe){X.push(V[fe]),Y++}function le(fe,we,De){const Ae=U[fe];return delete U[fe],U[we]=Ae,X[Ae].geometry[0].pop(),X[Ae].geometry[0]=X[Ae].geometry[0].concat(De[0]),Ae}function pe(fe,we,De){const Ae=N[we];return delete N[we],N[fe]=Ae,X[Ae].geometry[0].shift(),X[Ae].geometry[0]=De[0].concat(X[Ae].geometry[0]),Ae}function xe(fe,we,De){const Ae=De?we[0][we[0].length-1]:we[0][0];return`${fe}:${Ae.x}:${Ae.y}`}for(let fe=0;fe<V.length;fe++){const we=V[fe],De=we.geometry,Ae=we.text?we.text.toString():null;if(!Ae){ee(fe);continue}const ke=xe(Ae,De),be=xe(Ae,De,!0);if(ke in U&&be in N&&U[ke]!==N[be]){const Ee=pe(ke,be,De),Fe=le(ke,be,X[Ee].geometry);delete N[ke],delete U[be],U[xe(Ae,X[Fe].geometry,!0)]=Fe,X[Ee].geometry=null}else ke in U?le(ke,be,De):be in N?pe(ke,be,De):(ee(fe),N[ke]=Y-1,U[be]=Y-1)}return X.filter(fe=>fe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((V,N)=>V.sortKey-N.sortKey)}update(e,i,n,s,l){const c=Object.keys(e).length!==0;if(c&&!this.stateDependentLayers.length)return;const d=c?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,i,d,n,s,l),this.icon.programConfigurations.updatePaintArrays(e,i,d,n,s,l)}updateZOffset(){const e=(l,c,d)=>{n+=c,n>l.length&&l.resize(n);for(let f=-c;f<0;f++)l.emplace(f+n,d)},i=(l,c,d)=>{s+=c,s>l.length&&l.resize(s);for(let f=-c;f<0;f++)l.emplace(f+s,d)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let n=0,s=0;for(let l=0;l<this.symbolInstances.length;l++){const c=this.symbolInstances.get(l),{numHorizontalGlyphVertices:d,numVerticalGlyphVertices:f,numIconVertices:_}=c,y=c.zOffset,v=_>0;if((d>0||f>0)&&(e(this.text.zOffsetVertexArray,d,y),e(this.text.zOffsetVertexArray,f,y)),v){const{placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:A}=c;C>=0&&i(this.icon.zOffsetVertexArray,_,y),A>=0&&i(this.icon.zOffsetVertexArray,c.numVerticalIconVertices,y)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=qf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const n=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:s,y:l}of i)this.lineVertexArray.emplaceBack(s,l);return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,i,n,s,l,c,d,f,_,y,v,C,A,M,I,P){const D=e.indexArray,V=e.layoutVertexArray,N=e.globeExtVertexArray,U=e.segments.prepareSegment(4*i.length,V,D,this.canOverlap?c.sortKey:void 0),X=this.glyphOffsetArray.length,Y=U.vertexLength,ee=this.allowVerticalPlacement&&d===cn.vertical?Math.PI/2:0,le=c.text&&c.text.sections;for(let xe=0;xe<i.length;xe++){const{tl:fe,tr:we,bl:De,br:Ae,texPrimary:ke,texSecondary:be,pixelOffsetTL:Ee,pixelOffsetBR:Fe,minFontScaleX:Te,minFontScaleY:Ve,glyphOffset:Be,isSDF:Re,sectionIndex:rt}=i[xe],tt=U.vertexLength,He=Be[1];if(sh(V,_.x,_.y,fe.x,He+fe.y,ke.x,ke.y,n,Re,Ee.x,Ee.y,Te,Ve),sh(V,_.x,_.y,we.x,He+we.y,ke.x+ke.w,ke.y,n,Re,Fe.x,Ee.y,Te,Ve),sh(V,_.x,_.y,De.x,He+De.y,ke.x,ke.y+ke.h,n,Re,Ee.x,Fe.y,Te,Ve),sh(V,_.x,_.y,Ae.x,He+Ae.y,ke.x+ke.w,ke.y+ke.h,n,Re,Fe.x,Fe.y,Te,Ve),f){const{x:Ne,y:ht,z:it}=f.anchor,[Ke,mt,xt]=f.up;oh(N,Ne,ht,it,Ke,mt,xt),oh(N,Ne,ht,it,Ke,mt,xt),oh(N,Ne,ht,it,Ke,mt,xt),oh(N,Ne,ht,it,Ke,mt,xt),lh(e.dynamicLayoutVertexArray,Ne,ht,it,ee)}else lh(e.dynamicLayoutVertexArray,_.x,_.y,_.z,ee);if(P){const Ne=be||ke;ah(e.iconTransitioningVertexArray,Ne.x,Ne.y),ah(e.iconTransitioningVertexArray,Ne.x+Ne.w,Ne.y),ah(e.iconTransitioningVertexArray,Ne.x,Ne.y+Ne.h),ah(e.iconTransitioningVertexArray,Ne.x+Ne.w,Ne.y+Ne.h)}D.emplaceBack(tt,tt+1,tt+2),D.emplaceBack(tt+1,tt+2,tt+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Be[0]),xe!==i.length-1&&rt===i[xe+1].sectionIndex||e.programConfigurations.populatePaintArrays(V.length,c,c.index,{},A,M,I,le&&le[rt])}const pe=f?f.anchor:_;e.placedSymbolArray.emplaceBack(pe.x,pe.y,pe.z,_.x,_.y,X,this.glyphOffsetArray.length-X,Y,y,v,_.segment,n?n[0]:0,n?n[1]:0,s[0],s[1],d,0,!1,0,C,0)}_commitLayoutVertex(e,i,n,s,l,c,d){e.emplaceBack(i,n,s,l,c,Math.round(d.x),Math.round(d.y))}_addCollisionDebugVertices(e,i,n,s,l,c,d){const f=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),_=f.vertexLength,y=d.tileAnchorX,v=d.tileAnchorY;for(let A=0;A<4;A++)n.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(n.collisionVertexArrayExt,i,e.padding,d.zOffset),this._commitLayoutVertex(n.layoutVertexArray,s,l,c,y,v,new Ze(e.x1,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,s,l,c,y,v,new Ze(e.x2,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,s,l,c,y,v,new Ze(e.x2,e.y2)),this._commitLayoutVertex(n.layoutVertexArray,s,l,c,y,v,new Ze(e.x1,e.y2)),f.vertexLength+=4;const C=n.indexArray;C.emplaceBack(_,_+1),C.emplaceBack(_+1,_+2),C.emplaceBack(_+2,_+3),C.emplaceBack(_+3,_),f.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,n,s,l,c){for(let d=s;d<l;d++){const f=n.get(d),_=this.getSymbolInstanceTextSize(e,c,i,d);this._addCollisionDebugVertices(f,_,this.textCollisionBox,f.projectedAnchorX,f.projectedAnchorY,f.projectedAnchorZ,c)}}_addIconDebugCollisionBoxes(e,i,n,s,l,c){for(let d=s;d<l;d++){const f=n.get(d),_=this.getSymbolInstanceIconSize(e,i,c.placedIconSymbolIndex);this._addCollisionDebugVertices(f,_,this.iconCollisionBox,f.projectedAnchorX,f.projectedAnchorY,f.projectedAnchorZ,c)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new f0(wu,Kp.members,Ea),this.iconCollisionBox=new f0(wu,Kp.members,Ea);const n=C1(this.iconSizeData,e),s=C1(this.textSizeData,e);for(let l=0;l<this.symbolInstances.length;l++){const c=this.symbolInstances.get(l);this._addTextDebugCollisionBoxes(s,e,i,c.textBoxStartIndex,c.textBoxEndIndex,c),this._addTextDebugCollisionBoxes(s,e,i,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c),this._addIconDebugCollisionBoxes(n,e,i,c.iconBoxStartIndex,c.iconBoxEndIndex,c),this._addIconDebugCollisionBoxes(n,e,i,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c)}}getSymbolInstanceTextSize(e,i,n,s){const l=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:s),c=Ju(this.textSizeData,e,l)/hr;return this.tilePixelRatio*c}getSymbolInstanceIconSize(e,i,n){const s=this.icon.placedSymbolArray.get(n),l=Ju(this.iconSizeData,e,s);return this.tilePixelRatio*l}_commitDebugCollisionVertexUpdate(e,i,n,s){e.emplaceBack(i,-n,-n,s),e.emplaceBack(i,n,-n,s),e.emplaceBack(i,n,n,s),e.emplaceBack(i,-n,n,s)}_updateTextDebugCollisionBoxes(e,i,n,s,l,c){for(let d=s;d<l;d++){const f=n.get(d),_=this.getSymbolInstanceTextSize(e,c,i,d);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,_,f.padding,c.zOffset)}}_updateIconDebugCollisionBoxes(e,i,n,s,l,c){for(let d=s;d<l;d++){const f=n.get(d),_=this.getSymbolInstanceIconSize(e,i,c.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,_,f.padding,c.zOffset)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=C1(this.iconSizeData,e),s=C1(this.textSizeData,e);for(let l=0;l<this.symbolInstances.length;l++){const c=this.symbolInstances.get(l);this._updateTextDebugCollisionBoxes(s,e,i,c.textBoxStartIndex,c.textBoxEndIndex,c),this._updateTextDebugCollisionBoxes(s,e,i,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c),this._updateIconDebugCollisionBoxes(n,e,i,c.iconBoxStartIndex,c.iconBoxEndIndex,c),this._updateIconDebugCollisionBoxes(n,e,i,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,n,s,l,c,d,f,_){const y={};if(i<n){const{x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U,featureIndex:X}=e.get(i);y.textBox={x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U},y.textFeatureIndex=X}if(s<l){const{x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U,featureIndex:X}=e.get(s);y.verticalTextBox={x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U},y.verticalTextFeatureIndex=X}if(c<d){const{x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U,featureIndex:X}=e.get(c);y.iconBox={x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U},y.iconFeatureIndex=X}if(f<_){const{x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U,featureIndex:X}=e.get(f);y.verticalIconBox={x1:v,y1:C,x2:A,y2:M,padding:I,projectedAnchorX:P,projectedAnchorY:D,projectedAnchorZ:V,tileAnchorX:N,tileAnchorY:U},y.verticalIconFeatureIndex=X}return y}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const n=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,i){const n=e.placedSymbolArray.get(i),s=n.vertexStartIndex+4*n.numGlyphs;for(let l=n.vertexStartIndex;l<s;l+=4)e.indexArray.emplaceBack(l,l+1,l+2),e.indexArray.emplaceBack(l+1,l+2,l+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),n=Math.cos(e),s=[],l=[],c=[];for(let d=0;d<this.symbolInstances.length;++d){c.push(d);const f=this.symbolInstances.get(d);s.push(0|Math.round(i*f.tileAnchorX+n*f.tileAnchorY)),l.push(f.featureIndex)}return c.sort((d,f)=>s[d]-s[f]||l[f]-l[d]),c}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,i){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===i?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const n=this.symbolInstances.get(i);this.featureSortOrder.push(n.featureIndex);const{rightJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:l,leftJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:d,placedIconSymbolIndex:f,verticalPlacedIconSymbolIndex:_}=n;s>=0&&this.addIndicesForPlacedSymbol(this.text,s),l>=0&&l!==s&&this.addIndicesForPlacedSymbol(this.text,l),c>=0&&c!==l&&c!==s&&this.addIndicesForPlacedSymbol(this.text,c),d>=0&&this.addIndicesForPlacedSymbol(this.text,d),f>=0&&this.addIndicesForPlacedSymbol(this.icon,f),_>=0&&this.addIndicesForPlacedSymbol(this.icon,_)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}oe(M1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),M1.addDynamicAttributes=lh;class vn{constructor(e,i,n,s){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(i,s)}update(e,i,n){const{width:s,height:l}=e,{context:c}=this,{gl:d}=c;if(d.bindTexture(d.TEXTURE_2D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(this.format===d.RGBA&&(!i||i.premultiply!==!1)),this.useMipmap=!!(i&&i.useMipmap),n||this.size&&this.size[0]===s&&this.size[1]===l){const{x:f,y:_}=n||{x:0,y:0};if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap)d.texSubImage2D(d.TEXTURE_2D,0,f,_,d.RGBA,d.UNSIGNED_BYTE,e);else{let y=this.format,v=d.UNSIGNED_BYTE;this.format===d.R32F&&(y=d.RED,v=d.FLOAT),d.texSubImage2D(d.TEXTURE_2D,0,f,_,s,l,y,v,e.data)}}else if(this.size=[s,l],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap){let f=this.format;this.format===d.R8&&(f=d.RED),d.texImage2D(d.TEXTURE_2D,0,this.format,f,d.UNSIGNED_BYTE,e)}else{let f=this.format,_=this.format,y=d.UNSIGNED_BYTE,v=!1;this.format===d.DEPTH_COMPONENT&&(f=d.DEPTH_COMPONENT16,y=d.UNSIGNED_SHORT),this.format===d.DEPTH_STENCIL&&(f=d.DEPTH24_STENCIL8,y=d.UNSIGNED_INT_24_8,v=!0),this.format===d.R8&&(_=d.RED),this.format===d.R32F&&(y=d.FLOAT,_=d.RED),!this.useMipmap&&v?d.texStorage2D(d.TEXTURE_2D,1,f,s,l):d.texImage2D(d.TEXTURE_2D,0,f,s,l,0,_,y,e.data)}this.useMipmap&&d.generateMipmap(d.TEXTURE_2D)}bind(e,i,n=!1){const{context:s}=this,{gl:l}=s;l.bindTexture(l.TEXTURE_2D,this.texture),e!==this.minFilter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,this.useMipmap&&!n?e===l.NEAREST?l.NEAREST_MIPMAP_NEAREST:l.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),i!==this.wrapS&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(e,i,n,s){const{context:l}=this,{gl:c}=l;c.bindTexture(c.TEXTURE_2D,this.texture),i!==this.magFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,i),this.magFilter=i),e!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?e===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),n!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,n),this.wrapS=n),s!==this.wrapT&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,s),this.wrapT=s)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ch{constructor(e,i){this.context=e,this.texture=i}bind(e,i){const{context:n}=this,{gl:s}=n;s.bindTexture(s.TEXTURE_2D,this.texture),e!==this.minFilter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,e),this.minFilter=e),i!==this.wrapS&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,i),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,i),this.wrapS=i)}}const Cn=32,cs=33,ja=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,i=0,n=0,s=0,l=0,c=0,d=0;for(1&e?s=l=c=Cn:i=n=d=Cn;(e>>=1)>1;){const _=i+s>>1,y=n+l>>1;1&e?(s=i,l=n,i=c,n=d):(i=s,n=l,s=c,l=d),c=_,d=y}const f=4*t;ja[f+0]=i,ja[f+1]=n,ja[f+2]=s,ja[f+3]=l}const us=new Uint16Array(2178),Na=new Uint8Array(1089),uh=new Uint16Array(1089);function Wf(t){return t===0?-.03125:t===32?.03125:0}var hh=ei([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Qo{constructor(e,i,n,s){this.id=Qo.uniqueIdxCounter,Qo.uniqueIdxCounter++,this.context=e;const l=e.gl;this.buffer=l.createBuffer(),this.dynamicDraw=!!n,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||s||i.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){this.id=Qo.uniqueIdxCounter,Qo.uniqueIdxCounter++;const i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Qo.uniqueIdxCounter=0;class S1{constructor(e,i,n){this.func=e,this.mask=i,this.range=n}}S1.ReadOnly=!1,S1.ReadWrite=!0,S1.disabled=new S1(519,S1.ReadOnly,[0,1]);const m0=7680;class _0{constructor(e,i,n,s,l,c){this.test=e,this.ref=i,this.mask=n,this.fail=s,this.depthFail=l,this.pass=c}}_0.disabled=new _0({func:519,mask:0},0,0,m0,m0,m0);const o3=771;class Xr{constructor(e,i,n,s){this.blendFunction=e,this.blendColor=i,this.mask=n,this.blendEquation=s}}Xr.Replace=[1,0,1,0],Xr.disabled=new Xr(Xr.Replace,Yt.transparent,[!1,!1,!1,!1]),Xr.unblended=new Xr(Xr.Replace,Yt.transparent,[!0,!0,!0,!0]),Xr.alphaBlended=new Xr([1,o3,1,o3],Yt.transparent,[!0,!0,!0,!0]),Xr.alphaBlendedNonPremultiplied=new Xr([770,o3,770,o3],Yt.transparent,[!0,!0,!0,!0]),Xr.multiply=new Xr([774,0,774,0],Yt.transparent,[!0,!0,!0,!0]);const g0=1029,y0=2305;class Fn{constructor(e,i,n){this.enable=e,this.mode=i,this.frontFace=n}}Fn.disabled=new Fn(!1,g0,y0),Fn.backCCW=new Fn(!0,g0,y0),Fn.backCW=new Fn(!0,g0,2304),Fn.frontCW=new Fn(!0,1028,2304),Fn.frontCCW=new Fn(!0,1028,y0);var j9=ei([{name:"a_index",type:"Int16",components:1}]);const Hf={type:2,extent:je,loadGeometry:()=>[[new Ze(0,0),new Ze(je+1,0),new Ze(je+1,je+1),new Ze(0,je+1),new Ze(0,0)]]};class dh{constructor(e,i,n,s,l){this.tileID=e,this.uid=Tl(),this.uses=0,this.tileSize=i,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=l,s&&s.style&&(this._lastUpdatedBrightness=s.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",s&&s.transform&&(this.projection=s.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<sr.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Ko(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,n){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(s,l){const c={};if(!l)return c;for(const d of s){const f=d.layerIds.map(_=>l.getLayer(_)).filter(Boolean);if(f.length!==0){d.layers=f,d.stateDependentLayerIds&&(d.stateDependentLayers=d.stateDependentLayerIds.map(_=>f.filter(y=>y.id===_)[0]));for(const _ of f)c[_.fqid]=d}}return c}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const s in this.buckets){const l=this.buckets[s];if(l instanceof M1){if(this.hasSymbolBuckets=!0,!n)break;l.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const s in this.buckets){const l=this.buckets[s];if(l instanceof M1&&l.hasRTLText){this.hasRTLText=!0,zt.isLoading()||zt.isLoaded()||bt()!=="deferred"||$t();break}}this.queryPadding=0;for(const s in this.buckets){const l=this.buckets[s],c=i.style.getOwnLayer(s);if(!c)continue;const d=c.queryRadius(l);this.queryPadding=Math.max(this.queryPadding,d)}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas),this._lastUpdatedBrightness=e.brightness}else this.collisionBoxArray=new C2}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.fqid]}upload(e){for(const s in this.buckets){const l=this.buckets[s];l.uploadPending()&&l.upload(e)}const i=e.gl,n=this.imageAtlas;if(n&&!n.uploaded){const s=!!Object.keys(n.patternPositions).length;this.imageAtlasTexture=new vn(e,n.image,i.RGBA,{useMipmap:s}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new vn(e,this.glyphAtlasImage,i.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new vn(e,this.lineAtlas.image,i.R8),this.lineAtlas.uploaded=!0)}prepare(e,i,n){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,n),!i||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const s=i.style.getBrightness();(this._lastUpdatedBrightness||s)&&(this._lastUpdatedBrightness&&s&&Math.abs(this._lastUpdatedBrightness-s)<.001||(this._lastUpdatedBrightness=s,this.updateBuckets(void 0,i)))}queryRenderedFeatures(e,i,n,s,l,c,d,f){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:s,pixelPosMatrix:d,transform:c,params:l,tileTransform:this.tileTransform},e,i,n):{}}querySourceFeatures(e,i){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const s=n.loadVTLayers(),l=i?i.sourceLayer:"",c=s._geojsonTileLayer||s[l];if(!c)return;const d=zn(i&&i.filter),{z:f,x:_,y}=this.tileID.canonical,v={z:f,x:_,y};for(let C=0;C<c.length;C++){const A=c.feature(C);if(d.needGeometry){const P=ks(A,!0);if(!d.filter(new dt(this.tileID.overscaledZ),P,this.tileID.canonical))continue}else if(!d.filter(new dt(this.tileID.overscaledZ),A))continue;const M=n.getId(A,l),I=new mf(A,f,_,y,M);I.tile=v,e.push(I)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const n=lo(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const n=Date.now();let s=!1;if(this.expirationTime>n)s=!1;else if(i)if(this.expirationTime<i)s=!0;else{const l=this.expirationTime-i;l?this.expirationTime=n+Math.max(l,3e4):s=!0}else s=!0;s?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0&&i&&this.updateBuckets(e,i)}updateBuckets(e,i){if(!this.latestFeatureIndex)return;const n=this.latestFeatureIndex.loadVTLayers(),s=i.style.listImages(),l=i.style.getBrightness();for(const c in this.buckets){if(!i.style.hasLayer(c))continue;const d=this.buckets[c],f=d.layers[0].sourceLayer||"_geojsonTileLayer",_=n[f];let y={};if(e&&(y=e[f],!_||!y||Object.keys(y).length===0))continue;if(d.update(y,_,s,this.imageAtlas&&this.imageAtlas.patternPositions||{},l),d instanceof Hu||d instanceof ju){const C=i.style.getOwnSourceCache(d.layers[0].source);i._terrain&&i._terrain.enabled&&C&&d.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(C.id,this.tileID)}const v=i&&i.style&&i.style.getOwnLayer(c);v&&(this.queryPadding=Math.max(this.queryPadding,v.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<sr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=sr.now()+e}setTexture(e,i){const n=i.context,s=n.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture&&this.texture instanceof vn?this.texture.update(e,{useMipmap:!0}):(this.texture=new vn(n,e,s.RGBA,{useMipmap:!0}),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE))}setDependencies(e,i){const n={};for(const s of i)n[s]=!0;this.dependencies[e]=n}hasDependency(e,i){for(const n of e){const s=this.dependencies[n];if(s){for(const l of i)if(s[l])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const n=Ln(Hf,this.tileID.canonical,this.tileTransform)[0],s=new Dn,l=new Rc;for(let c=0;c<n.length;c++){const{x:d,y:f}=n[c];s.emplaceBack(d,f),l.emplaceBack(c)}l.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(l),this._tileDebugBuffer=e.createVertexBuffer(s,Nc.members),this._tileDebugSegments=wi.simpleSegment(0,0,s.length,l.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const n=Ln(Hf,this.tileID.canonical,this.tileTransform)[0];let s,l;if(this.isRaster){const c=function(d,f){const _=Ko(d,f),y=Math.pow(2,d.z);for(let P=0;P<cs;P++)for(let D=0;D<cs;D++){const V=Fr((d.x+(D+Wf(D))/Cn)/y),N=Qi((d.y+(P+Wf(P))/Cn)/y),U=f.project(V,N),X=P*cs+D;us[2*X+0]=Math.round((U.x*_.scale-_.x)*je),us[2*X+1]=Math.round((U.y*_.scale-_.y)*je)}Na.fill(0),uh.fill(0);for(let P=2045;P>=0;P--){const D=4*P,V=ja[D+0],N=ja[D+1],U=ja[D+2],X=ja[D+3],Y=V+U>>1,ee=N+X>>1,le=Y+ee-N,pe=ee+V-Y,xe=N*cs+V,fe=X*cs+U,we=ee*cs+Y,De=Math.hypot((us[2*xe+0]+us[2*fe+0])/2-us[2*we+0],(us[2*xe+1]+us[2*fe+1])/2-us[2*we+1])>=16;Na[we]=Na[we]||(De?1:0),P<1022&&(Na[we]=Na[we]||Na[(N+pe>>1)*cs+(V+le>>1)]||Na[(X+pe>>1)*cs+(U+le>>1)])}const v=new zs,C=new Hi;let A=0;function M(P,D){const V=D*cs+P;return uh[V]===0&&(v.emplaceBack(us[2*V+0],us[2*V+1],P*je/Cn,D*je/Cn),uh[V]=++A),uh[V]-1}function I(P,D,V,N,U,X){const Y=P+V>>1,ee=D+N>>1;if(Math.abs(P-U)+Math.abs(D-X)>1&&Na[ee*cs+Y])I(U,X,P,D,Y,ee),I(V,N,U,X,Y,ee);else{const le=M(P,D),pe=M(V,N),xe=M(U,X);C.emplaceBack(le,pe,xe)}}return I(0,0,Cn,Cn,Cn,0),I(Cn,Cn,0,0,0,Cn),{vertices:v,indices:C}}(this.tileID.canonical,i);s=c.vertices,l=c.indices}else{s=new zs,l=new Hi;for(const{x:d,y:f}of n)s.emplaceBack(d,f,0,0);const c=$c(s.int16,void 0,4);for(let d=0;d<c.length;d+=3)l.emplaceBack(c[d],c[d+1],c[d+2])}this._tileBoundsBuffer=e.createVertexBuffer(s,hh.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(l),this._tileBoundsSegments=wi.simpleSegment(0,0,s.length,l.length)}_makeGlobeTileDebugBuffers(e,i){const n=i.projection;if(!n||n.name!=="globe"||i.freezeTileCoverage)return;const s=this.tileID.canonical,l=Uc(jd(s,i)),c=Fs(i.zoom);let d;c>0&&(d=a.ae.invert(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,s,i,l,d,c),this._makeGlobeTileDebugTextBuffer(e,s,i,l,d,c)}_globePoint(e,i,n,s,l,c,d){let f=Vc(e,i,n);if(c){const _=1<<n.z,y=ss(s.center.lng),v=as(s.center.lat),C=(n.x+.5)/_-y;let A=0;C>.5?A=-1:C<-.5&&(A=1);let M=(e/je+n.x)/_+A,I=(i/je+n.y)/_;M=(M-y)*s._pixelsPerMercatorPixel+y,I=(I-v)*s._pixelsPerMercatorPixel+v;const P=[M*s.worldSize,I*s.worldSize,0];a.$.transformMat4(P,P,c),f=Bs(f,P,d)}return a.$.transformMat4(f,f,l)}_makeGlobeTileDebugBorderBuffer(e,i,n,s,l,c){const d=new Dn,f=new Rc,_=new vu,y=(C,A,M,I,P)=>{const D=(M-C)/(P-1),V=(I-A)/(P-1),N=d.length;for(let U=0;U<P;U++){const X=C+U*D,Y=A+U*V;d.emplaceBack(X,Y);const ee=this._globePoint(X,Y,i,n,s,l,c);_.emplaceBack(ee[0],ee[1],ee[2]),f.emplaceBack(N+U)}},v=je;y(0,0,v,0,16),y(v,0,v,v,16),y(v,v,0,v,16),y(0,v,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(d,Nc.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(_,Bd.members),this._tileDebugSegments=wi.simpleSegment(0,0,d.length,f.length)}_makeGlobeTileDebugTextBuffer(e,i,n,s,l,c){const d=je/4,f=new Dn,_=new Hi,y=new vu,v=25;_.reserve(32),f.reserve(v),y.reserve(v);const C=(A,M)=>v*A+M;for(let A=0;A<v;A++){const M=A*d;for(let I=0;I<v;I++){const P=I*d;f.emplaceBack(P,M);const D=this._globePoint(P,M,i,n,s,l,c);y.emplaceBack(D[0],D[1],D[2])}}for(let A=0;A<4;A++)for(let M=0;M<4;M++){const I=C(A,M),P=C(A,M+1),D=C(A+1,M),V=C(A+1,M+1);_.emplaceBack(I,P,D),_.emplaceBack(D,P,V)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(_),this._tileDebugTextBuffer=e.createVertexBuffer(f,Nc.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(y,Bd.members),this._tileDebugTextSegments=wi.simpleSegment(0,0,v,32)}destroy(e=!1){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!e&&this.texture&&this.texture instanceof vn&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}function N9(t,e,i){t===1?e.header_length=i.readFixed32():t===2?e.x=i.readVarint():t===3?e.y=i.readVarint():t===4?e.z=i.readVarint():t===5&&e.layers.push(function(n,s){return n.readFields(G9,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},s)}(i,i.readVarint()+i.pos))}function V9(t,e,i){t===1?(e.delta_filter=function(n,s){return n.readFields(U9,{block_size:0},s)}(i,i.readVarint()+i.pos),e.filter="delta_filter"):t===2?(i.readVarint(),e.filter="zigzag_filter"):t===3?(i.readVarint(),e.filter="bitshuffle_filter"):t===4&&(i.readVarint(),e.filter="byteshuffle_filter")}function U9(t,e,i){t===1&&(e.block_size=i.readVarint())}function Z9(t,e,i){t===1?(i.readVarint(),e.codec="gzip_data"):t===2?(i.readVarint(),e.codec="jpeg_image"):t===3?(i.readVarint(),e.codec="webp_image"):t===4&&(i.readVarint(),e.codec="png_image")}function $9(t,e,i){t===1?e.first_byte=i.readFixed64():t===2?e.last_byte=i.readFixed64():t===3?e.filters.push(function(n,s){return n.readFields(V9,{},s)}(i,i.readVarint()+i.pos)):t===4?e.codec=function(n,s){return n.readFields(Z9,{},s)}(i,i.readVarint()+i.pos):t===5?e.deprecated_offset=i.readFloat():t===6?e.deprecated_scale=i.readFloat():t===7?e.bands.push(i.readString()):t===8?e.offset=i.readDouble():t===9&&(e.scale=i.readDouble())}function G9(t,e,i){t===1?e.version=i.readVarint():t===2?e.name=i.readString():t===3?e.units=i.readString():t===4?e.tilesize=i.readVarint():t===5?e.buffer=i.readVarint():t===6?e.pixel_format=i.readVarint():t===7&&e.data_index.push(function(n,s){return n.readFields($9,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},s)}(i,i.readVarint()+i.pos))}function q9(t,e,i){if(t===2)(function(n,s,l){n.readFields(W9,l,s)})(i,i.readVarint()+i.pos,e);else if(t===3)throw new Error("Not implemented")}function W9(t,e,i){if(t===1){let n=0;const s=i.readVarint()+i.pos;for(;i.pos<s;)e[n++]=i.readVarint()}}class H9{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const i=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,i),i}put(e,i){this.cache.has(e)?this.cache.delete(e):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(e,i)}}function X9(t,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let i=e[3];for(let n=2;n>=1;n--){const s=n===1?1:0,l=n===2?1:0;for(let c=0;c<e[0];c++){const d=e[1]*c;for(let f=s;f<e[1];f++){const _=e[2]*(f+d);for(let y=l;y<e[2];y++){const v=e[3]*(y+_);for(let C=0;C<e[3];C++){const A=v+C;t[A]+=t[A-i]}}}}i*=e[n]}return t}function Y9(t){for(let e=0,i=t.length;e<i;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function J9(t,e){switch(e){case"uint32":return t;case"uint16":for(let i=0;i<t.length;i+=2){const n=t[i],s=t[i+1];t[i]=(240&n)>>4|(61440&n)>>8|(240&s)<<4|61440&s,t[i+1]=15&n|(3840&n)>>4|(15&s)<<8|(3840&s)<<4}return t;case"uint8":for(let i=0;i<t.length;i+=4){const n=t[i],s=t[i+1],l=t[i+2],c=t[i+3];t[i+0]=(192&n)>>6|(192&s)>>4|(192&l)>>2|192&c,t[i+1]=(48&n)>>4|(48&s)>>2|48&l|(48&c)<<2,t[i+2]=(12&n)>>2|12&s|(12&l)<<2|(12&c)<<4,t[i+3]=3&n|(3&s)<<2|(3&l)<<4|(3&c)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}var un=Uint8Array,l3=Uint16Array,K9=Int32Array,Xf=new un([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yf=new un([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Q9=new un([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Jf=function(t,e){for(var i=new l3(31),n=0;n<31;++n)i[n]=e+=1<<t[n-1];var s=new K9(i[30]);for(n=1;n<30;++n)for(var l=i[n];l<i[n+1];++l)s[l]=l-i[n]<<5|n;return{b:i,r:s}},Kf=Jf(Xf,2),Qf=Kf.b,e7=Kf.r;Qf[28]=258,e7[258]=28;for(var t7=Jf(Yf,0).b,e5=new l3(32768),Bi=0;Bi<32768;++Bi){var E1=(43690&Bi)>>1|(21845&Bi)<<1;e5[Bi]=((65280&(E1=(61680&(E1=(52428&E1)>>2|(13107&E1)<<2))>>4|(3855&E1)<<4))>>8|(255&E1)<<8)>>1}var c3=function(t,e,i){for(var n=t.length,s=0,l=new l3(e);s<n;++s)t[s]&&++l[t[s]-1];var c,d=new l3(e);for(s=1;s<e;++s)d[s]=d[s-1]+l[s-1]<<1;c=new l3(1<<e);var f=15-e;for(s=0;s<n;++s)if(t[s])for(var _=s<<4|t[s],y=e-t[s],v=d[t[s]-1]++<<y,C=v|(1<<y)-1;v<=C;++v)c[e5[v]>>f]=_;return c},u3=new un(288);for(Bi=0;Bi<144;++Bi)u3[Bi]=8;for(Bi=144;Bi<256;++Bi)u3[Bi]=9;for(Bi=256;Bi<280;++Bi)u3[Bi]=7;for(Bi=280;Bi<288;++Bi)u3[Bi]=8;var t5=new un(32);for(Bi=0;Bi<32;++Bi)t5[Bi]=5;var i7=c3(u3,9),r7=c3(t5,5),x0=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},jn=function(t,e,i){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&i},v0=function(t,e){var i=e/8|0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>(7&e)},n7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Nn=function(t,e,i){var n=new Error(e||n7[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Nn),!i)throw n;return n},s7=new un(0),a7=typeof TextDecoder<"u"&&new TextDecoder;try{a7.decode(s7,{stream:!0})}catch{}const o7={gzip_data:"gzip"};class bn extends Error{constructor(e){super(e),this.name="MRTError"}}const l7={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},i5={uint32:1,uint16:2,uint8:4},c7={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let C0,b0;class h3{constructor(e=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){const i=this.layers[e];if(!i)throw new bn(`Layer '${e}' not found`);return i}getHeaderLength(e){const i=new Uint8Array(e),n=new DataView(e);if(i[0]!==13)throw new bn("File is not a valid MRT.");return n.getUint32(1,!0)}parseHeader(e){const i=new Uint8Array(e),n=this.getHeaderLength(e);if(i.length<n)throw new bn(`Expected header with length >= ${n} but got buffer of length ${i.length}`);const s=function(l,c){return l.readFields(N9,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new C0(i.subarray(0,n)));if(!isNaN(this.x)&&(this.x!==s.x||this.y!==s.y||this.z!==s.z))throw new bn(`Invalid attempt to parse header ${s.z}/${s.x}/${s.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=s.x,this.y=s.y,this.z=s.z;for(const l of s.layers)this.layers[l.name]=new u7(l,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const i=[],n=this.getLayer(e.layerName);for(let s of e.blockIndices){const l=n.dataIndex[s],c=l.first_byte-e.firstByte,d=l.last_byte-e.firstByte;if(n._blocksInProgress.has(s))continue;const f={layerName:n.name,firstByte:c,lastByte:d,pixelFormat:n.pixelFormat,blockIndex:s,blockShape:[l.bands.length].concat(n.bandShape),buffer:n.buffer,codec:l.codec.codec,filters:l.filters.map(_=>_.filter)};n._blocksInProgress.add(s),i.push(f)}return new r5(i,()=>{i.forEach(s=>n._blocksInProgress.delete(s.blockIndex))},(s,l)=>{if(i.forEach(c=>n._blocksInProgress.delete(c.blockIndex)),s)throw s;l.forEach(c=>{this.getLayer(c.layerName).processDecodedData(c)})})}}class u7{constructor({version:e,name:i,units:n,tilesize:s,pixel_format:l,buffer:c,data_index:d},f){if(this.version=e,this.version!==1)throw new bn(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=i,this.units=n,this.tileSize=s,this.buffer=c,this.pixelFormat=l7[l],this.dataIndex=d,this.bandShape=[s+2*c,s+2*c,i5[this.pixelFormat]],this._decodedBlocks=new H9(f?f.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return i5[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:e})=>e).flat()}processDecodedData(e){const i=e.blockIndex.toString();this._decodedBlocks.get(i)||this._decodedBlocks.put(i,e.data)}getBlockForBand(e){let i=0;switch(typeof e){case"string":for(const[n,s]of this.dataIndex.entries()){for(const[l,c]of s.bands.entries())if(c===e)return{bandIndex:i+l,blockIndex:n,blockBandIndex:l};i+=s.bands.length}break;case"number":for(const[n,s]of this.dataIndex.entries()){if(e>=i&&e<i+s.bands.length)return{bandIndex:e,blockIndex:n,blockBandIndex:e-i};i+=s.bands.length}break;default:throw new bn(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new bn(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let i=1/0,n=-1/0;const s=[],l=new Set;for(const c of e){const{blockIndex:d}=this.getBlockForBand(c);if(d<0)throw new bn(`Invalid band: ${JSON.stringify(c)}`);const f=this.dataIndex[d];s.includes(d)||s.push(d),l.add(d),i=Math.min(i,f.first_byte),n=Math.max(n,f.last_byte)}if(l.size>this.cacheSize)throw new bn(`Number of blocks to decode (${l.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:i,lastByte:n,blockIndices:s}}hasBand(e){const{blockIndex:i}=this.getBlockForBand(e);return i>=0}hasDataForBand(e){const{blockIndex:i}=this.getBlockForBand(e);return i>=0&&!!this._decodedBlocks.get(i.toString())}getBandView(e){const{blockIndex:i,blockBandIndex:n}=this.getBlockForBand(e),s=this._decodedBlocks.get(i.toString());if(!s)throw new bn(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const l=this.dataIndex[i],c=this.bandShape.reduce((_,y)=>_*y,1),d=n*c,f=s.subarray(d,d+c);return{data:f,bytes:new Uint8Array(f.buffer).subarray(f.byteOffset,f.byteOffset+f.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:l.offset!==0?l.offset:l.deprecated_offset,scale:l.scale!==0?l.scale:l.deprecated_scale}}}h3.setPbf=function(t){C0=t};class r5{constructor(e,i,n){this.tasks=e,this._onCancel=i,this._onComplete=n,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,i){this._finalized||(this._onComplete(e,i),this._finalized=!0)}}h3.performDecoding=function(t,e){const i=new Uint8Array(t);return Promise.all(e.tasks.map(n=>{const{layerName:s,firstByte:l,lastByte:c,pixelFormat:d,blockShape:f,blockIndex:_,filters:y,codec:v}=n,C=i.subarray(l,c+1),A=new Uint32Array(f[0]*f[1]*f[2]);let M;if(v!=="gzip_data")throw new bn(`Unhandled codec: ${v}`);return M=function(I,P){if(!globalThis.DecompressionStream&&P==="gzip_data")return Promise.resolve(((U=function(ee){ee[0]==31&&ee[1]==139&&ee[2]==8||Nn(6,"invalid gzip data");var le=ee[3],pe=10;4&le&&(pe+=2+(ee[10]|ee[11]<<8));for(var xe=(le>>3&1)+(le>>4&1);xe>0;xe-=!ee[pe++]);return pe+(2&le)}(N=I))+8>N.length&&Nn(6,"invalid gzip data"),function(ee,le,pe,xe){var fe=ee.length;if(!fe||le.f&&!le.l)return pe||new un(0);var we=!pe,De=we||le.i!=2,Ae=le.i;we&&(pe=new un(3*fe));var ke,be,Ee=function(Ua){var sl=pe.length;if(Ua>sl){var C3=new un(Math.max(2*sl,Ua));C3.set(pe),pe=C3}},Fe=le.f||0,Te=le.p||0,Ve=le.b||0,Be=le.l,Re=le.d,rt=le.m,tt=le.n,He=8*fe;do{if(!Be){Fe=jn(ee,Te,1);var Ne=jn(ee,Te+1,3);if(Te+=3,!Ne){var ht=ee[(vt=4+((Te+7)/8|0))-4]|ee[vt-3]<<8,it=vt+ht;if(it>fe){Ae&&Nn(0);break}De&&Ee(Ve+ht),pe.set(ee.subarray(vt,it),Ve),le.b=Ve+=ht,le.p=Te=8*it,le.f=Fe;continue}if(Ne==1)Be=i7,Re=r7,rt=9,tt=5;else if(Ne==2){var Ke=jn(ee,Te,31)+257,mt=jn(ee,Te+10,15)+4,xt=Ke+jn(ee,Te+5,31)+1;Te+=14;for(var _t=new un(xt),Mt=new un(19),Ft=0;Ft<mt;++Ft)Mt[Q9[Ft]]=jn(ee,Te+3*Ft,7);Te+=3*mt;var Rt=x0(Mt),oi=(1<<Rt)-1,ui=c3(Mt,Rt);for(Ft=0;Ft<xt;){var vt,ti=ui[jn(ee,Te,oi)];if(Te+=15&ti,(vt=ti>>4)<16)_t[Ft++]=vt;else{var ii=0,fi=0;for(vt==16?(fi=3+jn(ee,Te,3),Te+=2,ii=_t[Ft-1]):vt==17?(fi=3+jn(ee,Te,7),Te+=3):vt==18&&(fi=11+jn(ee,Te,127),Te+=7);fi--;)_t[Ft++]=ii}}var Ei=_t.subarray(0,Ke),Fi=_t.subarray(Ke);rt=x0(Ei),tt=x0(Fi),Be=c3(Ei,rt),Re=c3(Fi,tt)}else Nn(1);if(Te>He){Ae&&Nn(0);break}}De&&Ee(Ve+131072);for(var Ii=(1<<rt)-1,Ti=(1<<tt)-1,Xi=Te;;Xi=Te){var Ui=(ii=Be[v0(ee,Te)&Ii])>>4;if((Te+=15&ii)>He){Ae&&Nn(0);break}if(ii||Nn(2),Ui<256)pe[Ve++]=Ui;else{if(Ui==256){Xi=Te,Be=null;break}var dr=Ui-254;Ui>264&&(dr=jn(ee,Te,(1<<(Un=Xf[Ft=Ui-257]))-1)+Qf[Ft],Te+=Un);var di=Re[v0(ee,Te)&Ti],jr=di>>4;if(di||Nn(3),Te+=15&di,Fi=t7[jr],jr>3){var Un=Yf[jr];Fi+=v0(ee,Te)&(1<<Un)-1,Te+=Un}if(Te>He){Ae&&Nn(0);break}De&&Ee(Ve+131072);var wn=Ve+dr;if(Ve<Fi){var An=0-Fi,nl=Math.min(Fi,wn);for(An+Ve<0&&Nn(3);Ve<nl;++Ve)pe[Ve]=(void 0)[An+Ve]}for(;Ve<wn;++Ve)pe[Ve]=pe[Ve-Fi]}}le.l=Be,le.p=Xi,le.b=Ve,le.f=Fe,Be&&(Fe=1,le.m=rt,le.d=Re,le.n=tt)}while(!Fe);return Ve!=pe.length&&we?(ke=pe,((be=Ve)==null||be>ke.length)&&(be=ke.length),new un(ke.subarray(0,be))):pe.subarray(0,Ve)}(N.subarray(U,-8),{i:2},new un(((D=N)[(V=D.length)-4]|D[V-3]<<8|D[V-2]<<16|D[V-1]<<24)>>>0))));var D,V,N,U;const X=o7[P];if(!X)throw new Error(`Unhandled codec: ${P}`);const Y=new globalThis.DecompressionStream(X);return new Response(new Blob([I]).stream().pipeThrough(Y)).arrayBuffer().then(ee=>new Uint8Array(ee))}(C,v).then(I=>(function(P,D){P.readFields(q9,D)}(new C0(I),A),new c7[d](A.buffer))),M.then(I=>{for(let P=y.length-1;P>=0;P--)switch(y[P]){case"delta_filter":X9(I,f);break;case"zigzag_filter":Y9(I);break;case"bitshuffle_filter":J9(I,d);break;default:throw new bn(`Unhandled filter "${y[P]}"`)}return{layerName:s,blockIndex:_,data:I}}).catch(I=>{throw I})}))},h3.setPbf(Kc);class n5 extends dh{constructor(e,i,n,s,l){super(e,i,n,s,l),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(e,i){const n=i.context,s=n.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture&&this.texture instanceof vn?this.texture.update(e,{useMipmap:!1,premultiply:!1}):this.texture=new vn(n,e,s.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(e=16384,i){const n=this._mrt=new h3(30),s=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(e-1)}});return this.entireBuffer=null,this.request=vs(s,(l,c,d,f)=>{if(l)i(l);else try{const _=n.getHeaderLength(c);if(_>e)return void(this.request=this.fetchHeader(_,i));n.parseHeader(c),this._isHeaderLoaded=!0;let y=0;for(const v of Object.values(n.layers))y=Math.max(y,v.dataIndex[v.dataIndex.length-1].last_byte);c.byteLength>=y&&(this.entireBuffer=c),i(null,this.entireBuffer||c,d,f)}catch(_){i(_)}}),this.request}fetchBand(e,i,n){const s=this._mrt;if(!this._isHeaderLoaded||!s)return void n(new Error("Tile header is not ready"));const l=this.actor;if(!l)return void n(new Error("Can't fetch tile band without an actor"));let c;const d=(v,C)=>{c.complete(v,C),v?n(v):(this.updateTextureDescriptor(e,i),n(null,this.textureDescriptor&&this.textureDescriptor.img))},f=(v,C)=>{if(v)return n(v);const A=l.send("decodeRasterArray",{buffer:C,task:c},d,void 0,!0);this._workQueue.push(()=>{A&&A.cancel(),c.cancel()})},_=s.getLayer(e);if(!_)return void n(new Error(`Unknown sourceLayer "${e}"`));if(_.hasDataForBand(i))return this.updateTextureDescriptor(e,i),void n(null,this.textureDescriptor?this.textureDescriptor.img:null);const y=_.getDataRange([i]);if(c=s.createDecodingTask(y),!c||c.tasks.length)if(this.flushQueues(),this.entireBuffer)f(null,this.entireBuffer.slice(y.firstByte,y.lastByte+1));else{const v=Object.assign({},this.requestParams,{headers:{Range:`bytes=${y.firstByte}-${y.lastByte}`}}),C=vs(v,f);this._fetchQueue.push(()=>{C.cancel(),c.cancel()})}else n(null)}updateNeeded(e,i){return(!this.textureDescriptor||this.textureDescriptor.band!==i||this.textureDescriptor.layer!==e)&&this.state!=="errored"}updateTextureDescriptor(e,i){if(!this._mrt)return;const n=this._mrt.getLayer(e);if(!n||!n.hasBand(i)||!n.hasDataForBand(i))return;const{bytes:s,tileSize:l,buffer:c,offset:d,scale:f}=n.getBandView(i),_=l+2*c,y={data:s,width:_,height:_},v=this.texture;v&&v instanceof vn&&v.update(y,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:e,band:i,img:y,buffer:c,offset:d,tileSize:l,format:n.pixelFormat,mix:[f,256*f,65536*f,16777216*f]}}}class h7{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,n){const s=e.wrapped().key;this.data[s]===void 0&&(this.data[s]=[]);const l={value:i,timeout:void 0};if(n!==void 0&&(l.timeout=setTimeout(()=>{this.remove(e,l)},n)),this.data[s].push(l),this.order.push(s),this.order.length>this.max){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const n=e.wrapped().key,s=i===void 0?0:this.data[n].indexOf(i),l=this.data[n][s];return this.data[n].splice(s,1),l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(l.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const n in this.data)for(const s of this.data[n])e(s.value)||i.push(s);for(const n of i)this.remove(n.value.tileID,n)}}class el extends As{constructor(e,i,n){super(),this.id=e,this._onlySymbols=n,i.on("data",s=>{s.dataType==="source"&&s.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&s.dataType==="source"&&s.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new h7(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new l9,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if(i.state!=="loaded"&&i.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,e.isExtraShadowCaster=this._shadowCasterTiles[e.tileID.key],this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e)}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e)}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const n=this._tiles[i];n.upload(e),n.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return H1(this._tiles).map(e=>e.tileID).sort(s5).map(e=>e.key)}getRenderableIds(e,i){const n=[];for(const s in this._tiles)this._isIdRenderable(+s,e,i)&&n.push(this._tiles[s]);return e?n.sort((s,l)=>{const c=s.tileID,d=l.tileID,f=new Ze(c.canonical.x,c.canonical.y)._rotate(this.transform.angle),_=new Ze(d.canonical.x,d.canonical.y)._rotate(this.transform.angle);return c.overscaledZ-d.overscaledZ||_.y-f.y||_.x-f.x}).map(s=>s.tileID.key):n.map(s=>s.tileID).sort(s5).map(s=>s.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())&&(n||!this._shadowCasterTiles[e])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const n=this._tiles[e];n&&(n.state!=="loading"&&(n.state=i),this._loadTile(n,this._tileLoaded.bind(this,n,e,i)))}_tileLoaded(e,i,n,s){if(s)if(e.state="errored",s.status!==404)this._source.fire(new bo(s,{tile:e}));else{if(this._source.fire(new mn("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:e})),!(e.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const l=this.map.painter.terrain;this.update(this.transform,l.getScaledDemTileSize(),!0),l.resetTileLookupCache(this.id)}else this.update(this.transform)}else e.timeAdded=sr.now(),n==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new mn("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let s=0;s<i.length;s++){const l=i[s];if(e.neighboringTiles&&e.neighboringTiles[l]){const c=this.getTileByID(l);n(e,c),n(c,e)}}function n(s,l){if(!s.dem||s.dem.borderReady)return;s.needsHillshadePrepare=!0,s.needsDEMTextureUpload=!0;let c=l.tileID.canonical.x-s.tileID.canonical.x;const d=l.tileID.canonical.y-s.tileID.canonical.y,f=Math.pow(2,s.tileID.canonical.z),_=l.tileID.key;c===0&&d===0||Math.abs(d)>1||(Math.abs(c)>1&&(Math.abs(c+f)===1?c+=f:Math.abs(c-f)===1&&(c-=f)),l.dem&&s.dem&&(s.dem.backfillBorder(l.dem,c,d),s.neighboringTiles&&s.neighboringTiles[_]&&(s.neighboringTiles[_].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,n,s){for(const l in this._tiles){let c=this._tiles[l];if(s[l]||!c.hasData()||c.tileID.overscaledZ<=i||c.tileID.overscaledZ>n)continue;let d=c.tileID;for(;c&&c.tileID.overscaledZ>i+1;){const _=c.tileID.scaledTo(c.tileID.overscaledZ-1);c=this._tiles[_.key],c&&c.hasData()&&(d=_)}let f=d;for(;f.overscaledZ>i;)if(f=f.scaledTo(f.overscaledZ-1),e[f.key]){s[d.key]=d;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=i?n:null}for(let n=e.overscaledZ-1;n>=i;n--){const s=e.scaledTo(n),l=this._getLoadedTile(s);if(l)return l}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const n=Math.ceil(e.width/i)+1,s=Math.ceil(e.height/i)+1,l=Math.floor(n*s*5),c=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,l):l,d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(d)}handleWrapJump(e){const i=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,i){const n={};for(const s in this._tiles){const l=this._tiles[s];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+i),n[l.tileID.key]=l}this._tiles=n;for(const s in this._timers)clearTimeout(this._timers[s]),delete this._timers[s];for(const s in this._tiles)this._setTileReloadTimer(+s,this._tiles[s])}}update(e,i,n,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!n)return;this.updateCacheSize(e,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const l=this._source.type==="batched-model";let c;if(this.used||this.usedForTerrain){if(this._source.tileID)c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(_=>new $i(_.canonical.z,_.wrap,_.canonical.z,_.canonical.x,_.canonical.y));else if(this.tileCoverLift!==0){const _=e.clone();_.tileCoverLift=this.tileCoverLift,c=_.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:l}),this._source.minzoom<=1&&e.projection.name==="globe"&&(c.push(new $i(1,0,1,0,0)),c.push(new $i(1,0,1,1,0)),c.push(new $i(1,0,1,0,1)),c.push(new $i(1,0,1,1,1)))}else if(c=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:l}),this._source.hasTile){const _=this._source.hasTile.bind(this._source);c=c.filter(y=>_(y))}}else c=[];if(c.length>0&&this.castsShadows&&s&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!w0(this._source.type)){const _=e.coveringZoomLevel({tileSize:i||this._source.tileSize,roundZoom:this._source.roundZoom&&!n}),y=Math.min(_,this._source.maxzoom);if(l){const v=e.extendTileCover(c,y);for(const C of v)c.push(C)}else{const v=e.extendTileCover(c,y,s);for(const C of v)this._shadowCasterTiles[C.key]=!0,c.push(C)}}const d=this._updateRetainedTiles(c);if(w0(this._source.type)&&c.length!==0){const _={},y={},v=Object.keys(d);for(const A of v){const M=d[A],I=this._tiles[A];if(!I||I.fadeEndTime&&I.fadeEndTime<=sr.now())continue;const P=this.findLoadedParent(M,Math.max(M.overscaledZ-el.maxOverzooming,this._source.minzoom));P&&(this._addTile(P.tileID),_[P.tileID.key]=P.tileID),y[A]=M}const C=c[c.length-1].overscaledZ;for(const A in this._tiles){const M=this._tiles[A];if(d[A]||!M.hasData())continue;let I=M.tileID;for(;I.overscaledZ>C;){I=I.scaledTo(I.overscaledZ-1);const P=this._tiles[I.key];if(P&&P.hasData()&&y[I.key]){d[A]=M.tileID;break}}}for(const A in _)d[A]||(this._coveredTiles[A]=!0,d[A]=_[A])}for(const _ in d)this._tiles[_].clearFadeHold();const f=function(_,y){const v=[];for(const C in _)C in y||v.push(C);return v}(this._tiles,d);for(const _ of f){const y=this._tiles[_];y.hasSymbolBuckets&&!y.holdingForFade()?y.setHoldDuration(this.map._fadeDuration):y.hasSymbolBuckets&&!y.symbolFadeFinished()||this._removeTile(+_)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(e.length===0)return i;const n={},s=e.reduce((_,y)=>Math.min(_,y.overscaledZ),1/0),l=e[0].overscaledZ,c=Math.max(l-el.maxOverzooming,this._source.minzoom),d=Math.max(l+el.maxUnderzooming,this._source.minzoom),f={};for(const _ of e){const y=this._addTile(_);i[_.key]=_,y.hasData()||s<this._source.maxzoom&&(f[_.key]=_)}this._retainLoadedChildren(f,s,d,i);for(const _ of e){let y=this._tiles[_.key];if(y.hasData())continue;if(_.canonical.z>=this._source.maxzoom){const C=_.children(this._source.maxzoom)[0],A=this.getTile(C);if(A&&A.hasData()){i[C.key]=C;continue}}else{const C=_.children(this._source.maxzoom);if(i[C[0].key]&&i[C[1].key]&&i[C[2].key]&&i[C[3].key])continue}let v=y.wasRequested();for(let C=_.overscaledZ-1;C>=c;--C){const A=_.scaledTo(C);if(n[A.key]||(n[A.key]=!0,y=this.getTile(A),!y&&v&&(y=this._addTile(A)),y&&(i[A.key]=A,v=y.wasRequested(),y.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let n,s=this._tiles[e].tileID;for(;s.overscaledZ>0;){if(s.key in this._loadedParentTiles){n=this._loadedParentTiles[s.key];break}i.push(s.key);const l=s.scaledTo(s.overscaledZ-1);if(n=this._getLoadedTile(l),n)break;s=l}for(const l of i)this._loadedParentTiles[l]=n}}_addTile(e){let i=this._tiles[e.key];if(i)return i.isExtraShadowCaster!==!0||this._shadowCasterTiles[e.key]||this._reloadTile(e.key,"reloading"),i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const n=!!i;if(!n){const s=this.map?this.map.painter:null,l=this._source.tileSize*e.overscaleFactor();i=this._source.type==="raster-array"?new n5(e,l,this.transform.tileZoom,s,this._isRaster):new dh(e,l,this.transform.tileZoom,s,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,n||this._source.fire(new mn("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=i.getExpiryTimeout();n&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},n))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&i.state!=="reloading"||i.state==="empty"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,n){const s=[],l=this.transform;if(!l)return s;const c=l.projection.name==="globe",d=ss(l.center.lng);for(const f in this._tiles){const _=this._tiles[f];if(n&&_.clearQueryDebugViz(),_.holdingForFade())continue;let y;if(c){const v=_.tileID.canonical;if(v.z===0){const C=[Math.abs(Pt(d,...d3(v,-1))-d),Math.abs(Pt(d,...d3(v,1))-d)];y=[0,2*C.indexOf(Math.min(...C))-1]}else{const C=[Math.abs(Pt(d,...d3(v,-1))-d),Math.abs(Pt(d,...d3(v,0))-d),Math.abs(Pt(d,...d3(v,1))-d)];y=[C.indexOf(Math.min(...C))-1]}}else y=[0];for(const v of y){const C=e.containsTile(_,l,i,v);C&&s.push(C)}}return s}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(e){return this._getRenderableCoordinates(e)}_getRenderableCoordinates(e,i){const n=this.getRenderableIds(e,i).map(l=>this._tiles[l].tileID),s=this.transform.projection.name==="globe";for(const l of n)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped()),l.expandedProjMatrix=s?this.transform.calculateProjMatrix(l.toUnwrapped(),!1,!0):l.projMatrix;return n}sortCoordinatesByDistance(e){const i=e.slice(),n=this.transform._camera.position,s=this.transform._camera.forward(),l={};for(const c of i){const d=1/(1<<c.canonical.z);l[c.key]=((c.canonical.x+.5)*d+c.wrap-n[0])*s[0]+((c.canonical.y+.5)*d-n[1])*s[1]-n[2]*s[2]}return i.sort((c,d)=>l[c.key]-l[d.key]),i}hasTransition(){if(this._source.hasTransition())return!0;if(w0(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=sr.now())return!0}return!1}setFeatureState(e,i,n){this._state.updateState(e=e||"_geojsonTileLayer",i,n)}removeFeatureState(e,i,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,n)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,n){const s=this._tiles[e];s&&s.setDependencies(i,n)}reloadTilesForDependencies(e,i){for(const n in this._tiles)this._tiles[n].hasDependency(e,i)&&this._reloadTile(+n,"reloading");this._cache.filter(n=>!n.hasDependency(e,i))}_preloadTiles(e,i){if(!this._sourceLoaded){const d=()=>{this._sourceLoaded&&(this._source.off("data",d),this._preloadTiles(e,i))};return void this._source.on("data",d)}const n=new Map,s=Array.isArray(e)?e:[e],l=this.map.painter.terrain,c=this.usedForTerrain&&l?l.getScaledDemTileSize():this._source.tileSize;for(const d of s){const f=d.coveringTiles({tileSize:c,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const _ of f)n.set(_.key,_);this.usedForTerrain&&d.updateElevation(!1)}so(Array.from(n.values()),(d,f)=>{const _=new dh(d,this._source.tileSize*d.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(_,y=>{this._source.type==="raster-dem"&&_.dem&&this._backfillDEM(_),f(y,_)})},i)}}function s5(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),n=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||n-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function w0(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function d3(t,e){const i=1<<t.z;return[t.x/i+e,(t.x+1)/i+e]}el.maxOverzooming=10,el.maxUnderzooming=3;const a5=()=>b0||(b0={layout:tf||(tf=new ci({"line-cap":new Qe(_e.layout_line["line-cap"]),"line-join":new Qe(_e.layout_line["line-join"]),"line-miter-limit":new Le(_e.layout_line["line-miter-limit"]),"line-round-limit":new Le(_e.layout_line["line-round-limit"]),"line-sort-key":new Qe(_e.layout_line["line-sort-key"]),"line-z-offset":new Qe(_e.layout_line["line-z-offset"]),visibility:new Le(_e.layout_line.visibility)})),paint:rf||(rf=new ci({"line-opacity":new Qe(_e.paint_line["line-opacity"]),"line-color":new Qe(_e.paint_line["line-color"]),"line-translate":new Le(_e.paint_line["line-translate"]),"line-translate-anchor":new Le(_e.paint_line["line-translate-anchor"]),"line-width":new Qe(_e.paint_line["line-width"]),"line-gap-width":new Qe(_e.paint_line["line-gap-width"]),"line-offset":new Qe(_e.paint_line["line-offset"]),"line-blur":new Qe(_e.paint_line["line-blur"]),"line-dasharray":new Qe(_e.paint_line["line-dasharray"]),"line-pattern":new Qe(_e.paint_line["line-pattern"]),"line-gradient":new gr(_e.paint_line["line-gradient"]),"line-trim-offset":new Le(_e.paint_line["line-trim-offset"]),"line-trim-fade-range":new Le(_e.paint_line["line-trim-fade-range"]),"line-trim-color":new Le(_e.paint_line["line-trim-color"]),"line-emissive-strength":new Le(_e.paint_line["line-emissive-strength"]),"line-border-width":new Qe(_e.paint_line["line-border-width"]),"line-border-color":new Qe(_e.paint_line["line-border-color"]),"line-occlusion-opacity":new Le(_e.paint_line["line-occlusion-opacity"])}))},b0);class d7 extends Qe{possiblyEvaluate(e,i){return i=new dt(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,n,s){return i=ir({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,n,s)}}let p3,o5,l5,A0;function c5(t,e){return e>0?e+2*t:t}class u5{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ir,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}oe(u5,"FormatSectionOverride",{omit:["defaultValue"]});const T0=()=>A0||(A0={layout:o5||(o5=new ci({"symbol-placement":new Le(_e.layout_symbol["symbol-placement"]),"symbol-spacing":new Le(_e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Le(_e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qe(_e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Le(_e.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Le(_e.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Le(_e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Le(_e.layout_symbol["icon-ignore-placement"]),"icon-optional":new Le(_e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Le(_e.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qe(_e.layout_symbol["icon-size"]),"icon-text-fit":new Qe(_e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qe(_e.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qe(_e.layout_symbol["icon-image"]),"icon-rotate":new Qe(_e.layout_symbol["icon-rotate"]),"icon-padding":new Le(_e.layout_symbol["icon-padding"]),"icon-keep-upright":new Le(_e.layout_symbol["icon-keep-upright"]),"icon-offset":new Qe(_e.layout_symbol["icon-offset"]),"icon-anchor":new Qe(_e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Le(_e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Le(_e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Le(_e.layout_symbol["text-rotation-alignment"]),"text-field":new Qe(_e.layout_symbol["text-field"]),"text-font":new Qe(_e.layout_symbol["text-font"]),"text-size":new Qe(_e.layout_symbol["text-size"]),"text-max-width":new Qe(_e.layout_symbol["text-max-width"]),"text-line-height":new Qe(_e.layout_symbol["text-line-height"]),"text-letter-spacing":new Qe(_e.layout_symbol["text-letter-spacing"]),"text-justify":new Qe(_e.layout_symbol["text-justify"]),"text-radial-offset":new Qe(_e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Le(_e.layout_symbol["text-variable-anchor"]),"text-anchor":new Qe(_e.layout_symbol["text-anchor"]),"text-max-angle":new Le(_e.layout_symbol["text-max-angle"]),"text-writing-mode":new Le(_e.layout_symbol["text-writing-mode"]),"text-rotate":new Qe(_e.layout_symbol["text-rotate"]),"text-padding":new Le(_e.layout_symbol["text-padding"]),"text-keep-upright":new Le(_e.layout_symbol["text-keep-upright"]),"text-transform":new Qe(_e.layout_symbol["text-transform"]),"text-offset":new Qe(_e.layout_symbol["text-offset"]),"text-allow-overlap":new Le(_e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Le(_e.layout_symbol["text-ignore-placement"]),"text-optional":new Le(_e.layout_symbol["text-optional"]),visibility:new Le(_e.layout_symbol.visibility)})),paint:l5||(l5=new ci({"icon-opacity":new Qe(_e.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Qe(_e.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Qe(_e.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Qe(_e.paint_symbol["text-emissive-strength"]),"icon-color":new Qe(_e.paint_symbol["icon-color"]),"icon-halo-color":new Qe(_e.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qe(_e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qe(_e.paint_symbol["icon-halo-blur"]),"icon-translate":new Le(_e.paint_symbol["icon-translate"]),"icon-translate-anchor":new Le(_e.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Qe(_e.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Qe(_e.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Qe(_e.paint_symbol["text-occlusion-opacity"]),"text-color":new Qe(_e.paint_symbol["text-color"],{runtimeType:qr,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Qe(_e.paint_symbol["text-halo-color"]),"text-halo-width":new Qe(_e.paint_symbol["text-halo-width"]),"text-halo-blur":new Qe(_e.paint_symbol["text-halo-blur"]),"text-translate":new Le(_e.paint_symbol["text-translate"]),"text-translate-anchor":new Le(_e.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Le(_e.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Le(_e.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Le(_e.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Le(_e.paint_symbol["icon-color-brightness-max"])}))},A0);class ph extends Br{constructor(e,i,n,s){super(e,T0(),i,n,s),this._colorAdjustmentMatrix=a.ae.identity([]),this.hasInitialOcclusionOpacityProperties=e.paint!==void 0&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,i){super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const s=[];for(const l of n)s.indexOf(l)<0&&s.push(l);this.layout._values["text-writing-mode"]=s}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,i,n,s){return this._saturation===e&&this._contrast===i&&this._brightnessMin===n&&this._brightnessMax===s||(this._colorAdjustmentMatrix=function(l,c,d,f){l=O3(l),c=P3(c);const _=a.ae.create(),y=l/3,v=1-2*y,C=[v,y,y,0,y,v,y,0,y,y,v,0,0,0,0,1],A=.5-.5*c,M=f-d;return a.ae.multiply(_,[M,0,0,0,0,M,0,0,0,0,M,0,d,d,d,1],[c,0,0,0,0,c,0,0,0,0,c,0,A,A,A,1]),a.ae.multiply(_,_,C),_}(e,i,n,s),this._saturation=e,this._contrast=i,this._brightnessMin=n,this._brightnessMax=s),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,i,n,s){const l=this.layout.get(e).evaluate(i,{},n,s),c=this._unevaluatedLayout._values[e];return c.isDataDriven()||G(c.value)||!l?l:function(d,f){return f.replace(/{([^{}]+)}/g,(_,y)=>y in d?String(d[y]):"")}(i.properties,l)}createBucket(e){return new M1(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of T0().paint.overridableProperties){if(!ph.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),n=new u5(i),s=new $(n,i.property.specification,this.scope,this.options);let l=null;l=i.value.kind==="constant"||i.value.kind==="source"?new K("source",s):new W("composite",s,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Wi(i.property,l,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,n){return!(!this.layout||i.isDataDriven()||n.isDataDriven())&&ph.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const n=e.get("text-field"),s=T0().paint.properties[i];let l=!1;const c=d=>{for(const f of d)if(s.overrides&&s.overrides.hasOverride(f))return void(l=!0)};if(n.value.kind==="constant"&&n.value.value instanceof _r)c(n.value.value.sections);else if(n.value.kind==="source"){const d=_=>{l||(_ instanceof an&&Vi(_.value)===_a?c(_.value.sections):_ instanceof Ms?c(_.sections):_.eachChild(d))},f=n.value;f._styleExpression&&d(f._styleExpression.expression)}return l}getProgramIds(){const e=this.paint.get("icon-opacity").constantOr(1)!==0,i=this.paint.get("text-opacity").constantOr(1)!==0,n=[];return e&&n.push("symbolIcon"),i&&n.push("symbolSDF"),n}getDefaultProgramParams(e,i,n){return{config:new qo(this,{zoom:i,lut:n}),overrideFog:!1}}}let h5,d5,p5,f5;function fh(t,e,i,n,s,l,c,d){const f=[t,e,1,i,n,1,s,l,1],_=[c,d,1],y=a.bE.adjoint([],f),[v,C,A]=a.$.transformMat3(_,_,y);return a.bE.multiply(f,f,[v,0,0,0,C,0,0,0,A])}function m5(t,e,i,n,s,l,c,d){const f=function(_,y,v,C,A,M,I,P){const D=fh(0,0,1,0,1,1,0,1),V=fh(_,y,v,C,A,M,I,P),N=a.bE.adjoint([],D);return a.bE.multiply(V,V,N)}(t,e,i,n,s,l,c,d);return[f[2]/f[8]/je,f[5]/f[8]/je]}function mh(t){return[t[0],Math.min(Math.max(t[1],-ki),ki)]}class _5 extends As{constructor(e,i,n,s){super(),this.id=e,this.dispatcher=n,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(s),this.options=i,this._dirty=!1}load(e,i){if(this._loaded=i||!1,this.fire(new mn("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=yo(this.map._requestManager.transformRequest(this.url,_o.Image),(n,s)=>{this._imageRequest=null,this._loaded=!0,n?this.fire(new bo(n)):s&&(this.image=s instanceof HTMLImageElement?sr.getImageData(s):s,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new ch(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new mn("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof ch||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=e[0][1],n=e[0][1];for(const l of e)l[1]>n&&(n=l[1]),l[1]<i&&(i=l[1]);const s=(n+i)/2;if(s>ki?this.onNorthPole=!0:s<-ki&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const l=e.map(yr.fromLngLat);this.tileID=function(c){let d=1/0,f=1/0,_=-1/0,y=-1/0;for(const I of c)d=Math.min(d,I.x),f=Math.min(f,I.y),_=Math.max(_,I.x),y=Math.max(y,I.y);const v=Math.max(_-d,y-f),C=Math.max(0,Math.floor(-Math.log(v)/Math.LN2)),A=Math.pow(2,C);let M=Math.floor((d+_)/2*A);return M>1&&(M-=1),new Ho(C,M,Math.floor((f+y)/2*A))}(l),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new mn("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const P in this.tiles){const D=this.tiles[P];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const i=Ko(new Ho(0,0,0),this.map.transform.projection),n=[i.projection.project(this.coordinates[0][0],this.coordinates[0][1]),i.projection.project(this.coordinates[1][0],this.coordinates[1][1]),i.projection.project(this.coordinates[2][0],this.coordinates[2][1]),i.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(P){const D=P[1].x-P[0].x,V=P[1].y-P[0].y,N=P[2].x-P[1].x,U=P[2].y-P[1].y,X=P[3].x-P[2].x,Y=P[3].y-P[2].y,ee=P[0].x-P[3].x,le=P[0].y-P[3].y,pe=D*U-N*V,xe=N*Y-X*U,fe=X*le-ee*Y,we=ee*V-D*le;return pe>0&&xe>0&&fe>0&&we>0||pe<0&&xe<0&&fe<0&&we<0}(n))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const s=Ko(this.tileID,this.map.transform.projection),[l,c,d,f]=this.coordinates.map(P=>{const D=s.projection.project(P[0],P[1]);return Vf(s,D)._round()});this.perspectiveTransform=m5(l.x,l.y,c.x,c.y,d.x,d.y,f.x,f.y);const _=this._boundsArray=new zs;_.emplaceBack(l.x,l.y,0,0),_.emplaceBack(c.x,c.y,je,0),_.emplaceBack(f.x,f.y,0,je),_.emplaceBack(d.x,d.y,je,je),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(_,hh.members),this.boundsSegments=wi.simpleSegment(0,0,4,2);const y=[],v=function(P){return[mh(P[0]),mh(P[1]),mh(P[2]),mh(P[3])]}(this.coordinates),[C,A,M,I]=function(P){let D=P[0][0],V=D,N=P[0][1],U=N;for(let X=1;X<P.length;X++)P[X][0]<D?D=P[X][0]:P[X][0]>V&&(V=P[X][0]),P[X][1]<N?N=P[X][1]:P[X][1]>U&&(U=P[X][1]);return[D,N,V-D,U-N]}(v);{const P=new zs,[D,V,N,U]=function(be){let Ee=be[0].x,Fe=Ee,Te=be[0].y,Ve=Te;for(let Be=1;Be<be.length;Be++)be[Be].x<Ee?Ee=be[Be].x:be[Be].x>Fe&&(Fe=be[Be].x),be[Be].y<Te?Te=be[Be].y:be[Be].y>Ve&&(Ve=be[Be].y);return[Ee,Te,Fe-Ee,Ve-Te]}(n),X=be=>[(be.x-D)/N,(be.y-V)/U],[Y,ee,le,pe]=n.map(X),xe=function(be,Ee,Fe,Te,Ve,Be,Re,rt){const tt=fh(0,0,1,0,1,1,0,1),He=fh(be,Ee,Fe,Te,Ve,Be,Re,rt),Ne=a.bE.adjoint([],He);return a.bE.multiply(tt,tt,Ne)}(Y[0],Y[1],ee[0],ee[1],le[0],le[1],pe[0],pe[1]);this.elevatedGlobePerspectiveTransform=m5(Y[0],Y[1],ee[0],ee[1],le[0],le[1],pe[0],pe[1]);const fe=(be,Ee)=>{y.push(be.lng);const Fe=Math.round((be.lng-C)/M*je),Te=Math.round((be.lat-A)/I*je),Ve=X(Ee),Be=a.$.transformMat3([],[Ve[0],Ve[1],1],xe),Re=Math.round(Be[0]/Be[2]*je),rt=Math.round(Be[1]/Be[2]*je);P.emplaceBack(Fe,Te,Re,rt)},we=n[3].x-n[0].x,De=n[3].y-n[0].y,Ae=n[2].x-n[1].x,ke=n[2].y-n[1].y;for(let be=0;be<65;be++){const Ee=be/64,Fe=[n[0].x+Ee*we,n[0].y+Ee*De],Te=[n[1].x+Ee*Ae,n[1].y+Ee*ke],Ve=Te[0]-Fe[0],Be=Te[1]-Fe[1];for(let Re=0;Re<65;Re++){const rt=Re/64,tt={x:Fe[0]+Ve*rt,y:Fe[1]+Be*rt,z:0};fe(i.projection.unproject(tt.x,tt.y),tt)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(P,hh.members)}{this.maxLongitudeTriangleSize=0;let P=[],D=new Hi;const V=(N,U,X)=>{D.emplaceBack(N,U,X);const Y=y[N],ee=y[U],le=y[X],pe=Math.min(Math.min(Y,ee),le),xe=Math.max(Math.max(Y,ee),le)-pe;xe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=xe),P.push(pe+xe/2)};for(let N=0;N<64;N++)for(let U=0;U<64;U++){const X=65*N+U,Y=X+1,ee=X+65,le=ee+1;V(X,ee,Y),V(Y,ee,le)}[P,D]=function(N,U){const X=Array.from({length:N.length},(le,pe)=>pe);X.sort((le,pe)=>N[le]-N[pe]);const Y=[],ee=new Hi;for(let le=0;le<X.length;le++){const pe=X[le];Y.push(N[pe]);const xe=3*pe,fe=xe+1;ee.emplaceBack(U.uint16[xe],U.uint16[fe],U.uint16[fe+1])}return[Y,ee]}(P,D),this.elevatedGlobeTrianglesCenterLongitudes=P,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(D)}this.elevatedGlobeSegments=wi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,M/je,0,I/je,0,0,A,C,0])}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const i=this.map.painter.context,n=i.gl;!this._dirty||this.texture instanceof ch||(this.texture?this.texture.update(this.image):(this.texture=new vn(i,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(i)}loadTile(e,i){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},i(null)):(e.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const i=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!i)return null;const n=this.elevatedGlobeTrianglesCenterLongitudes;let s=(l=e+180)+360*Math.round((n[0]-l)/360);var l;const c=new wi,d=(v,C)=>{c.segments.push({vertexOffset:0,primitiveOffset:v,vertexLength:i.segments[0].vertexLength,primitiveLength:C,sortKey:void 0,vaos:{}})},f=.51*this.maxLongitudeTriangleSize;if(Math.abs(n[0]-s)<=f){const v=Il(n,0,n.length,s+f);return v===n.length||d(v,El(n,v+1,n.length,s+360-f)-v),c}s<n[0]&&(s+=360);const _=El(n,0,n.length,s-f);if(_===n.length)return d(0,n.length),c;d(0,_-0);const y=Il(n,_+1,n.length,s+f);return y!==n.length&&d(y,n.length-y),c}}const p7=(Math.pow(256,2)-1)/16907520;class g5 extends Br{constructor(e,i,n,s){super(e,{layout:p5||(p5=new ci({visibility:new Le(_e.layout_raster.visibility)})),paint:f5||(f5=new ci({"raster-opacity":new Le(_e.paint_raster["raster-opacity"]),"raster-color":new gr(_e.paint_raster["raster-color"]),"raster-color-mix":new Le(_e.paint_raster["raster-color-mix"]),"raster-color-range":new Le(_e.paint_raster["raster-color-range"]),"raster-hue-rotate":new Le(_e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Le(_e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Le(_e.paint_raster["raster-brightness-max"]),"raster-saturation":new Le(_e.paint_raster["raster-saturation"]),"raster-contrast":new Le(_e.paint_raster["raster-contrast"]),"raster-resampling":new Le(_e.paint_raster["raster-resampling"]),"raster-fade-duration":new Le(_e.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Le(_e.paint_raster["raster-emissive-strength"]),"raster-array-band":new Le(_e.paint_raster["raster-array-band"]),"raster-elevation":new Le(_e.paint_raster["raster-elevation"])}))},i,n,s),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof _5&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;const i=this._transitionablePaint._values["raster-color"].value.expression,[n,s]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(n)&&isNaN(s)||n===this._curRampRange[0]&&s===this._curRampRange[1]||(this.colorRamp=Zc({expression:i,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:n,end:s}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[n,s])}}let y5,x5,v5,C5,b5;class w5 extends Br{constructor(e,i,n,s){super(e,{layout:y5||(y5=new ci({visibility:new Le(_e["layout_raster-particle"].visibility)})),paint:x5||(x5=new ci({"raster-particle-array-band":new Le(_e["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Le(_e["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new gr(_e["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Le(_e["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Le(_e["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Le(_e["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Le(_e["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Le(_e["paint_raster-particle"]["raster-particle-elevation"])}))},i,n,s),this._updateColorRamp(),this.lastInvalidatedAt=sr.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,i=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Zc({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:i}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=sr.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class f7 extends Br{constructor(e,i){super(e,{},i,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}function M0(t,e,i){const n=[0,0,1],s=a.aw.identity([]);return a.aw.rotateY(s,s,i?-Lt(t)+Math.PI:Lt(t)),a.aw.rotateX(s,s,-Lt(e)),a.$.transformQuat(n,n,s),a.$.normalize(n,n)}function A5(t,e){const i=_h(t.projection,t.zoom,t.width,t.height),n=function(l,c,d,f,_){const y=new Ht(d.lng-180*Va,d.lat),v=new Ht(d.lng+180*Va,d.lat),C=l.project(y.lng,y.lat),A=l.project(v.lng,v.lat),M=-Math.atan2(A.y-C.y,A.x-C.x),I=yr.fromLngLat(d);I.y=Pt(I.y,-1+Va,1-Va);const P=I.toLngLat(),D=l.project(P.lng,P.lat),V=yr.fromLngLat(P);V.x+=Va;const N=V.toLngLat(),U=l.project(N.lng,N.lat),X=S5(U.x-D.x,U.y-D.y,M),Y=yr.fromLngLat(P);Y.y+=Va;const ee=Y.toLngLat(),le=l.project(ee.lng,ee.lat),pe=S5(le.x-D.x,le.y-D.y,M),xe=Math.abs(X.x)/Math.abs(pe.y),fe=a.ae.identity([]);a.ae.rotateZ(fe,fe,-M*(1-(_?0:f)));const we=a.ae.identity([]);return a.ae.scale(we,we,[1,1-(1-xe)*f,1]),we[4]=-pe.x/pe.y*f,a.ae.rotateZ(we,we,M),a.ae.multiply(we,fe,we),we}(t.projection,0,t.center,i,e),s=T5(t);return a.ae.scale(n,n,[s,s,1]),n}function T5(t){const e=t.projection,i=_h(t.projection,t.zoom,t.width,t.height),n=M5(e,t.center),s=M5(e,Ht.convert(e.center));return Math.pow(2,n*i+(1-i)*s)}function _h(t,e,i,n,s=1/0){const l=t.range;if(!l)return 0;const c=Math.min(s,Math.max(i,n)),d=Math.log(c/1024)/Math.LN2;return W1(l[0]+d,l[1]+d,e)}const Va=1/4e4;function M5(t,e){const i=Pt(e.lat,-ki,ki),n=new Ht(e.lng-180*Va,i),s=new Ht(e.lng+180*Va,i),l=t.project(n.lng,i),c=t.project(s.lng,i),d=yr.fromLngLat(n),f=yr.fromLngLat(s),_=c.x-l.x,y=c.y-l.y,v=f.x-d.x,C=f.y-d.y,A=Math.sqrt((v*v+C*C)/(_*_+y*y));return Math.log(A)/Math.LN2}function S5(t,e,i){const n=Math.cos(i),s=Math.sin(i);return{x:t*n-e*s,y:t*s+e*n}}function E5(t,e,i){a.ae.identity(t),a.ae.rotateZ(t,t,Lt(e[2])),a.ae.rotateX(t,t,Lt(e[0])),a.ae.rotateY(t,t,Lt(e[1])),a.ae.scale(t,t,i),a.ae.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function gh(t,e,i,n,s,l,c,d){const f=[i[0]-e[0],i[1]-e[1],0],_=[n[0]-e[0],n[1]-e[1],0];if(a.$.length(f)<1e-12||a.$.length(_)<1e-12)return a.aw.identity(t);const y=a.$.cross([],f,_);a.$.normalize(y,y),a.$.subtract(_,n,e),f[2]=(l-s)*d,_[2]=(c-s)*d;const v=f;return a.$.cross(v,f,_),a.$.normalize(v,v),a.aw.rotationTo(t,y,v)}function S0(t,e,i=!1){const n=Fs(e.zoom),s=function(l,c,d){const f=c.worldSize,_=[l[12],l[13],l[14]],y=Qi(_[1]/f),v=Fr(_[0]/f),C=a.ae.identity([]),A=Mr(1,y)*f,M=Mr(1,0)*f*Xo(y,c.zoom),I=1/G2(f);let P=M*I;if(d){const U=_h(c.projection,c.zoom,c.width,c.height,1024);P=I*c.projection.pixelSpaceConversion(c.center.lat,f,U)}const D=Wo(y,v);a.$.add(D,D,a.$.scale([],a.$.normalize([],D),A*P*_[2]));const V=function(U){const X=[U[0],U[1],U[2]];let Y=[0,1,0];const ee=a.$.cross([],Y,X);return a.$.cross(Y,X,ee),a.$.squaredLength(Y)===0&&(Y=[0,1,0],a.$.cross(ee,X,Y)),a.$.normalize(ee,ee),a.$.normalize(Y,Y),a.$.normalize(X,X),[ee[0],ee[1],ee[2],0,Y[0],Y[1],Y[2],0,X[0],X[1],X[2],0,U[0],U[1],U[2],1]}(D);a.ae.scale(C,C,[P,P,P*A]),a.ae.translate(C,C,[-_[0],-_[1],-_[2]]);const N=a.ae.multiply([],c.globeMatrix,V);return a.ae.multiply(N,N,C),a.ae.multiply(N,N,l),N}(t,e,i);if(n>0){const l=function(c,d){const f=d.worldSize,_=Mr(1,0)*f*Xo(d.center.lat,d.zoom)/G2(f),y=Mr(1,d.center.lat)*f,v=a.ae.identity([]);return a.ae.rotateY(v,v,Lt(d.center.lng)),a.ae.rotateX(v,v,Lt(d.center.lat)),a.ae.translate(v,v,[0,0,Tr]),a.ae.scale(v,v,[_,_,_*y]),a.ae.translate(v,v,[d.point.x-.5*f,d.point.y-.5*f,0]),a.ae.multiply(v,v,c),a.ae.multiply(v,d.globeMatrix,v)}(t,e);return function(c,d,f){const _=(M,I,P)=>{const D=a.$.length(M),V=a.$.length(I),N=Bs(M,I,P);return a.$.scale(N,N,1/a.$.length(N)*lt(D,V,P))},y=_([c[0],c[1],c[2]],[d[0],d[1],d[2]],f),v=_([c[4],c[5],c[6]],[d[4],d[5],d[6]],f),C=_([c[8],c[9],c[10]],[d[8],d[9],d[10]],f),A=Bs([c[12],c[13],c[14]],[d[12],d[13],d[14]],f);return[y[0],y[1],y[2],0,v[0],v[1],v[2],0,C[0],C[1],C[2],0,A[0],A[1],A[2],1]}(s,l,n)}return s}function I5(t,e,i,n){const s=vi.projectAabbCorners(n,i);let l=Number.MAX_VALUE,c=-1;for(let _=0;_<s.length;++_){const y=s[_];y[0]=(.5*y[0]+.5)*e.width,y[1]=(.5-.5*y[1])*e.height,y[2]<l&&(c=_,l=y[2])}const d=_=>new Ze(s[_][0],s[_][1]);let f;switch(c){case 0:case 6:f=[d(1),d(5),d(4),d(7),d(3),d(2),d(1)];break;case 1:case 7:f=[d(0),d(4),d(5),d(6),d(2),d(3),d(0)];break;case 3:case 5:f=[d(1),d(0),d(4),d(7),d(6),d(2),d(1)];break;default:f=[d(1),d(5),d(6),d(7),d(3),d(0),d(1)]}if(L2(t,f))return l}const m7=ei([{name:"a_pos_3f",components:3,type:"Float32"}]),_7=ei([{name:"a_color_3f",components:3,type:"Float32"}]),g7=ei([{name:"a_color_4f",components:4,type:"Float32"}]),y7=ei([{name:"a_uv_2f",components:2,type:"Float32"}]),x7=ei([{name:"a_normal_3f",components:3,type:"Float32"}]),v7=ei([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),C7=ei([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class yh{constructor(e,i,n,s){this.message=(e?`${e}: `:"")+n,s&&(this.identifier=s),i!=null&&i.__line__&&(this.line=i.__line__)}}function P5(t,e){const i=t.indexOf("://")===-1;try{return new URL(t,i&&e?"http://example.com":void 0),!0}catch{return!1}}class O5{constructor(e,i){this.feature=e,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class z5{constructor(){this.instancedDataArray=new y2,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class E0{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(e,i){}populate(e,i,n,s){this.tileToMeter=Su(n);const l=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:c,id:d,index:f,sourceLayerIndex:_}of e){const y=d??(c.properties&&c.properties.hasOwnProperty("id")?c.properties.id:void 0),v=ks(c,l);if(!this.layers[0]._featureFilter.filter(new dt(this.zoom),v,n))continue;const C={id:y,sourceLayerIndex:_,index:f,geometry:l?v.geometry:Ln(c,n,s),properties:c.properties,type:c.type,patterns:{}},A=this.addFeature(C,C.geometry,v);A&&i.featureIndex.insert(c,C.geometry,f,_,this.index,this.instancesPerModel[A].instancedDataArray.length,je/32)}this.lookup=null}update(e,i,n,s){for(const l in this.instancesPerModel){const c=this.instancesPerModel[l];for(const d in e)c.idToFeaturesIndex.hasOwnProperty(d)&&(this.evaluate(c.features[c.idToFeaturesIndex[d]],e[d],c,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const i in this.instancesPerModel){const n=this.instancesPerModel[i];for(const s of n.features){const l=this.layers[0],c=s.feature,d=this.canonical,f=l.paint.get("model-rotation").evaluate(c,{},d),_=l.paint.get("model-scale").evaluate(c,{},d),y=l.paint.get("model-translation").evaluate(c,{},d);a.$.exactEquals(s.rotation,f)&&a.$.exactEquals(s.scale,_)&&a.$.exactEquals(s.translation,y)||(this.evaluate(s,s.featureStates,n,!0),e=!0)}}return e}updateReplacement(e,i,n,s){if(i.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=i.updateTime;const l=i.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(t0(this.activeReplacements,l))return!1;this.activeReplacements=l;let c=!1;for(const d in this.instancesPerModel){const f=this.instancesPerModel[d],_=f.instancedDataArray;for(const y of f.features){const v=y.instancedDataOffset,C=y.instancedDataCount;for(let A=0;A<C;A++){const M=16*(A+v);let I=_.float32[M+0];I=I>je?I-je:I;const P=Math.floor(I),D=_.float32[M+1];let V=!1;for(const N of this.activeReplacements)if(!xp(N,n,Dp.Model,s)&&!(N.min.x>P||P>N.max.x||N.min.y>D||D>N.max.y)&&(V=Tp(Ap(P,D,e.canonical,N.footprintTileId.canonical),N),V))break;_.float32[M]=V?I+je:I,c=c||V}}}return c}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const i in this.instancesPerModel){const n=this.instancesPerModel[i];n.instancedDataArray.length<0||n.instancedDataArray.length===0||(n.instancedDataBuffer?n.instancedDataBuffer.updateData(n.instancedDataArray):n.instancedDataBuffer=e.createVertexBuffer(n.instancedDataArray,v7.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const i in this.instancesPerModel){const n=this.instancesPerModel[i];n.instancedDataArray.length!==0&&n.instancedDataBuffer&&n.instancedDataBuffer.destroy()}const e=this.layers[0].modelManager;if(e&&this.modelUris)for(const i of this.modelUris)e.removeModel(i,"")}addFeature(e,i,n){const s=this.layers[0],l=s.layout.get("model-id").evaluate(n,{},this.canonical);if(!l)return Di(`modelId is not evaluated for layer ${s.id} and it is not going to get rendered.`),l;P5(l,!1)&&(this.modelUris.includes(l)||this.modelUris.push(l)),this.instancesPerModel[l]||(this.instancesPerModel[l]=new z5);const c=this.instancesPerModel[l],d=c.instancedDataArray,f=new O5(n,d.length);for(const _ of i)for(const y of _){if(y.x<0||y.x>=je||y.y<0||y.y>=je)continue;const v=(this.lookupDim-1)/je,C=this.lookupDim*(y.y*v|0)+y.x*v|0;if(this.lookup){if(this.lookup[C]!==0)continue;this.lookup[C]=1}this.instanceCount++;const A=d.length;d.resize(A+1),c.instancesEvaluatedElevation.push(0),d.float32[16*A]=y.x,d.float32[16*A+1]=y.y}return f.instancedDataCount=c.instancedDataArray.length-f.instancedDataOffset,f.instancedDataCount>0&&(e.id&&(c.idToFeaturesIndex[e.id]=c.features.length),c.features.push(f),this.evaluate(f,{},c,!1)),l}getModelUris(){return this.modelUris}evaluate(e,i,n,s){const l=this.layers[0],c=e.feature,d=this.canonical,f=e.rotation=l.paint.get("model-rotation").evaluate(c,i,d),_=e.scale=l.paint.get("model-scale").evaluate(c,i,d),y=e.translation=l.paint.get("model-translation").evaluate(c,i,d),v=l.paint.get("model-color").evaluate(c,i,d);v.a=l.paint.get("model-color-mix-intensity").evaluate(c,i,d);const C=[];this.maxVerticalOffset<y[2]&&(this.maxVerticalOffset=y[2]),this.maxScale=Math.max(Math.max(this.maxScale,_[0]),Math.max(_[1],_[2])),E5(C,f,_);const A=Math.round(100*v.a)+v.b/1.05;for(let M=0;M<e.instancedDataCount;++M){const I=e.instancedDataOffset+M,P=16*I,D=n.instancedDataArray.float32;let V=0;s&&(V=D[P+6]-n.instancesEvaluatedElevation[I]);const N=0|D[P+1];D[P]=(0|D[P])+v.r/1.05,D[P+1]=N+v.g/1.05,D[P+2]=A,D[P+3]=1/(d.z>10?this.tileToMeter:Su(d,N)),D[P+4]=y[0],D[P+5]=y[1],D[P+6]=y[2]+V,D[P+7]=C[0],D[P+8]=C[1],D[P+9]=C[2],D[P+10]=C[4],D[P+11]=C[5],D[P+12]=C[6],D[P+13]=C[8],D[P+14]=C[9],D[P+15]=C[10],n.instancesEvaluatedElevation[I]=y[2]}}}let D5,R5;oe(E0,"ModelBucket",{omit:["layers"]}),oe(z5,"PerModelAttributes"),oe(O5,"ModelFeature");const tl=64,I1={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function L5(t,e,i,n,s,l,c,d,f,_=!1){const y=i.zoom,v=i.project(n),C=Xo(n.lat,y),A=1/C;a.ae.identity(t),a.ae.translate(t,t,[v.x+c[0]*A,v.y+c[1]*A,c[2]]);let M=1,I=1;const P=i.worldSize;if(_){if(i.projection.name==="mercator"){let U=0;i.elevation&&(U=i.elevation.getAtPointOrZero(new yr(v.x/P,v.y/P),0));const X=a.aB.transformMat4([],[v.x,v.y,U,1],i.projMatrix)[3]/i.cameraToCenterDistance;M=X,I=X*Xo(i.center.lat,y)}else if(i.projection.name==="globe"){const U=S0(t,i),X=a.ae.multiply([],i.projMatrix,U),Y=[0,0,0,1];a.aB.transformMat4(Y,Y,X);const ee=Y[3]/i.cameraToCenterDistance,le=Fs(y),pe=i.projection.pixelsPerMeter(n.lat,P)*Xo(n.lat,y),xe=i.projection.pixelsPerMeter(i.center.lat,P)*Xo(i.center.lat,y);M=ee/lt(pe,bd(i.center.lat),le),I=ee*C/pe,M*=xe,I*=xe}}else M=A;a.ae.scale(t,t,[M,M,I]);const D=[...t],V=e.orientation,N=[];if(E5(N,[V[0]+s[0],V[1]+s[1],V[2]+s[2]],l),a.ae.multiply(t,D,N),d&&i.elevation){let U=0;const X=[];if(f&&i.elevation){U=function(le,pe,xe,fe,we){const De=pe.elevation;if(!De)return 0;const Ae=vi.projectAabbCorners(xe,fe),ke=Mr(1,we.lat)*pe.worldSize,be=function(ht,it){const Ke=[0,0,1],mt=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const xt of mt){const _t=ht[xt.corners[0]],Mt=ht[xt.corners[1]],Ft=ht[xt.corners[2]],Rt=[Mt[0]-_t[0],Mt[1]-_t[1],it*(Mt[2]-_t[2])],oi=a.$.cross(Rt,Rt,[Ft[0]-_t[0],Ft[1]-_t[1],it*(Ft[2]-_t[2])]);a.$.normalize(oi,oi),xt.dotProductWithUp=a.$.dot(oi,Ke)}return mt.sort((xt,_t)=>xt.dotProductWithUp-_t.dotProductWithUp),mt[0].corners}(Ae,ke),Ee=Ae[be[0]],Fe=Ae[be[1]],Te=Ae[be[2]],Ve=Ae[be[3]],Be=De.getAtPointOrZero(new yr(Ee[0]/pe.worldSize,Ee[1]/pe.worldSize),0),Re=De.getAtPointOrZero(new yr(Fe[0]/pe.worldSize,Fe[1]/pe.worldSize),0),rt=De.getAtPointOrZero(new yr(Te[0]/pe.worldSize,Te[1]/pe.worldSize),0),tt=De.getAtPointOrZero(new yr(Ve[0]/pe.worldSize,Ve[1]/pe.worldSize),0),He=(Be+tt)/2,Ne=(Re+rt)/2;return He>Ne?Re<rt?gh(le,Fe,Ve,Ee,Re,tt,Be,ke):gh(le,Te,Ee,Ve,rt,Be,tt,ke):Be<tt?gh(le,Ee,Fe,Te,Be,Re,rt,ke):gh(le,Ve,Te,Fe,tt,rt,Re,ke),Math.max(He,Ne)}(X,i,e.aabb,t,n);const Y=a.ae.fromQuat([],X),ee=a.ae.multiply([],Y,N);a.ae.multiply(t,D,ee)}else U=i.elevation.getAtPointOrZero(new yr(v.x/P,v.y/P),0);U!==0&&(t[14]+=U)}}function f3(t,e,i=!1){t.uploaded||(t.gfxTexture=new vn(e,t.image,i?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function b7(t,e,i){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,m7.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,x7.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,y7.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?_7:g7).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,C7.members,!0)),t.segments=wi.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const n=t.material;n.pbrMetallicRoughness.baseColorTexture&&f3(n.pbrMetallicRoughness.baseColorTexture,e),n.pbrMetallicRoughness.metallicRoughnessTexture&&f3(n.pbrMetallicRoughness.metallicRoughnessTexture,e),n.normalTexture&&f3(n.normalTexture,e),n.occlusionTexture&&f3(n.occlusionTexture,e,i),n.emissionTexture&&f3(n.emissionTexture,e)}function I0(t,e,i){if(t.meshes)for(const n of t.meshes)b7(n,e,i);if(t.children)for(const n of t.children)I0(n,e,i)}function xh(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)xh(e)}function P0(t){if(t.meshes)for(const i of t.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((e=i.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const i of t.children)P0(i)}class w7{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class A7{constructor(){this.tasks={},this.taskQueue=[],Ml(["process"],this),this.invoker=new w7(this.process),this.nextId=0}add(e,i){const n=this.nextId++,s=function({type:l,isSymbolTile:c,zoom:d}){return d=d||0,l==="message"?0:l!=="maybePrepare"||c?l!=="parseTile"||c?l==="parseTile"&&c?300-d:l==="maybePrepare"&&c?400-d:500:200-d:100-d}(i);if(s===0){try{e()}finally{}return null}return this.tasks[n]={fn:e,metadata:i,priority:s,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(n=>!!this.tasks[n]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let s=0;s<this.taskQueue.length;s++){const l=this.tasks[this.taskQueue[s]];l.priority<i&&(i=l.priority,e=s)}if(e===null)return null;const n=this.taskQueue[e];return this.taskQueue.splice(e,1),n}remove(){this.invoker.remove()}}class k5{constructor(e,i,n){this.target=e,this.parent=i,this.mapId=n,this.callbacks={},this.cancelCallbacks={},Ml(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new A7}send(e,i,n,s,l=!1,c){const d=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=c,this.callbacks[d]=n);const f=new Set;return this.target.postMessage({id:d,type:e,hasCallback:!!n,targetMapId:s,mustQueue:l,sourceMapId:this.mapId,data:de(i,f)},f),{cancel:()=>{n&&delete this.callbacks[d],this.target.postMessage({id:d,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(e){const i=e.data,n=i.id;if(n&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const s=this.cancelCallbacks[n];delete this.cancelCallbacks[n],s&&s.cancel()}else if(i.mustQueue||ca()){const s=this.callbacks[n],l=this.scheduler.add(()=>this.processTask(n,i),s&&s.metadata||{type:"message"});l&&(this.cancelCallbacks[n]=l)}else this.processTask(n,i)}processTask(e,i){if(delete this.cancelCallbacks[e],i.type==="<response>"){const n=this.callbacks[e];delete this.callbacks[e],n&&(i.error?n(Ce(i.error)):n(null,Ce(i.data)))}else{const n=new Set,s=i.hasCallback?(c,d)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:c?de(c):null,data:de(d,n)},n)}:c=>{},l=Ce(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,l,s);else if(this.parent.getWorkerSource){const c=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,c[0],l.source,l.scope)[c[1]](l,s)}else s(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class P1{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Tl();const n=this.workerPool.acquire(this.id);for(let s=0;s<n.length;s++){const l=new P1.Actor(n[s],i,this.id);l.name=`Worker ${s}`,this.actors.push(l)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,i,n){so(this.actors,(s,l)=>{s.send(e,i,l)},n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}P1.Actor=k5;var m3={workerUrl:"",workerClass:null,workerParams:void 0};function T7(){return m3.workerClass!=null?new m3.workerClass:new self.Worker(m3.workerUrl,m3.workerParams)}const O0="mapboxgl_preloaded_worker_pool";class _3{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<_3.workerCount;)this.workers.push(new T7);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[O0]}numActive(){return Object.keys(this.active).length}}let g3;function vh(){return g3||(g3=new _3),g3}_3.workerCount=2;let Ch,z0,Vn,O1,D0,z1=null;function B5(){return ca()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:z0||st.DRACO_URL}function F5(){if(ca()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(O1)return O1;const t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return O1=WebAssembly.validate(t)?st.MESHOPT_SIMD_URL:st.MESHOPT_URL,O1}const bh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M7={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},y3={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function j5(t,e,i){const n=i.json.bufferViews.length,s=i.buffers.length;e.bufferView=n,i.json.bufferViews[n]={buffer:s,byteLength:t.byteLength},i.buffers[s]=t}const R0="KHR_draco_mesh_compression";function S7(t,e){const i=t.extensions&&t.extensions[R0];if(!i)return;const n=new Vn.Decoder,s=Z5(e,i.bufferView),l=new Vn.Mesh;if(!n.DecodeArrayToMesh(s,s.byteLength,l))throw new Error("Failed to decode Draco mesh");const c=e.json.accessors[t.indices],d=bh[c.componentType],f=c.count*d.BYTES_PER_ELEMENT,_=Vn._malloc(f);d===Uint16Array?n.GetTrianglesUInt16Array(l,f,_):n.GetTrianglesUInt32Array(l,f,_),j5(Vn.memory.buffer.slice(_,_+f),c,e),Vn._free(_);for(const y of Object.keys(i.attributes)){const v=n.GetAttributeByUniqueId(l,i.attributes[y]),C=e.json.accessors[t.attributes[y]],A=M7[C.componentType],M=C.count*y3[C.type]*bh[C.componentType].BYTES_PER_ELEMENT,I=Vn._malloc(M);n.GetAttributeDataArrayForAllPoints(l,v,Vn[A],M,I),j5(Vn.memory.buffer.slice(I,I+M),C,e),Vn._free(I)}n.destroy(),l.destroy(),delete t.extensions[R0]}const wh="EXT_meshopt_compression";function E7(t,e){if(!t.extensions||!t.extensions[wh])return;const i=t.extensions[wh],n=new Uint8Array(e.buffers[i.buffer],i.byteOffset||0,i.byteLength||0),s=new Uint8Array(i.count*i.byteStride);D0.decodeGltfBuffer(s,i.count,i.byteStride,n,i.mode,i.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=s.buffer,delete t.extensions[wh]}const N5=1179937895,V5=new TextDecoder("utf8");function U5(t,e){return new URL(t,e).href}function I7(t,e,i,n){return fetch(U5(t.uri,n)).then(s=>s.arrayBuffer()).then(s=>{e.buffers[i]=s})}function Z5(t,e){const i=t.json.bufferViews[e];return new Uint8Array(t.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function P7(t,e,i,n){if(t.uri){const s=U5(t.uri,n);return fetch(s).then(l=>l.blob()).then(l=>createImageBitmap(l)).then(l=>{e.images[i]=l})}if(t.bufferView!==void 0){const s=Z5(e,t.bufferView),l=new Blob([s],{type:t.mimeType});return createImageBitmap(l).then(c=>{e.images[i]=c})}}function $5(t,e=0,i){const n={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===N5){const y=new Uint32Array(t,e);let v=2;const C=(y[v++]>>2)-3,A=y[v++]>>2;if(v++,n.json=JSON.parse(V5.decode(y.subarray(v,v+A))),v+=A,v<C){const M=y[v++];v++;const I=e+(v<<2);n.buffers[0]=t.slice(I,I+M)}}else n.json=JSON.parse(V5.decode(new Uint8Array(t,e)));const{buffers:s,images:l,meshes:c,extensionsUsed:d,bufferViews:f}=n.json;let _=Promise.resolve();if(s){const y=[];for(let v=0;v<s.length;v++){const C=s[v];C.uri?y.push(I7(C,n,v,i)):n.buffers[v]||(n.buffers[v]=null)}_=Promise.all(y)}return _.then(()=>{const y=[],v=d&&d.includes(R0),C=d&&d.includes(wh);if(v&&y.push(function(){if(!Vn)return Ch||(Ch=function(A){let M,I=null;function P(){M=new Uint8Array(I.buffer)}function D(){throw new Error("Unexpected Draco error.")}const V={a:{a:D,d:function(N,U,X){return M.copyWithin(N,U,U+X)},c:function(N){const U=M.length,X=Math.max(N>>>0,Math.ceil(1.2*U)),Y=Math.ceil((X-U)/65536);try{return I.grow(Y),P(),!0}catch{return!1}},b:D}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(A,V):A.then(N=>N.arrayBuffer()).then(N=>WebAssembly.instantiate(N,V))).then(N=>{const{Rb:U,Qb:X,P:Y,T:ee,X:le,Ja:pe,La:xe,Qa:fe,Va:we,Wa:De,eb:Ae,jb:ke,f:be,e:Ee,yb:Fe,zb:Te,Ab:Ve,Bb:Be,Db:Re,Gb:rt}=N.instance.exports;I=Ee;const tt=(()=>{let He=0,Ne=0,ht=0,it=0;return Ke=>{ht&&(U(it),U(He),Ne+=ht,ht=He=0),He||(Ne+=128,He=X(Ne));const mt=Ke.length+7&-8;let xt=He;mt>=Ne&&(ht=mt,xt=it=X(mt));for(let _t=0;_t<Ke.length;_t++)M[xt+_t]=Ke[_t];return xt}})();return P(),be(),{memory:Ee,_free:U,_malloc:X,Mesh:class{constructor(){this.ptr=Y()}destroy(){ee(this.ptr)}},Decoder:class{constructor(){this.ptr=pe()}destroy(){ke(this.ptr)}DecodeArrayToMesh(He,Ne,ht){const it=tt(He),Ke=xe(this.ptr,it,Ne,ht.ptr);return!!le(Ke)}GetAttributeByUniqueId(He,Ne){return{ptr:fe(this.ptr,He.ptr,Ne)}}GetTrianglesUInt16Array(He,Ne,ht){we(this.ptr,He.ptr,Ne,ht)}GetTrianglesUInt32Array(He,Ne,ht){De(this.ptr,He.ptr,Ne,ht)}GetAttributeDataArrayForAllPoints(He,Ne,ht,it,Ke){Ae(this.ptr,He.ptr,Ne.ptr,ht,it,Ke)}},DT_INT8:Fe(),DT_UINT8:Te(),DT_INT16:Ve(),DT_UINT16:Be(),DT_UINT32:Re(),DT_FLOAT32:rt()}})}(fetch(B5())),Ch.then(A=>{Vn=A,Ch=void 0}))}()),C&&y.push(function(){if(D0)return;const A=function(M){let I;const P=WebAssembly.instantiateStreaming(M,{}).then(N=>{I=N.instance,I.exports.__wasm_call_ctors()}),D={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},V={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:P,supported:!0,decodeGltfBuffer(N,U,X,Y,ee,le){(function(pe,xe,fe,we,De,Ae,ke){const be=pe.exports.sbrk,Ee=we+3&-4,Fe=be(Ee*De),Te=be(Ae.length),Ve=new Uint8Array(pe.exports.memory.buffer);Ve.set(Ae,Te);const Be=xe(Fe,we,De,Te,Ae.length);if(Be===0&&ke&&ke(Fe,Ee,De),fe.set(Ve.subarray(Fe,Fe+we*De)),be(Fe-be(0)),Be!==0)throw new Error(`Malformed buffer data: ${Be}`)})(I,I.exports[V[ee]],N,U,X,Y,I.exports[D[le]])}}}(fetch(F5()));return A.ready.then(()=>{D0=A})}()),l)for(let A=0;A<l.length;A++)y.push(P7(l[A],n,A,i));return(y.length?Promise.all(y):Promise.resolve()).then(()=>{if(v&&c)for(const{primitives:A}of c)for(const M of A)S7(M,n);if(C&&c&&f)for(const A of f)E7(A,n);return n})})}function il(t,e){const i=t.json.bufferViews[e.bufferView],n=bh[e.componentType];return new n(t.buffers[i.buffer],(e.byteOffset||0)+(i.byteOffset||0),e.count*(i.byteStride&&i.byteStride!==y3[e.type]*n.BYTES_PER_ELEMENT?i.byteStride/n.BYTES_PER_ELEMENT:y3[e.type]))}function L0(t,e,i,n){const s=bh[e.componentType],l=function(y){switch(y){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(s),c=t.json.bufferViews[e.bufferView],d=c.byteStride?c.byteStride/s.BYTES_PER_ELEMENT:y3[e.type],f=i.float32,_=f.length/i.capacity;for(let y=0,v=0;y<e.count*d;y+=d,v+=_)for(let C=0;C<_;C++)f[v+C]=n[y+C]*l;i._trim()}function O7(t,e,i){const n=t.indices,s=t.attributes,l={};l.indexArray=new Hi;const c=e.json.accessors[n],d=c.count/3;l.indexArray.reserve(d);const f=il(e,c);for(let C=0;C<d;C++)l.indexArray.emplaceBack(f[3*C],f[3*C+1],f[3*C+2]);l.indexArray._trim(),l.vertexArray=new Ma;const _=e.json.accessors[s.POSITION];l.vertexArray.reserve(_.count);const y=il(e,_);for(let C=0;C<_.count;C++)l.vertexArray.emplaceBack(y[3*C],y[3*C+1],y[3*C+2]);if(l.vertexArray._trim(),l.aabb=new vi(_.min,_.max),l.centroid=function(C,A){const M=[0,0,0],I=C.length;if(I>0){for(let P=0;P<I;P++){const D=3*C[P];M[0]+=A[D],M[1]+=A[D+1],M[2]+=A[D+2]}M[0]/=I,M[1]/=I,M[2]/=I}return M}(f,y),s.COLOR_0!==void 0){const C=e.json.accessors[s.COLOR_0],A=y3[C.type],M=il(e,C);l.colorArray=A===3?new Ma:new Ta,l.colorArray.resize(C.count),L0(e,C,l.colorArray,M)}if(s.NORMAL!==void 0){l.normalArray=new Ma;const C=e.json.accessors[s.NORMAL];l.normalArray.resize(C.count);const A=il(e,C);L0(e,C,l.normalArray,A)}if(s.TEXCOORD_0!==void 0&&i.length>0){l.texcoordArray=new Lc;const C=e.json.accessors[s.TEXCOORD_0];l.texcoordArray.resize(C.count);const A=il(e,C);L0(e,C,l.texcoordArray,A)}if(s._FEATURE_ID_RGBA4444!==void 0){const C=e.json.accessors[s._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(l.featureData=il(e,C))}s._FEATURE_RGBA4444!==void 0&&(l.featureData=new Uint32Array(il(e,e.json.accessors[s._FEATURE_RGBA4444]).buffer));const v=t.material;return l.material=function(C,A){const{emissiveFactor:M=[0,0,0],alphaMode:I="OPAQUE",alphaCutoff:P=.5,normalTexture:D,occlusionTexture:V,emissiveTexture:N,doubleSided:U}=C,{baseColorFactor:X=[1,1,1,1],metallicFactor:Y=1,roughnessFactor:ee=1,baseColorTexture:le,metallicRoughnessTexture:pe}=C.pbrMetallicRoughness||{},xe=V?A[V.index]:void 0;if(V&&V.extensions&&V.extensions.KHR_texture_transform&&xe){const fe=V.extensions.KHR_texture_transform;xe.offsetScale=[fe.offset[0],fe.offset[1],fe.scale[0],fe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Yt(...X),metallicFactor:Y,roughnessFactor:ee,baseColorTexture:le?A[le.index]:void 0,metallicRoughnessTexture:pe?A[pe.index]:void 0},doubleSided:U,emissiveFactor:M,alphaMode:I,alphaCutoff:P,normalTexture:D?A[D.index]:void 0,occlusionTexture:xe,emissionTexture:N?A[N.index]:void 0,defined:C.defined===void 0}}(v!==void 0?e.json.materials[v]:{defined:!1},i),l}function G5(t,e,i){const{matrix:n,rotation:s,translation:l,scale:c,mesh:d,extras:f,children:_}=t,y={};if(y.matrix=n||a.ae.fromRotationTranslationScale([],s||[0,0,0,1],l||[0,0,0],c||[1,1,1]),d!==void 0){y.meshes=i[d];const v=y.anchor=[0,0];for(const C of y.meshes){const{min:A,max:M}=C.aabb;v[0]+=A[0]+M[0],v[1]+=A[1]+M[1]}v[0]=Math.floor(v[0]/y.meshes.length/2),v[1]=Math.floor(v[1]/y.meshes.length/2)}if(f&&(f.id&&(y.id=f.id),f.lights&&(y.lights=function(v){if(!v.length)return[];const C=function(D){const V=atob(D),N=new Uint8Array(V.length);for(let U=0;U<V.length;U++)N[U]=V.codePointAt(U);return N}(v),A=[],M=C.length/24,I=new Uint16Array(C.buffer),P=new Float32Array(C.buffer);for(let D=0;D<M;D++){const V=I[2*D*6]/30,N=I[2*D*6+1]/30,U=I[2*D*6+10]/100,X=P[6*D+1],Y=P[6*D+2],ee=P[6*D+3],le=P[6*D+4],pe=ee-X,xe=le-Y,fe=Math.hypot(pe,xe);A.push({pos:[X+.5*pe,Y+.5*xe,N],normal:[xe/fe,-pe/fe,0],width:fe,height:V,depth:U,points:[X,Y,ee,le]})}return A}(f.lights))),_){const v=[];for(const C of _)v.push(G5(e.json.nodes[C],e,i));y.children=v}return y}function z7(t){if(t.vertices.length===0||t.indices.length===0)return null;const e=new K2(t.vertices,t.indices,8,256),[i,n]=[e.min.clone(),e.max.clone()];return{vertices:t.vertices,indices:t.indices,grid:e,min:i,max:n}}function D7(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const i=e[0];if(!i||!Array.isArray(i)||i.length===0)return null;const n=[];for(const c of i){if(!Array.isArray(c)||c.length!==2)continue;const d=c[0],f=c[1];typeof d=="number"&&typeof f=="number"&&n.push(new Ze(d,f))}if(n.length<3)return null;n.length>1&&n[n.length-1].equals(n[0])&&n.pop();let s=0;for(let c=0;c<n.length;c++){const d=n[c],f=n[(c+1)%n.length],_=n[(c+2)%n.length];s+=(d.x-f.x)*(_.y-f.y)-(_.x-f.x)*(d.y-f.y)}s>0&&n.reverse();const l=$c(n.flatMap(c=>[c.x,c.y]),[]);return l.length===0?null:{vertices:n,indices:l}}function R7(t,e){const i=[],n=[];let s=0;const l=[];for(const c of t){s=i.length;const d=c.vertexArray.float32,f=c.indexArray.uint16;for(let _=0;_<c.vertexArray.length;_++)l[0]=d[3*_+0],l[1]=d[3*_+1],l[2]=d[3*_+2],a.$.transformMat4(l,l,e),i.push(new Ze(l[0],l[1]));for(let _=0;_<3*c.indexArray.length;_++)n.push(f[_]+s)}if(n.length%3!=0)return null;for(let c=0;c<n.length;c+=3){const d=i[n[c+0]],f=i[n[c+1]],_=i[n[c+2]];(d.x-f.x)*(_.y-f.y)-(_.x-f.x)*(d.y-f.y)>0&&([n[c+1],n[c+2]]=[n[c+2],n[c+1]])}return{vertices:i,indices:n}}function q5(t){const e=function(f,_){const y=[],v=WebGL2RenderingContext;if(f.json.textures)for(const C of f.json.textures){const A={magFilter:v.LINEAR,minFilter:v.NEAREST,wrapS:v.REPEAT,wrapT:v.REPEAT};C.sampler!==void 0&&Object.assign(A,f.json.samplers[C.sampler]),y.push({image:_[C.source],sampler:A,uploaded:!1})}return y}(t,t.images),i=function(f,_){const y=[];for(const v of f.json.meshes){const C=[];for(const A of v.primitives)C.push(O7(A,f,_));y.push(C)}return y}(t,e),{scenes:n,scene:s,nodes:l}=t.json,c=n?n[s||0].nodes:l,d=[];for(const f of c)d.push(G5(l[f],t,i));return function(f,_,y){const v={},C=new Set;for(let A=0;A<f.length;A++){const M=y[_[A]];if(!M.extras)continue;const I=M.extras["mapbox:footprint:version"],P=M.extras["mapbox:footprint:id"];(I||P)&&C.add(A),I==="1.0.0"&&P&&(v[P]=A)}for(let A=0;A<f.length;A++){if(C.has(A))continue;const M=f[A],I=y[_[A]];if(!I.extras)continue;let P=null;M.id in v&&(P=R7(f[v[M.id]].meshes,M.matrix)),P||(P=D7(I)),P&&(M.footprint=z7(P))}if(C.size>0){const A=Array.from(C.values()).sort((M,I)=>M-I);for(let M=A.length-1;M>=0;M--)f.splice(A[M],1)}}(d,c,t.json.nodes),d}function L7(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);const e=t.vertexArray.float32,i=t.aabb.min[0]-1,n=t.aabb.min[1]-1,s=tl/(t.aabb.max[0]-i+2),l=tl/(t.aabb.max[1]-n+2);for(let c=0;c<e.length;c+=3){const d=e[c+2],f=(e[c+0]-i)*s|0,_=(e[c+1]-n)*l|0;d>t.heightmap[_*tl+f]&&(t.heightmap[_*tl+f]=d)}}function k7(t,e){const i={};i.indexArray=new Hi,i.indexArray.reserve(4*t.length),i.vertexArray=new Ma,i.vertexArray.reserve(10*t.length),i.colorArray=new Ta,i.vertexArray.reserve(10*t.length);let n=0;for(const c of t){const d=Math.min(10,Math.max(4,1.3*c.height))*e,f=[-c.normal[1],c.normal[0],0],_=Math.min(.29,.1*c.width/c.depth),y=c.width-2*c.depth*e*(_+.01),v=a.$.scaleAndAdd([],c.pos,f,y/2),C=a.$.scaleAndAdd([],c.pos,f,-y/2),A=[v[0],v[1],v[2]+c.height],M=[C[0],C[1],C[2]+c.height],I=a.$.scaleAndAdd([],c.normal,f,_);a.$.scale(I,I,d);const P=a.$.scaleAndAdd([],c.normal,f,-_);a.$.scale(P,P,d),a.$.add(I,v,I),a.$.add(P,C,P),v[2]+=.1,C[2]+=.1,i.vertexArray.emplaceBack(I[0],I[1],I[2]),i.vertexArray.emplaceBack(P[0],P[1],P[2]),i.vertexArray.emplaceBack(v[0],v[1],v[2]),i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(A[0],A[1],A[2]),i.vertexArray.emplaceBack(M[0],M[1],M[2]),i.vertexArray.emplaceBack(v[0],v[1],v[2]),i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(I[0],I[1],I[2]),i.vertexArray.emplaceBack(P[0],P[1],P[2]);const D=y/d/2;i.colorArray.emplaceBack(-D-_,-1,D,.8),i.colorArray.emplaceBack(D+_,-1,D,.8),i.colorArray.emplaceBack(-D,0,D,1.3),i.colorArray.emplaceBack(D,0,D,1.3),i.colorArray.emplaceBack(D+_,-.8,D,.7),i.colorArray.emplaceBack(D+_,-.8,D,.7),i.colorArray.emplaceBack(0,0,D,1.3),i.colorArray.emplaceBack(0,0,D,1.3),i.colorArray.emplaceBack(D+_,-1.2,D,.8),i.colorArray.emplaceBack(D+_,-1.2,D,.8),i.indexArray.emplaceBack(6+n,4+n,8+n),i.indexArray.emplaceBack(7+n,9+n,5+n),i.indexArray.emplaceBack(0+n,1+n,2+n),i.indexArray.emplaceBack(1+n,3+n,2+n),n+=10}const s={defined:!0,emissiveFactor:[0,0,0]},l={};return l.baseColorFactor=Yt.white,s.pbrMetallicRoughness=l,i.material=s,i.aabb=new vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}const k0=new Float32Array(262144),rl=new Uint8Array(262144);function W5(t){let e=0;if(t.meshes)for(const i of t.meshes)e=Math.max(e,i.aabb.max[2]);if(t.children)for(const i of t.children)e=Math.max(e,W5(i));return e}function H5(t,e,i){if(t.meshes)for(const n of t.meshes)n.aabb.min[0]!==1/0&&i.insert(e,n.aabb.min[0],n.aabb.min[1],n.aabb.max[0],n.aabb.max[1]);if(t.children)for(const n of t.children)H5(n,e,i)}const X5=["","wall","door","roof","window","lamp","logo"];class Y5{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:W5(e)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const i=new vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const n of this.node.meshes)this.node.lightMeshIndex!==e&&(n.transformedAabb=vi.applyTransformFast(n.aabb,this.node.matrix),i.encapsulate(n.transformedAabb)),e++;this.aabb=i}return this.aabb}}class Ah{constructor(e,i,n,s,l,c){this.id=i,this.modelTraits|=I1.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,n&&(this.modelTraits|=I1.HasMapboxMeshFeatures),s&&(this.modelTraits|=I1.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=l,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const d of e)this.nodesInfo.push(new Y5(d)),H5(d,c.featureIndexArray.length,c.grid),c.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,c.bucketLayerIDs.length-1,0)}updateFootprints(e,i){for(const n of this.getNodesInfo()){const s=n.node;s.footprint&&i.push({footprint:s.footprint,id:e})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const n of i){const s=n.node;this.uploaded?this.updatePbrBuffer(s):I0(s,e,!0)}for(const n of i)xh(n.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let i=!1;if(!e.meshes)return i;for(const n of e.meshes)n.pbrBuffer&&(n.pbrBuffer.updateData(n.featureArray),i=!0);return i}needsReEvaluation(e,i,n){const s=e.transform.projectionOptions,l=e.style.getBrightness(),c=this.brightness!==l;return!!(!this.uploaded||this.dirty||s.name!==this.projection.name||x3(n.paint.get("model-color").value,c)||x3(n.paint.get("model-color-mix-intensity").value,c)||x3(n.paint.get("model-roughness").value,c)||x3(n.paint.get("model-emissive-strength").value,c)||x3(n.paint.get("model-height-based-emissive-strength-multiplier").value,c))&&(this.projection=s,this.brightness=l,!0)}evaluateScale(e,i){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const n=this.getNodesInfo(),s=this.id.canonical;for(const l of n){const c=l.feature;l.evaluatedScale=i.paint.get("model-scale").evaluate(c,{},s)}}evaluate(e){const i=this.getNodesInfo();for(const n of i){if(!n.node.meshes)continue;const s=n.feature,l=n.node.meshes&&n.node.meshes[0].featureData,c=n.evaluatedColor[2],d=n.evaluatedRMEA[2],f=this.id.canonical;if(n.hasTranslucentParts=!1,l){for(let _=0;_<X5.length;_++){const y=X5[_];y.length&&(s.properties.part=y);const v=e.paint.get("model-color").evaluate(s,{},f).toRenderColor(null),C=e.paint.get("model-color-mix-intensity").evaluate(s,{},f);n.evaluatedColor[_]=[v.r,v.g,v.b,C],n.evaluatedRMEA[_][0]=e.paint.get("model-roughness").evaluate(s,{},f),n.evaluatedRMEA[_][2]=e.paint.get("model-emissive-strength").evaluate(s,{},f),n.evaluatedRMEA[_][3]=v.a,n.emissionHeightBasedParams[_]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(s,{},f),!n.hasTranslucentParts&&v.a<1&&(n.hasTranslucentParts=!0)}delete s.properties.part,F7(n,c!==n.evaluatedColor[2]||d!==n.evaluatedRMEA[2],this.modelTraits)}else n.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(s,{},f);n.evaluatedScale=e.paint.get("model-scale").evaluate(s,{},f),this.updatePbrBuffer(n.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,i,n,s){const l=e.findDEMTileFor(n);if(l&&(l.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(l.dem&&l.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=l.tileID.overscaledZ;const c=y1.create(e,n,l);if(!c)return;this.modelTraits&I1.HasMapboxMeshFeatures&&this.updateDEM(e,c,n,s);for(const d of this.getNodesInfo()){const f=d.node;if(!f.footprint||!f.footprint.vertices||!f.footprint.vertices.length)continue;const _=f.footprint.vertices;let y=c.getElevationAt(_[0].x,_[0].y,!0,!0);for(let v=1;v<_.length;v++)y=Math.min(y,c.getElevationAt(_[v].x,_[v].y,!0,!0));f.elevation=y}}this.terrainTile=l.tileID.canonical,this.terrainExaggeration=i}}updateDEM(e,i,n,s){let l=i._dem._modifiedForSources[s];if(l===void 0&&(i._dem._modifiedForSources[s]=[],l=i._dem._modifiedForSources[s]),l.includes(n.canonical))return;const c=i._dem.dim;l.push(n.canonical);let d=!1;for(const f of this.getNodesInfo()){const _=f.node;if(!_.footprint||!_.footprint.grid)continue;const y=_.footprint.grid,v=i.tileCoordToPixel(y.min.x,y.min.y),C=i.tileCoordToPixel(y.max.x,y.max.y),A=Math.min(Math.min(c-C.y,v.x),Math.min(v.y,c-C.x));if(A<0)continue;const M=Pt(A,2,5);let I=Math.max(0,v.x-M),P=Math.max(0,v.y-M),D=Math.min(C.x+M,c-1),V=Math.min(C.y+M,c-1);for(let Y=P;Y<=V;++Y)for(let ee=I;ee<=D;++ee)rl[Y*c+ee]=255;let N=0,U=0;for(let Y=0;Y<y.cellsY;++Y)for(let ee=0;ee<y.cellsX;++ee){if(!y.cells[Y*y.cellsX+ee])continue;const le=i.tileCoordToPixel(y.min.x+ee/y.xScale,y.min.y+Y/y.yScale),pe=i.tileCoordToPixel(y.min.x+(ee+1)/y.xScale,y.min.y+(Y+1)/y.yScale);for(let xe=le.y;xe<=Math.min(pe.y+1,c-1);++xe)for(let fe=le.x;fe<=Math.min(pe.x+1,c-1);++fe)rl[xe*c+fe]===255&&(rl[xe*c+fe]=0,N+=i.getElevationAtPixel(fe,xe),U++)}const X=N/U;I=Math.max(1,v.x-M),P=Math.max(1,v.y-M),D=Math.min(C.x+M,c-2),V=Math.min(C.y+M,c-2),d=!0;for(let Y=P;Y<=V;++Y)for(let ee=I;ee<=D;++ee)rl[Y*c+ee]===0&&(k0[Y*c+ee]=i._dem.set(ee,Y,X));for(let Y=1;Y<M;++Y){I=Math.max(1,v.x-Y),P=Math.max(1,v.y-Y),D=Math.min(C.x+Y,c-2),V=Math.min(C.y+Y,c-2);for(let ee=P;ee<=V;++ee)for(let le=I;le<=D;++le){const pe=ee*c+le;if(rl[pe]===255){let xe=0,fe=0,we=-1,De=-1;for(let Ae=-1;Ae<=1;++Ae)for(let ke=-1;ke<=1;++ke){const be=(ee+Ae)*c+le+ke;if(rl[be]>=Y)continue;const Ee=k0[be],Fe=Math.abs(Ee);Fe>fe&&(xe=Ee,fe=Fe,we=ke,De=Ae)}if(fe>.1){const Ae=1-(Y+.5*Math.abs(we*De))/M;let ke=i._dem.get(le,ee)+xe*Ae;const be=i._dem.get(le+we,ee+De),Ee=i._dem.get(le-we,ee-De,!0);(ke-be)*(ke-Ee)>0&&(ke=(be+Ee)/2),k0[pe]=i._dem.set(le,ee,ke),rl[pe]=Y}}}}}d&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=sr.now())}getNodesInfo(){return this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const i of e)xh(i.node),P0(i.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const n=i.getReplacementRegionsForTile(e.toUnwrapped()),s=this.getNodesInfo();for(let l=0;l<this.nodesInfo.length;l++){const c=s[l].node;s[l].hiddenByReplacement=!!c.footprint&&!n.find(d=>d.footprint===c.footprint)}}getHeightAtTileCoord(e,i){const n=this.getNodesInfo(),s=[],l=[0,0,0],c=a.ae.identity([]);for(let d=0;d<this.nodesInfo.length;d++){const f=n[d],_=f.node.meshes[0],y=_.transformedAabb;if(e<y.min[0]||i<y.min[1]||e>y.max[0]||i>y.max[1])continue;if(f.node.hidden===!0)return{height:0,maxHeight:f.feature.properties.height,hidden:!1,verticalScale:f.evaluatedScale[2]};a.ae.invert(c,f.node.matrix),l[0]=e,l[1]=i,a.$.transformMat4(l,l,c);const v=(l[0]-_.aabb.min[0])/(_.aabb.max[0]-_.aabb.min[0])*tl|0,C=Math.min(63,(l[1]-_.aabb.min[1])/(_.aabb.max[1]-_.aabb.min[1])*tl|0)*tl+Math.min(63,v),A=_.heightmap[C];if(!(A<0&&f.node.footprint))return f.hiddenByReplacement?void 0:{height:A,maxHeight:f.feature.properties.height,hidden:!1,verticalScale:f.evaluatedScale[2]};if(f.node.footprint.grid.query(new Ze(e,i),new Ze(e,i),s),s.length>0)return{height:void 0,maxHeight:f.feature.properties.height,hidden:f.hiddenByReplacement,verticalScale:f.evaluatedScale[2]}}}}function x3(t,e){return!t.isLightConstant&&e}function B7(t,e,i,n,s,l,c,d){let f=(61440&e|(61440&e)>>4)>>8,_=(3840&e|(3840&e)>>4)>>4,y=240&e|(240&e)>>4;i[3]>0&&(f=lt(f,255*i[0],i[3]),_=lt(_,255*i[1],i[3]),y=lt(y,255*i[2],i[3]));const v=f<<8|_,C=y<<8|Math.floor(255*n[3]),A=function(Y){const ee=Pt(Y,0,2);return Math.min(Math.round(.5*ee*255),255)}(n[2])<<8|15*n[0]<<4|15*n[1],M=Pt(s[0],0,1),I=Pt(s[1],0,1),P=Pt(s[2],0,1),D=Pt(s[3],0,1);let V,N,U,X;if(M!==I&&c!==l&&I!==M){const Y=c-l;N=1/(Y*(I-M)),U=-(l+Y*M)/(Y*(I-M));const ee=Pt(s[4],-1,1);X=Math.pow(10,ee),V=255*P<<8|255*D}else V=65535,N=0,U=1,X=1;if(t.emplaceBack(v,C,A,V,N,U,X),d){const Y=d.length;d.clear();for(let ee=0;ee<Y;ee++)d.emplaceBack(v,C,A,V,N,U,X)}}function F7(t,e,i){const n=t.node;let s=0;const l=i&I1.HasMeshoptCompression;for(const c of n.meshes){if(n.lights&&n.lightMeshIndex===s||!c.featureData)continue;c.featureArray=new Au,c.featureArray.reserve(c.featureData.length);let d=e;for(const f of c.featureData){const _=l?65535&f:f>>16&65535,y=l?f>>16&65535:65535&f,v=(15&y)<8?15&y:0,C=t.evaluatedRMEA[v],A=t.evaluatedColor[v],M=t.emissionHeightBasedParams[v];let I;if(d&&v===2&&n.lights&&(I=new Au,I.resize(10*n.lights.length)),B7(c.featureArray,_,A,C,M,c.aabb.min[2],c.aabb.max[2],I),I&&d){d=!1;const P=n.meshes[n.lightMeshIndex];P.featureArray=I,P.featureArray._trim()}}c.featureArray._trim(),s++}}function J5(t,e,i,n){const s=1<<t.z;e.lat=Qi((n/je+t.y)/s),e.lng=Fr((i/je+t.x)/s)}oe(Ah,"Tiled3dModelBucket",{omit:["layers"]}),oe(Y5,"Tiled3dModelFeature");const j7={circle:class extends Br{constructor(t,e,i,n){super(t,{layout:zd||(zd=new ci({"circle-sort-key":new Qe(_e.layout_circle["circle-sort-key"]),visibility:new Le(_e.layout_circle.visibility)})),paint:Dd||(Dd=new ci({"circle-radius":new Qe(_e.paint_circle["circle-radius"]),"circle-color":new Qe(_e.paint_circle["circle-color"]),"circle-blur":new Qe(_e.paint_circle["circle-blur"]),"circle-opacity":new Qe(_e.paint_circle["circle-opacity"]),"circle-translate":new Le(_e.paint_circle["circle-translate"]),"circle-translate-anchor":new Le(_e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Le(_e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Le(_e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qe(_e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qe(_e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qe(_e.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Le(_e.paint_circle["circle-emissive-strength"])}))},e,i,n)}createBucket(t){return new R2(t)}queryRadius(t){const e=t;return m1("circle-radius",this,e)+m1("circle-stroke-width",this,e)+Pu(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,n,s,l,c,d){const f=Od(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),_=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return Hd(t,n,l,c,d,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",f,_)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e,i){const n=Wd(this);return{config:new qo(this,{zoom:e,lut:i}),defines:n,overrideFog:!1}}},heatmap:class extends Br{createBucket(t){return new Yd(t)}constructor(t,e,i,n){super(t,{layout:ep||(ep=new ci({visibility:new Le(_e.layout_heatmap.visibility)})),paint:tp||(tp=new ci({"heatmap-radius":new Qe(_e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qe(_e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Le(_e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new gr(_e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Le(_e.paint_heatmap["heatmap-opacity"])}))},e,i,n),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return m1("heatmap-radius",this,t)}queryIntersectsFeature(t,e,i,n,s,l,c,d){const f=this.paint.get("heatmap-radius").evaluate(e,i);return Hd(t,n,l,c,d,!0,!0,new Ze(0,0),f)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e,i){return t==="heatmap"?{config:new qo(this,{zoom:e,lut:i}),overrideFog:!1}:{}}},hillshade:class extends Br{constructor(t,e,i,n){super(t,{layout:ip||(ip=new ci({visibility:new Le(_e.layout_hillshade.visibility)})),paint:rp||(rp=new ci({"hillshade-illumination-direction":new Le(_e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Le(_e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Le(_e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Le(_e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Le(_e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Le(_e.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Le(_e.paint_hillshade["hillshade-emissive-strength"])}))},e,i,n)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e,i){return{overrideFog:!1}}},fill:class extends Br{constructor(t,e,i,n){super(t,{layout:lp||(lp=new ci({"fill-sort-key":new Qe(_e.layout_fill["fill-sort-key"]),visibility:new Le(_e.layout_fill.visibility)})),paint:cp||(cp=new ci({"fill-antialias":new Le(_e.paint_fill["fill-antialias"]),"fill-opacity":new Qe(_e.paint_fill["fill-opacity"]),"fill-color":new Qe(_e.paint_fill["fill-color"]),"fill-outline-color":new Qe(_e.paint_fill["fill-outline-color"]),"fill-translate":new Le(_e.paint_fill["fill-translate"]),"fill-translate-anchor":new Le(_e.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qe(_e.paint_fill["fill-pattern"]),"fill-emissive-strength":new Le(_e.paint_fill["fill-emissive-strength"])}))},e,i,n)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(t,e,i){return{config:new qo(this,{zoom:e,lut:i}),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new ju(t)}queryRadius(){return Pu(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,n,s,l){return!t.queryGeometry.isAboveHorizon&&Md(Pd(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends Br{constructor(t,e,i,n){super(t,{layout:Wp||(Wp=new ci({visibility:new Le(_e["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Le(_e["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:Hp||(Hp=new ci({"fill-extrusion-opacity":new Le(_e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Le(_e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Le(_e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Le(_e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Le(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Le(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Le(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Le(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Le(_e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Le(_e["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Le(_e["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Le(_e["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Le(_e["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Le(_e["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Le(_e["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Le(_e["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Qe(_e["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-line-alignment":new Le(_e["paint_fill-extrusion"]["fill-extrusion-line-alignment"])}))},e,i,n),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new Wu(t)}queryRadius(){return Pu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(t,e,i,n,s,l,c,d,f){const _=Od(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),y=this.paint.get("fill-extrusion-height").evaluate(e,i),v=this.paint.get("fill-extrusion-base").evaluate(e,i),C=[0,0],A=d&&l.elevation,M=l.elevation?l.elevation.exaggeration():1,I=t.tile.getBucket(this);if(A&&I instanceof Wu){const U=I.centroidVertexArray,X=f+1;X<U.length&&(C[0]=U.geta_centroid_pos0(X),C[1]=U.geta_centroid_pos1(X))}if(C[0]===0&&C[1]===1)return!1;l.projection.name==="globe"&&(n=qp([n],[new Ze(0,0),new Ze(je,je)],t.tileID.canonical).map(U=>U.polygon).flat());const P=A?d:null,[D,V]=function(U,X,Y,ee,le,pe,xe,fe,we,De,Ae){return U.projection.name==="globe"?function(ke,be,Ee,Fe,Te,Ve,Be,Re,rt,tt,He){const Ne=[],ht=[],it=ke.projection.upVectorScale(He,ke.center.lat,ke.worldSize).metersToTile,Ke=[0,0,0,1],mt=[0,0,0,1],xt=(Mt,Ft,Rt,oi)=>{Mt[0]=Ft,Mt[1]=Rt,Mt[2]=oi,Mt[3]=1},_t=Gp();Ee>0&&(Ee+=_t),Fe+=_t;for(const Mt of be){const Ft=[],Rt=[];for(const oi of Mt){const ui=oi.x+Te.x,vt=oi.y+Te.y,ti=ke.projection.projectTilePoint(ui,vt,He),ii=ke.projection.upVector(He,oi.x,oi.y);let fi=Ee,Ei=Fe;if(Be){const Fi=Yp(ui,vt,Ee,Fe,Be,Re,rt,tt);fi+=Fi.base,Ei+=Fi.top}Ee!==0?xt(Ke,ti.x+ii[0]*it*fi,ti.y+ii[1]*it*fi,ti.z+ii[2]*it*fi):xt(Ke,ti.x,ti.y,ti.z),xt(mt,ti.x+ii[0]*it*Ei,ti.y+ii[1]*it*Ei,ti.z+ii[2]*it*Ei),a.$.transformMat4(Ke,Ke,Ve),a.$.transformMat4(mt,mt,Ve),Ft.push(new Jo(Ke[0],Ke[1],Ke[2])),Rt.push(new Jo(mt[0],mt[1],mt[2]))}Ne.push(Ft),ht.push(Rt)}return[Ne,ht]}(U,X,Y,ee,le,pe,xe,fe,we,De,Ae):xe?function(ke,be,Ee,Fe,Te,Ve,Be,Re,rt){const tt=[],He=[],Ne=[0,0,0,1];for(const ht of ke){const it=[],Ke=[];for(const mt of ht){const xt=mt.x+Fe.x,_t=mt.y+Fe.y,Mt=Yp(xt,_t,be,Ee,Ve,Be,Re,rt);Ne[0]=xt,Ne[1]=_t,Ne[2]=Mt.base,Ne[3]=1,a.aB.transformMat4(Ne,Ne,Te),Ne[3]=Math.max(Ne[3],1e-5);const Ft=new Jo(Ne[0]/Ne[3],Ne[1]/Ne[3],Ne[2]/Ne[3]);Ne[0]=xt,Ne[1]=_t,Ne[2]=Mt.top,Ne[3]=1,a.aB.transformMat4(Ne,Ne,Te),Ne[3]=Math.max(Ne[3],1e-5);const Rt=new Jo(Ne[0]/Ne[3],Ne[1]/Ne[3],Ne[2]/Ne[3]);it.push(Ft),Ke.push(Rt)}tt.push(it),He.push(Ke)}return[tt,He]}(X,Y,ee,le,pe,xe,fe,we,De):function(ke,be,Ee,Fe,Te){const Ve=[],Be=[],Re=Te[8]*be,rt=Te[9]*be,tt=Te[10]*be,He=Te[11]*be,Ne=Te[8]*Ee,ht=Te[9]*Ee,it=Te[10]*Ee,Ke=Te[11]*Ee;for(const mt of ke){const xt=[],_t=[];for(const Mt of mt){const Ft=Mt.x+Fe.x,Rt=Mt.y+Fe.y,oi=Te[0]*Ft+Te[4]*Rt+Te[12],ui=Te[1]*Ft+Te[5]*Rt+Te[13],vt=Te[2]*Ft+Te[6]*Rt+Te[14],ti=Te[3]*Ft+Te[7]*Rt+Te[15],ii=oi+Re,fi=ui+rt,Ei=vt+tt,Fi=Math.max(ti+He,1e-5),Ii=oi+Ne,Ti=ui+ht,Xi=vt+it,Ui=Math.max(ti+Ke,1e-5);xt.push(new Jo(ii/Fi,fi/Fi,Ei/Fi)),_t.push(new Jo(Ii/Ui,Ti/Ui,Xi/Ui))}Ve.push(xt),Be.push(_t)}return[Ve,Be]}(X,Y,ee,le,pe)}(l,n,v,y,_,c,P,C,M,l.center.lat,t.tileID.canonical),N=t.queryGeometry;return function(U,X,Y){let ee=1/0;Md(Y,X)&&(ee=Xp(Y,X[0]));for(let le=0;le<X.length;le++){const pe=X[le],xe=U[le];for(let fe=0;fe<pe.length-1;fe++){const we=pe[fe],De=[we,pe[fe+1],xe[fe+1],xe[fe],we];L2(Y,De)&&(ee=Math.min(ee,Xp(Y,De)))}}return ee!==1/0&&ee}(D,V,N.isPointQuery()?N.screenBounds:N.screenGeometry)}},line:class extends Br{constructor(t,e,i,n){const s=a5();super(t,s,e,i,n),s.layout&&(this.layout=new Ki(s.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ca,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=(()=>{if(p3)return p3;const i=a5();return p3=new d7(i.paint.properties["line-width"].specification),p3.useIntegerZoom=!0,p3})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Hu(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e,i){const n=of(this);return{config:new qo(this,{zoom:e,lut:i}),defines:n,overrideFog:!1}}queryRadius(t){const e=t,i=c5(m1("line-width",this,e),m1("line-gap-width",this,e)),n=m1("line-offset",this,e);return i/2+Math.abs(n)+Pu(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,n,s,l){if(t.queryGeometry.isAboveHorizon)return!1;const c=Pd(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),l.angle,t.pixelToTileUnitsFactor),d=t.pixelToTileUnitsFactor/2*c5(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),f=this.paint.get("line-offset").evaluate(e,i);return f&&(n=function(_,y){const v=[],C=new Ze(0,0);for(let A=0;A<_.length;A++){const M=_[A],I=[];for(let P=0;P<M.length;P++){const D=M[P],V=M[P+1],N=P===0?C:D.sub(M[P-1])._unit()._perp(),U=P===M.length-1?C:V.sub(D)._unit()._perp(),X=N._add(U)._unit();X._mult(1/(X.x*U.x+X.y*U.y)),I.push(X._mult(y)._add(D))}v.push(I)}return v}(n,f*t.pixelToTileUnitsFactor)),function(_,y,v){for(let C=0;C<y.length;C++){const A=y[C];if(_.length>=3){for(let M=0;M<A.length;M++)if(za(_,A[M]))return!0}if(F4(_,A,v))return!0}return!1}(c,n,d)}isTileClipped(){return!0}isDraped(t){const e=this.layout.get("line-z-offset");return e.isConstant()&&!e.constantOr(0)}},symbol:ph,background:class extends Br{constructor(t,e,i,n){super(t,{layout:h5||(h5=new ci({visibility:new Le(_e.layout_background.visibility)})),paint:d5||(d5=new ci({"background-color":new Le(_e.paint_background["background-color"]),"background-pattern":new Le(_e.paint_background["background-pattern"]),"background-opacity":new Le(_e.paint_background["background-opacity"]),"background-emissive-strength":new Le(_e.paint_background["background-emissive-strength"])}))},e,i,n)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e,i){return{overrideFog:!1}}},raster:g5,"raster-particle":w5,sky:class extends Br{constructor(t,e,i,n){super(t,{layout:v5||(v5=new ci({visibility:new Le(_e.layout_sky.visibility)})),paint:C5||(C5=new ci({"sky-type":new Le(_e.paint_sky["sky-type"]),"sky-atmosphere-sun":new Le(_e.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Le(_e.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Le(_e.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Le(_e.paint_sky["sky-gradient-radius"]),"sky-gradient":new gr(_e.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Le(_e.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Le(_e.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Le(_e.paint_sky["sky-opacity"])}))},e,i,n),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Zc({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const n=this.paint.get("sky-atmosphere-sun"),s=!n,l=t.style.light,c=l.properties.get("position");return s&&l.properties.get("anchor")==="viewport"&&Di("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),s?M0(c.azimuthal,90-c.polar,e):M0(n[0],90-n[1],e)}const i=this.paint.get("sky-gradient-center");return M0(i[0],90-i[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends Br{constructor(t,e,i,n){super(t,{paint:b5||(b5=new ci({}))},e,null)}},model:class extends Br{constructor(t,e,i,n){super(t,{layout:D5||(D5=new ci({visibility:new Le(_e.layout_model.visibility),"model-id":new Qe(_e.layout_model["model-id"])})),paint:R5||(R5=new ci({"model-opacity":new Le(_e.paint_model["model-opacity"]),"model-rotation":new Qe(_e.paint_model["model-rotation"]),"model-scale":new Qe(_e.paint_model["model-scale"]),"model-translation":new Qe(_e.paint_model["model-translation"]),"model-color":new Qe(_e.paint_model["model-color"]),"model-color-mix-intensity":new Qe(_e.paint_model["model-color-mix-intensity"]),"model-type":new Le(_e.paint_model["model-type"]),"model-cast-shadows":new Le(_e.paint_model["model-cast-shadows"]),"model-receive-shadows":new Le(_e.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Le(_e.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Qe(_e.paint_model["model-emissive-strength"]),"model-roughness":new Qe(_e.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Qe(_e.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Le(_e.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Le(_e.paint_model["model-front-cutoff"])}))},e,i,n),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new E0(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof Ah?je-1:0}queryIntersectsFeature(t,e,i,n,s,l){if(!this.modelManager)return!1;const c=this.modelManager,d=t.tile.getBucket(this);if(!(d&&d instanceof E0))return!1;const f=d;for(const _ in f.instancesPerModel){const y=f.instancesPerModel[_],v=e.id!==void 0?e.id:e.properties&&e.properties.hasOwnProperty("id")?e.properties.id:void 0;if(y.idToFeaturesIndex.hasOwnProperty(v)){const C=y.features[y.idToFeaturesIndex[v]],A=c.getModel(_,this.scope);if(!A)return!1;let M=a.ae.create();const I=new Ht(0,0),P=f.canonical;let D=Number.MAX_VALUE;for(let V=0;V<C.instancedDataCount;++V){const N=16*(C.instancedDataOffset+V),U=y.instancedDataArray.float32,X=[U[N+4],U[N+5],U[N+6]];J5(P,I,U[N],0|U[N+1]),L5(M,A,l,I,C.rotation,C.scale,X,!1,!1,!1),l.projection.name==="globe"&&(M=S0(M,l));const Y=a.ae.multiply([],l.projMatrix,M),ee=t.queryGeometry,le=I5(ee.isPointQuery()?ee.screenBounds:ee.screenGeometry,l,Y,A.aabb);le!=null&&(D=Math.min(le,D))}return D!==Number.MAX_VALUE&&D}}return!1}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}_isPropertyZoomDependent(t){const e=this._transitionablePaint._values[t];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof W}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(t,e,i,n){const s=t.tile,l=s.getBucket(this);let c=null,d=Number.MAX_VALUE;if(!(l&&l instanceof Ah))return{queryFeature:c,intersectionZ:d};const f=l.getNodesInfo()[e];if(f.hiddenByReplacement||!f.node.meshes||!i.filter(new dt(s.tileID.overscaledZ),f.feature,s.tileID.canonical))return{queryFeature:c,intersectionZ:d};const _=f.node,y=n.calculatePosMatrix(s.tileID.toUnwrapped(),n.worldSize),v=f.evaluatedScale;let C=0;n.elevation&&_.elevation&&(C=_.elevation*n.elevation.exaggeration()),a.ae.translate(y,y,[(_.anchor?_.anchor[0]:0)*(v[0]-1),(_.anchor?_.anchor[1]:0)*(v[1]-1),C]),a.ae.scale(y,y,v),a.ae.multiply(y,y,_.matrix);const A=t.queryGeometry,M=A.isPointQuery()?A.screenBounds:A.screenGeometry,I=function(D){const V=a.ae.multiply([],y,D.matrix),N=a.ae.multiply(V,n.expandedFarZProjMatrix,V);for(let U=0;U<D.meshes.length;++U){const X=D.meshes[U];if(U===D.lightMeshIndex)continue;const Y=I5(M,n,N,X.aabb);Y!=null&&(d=Math.min(Y,d))}if(D.children)for(const U of D.children)I(U)};if(I(_),d===Number.MAX_VALUE)return{queryFeature:c,intersectionZ:d};const P=new Ht(0,0);return J5(s.tileID.canonical,P,f.node.anchor[0],f.node.anchor[1]),c={type:"Feature",geometry:{type:"Point",coordinates:[P.lng,P.lat]},properties:f.feature.properties,id:f.feature.id,state:{},layer:this.serialize()},{queryFeature:c,intersectionZ:d}}},clip:class extends Br{constructor(t,e,i,n){super(t,{layout:up||(up=new ci({"clip-layer-types":new Le(_e.layout_clip["clip-layer-types"]),"clip-layer-scope":new Le(_e.layout_clip["clip-layer-scope"])})),paint:hp||(hp=new ci({}))},e,i,n)}recalculate(t,e){super.recalculate(t,e)}createBucket(t){return new dp(t)}isTileClipped(){return!0}is3D(){return!0}}};oe(r5,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const K5=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class B0{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,n]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=n>>4;if(s!==1)throw new Error(`Got v${s} data when expected v1.`);const l=K5[15&n];if(!l)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(e,2,1),[d]=new Uint32Array(e,4,1);return new B0(d,c,l,e)}constructor(e,i=64,n=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const l=K5.indexOf(this.ArrayType),c=2*e*this.ArrayType.BYTES_PER_ELEMENT,d=e*this.IndexArrayType.BYTES_PER_ELEMENT,f=(8-d%8)%8;if(l<0)throw new Error(`Unexpected typed array class: ${n}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+d+f,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+c+d+f),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+d+f,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+l]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=i,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return F0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,n,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:l,coords:c,nodeSize:d}=this,f=[0,l.length-1,0],_=[];for(;f.length;){const y=f.pop()||0,v=f.pop()||0,C=f.pop()||0;if(v-C<=d){for(let P=C;P<=v;P++){const D=c[2*P],V=c[2*P+1];D>=e&&D<=n&&V>=i&&V<=s&&_.push(l[P])}continue}const A=C+v>>1,M=c[2*A],I=c[2*A+1];M>=e&&M<=n&&I>=i&&I<=s&&_.push(l[A]),(y===0?e<=M:i<=I)&&(f.push(C),f.push(A-1),f.push(1-y)),(y===0?n>=M:s>=I)&&(f.push(A+1),f.push(v),f.push(1-y))}return _}within(e,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:l,nodeSize:c}=this,d=[0,s.length-1,0],f=[],_=n*n;for(;d.length;){const y=d.pop()||0,v=d.pop()||0,C=d.pop()||0;if(v-C<=c){for(let P=C;P<=v;P++)e4(l[2*P],l[2*P+1],e,i)<=_&&f.push(s[P]);continue}const A=C+v>>1,M=l[2*A],I=l[2*A+1];e4(M,I,e,i)<=_&&f.push(s[A]),(y===0?e-n<=M:i-n<=I)&&(d.push(C),d.push(A-1),d.push(1-y)),(y===0?e+n>=M:i+n>=I)&&(d.push(A+1),d.push(v),d.push(1-y))}return f}}function F0(t,e,i,n,s,l){if(s-n<=i)return;const c=n+s>>1;Q5(t,e,c,n,s,l),F0(t,e,i,n,c-1,1-l),F0(t,e,i,c+1,s,1-l)}function Q5(t,e,i,n,s,l){for(;s>n;){if(s-n>600){const _=s-n+1,y=i-n+1,v=Math.log(_),C=.5*Math.exp(2*v/3),A=.5*Math.sqrt(v*C*(_-C)/_)*(y-_/2<0?-1:1);Q5(t,e,i,Math.max(n,Math.floor(i-y*C/_+A)),Math.min(s,Math.floor(i+(_-y)*C/_+A)),l)}const c=e[2*i+l];let d=n,f=s;for(v3(t,e,n,i),e[2*s+l]>c&&v3(t,e,n,s);d<f;){for(v3(t,e,d,f),d++,f--;e[2*d+l]<c;)d++;for(;e[2*f+l]>c;)f--}e[2*n+l]===c?v3(t,e,n,f):(f++,v3(t,e,f,s)),f<=i&&(n=f+1),i<=f&&(s=f-1)}}function v3(t,e,i,n){j0(t,i,n),j0(e,2*i,2*n),j0(e,2*i+1,2*n+1)}function j0(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function e4(t,e,i,n){const s=t-i,l=e-n;return s*s+l*l}a.A=Yl,a.B=Bo,a.C=Yt,a.D=Lo,a.E=As,a.F=wr,a.H=On,a.I=Qo,a.J=T,a.K=x,a.L=function(t){const e=t.value;let i=[];if(!e)return i;const n=Qn(e);return n!=="string"?(i=i.concat([new yh(t.key,e,`string expected, "${n}" found`)]),i):(P5(e,!0)||(i=i.concat([new yh(t.key,e,`invalid url "${e}"`)])),i)},a.M=class{constructor(t,e,i,n){this.id=t,this.position=e!=null?new Ht(e[0],e[1]):new Ht(0,0),this.orientation=i??[0,0,0],this.nodes=n,this.uploaded=!1,this.aabb=new vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,e){if(a.ae.multiply(t.matrix,e,t.matrix),t.meshes)for(const i of t.meshes){const n=vi.applyTransformFast(i.aabb,t.matrix);this.aabb.encapsulate(n)}if(t.children)for(const i of t.children)this._applyTransformations(i,t.matrix)}computeBoundsAndApplyParent(){const t=a.ae.identity([]);for(const e of this.nodes)this._applyTransformations(e,t)}computeModelMatrix(t,e,i,n,s,l,c=!1){L5(this.matrix,this,t.transform,this.position,e,i,n,s,l,c)}upload(t){if(!this.uploaded){for(const e of this.nodes)I0(e,t);for(const e of this.nodes)xh(e);this.uploaded=!0}}destroy(){for(const t of this.nodes)P0(t)}},a.N=_e,a.O=lr,a.P=Ze,a.Q=ir,a.R=_o,a.S=x2,a.T=vn,a.U=ci,a.V=yh,a.W=Le,a.X=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return la(t.expression.evaluate(e))}interpolate(t,e,i){return{x:lt(t.x,e.x,i),y:lt(t.y,e.y,i),z:lt(t.z,e.z,i),azimuthal:lt(t.azimuthal,e.azimuthal,i),polar:lt(t.polar,e.polar,i)}}},a.Y=dt,a.Z=W,a._=yr,a.a=Xr,a.a$=N2,a.a0=W1,a.a1=Ki,a.a2=Fs,a.a3=lt,a.a4=je,a.a5=hc,a.a6=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([i,n]){const s=la([1,i,n]);return{x:s.x,y:s.y,z:s.z}}(t.expression.evaluate(e))}interpolate(t,e,i){return{x:lt(t.x,e.x,i),y:lt(t.y,e.y,i),z:lt(t.z,e.z,i)}}},a.a7=Bc,a.a8=Mu,a.a9=Rs,a.aA=function(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3]},a.aC=function(t,e){const{x:i,y:n}=t.point,s=$d(i,n,t.worldSize/t._pixelsPerMercatorPixel,0,0);return a.ae.multiply(s,s,$2(os(e)))},a.aE=C1,a.aF=cn,a.aG=Ju,a.aH=function(t,e,i,n,s){const l=5*e+2;t.float32[l+0]=i,t.float32[l+1]=n,t.float32[l+2]=s},a.aI=lh,a.aJ=Ht,a.aK=qf,a.aL=vd,a.aM=V2,a.aN=T5,a.aO=Ho,a.aP=Vd,a.aQ=$i,a.aR=function(t,e,i,n,s,l,c,d,f){if(f.name==="globe")return Vd(t,e,new Ho(i,n,s),!1);const _=Ko({z:i,x:n,y:s},f);return new vi([(l+_.x/_.scale)*e,e*(_.y/_.scale),c],[(l+_.x2/_.scale)*e,e*(_.y2/_.scale),d])},a.aS=function(t,e,i){let n=0;for(let s=0;s<2;++s)t[s]>0&&(n+=(t[s]-0)*(t[s]-0)),e[s]<0&&(n+=(0-e[s])*(0-e[s]));return n},a.aT=ki,a.aU=j2,a.aV=yd,a.aW=function(t){const e=a.ae.identity(new Float64Array(16));a.ae.multiply(e,t.pixelMatrix,t.globeMatrix);const i=[0,yn,0],n=[0,xn,0];return a.$.transformMat4(i,i,e),a.$.transformMat4(n,n,e),[i[0]>0&&i[0]<=t.width&&i[1]>0&&i[1]<=t.height&&!q2(t,new Ht(t.center.lat,90)),n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!q2(t,new Ht(t.center.lat,-90))]},a.aX=function(t,e){const{scale:i}=t.tileTransform,n=i*je/(t.tileSize*Math.pow(2,e.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return a.aD.scale(new Float32Array(4),e.inverseAdjustmentMatrix,[n,n])},a.aY=_h,a.aZ=A5,a.a_=function(t){const e=A5(t,!0);return a.aD.invert([],[e[0],e[1],e[4],e[5]])},a.aa=_d,a.ab=Ar,a.ac=Lt,a.ad=function(t,e,i){const n=Math.sqrt(t*t+e*e+i*i),s=n>0?Math.acos(i/n)*sa:0;let l=t!==0||e!==0?Math.atan2(-e,-t)*sa+90:0;return l<0&&(l+=360),[n,l,s]},a.af=S1,a.ag=Fn,a.ah=_0,a.ai=function(t,e){const i={};for(let n=0;n<e.length;n++){const s=e[n];s in t&&(i[s]=t[s])}return i},a.aj=Oa,a.ak=ss,a.al=as,a.am=Q0,a.an=function(t){Ol++,Ol>ec&&(t.getActor().send("enforceCacheSizeLimit",Q1),Ol=0)},a.ao=ac,a.ap=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,i,n){const s=this.entries[t]=this.entries[t]||{callbacks:[]};if(s.result){const[l,c]=s.result;return this.scheduler?this.scheduler.add(()=>{n(l,c)},e):n(l,c),()=>{}}return s.callbacks.push(n),s.cancel||(s.cancel=i((l,c)=>{s.result=[l,c];for(const d of s.callbacks)this.scheduler?this.scheduler.add(()=>{d(l,c)},e):d(l,c);setTimeout(()=>delete this.entries[t],3e3)})),()=>{s.result||(s.callbacks=s.callbacks.filter(l=>l!==n),s.callbacks.length||(s.cancel(),delete this.entries[t]))}}},a.aq=function(t,e,i){const n=JSON.stringify(t.request);return t.data&&(this.deduped.entries[n]={result:[null,t.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},s=>{const l=vs(t.request,(c,d,f,_)=>{c?s(c):d&&s(null,{vectorTile:i?void 0:new Q2(new Kc(d)),rawData:d,cacheControl:f,expires:_})});return()=>{l.cancel(),s()}},e)},a.ar=w2,a.as=class extends Ds{constructor(t){super(t),this.current=A4}set(t,e,i){if(this.fetchUniformLocation(t,e)){for(let n=0;n<9;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},a.at=A2,a.au=Pt,a.av=aa,a.ax=Kn,a.ay=Mr,a.az=Qi,a.b=wi,a.b$=z4,a.b0=function(t){const{x:e,y:i}=t.point,{lng:n,lat:s}=t._center;return $d(e,i,t.worldSize,n,s)},a.b1=vr,a.b2=p1,a.b3=S2,a.b4=function(t){const e=Math.round((t+45+360)%360/90)%4;return no[e]},a.b5=45,a.b6=P2,a.b7=Su,a.b8=vi,a.b9=la,a.bA=dh,a.bB=Qd,a.bC=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},a.bD=nf,a.bF=Zd,a.bG=O3,a.bH=P3,a.bI=256,a.bJ=function(t,e){const i=[0,0,0],n=Uc(os(e.canonical));return a.$.transformMat4(i,i,n),a.$.transformMat4(i,i,t),i},a.bK=t=>({u_camera_to_center_distance:new Ar(t),u_extrude_scale:new T2(t),u_device_pixel_ratio:new Ar(t),u_matrix:new Bc(t),u_inv_rot_matrix:new Bc(t),u_merc_center:new Rs(t),u_tile_id:new w2(t),u_zoom_transition:new Ar(t),u_up_dir:new w2(t),u_emissive_strength:new Ar(t)}),a.bL=t=>({u_matrix:new Bc(t),u_pixels_to_tile_units:new T2(t),u_device_pixel_ratio:new Ar(t),u_units_to_pixels:new Rs(t),u_dash_image:new Mu(t),u_gradient_image:new Mu(t),u_image_height:new Ar(t),u_texsize:new Rs(t),u_tile_units_to_pixels:new Ar(t),u_alpha_discard_threshold:new Ar(t),u_trim_offset:new Rs(t),u_trim_fade_range:new Rs(t),u_trim_color:new A2(t),u_emissive_strength:new Ar(t)}),a.bM=t=>({u_matrix:new Bc(t),u_texsize:new Rs(t),u_pixels_to_tile_units:new T2(t),u_device_pixel_ratio:new Ar(t),u_image:new Mu(t),u_units_to_pixels:new Rs(t),u_tile_units_to_pixels:new Ar(t),u_alpha_discard_threshold:new Ar(t),u_trim_offset:new Rs(t)}),a.bN=d2,a.bO=W6,a.bP=hr,a.bQ=u9,a.bR=Bf,a.bS=o0,a.bT=Wd,a.bU=(t,e,i,n,s,l)=>{const c=t.transform,d=c.projection.name==="globe";let f;if(l.paint.get("circle-pitch-alignment")==="map")if(d){const y=Zd(c.zoom,e.canonical)*c._pixelsPerMercatorPixel;f=Float32Array.from([y,0,0,y])}else f=c.calculatePixelsToTileUnitsMatrix(i);else f=new Float32Array([c.pixelsToGLUnits[0],0,0,c.pixelsToGLUnits[1]]);const _={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(c.projection),u_matrix:t.translatePosMatrix(e.projMatrix,i,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_device_pixel_ratio:sr.devicePixelRatio,u_extrude_scale:f,u_inv_rot_matrix:q4,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:l.paint.get("circle-emissive-strength")};if(d){_.u_inv_rot_matrix=n,_.u_merc_center=s,_.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],_.u_zoom_transition=Fs(c.zoom);const y=s[0]*je,v=s[1]*je;_.u_up_dir=c.projection.upVector(new Ho(0,0,0),y,v)}return _},a.bV=of,a.bW=(t,e,i,n,s,l)=>{const c=t.transform;return{u_matrix:af(t,e,i,n),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:c.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:s,u_image:0,u_tile_units_to_pixels:sf(e,c),u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:l}},a.bX=(t,e,i,n,s,l,c)=>{const d=t.transform,f=d.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:af(t,e,i,n),u_pixels_to_tile_units:f,u_device_pixel_ratio:l,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:s,u_texsize:lf(i)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:sf(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:c,u_trim_fade_range:i.paint.get("line-trim-fade-range"),u_trim_color:i.paint.get("line-trim-color").toRenderColor(i.lut).toArray01(),u_emissive_strength:i.paint.get("line-emissive-strength")}},a.bY=xs,a.bZ=Zc,a.b_=Gp,a.ba=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},a.bb=wl,a.bc=function(t,e,i){const n=Fs(i.zoom),s=t.style.map._antialias,l=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return n===0&&!s&&!l},a.bd=function(t){const e=t.pixelsPerMeter,i=e/Mr(1,t.center.lat),n=a.ae.identity(new Float64Array(16));return a.ae.translate(n,n,[t.point.x,t.point.y,0]),a.ae.scale(n,n,[i,i,e]),Float32Array.from(n)},a.be=Du,a.bf=function(t){const e=ki-5;t=Pt(t,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Lt(t))),3);return Math.round(i*(E2.length-1))},a.bg=function(t,e,i,n){const s=e.getNorth(),l=e.getSouth(),c=e.getWest(),d=e.getEast(),f=1<<t.z,_=d-c,y=s-l,v=_/u1,C=-y/E2[i],A=[0,v,0,C,0,0,s,c,0];if(t.z>0){const M=180/n;a.bE.multiply(A,A,[M/_+1,0,0,0,M/y+1,0,-.5*M/v,.5*M/C,1])}return A[2]=f,A[5]=t.x,A[8]=t.y,A},a.bh=Uc,a.bi=os,a.bj=function(t,e,i){const n=a.ae.identity(new Float64Array(16)),s=(e/(1<<t)-.5)*Math.PI*2;return a.ae.rotateY(n,i.globeMatrix,s),Float32Array.from(n)},a.bk=J1,a.bl=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},a.bm=g5,a.bn=w5,a.bo=_5,a.bp=function(t,e){const i=document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let n=0;n<t.length;n++){const s=document.createElement("source");Dh(t[n])||(i.crossOrigin="Anonymous"),s.src=t[n],i.appendChild(s)}return{cancel:()=>{}}},a.bq=ch,a.br=Ml,a.bs=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const i=e.getSource().maxzoom,n=1<<i,s=Math.floor(t.x),l=Math.floor((t.x-s)*n),c=Math.floor(t.y*n),d=this.findDEMTileFor(new $i(i,s,i,l,c));return!(!d||!d.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,i=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const n=this._source();if(!n||t.y<0||t.y>1)return e;const s=n.getSource().maxzoom,l=1<<s,c=Math.floor(t.x),d=t.x-c,f=new $i(s,c,s,Math.floor(d*l),Math.floor(t.y*l)),_=this.findDEMTileFor(f);if(!_||!_.dem)return e;const y=_.dem,v=1<<_.tileID.canonical.z,C=(d*v-_.tileID.canonical.x)*y.dim,A=(t.y*v-_.tileID.canonical.y)*y.dim,M=Math.floor(C),I=Math.floor(A);return(i?this.exaggeration():1)*lt(lt(y.get(M,I),y.get(M,I+1),A-I),lt(y.get(M+1,I),y.get(M+1,I+1),A-I),C-M)}getAtTileOffset(t,e,i){const n=1<<t.canonical.z;return this.getAtPointOrZero(new yr(t.wrap+(t.canonical.x+e/je)/n,(t.canonical.y+i/je)/n))}getAtTileOffsetFunc(t,e,i,n){return s=>{const l=this.getAtTileOffset(t,s.x,s.y),c=n.upVector(t.canonical,s.x,s.y),d=n.upVectorScale(t.canonical,e,i).metersToTile;return a.$.scale(c,c,l*d),c}}getForTilePoints(t,e,i,n){if(this.isUsingMockSource())return!1;const s=y1.create(this,t,n);return!!s&&(e.forEach(l=>{l[2]=this.exaggeration()*s.getElevationAt(l[0],l[1],i)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const i=e.dem.tree,n=e.tileID,s=1<<t.canonical.z-n.canonical.z;let l=t.canonical.x/s-n.canonical.x,c=t.canonical.y/s-n.canonical.y,d=0;for(let f=0;f<t.canonical.z-n.canonical.z&&!i.leaves[d];f++){l*=2,c*=2;const _=2*Math.floor(c)+Math.floor(l);d=i.childOffsets[d]+_,l%=1,c%=1}return{min:this.exaggeration()*i.minimums[d],max:this.exaggeration()*i.maximums[d]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(t.length===0)return null;let e=!1,i=Number.MAX_VALUE,n=Number.MIN_VALUE;for(const s of t){const l=this.getMinMaxForTile(s.tileID);l&&(i=Math.min(i,l.min),n=Math.max(n,l.max),e=!0)}return e?{min:i,max:n}:null}},a.bt=Nc,a.bu=zu,a.bv=Dn,a.bw=Hi,a.bx=el,a.by=P1,a.bz=vh,a.c=q5,a.c$=function(t,e,i,n){return t.type==="custom"?new f7(t,e):new j7[t.type](t,e,i,n)},a.c0=Wu,a.c1=La,a.c2=450,a.c3=7,a.c4=p7,a.c5=n5,a.c6=256,a.c7=jd,a.c8=$2,a.c9=ei,a.cA=Id,a.cB=function(t,e,i=0){return a.$.fromValues(((e.x-i)*t.scale-t.x)*je,(e.y*t.scale-t.y)*je,Cd(e.z,e.y))},a.cC=function(t){let e=1/0,i=1/0,n=-1/0,s=-1/0;for(const l of t)e=Math.min(e,l.x),i=Math.min(i,l.y),n=Math.max(n,l.x),s=Math.max(s,l.y);return{min:new Ze(e,i),max:new Ze(n,s)}},a.cD=za,a.cE=Ad,a.cF=Tr,a.cG=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.cH=Pf,a.cI=L2,a.cJ=xp,a.cK=Ap,a.cL=Tp,a.cM=h0,a.cN=B0,a.cO=function(t){return t({pluginStatus:ai,pluginURL:Bt}),Ot.on("pluginStateChange",t),t},a.cP=w1,a.cQ=c0,a.cR=ic,a.cS=ni,a.cT=_i,a.cU=K1,a.cV=Ll,a.cW=Cr,a.cX=function(t){const e=t.indexOf(xu);return e>=0?t.slice(0,e):t},a.cY=function(t){return t.indexOf(xu)>=0},a.cZ=function(t){const e=t.indexOf(xu);return e>=0?t.slice(e+1):""},a.c_=function(t){const e=[],i=t.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},a.ca=Ma,a.cb=Go,a.cc=1,a.cd=o3,a.ce=0,a.cf=_2,a.cg=function(t,e,i,n,s){return Pt((t-e)/(i-e)*(s-n)+n,n,s)},a.ch=_u,a.ci=Xo,a.cj=class{constructor(t,e,i,n){this.context=t,this.format=n,this.size=i,this.texture=t.gl.createTexture();const[s,l,c]=this.size,{gl:d}=t;d.bindTexture(d.TEXTURE_3D,this.texture),t.pixelStoreUnpackFlipY.set(!1),t.pixelStoreUnpack.set(1),t.pixelStoreUnpackPremultiplyAlpha.set(!1);let f=this.format,_=d.UNSIGNED_BYTE;this.format===d.DEPTH_COMPONENT&&(f=d.DEPTH_COMPONENT16,_=d.UNSIGNED_SHORT),this.format===d.R8&&(n=d.RED),this.format===d.R32F&&(_=d.FLOAT,n=d.RED),d.texImage3D(d.TEXTURE_3D,0,f,s,l,c,0,n,_,e.data)}bind(t,e){const{context:i}=this,{gl:n}=i;n.bindTexture(n.TEXTURE_3D,this.texture),t!==this.minFilter&&(n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}},a.ck=S0,a.cl=[1,1,1],a.cm=y1,a.cn=I1,a.co=Ea,a.cp=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Ze(1/0,1/0),max:new Ze(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t,e=!1){const i=Cp(new Ze(0,0),new Ze(je,je),t),n=[];if(e&&!e0(i,this._globalClipBounds))return n;for(const s of this._activeRegions){if(s.hiddenByOverlap||!e0(i,s))continue;const l=b6(s.min,s.max,t);n.push({min:l.min,max:l.max,sourceId:this._sourceIds[s.priority],footprint:s.footprint,footprintTileId:s.tileId,order:s.order,clipMask:s.clipMask,clipScope:s.clipScope})}return n}setSources(t){this._setSources(t.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const i=[];for(const n of e.cache.getVisibleCoordinates()){const s=e.cache.getTile(n).buckets[e.layer];s&&s.updateFootprints(n.toUnwrapped(),i)}return i},getOrder:()=>e.order,getClipMask:()=>e.clipMask,getClipScope:()=>e.clipScope})))}_addSource(t){const e=t.getFootprints();if(e.length===0)return;const i=t.getOrder(),n=t.getClipMask(),s=t.getClipScope();for(const l of e){if(!l.footprint)continue;const c=Cp(l.footprint.min,l.footprint.max,l.id);this._activeRegions.push({min:c.min,max:c.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:l.id,footprint:l.footprint,order:i,clipMask:n,clipScope:s})}this._sourceIds.push(t.getSourceId())}_computeReplacement(){this._activeRegions.sort((e,i)=>e.priority-i.priority||$u(e.min,i.min)||$u(e.max,i.max)||e.order-i.order||e.clipMask-i.clipMask||function(n,s){const l=(c,d)=>c+d;return n.length-s.length||n.reduce(l,"").localeCompare(s.reduce(l,""))}(e.clipScope,i.clipScope));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0;for(;!t&&e!==this._activeRegions.length;){const i=this._activeRegions[e],n=this._prevRegions[e];t=i.priority!==n.priority||!vp(i,n)||i.order!==n.order||i.clipMask!==n.clipMask||!na(i.clipScope,n.clipScope),++e}}if(t){++this._updateTime;for(const i of this._activeRegions)i.order!==Zu&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,i.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,i.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,i.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,i.max.y));const e=i=>{const n=this._activeRegions;if(i>=n.length)return i;const s=n[i].priority;for(;i<n.length&&n[i].priority===s;)++i;return i};if(this._sourceIds.length>1){let i=0,n=e(i);for(;i!==n;){let s=i;const l=i;for(;s!==n;){const c=this._activeRegions[s];c.hiddenByOverlap=!1;for(let d=0;d<l;d++){const f=this._activeRegions[d];if(!f.hiddenByOverlap&&c.order===Zu&&e0(c,f)&&(c.hiddenByOverlap=wp(c.footprint,c.tileId,f.footprint,f.tileId),c.hiddenByOverlap))break}++s}i=n,n=e(i)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},a.cq=zs,a.cr=hh,a.cs=Rc,a.ct=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){const i=new Dn,n=new Hi,s=[],l=t+1+2,c=e[0]+1,d=e[0]+1+(1+e.length),f=(_,y,v)=>{let C=_===l-1?_-2:_===0?_:_-1;return C+=v?24575:0,[C,y]};for(let _=0;_<l;++_)i.emplaceBack(...f(_,0,!0));for(let _=0;_<c;++_)for(let y=0;y<l;++y)i.emplaceBack(...f(y,_,(y===0||y===l-1)&&!0));for(let _=0;_<e.length;++_){const y=e[_];for(let v=0;v<l;++v)i.emplaceBack(...f(v,y,!0))}for(let _=0;_<e.length;++_){const y=n.length,v=e[_]+1+2,C=new Hi;for(let I=0;I<v-1;I++){const P=I===v-2,D=P?l*(d-e.length+_-I):l;for(let V=0;V<l-1;V++){const N=I*l+V;I===0||P||V===0||V===l-2?(C.emplaceBack(N+1,N,N+D),C.emplaceBack(N+D,N+D+1,N+1)):(n.emplaceBack(N+1,N,N+D),n.emplaceBack(N+D,N+D+1,N+1))}}const A=wi.simpleSegment(0,y,i.length,n.length-y);for(let I=0;I<C.uint16.length;I+=3)n.emplaceBack(C.uint16[I],C.uint16[I+1],C.uint16[I+2]);const M=wi.simpleSegment(0,y,i.length,n.length-y);s.push({withoutSkirts:A,withSkirts:M})}return{vertices:i,indices:n,segments:s}}_createGrid(t){const e=this._fillGridMeshWithLods(u1,E2);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Nc.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new Hi;for(let c=0;c<=u1;c++)e.emplaceBack(0,c+1,c+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const i=new Go,n=new Go,s=new Go,l=new Go;this._poleSegments=[];for(let c=0,d=0;c<S2;c++){const f=360/(1<<c);i.emplaceBack(0,-Tr,0,.5,0),n.emplaceBack(0,-Tr,0,.5,1),s.emplaceBack(0,-Tr,0,.5,.5),l.emplaceBack(0,-Tr,0,.5,.5);for(let _=0;_<=u1;_++){let y=_/u1,v=0;const C=lt(0,f,y),[A,M,I]=h1($4,G4,C,Tr);i.emplaceBack(A,M,I,y,v),n.emplaceBack(A,M,I,y,1-v);const P=Lt(C);y=.5+.5*Math.sin(P),v=.5+.5*Math.cos(P),s.emplaceBack(A,M,I,y,v),l.emplaceBack(A,M,I,y,1-v)}this._poleSegments.push(wi.simpleSegment(d,0,66,64)),d+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(i,Ou,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(n,Ou,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(s,Ou,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(l,Ou,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},a.cu=function(t){return Co.has(t)},a.cv=Zu,a.cw=Dp,a.cx=function(t,e,i=0,n=!0){const s=new Ze(i,i),l=t.sub(s),c=e.add(s),d=[l,new Ze(c.x,l.y),c,new Ze(l.x,c.y)];return n&&d.push(l.clone()),d},a.cy=function(t,e){const i=[];for(let n=0;n<t.length;n++){const s=aa(n-1,-1,t.length-1),l=aa(n+1,-1,t.length-1),c=t[n],d=t[l],f=t[s].sub(c).unit(),_=d.sub(c).unit(),y=_.angleWithSep(f.x,f.y),v=f.add(_).unit().mult(-1*e/Math.sin(y/2));i.push(c.add(v))}return i},a.cz=Vf,a.d=na,a.d$=h3,a.d0=rr,a.d1=Ot,a.d2=fn,a.d3=Al,a.d4=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.d5=nn,a.d6=wd,a.d7=Wo,a.d8=function([t,e,i]){const n=Math.hypot(t,e,i),s=Math.atan2(t,i),l=.5*Math.PI-Math.acos(-e/n);return new Ht(vr(s),vr(l))},a.d9=Fr,a.dA=function(){vh().acquire(O0)},a.dB=function(){const t=g3;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(O0),g3=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.dC=_3,a.dD=function(t){const e=L3();if(!e)return;const i=e.delete(D3);t&&i.catch(t).then(()=>t())},a.dE=m3,a.dF=B5,a.dG=function(t){z0=sr.resolveURL(t),z1||(z1=new P1(vh(),new As)),z1.broadcast("setDracoUrl",z0)},a.dH=F5,a.dI=function(t){O1=sr.resolveURL(t),z1||(z1=new P1(vh(),new As)),z1.broadcast("setMeshoptUrl",O1)},a.dJ=H1,a.dK=oe,a.dL=Da,a.dM=Bn,a.dN=Ko,a.dO=C2,a.dP=cf,a.dQ=_f,a.dR=Qp,a.dS=oo,a.dT=zf,a.dU=M1,a.dV=function(t,e,i,n,s,l,c,d,f,_,y){t.createArrays(),t.tilePixelRatio=je/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const v=t.layers[0].layout,C=t.layers[0]._unevaluatedLayout._values,A={};if(t.textSizeData.kind==="composite"){const{minZoom:D,maxZoom:V}=t.textSizeData;A.compositeTextSizes=[C["text-size"].possiblyEvaluate(new dt(D),d),C["text-size"].possiblyEvaluate(new dt(V),d)]}if(t.iconSizeData.kind==="composite"){const{minZoom:D,maxZoom:V}=t.iconSizeData;A.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new dt(D),d),C["icon-size"].possiblyEvaluate(new dt(V),d)]}A.layoutTextSize=C["text-size"].possiblyEvaluate(new dt(f+1),d),A.layoutIconSize=C["icon-size"].possiblyEvaluate(new dt(f+1),d),A.textMaxSize=C["text-size"].possiblyEvaluate(new dt(18),d);const M=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point",I=v.get("text-size");let P=!1;for(const D of t.features)if(D.icon&&D.icon.nameSecondary){P=!0;break}for(const D of t.features){const V=v.get("text-font").evaluate(D,{},d).join(","),N=I.evaluate(D,{},d),U=A.layoutTextSize.evaluate(D,{},d),X=(A.layoutIconSize.evaluate(D,{},d),{horizontal:{},vertical:void 0}),Y=D.text;let ee,le=[0,0];if(Y){const fe=Y.toString(),we=v.get("text-letter-spacing").evaluate(D,{},d)*hr,De=v.get("text-line-height").evaluate(D,{},d)*hr,Ae=Ie(fe)?we:0,ke=v.get("text-anchor").evaluate(D,{},d),be=v.get("text-variable-anchor");if(!be){const Be=v.get("text-radial-offset").evaluate(D,{},d);le=Be?Bf(ke,[Be*hr,u0]):v.get("text-offset").evaluate(D,{},d).map(Re=>Re*hr)}let Ee=M?"center":v.get("text-justify").evaluate(D,{},d);const Fe=v.get("symbol-placement")==="point",Te=Fe?v.get("text-max-width").evaluate(D,{},d)*hr:1/0,Ve=Be=>{t.allowVerticalPlacement&&Se(fe)&&(X.vertical=a0(Y,e,i,s,V,Te,De,ke,Be,Ae,le,cn.vertical,!0,U,N))};if(!M&&be){const Be=Ee==="auto"?be.map(rt=>h0(rt)):[Ee];let Re=!1;for(let rt=0;rt<Be.length;rt++){const tt=Be[rt];if(!X.horizontal[tt])if(Re)X.horizontal[tt]=X.horizontal[0];else{const He=a0(Y,e,i,s,V,Te,De,"center",tt,Ae,le,cn.horizontal,!1,U,N);He&&(X.horizontal[tt]=He,Re=He.positionedLines.length===1)}}Ve("left")}else{if(Ee==="auto"&&(Ee=h0(ke)),Fe||v.get("text-writing-mode").indexOf("horizontal")>=0||!Se(fe)){const Be=a0(Y,e,i,s,V,Te,De,ke,Ee,Ae,le,cn.horizontal,!1,U,N);Be&&(X.horizontal[Ee]=Be)}Ve(Fe?"left":Ee)}}let pe=!1;if(D.icon&&D.icon.namePrimary){const fe=n[D.icon.namePrimary];fe&&(ee=x9(s[D.icon.namePrimary],D.icon.nameSecondary?s[D.icon.nameSecondary]:void 0,v.get("icon-offset").evaluate(D,{},d),v.get("icon-anchor").evaluate(D,{},d)),pe=fe.sdf,t.sdfIcons===void 0?t.sdfIcons=fe.sdf:t.sdfIcons!==fe.sdf&&Di("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==t.pixelRatio||v.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const xe=jf(X.horizontal)||X.vertical;t.iconsInText||(t.iconsInText=!!xe&&xe.iconsInText),(xe||ee)&&M9(t,D,X,ee,n,A,U,0,le,pe,c,d,_,y,P)}l&&t.generateCollisionDebugBuffers(f,t.collisionBoxArray)},a.dW=Hu,a.dX=ju,a.dY=Q2,a.dZ=Kc,a.d_=Gu,a.da=d1,a.db=st,a.dc=q2,a.dd=Gd,a.de=function(t){const e=[0,0,0],i=a.ae.identity(new Float64Array(16));return a.ae.multiply(i,t.pixelMatrix,t.globeMatrix),a.$.transformMat4(e,e,i),new Ze(e[0],e[1])},a.df=Zn,a.dg=pr,a.dh=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!function(i){if(po==null){const n=i.navigator?i.navigator.userAgent:null;po=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return po}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.di=Tl,a.dj=class{constructor(t,e,i){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",rc,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!_i(t))return t;const i=Gr(t);return i.params.push(`sdk=js-${mi}`),i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!_i(t))return t;const i=Gr(t);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeModelURL(t,e){if(!_i(t))return t;const i=Gr(t);return i.path=`/models/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(t,e,i,n){if(!_i(t))return t;const s=Gr(t);return s.path=`/v4/${s.authority}.json`,s.params.push("secure"),i&&s.params.push(`language=${i}`),n&&s.params.push(`worldview=${n}`),this._makeAPIURL(s,this._customAccessToken||e)}normalizeSpriteURL(t,e,i,n){const s=Gr(t);return _i(t)?(s.path=`/styles/v1${s.path}/sprite${e}${i}`,this._makeAPIURL(s,this._customAccessToken||n)):(s.path+=`${e}${i}`,Cs(s))}normalizeTileURL(t,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!_i(t))return t;const n=Gr(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&n.authority!=="raster"&&i===512?"@2x":""}${zl.supported?".webp":"$1"}`),n.authority==="raster"?n.path=`/${st.RASTER_URL_PREFIX}${n.path}`:n.authority==="rasterarrays"?n.path=`/${st.RASTERARRAYS_URL_PREFIX}${n.path}`:n.authority==="3dtiles"?n.path=`/${st.TILES3D_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${st.TILE_URL_VERSION}${n.path}`);const s=this._customAccessToken||function(l){for(const c of l){const d=c.match(/^access_token=(.*)$/);if(d)return d[1]}return null}(n.params)||st.ACCESS_TOKEN;return st.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,s)}canonicalizeTileURL(t,e){const i=Gr(t);if(!i.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!i.path.match(/\.[\w]+$/))return t;let n="mapbox://";i.path.match(/^\/raster\/v1\//)?n+=`raster/${i.path.replace(`/${st.RASTER_URL_PREFIX}/`,"")}`:i.path.match(/^\/rasterarrays\/v1\//)?n+=`rasterarrays/${i.path.replace(`/${st.RASTERARRAYS_URL_PREFIX}/`,"")}`:n+=`tiles/${i.path.replace(`/${st.TILE_URL_VERSION}/`,"")}`;let s=i.params;return e&&(s=s.filter(l=>!l.match(/^access_token=/))),s.length&&(n+=`?${s.join("&")}`),n}canonicalizeTileset(t,e){const i=!!e&&_i(e),n=[];for(const s of t.tiles||[])It(s)?n.push(this.canonicalizeTileURL(s,i)):n.push(s);return n}_makeAPIURL(t,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",n=Gr(st.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,t.protocol==="http"){const s=t.params.indexOf("secure");s>=0&&t.params.splice(s,1)}if(n.path!=="/"&&(t.path=`${n.path}${t.path}`),!st.REQUIRE_ACCESS_TOKEN)return Cs(t);if(e=e||st.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return t.params=t.params.filter(s=>s.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),Cs(t)}},a.dk=function(t,e){e?Co.add(t):Co.delete(t)},a.dl=zl,a.dm=Lh,a.dn=oc,a.dp=nc,a.dq=V3,a.dr=U3,a.ds=function(t){Co.delete(t)},a.dt=vo,a.du=da,a.dv=so,a.dw=mi,a.dx=function(t,e){Q1=t,ec=e},a.dy=function(t,e,i=!1){if(ai===ct||ai===Tt||ai===kt)throw new Error("setRTLTextPlugin cannot be called multiple times.");Bt=sr.resolveURL(t),ai=ct,hi=e,Et(),i||$t()},a.dz=bt,a.e=sr,a.e0=Vu,a.e1=Nu,a.e2=ro,a.e3=uf,a.e4=dn,a.e5=vs,a.e6=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==N5){const i=new Uint32Array(t,0,7),[,,n,s,l,c]=i;e=i.byteLength+s+l+c+l,(n!==t.byteLength||e>=t.byteLength)&&Di("Invalid b3dm header information.")}return $5(t,e)},a.e7=function(t,e){const i=q5(t);for(const n of i){for(const s of n.meshes)L7(s);n.lights&&(n.lightMeshIndex=n.meshes.length,n.meshes.push(k7(n.lights,e)))}return i},a.e8=Ah,a.e9=k5,a.ea=zt,a.eb=function(t){fo(),pn&&pn.then(e=>{e.keys().then(i=>{for(let n=0;n<i.length-t;n++)e.delete(i[n])})})},a.f=bo,a.g=mn,a.h=function(t,e){return fn(ir(t,{type:"json"}),e)},a.i=yo,a.j=ln,a.k=Of,a.l=function(t){return fetch(t).then(e=>e.arrayBuffer()).then(e=>$5(e,0,t))},a.m=l0,a.n=class extends yh{},a.o=Qn,a.p=j9,a.q=fa,a.r=g,a.s=w,a.t=b,a.u=Pn,a.v=G,a.w=Di,a.x=on,a.y=H,a.z=Z}),Xt(["./shared"],function(a){function mi(ae){const R=ae?ae.url.toString():void 0;return R?performance.getEntriesByName(R):[]}function bi(ae){if(typeof ae=="number"||typeof ae=="boolean"||typeof ae=="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){let j="[";for(const q of ae)j+=`${bi(q)},`;return`${j}]`}let R="{";for(const j of Object.keys(ae).sort())R+=`${j}:${bi(ae[j])},`;return`${R}}`}function st(ae){let R="";for(const j of a.cG)R+=`/${bi(ae[j])}`;return R}class It{constructor(R){this.keyCache={},this._layers={},this._layerConfigs={},R&&this.replace(R)}replace(R,j){this._layerConfigs={},this._layers={},this.update(R,[],j)}update(R,j,q){this._options=q;for(const Q of R)this._layerConfigs[Q.id]=Q,(this._layers[Q.id]=a.c$(Q,this.scope,null,this._options)).compileFilter(),this.keyCache[Q.id]&&delete this.keyCache[Q.id];for(const Q of j)delete this.keyCache[Q],delete this._layerConfigs[Q],delete this._layers[Q];this.familiesBySource={};const ie=function(Q,ue){const ve={};for(let ye=0;ye<Q.length;ye++){const ze=ue&&ue[Q[ye].id]||st(Q[ye]);ue&&(ue[Q[ye].id]=ze);let Oe=ve[ze];Oe||(Oe=ve[ze]=[]),Oe.push(Q[ye])}const ce=[];for(const ye in ve)ce.push(ve[ye]);return ce}(a.dJ(this._layerConfigs),this.keyCache);for(const Q of ie){const ue=Q.map(We=>this._layers[We.id]),ve=ue[0];if(ve.visibility==="none")continue;const ce=ve.source||"";let ye=this.familiesBySource[ce];ye||(ye=this.familiesBySource[ce]={});const ze=ve.sourceLayer||"_geojsonTileLayer";let Oe=ye[ze];Oe||(Oe=ye[ze]=[]),Oe.push(ue)}}}const _i=1*a.dM;class Pi{constructor(R){const j={},q=[];for(const ve in R){const ce=R[ve],ye=j[ve]={};for(const ze in ce.glyphs){const Oe=ce.glyphs[+ze];if(!Oe||Oe.bitmap.width===0||Oe.bitmap.height===0)continue;const We=Oe.metrics.localGlyph?_i:1,nt={x:0,y:0,w:Oe.bitmap.width+2*We,h:Oe.bitmap.height+2*We};q.push(nt),ye[ze]=nt}}const{w:ie,h:Q}=a.k(q),ue=new a.dL({width:ie||1,height:Q||1});for(const ve in R){const ce=R[ve];for(const ye in ce.glyphs){const ze=ce.glyphs[+ye];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const Oe=j[ve][ye],We=ze.metrics.localGlyph?_i:1;a.dL.copy(ze.bitmap,ue,{x:0,y:0},{x:Oe.x+We,y:Oe.y+We},ze.bitmap)}}this.image=ue,this.positions=j}}a.dK(Pi,"GlyphAtlas");class Sr{constructor(R){this.tileID=new a.aQ(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.tileZoom=R.tileZoom,this.uid=R.uid,this.zoom=R.zoom,this.lut=R.lut,this.canonical=R.tileID.canonical,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.scope=R.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.promoteId=R.promoteId,this.isSymbolTile=R.isSymbolTile,this.tileTransform=a.dN(R.tileID.canonical,R.projection),this.projection=R.projection,this.brightness=R.brightness,this.extraShadowCaster=!!R.extraShadowCaster,this.tessellationStep=R.tessellationStep}parse(R,j,q,ie,Q){this.status="parsing",this.data=R,this.collisionBoxArray=new a.dO;const ue=new a.dP(Object.keys(R.layers).sort()),ve=new a.dQ(this.tileID,this.promoteId);ve.bucketLayerIDs=[];const ce={},ye=new a.dR(256,256),ze={featureIndex:ve,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:ye,availableImages:q,brightness:this.brightness},Oe=j.familiesBySource[this.source];for(const et in Oe){const gi=R.layers[et];if(!gi)continue;let qt=!1,jt=!1,Oi=!1;for(const tr of Oe[et])tr[0].type==="symbol"?qt=!0:jt=!0,tr[0].is3D()&&tr[0].type!=="model"&&(Oi=!0);if(this.extraShadowCaster&&!Oi||this.isSymbolTile===!0&&!qt||this.isSymbolTile===!1&&!jt)continue;gi.version===1&&a.w(`Vector tile source "${this.source}" layer "${et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const zi=ue.encode(et),qi=[];for(let tr=0;tr<gi.length;tr++){const mr=gi.feature(tr),gs=ve.getId(mr,et);qi.push({feature:mr,id:gs,index:tr,sourceLayerIndex:zi})}for(const tr of Oe[et]){const mr=tr[0];(!this.extraShadowCaster||mr.is3D()&&mr.type!=="model")&&(this.isSymbolTile!==void 0&&mr.type==="symbol"!==this.isSymbolTile||mr.minzoom&&this.zoom<Math.floor(mr.minzoom)||mr.maxzoom&&this.zoom>=mr.maxzoom||mr.visibility!=="none"&&(Kr(tr,this.zoom,ze.brightness,q),(ce[mr.id]=mr.createBucket({index:ve.bucketLayerIDs.length,layers:tr,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:zi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(qi,ze,this.tileID.canonical,this.tileTransform),ve.bucketLayerIDs.push(tr.map(gs=>gs.id))))}}let We,nt,ut,Gt;ye.trim();const At={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Zt=()=>{if(We)return this.status="done",Q(We);if(this.extraShadowCaster)this.status="done",Q(null,{buckets:a.dJ(ce).filter(et=>!et.isEmpty()),featureIndex:ve,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:ze.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(nt&&ut&&Gt){const et=new Pi(nt),gi=new a.dT(ut,Gt,this.lut);for(const qt in ce){const jt=ce[qt];jt instanceof a.dU?(Kr(jt.layers,this.zoom,ze.brightness,q),a.dV(jt,nt,et.positions,ut,gi.iconPositions,this.showCollisionBoxes,q,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):jt.hasPattern&&(jt instanceof a.dW||jt instanceof a.dX||jt instanceof a.c0)&&(Kr(jt.layers,this.zoom,ze.brightness,q),jt.addFeatures(ze,this.tileID.canonical,gi.patternPositions,q,this.tileTransform,this.brightness))}this.status="done",Q(null,{buckets:a.dJ(ce).filter(qt=>!qt.isEmpty()),featureIndex:ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:et.image,lineAtlas:ye,imageAtlas:gi,brightness:ze.brightness})}};if(!this.extraShadowCaster){const et=a.dS(ze.glyphDependencies,jt=>Object.keys(jt).map(Number));Object.keys(et).length?ie.send("getGlyphs",{uid:this.uid,stacks:et,scope:this.scope},(jt,Oi)=>{We||(We=jt,nt=Oi,Zt())},void 0,!1,At):nt={};const gi=Object.keys(ze.iconDependencies);gi.length?ie.send("getImages",{icons:gi,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(jt,Oi)=>{We||(We=jt,ut=Oi,Zt())},void 0,!1,At):ut={};const qt=Object.keys(ze.patternDependencies);qt.length?ie.send("getImages",{icons:qt,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(jt,Oi)=>{We||(We=jt,Gt=Oi,Zt())},void 0,!1,At):Gt={}}Zt()}}function Kr(ae,R,j,q){const ie=new a.Y(R,{brightness:j});for(const Q of ae)Q.recalculate(ie,q)}class pr extends a.E{constructor(R,j,q,ie,Q,ue){super(),this.actor=R,this.layerIndex=j,this.availableImages=q,this.loadVectorData=Q||a.aq,this.loading={},this.loaded={},this.deduped=new a.ap(R.scheduler),this.isSpriteLoaded=ie,this.scheduler=R.scheduler,this.brightness=ue}loadTile(R,j){const q=R.uid,ie=R&&R.request,Q=ie&&ie.collectResourceTiming,ue=this.loading[q]=new Sr(R);ue.abort=this.loadVectorData(R,(ve,ce)=>{const ye=!this.loading[q];if(delete this.loading[q],ye||ve||!ce)return ue.status="done",ye||(this.loaded[q]=ue),j(ve);const ze=ce.rawData,Oe={};ce.expires&&(Oe.expires=ce.expires),ce.cacheControl&&(Oe.cacheControl=ce.cacheControl),ue.vectorTile=ce.vectorTile||new a.dY(new a.dZ(ze));const We=()=>{ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor,(nt,ut)=>{if(nt||!ut)return j(nt);const Gt={};if(Q){const At=mi(ie);At.length>0&&(Gt.resourceTiming=JSON.parse(JSON.stringify(At)))}j(null,a.Q({rawTileData:ze.slice(0)},ut,Oe,Gt))})};this.isSpriteLoaded?We():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(We,{type:"parseTile",isSymbolTile:R.isSymbolTile,zoom:R.tileZoom}):We()}),this.loaded=this.loaded||{},this.loaded[q]=ue})}reloadTile(R,j){const q=this.loaded,ie=R.uid;if(q&&q[ie]){const Q=q[ie];Q.showCollisionBoxes=R.showCollisionBoxes,Q.projection=R.projection,Q.brightness=R.brightness,Q.tileTransform=a.dN(R.tileID.canonical,R.projection),Q.extraShadowCaster=R.extraShadowCaster,Q.lut=R.lut;const ue=(ve,ce)=>{const ye=Q.reloadCallback;ye&&(delete Q.reloadCallback,Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,ye)),j(ve,ce)};Q.status==="parsing"?Q.reloadCallback=ue:Q.status==="done"&&(Q.vectorTile?Q.parse(Q.vectorTile,this.layerIndex,this.availableImages,this.actor,ue):ue())}else j(null,void 0)}abortTile(R,j){const q=R.uid,ie=this.loading[q];ie&&(ie.abort&&ie.abort(),delete this.loading[q]),j()}removeTile(R,j){const q=this.loaded,ie=R.uid;q&&q[ie]&&delete q[ie],j()}}class Zn{loadTile(R,j){const{uid:q,encoding:ie,rawImageData:Q,padding:ue}=R,ve=ImageBitmap&&Q instanceof ImageBitmap?this.getImageData(Q,ue):Q;j(null,new a.d_(q,ve,ie,ue<1))}getImageData(R,j){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(R.width,R.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=R.width,this.offscreenCanvas.height=R.height,this.offscreenCanvasContext.drawImage(R,0,0,R.width,R.height);const q=this.offscreenCanvasContext.getImageData(-j,-j,R.width+2*j,R.height+2*j);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),q}}a.d$.setPbf(a.dZ);class $a{decodeRasterArray({task:R,buffer:j},q){a.d$.performDecoding(j,R).then(ie=>{q(null,ie)},ie=>{q(ie)})}}const dn=a.e0.prototype.toGeoJSON;let Ai=class{constructor(ae){this._feature=ae,this.extent=a.a4,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const R of this._feature.geometry)ae.push([new a.P(R[0],R[1])]);return ae}{const ae=[];for(const R of this._feature.geometry){const j=[];for(const q of R)j.push(new a.P(q[0],q[1]));ae.push(j)}return ae}}toGeoJSON(ae,R,j){return dn.call(this,ae,R,j)}},Mi=class{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.a4,this.length=ae.length,this._features=ae}feature(ae){return new Ai(this._features[ae])}};const $n=64/4096,Vs=128;class R1{constructor(){this.features=new Map}clear(){this.features.clear()}load(R=[],j){for(const q of R){const ie=q.id;if(ie==null)continue;let Q=this.features.get(ie);Q&&this.updateCache(Q,j),q.geometry?(Q=pi(q),this.updateCache(Q,j),this.features.set(ie,Q)):this.features.delete(ie),this.updateCache(Q,j)}}updateCache(R,j){for(const{canonical:q,uid:ie}of Object.values(j)){const{z:Q,x:ue,y:ve}=q;ll(R,Math.pow(2,Q),ue,ve)&&delete j[ie]}}getTile(R,j,q){const ie=Math.pow(2,R),Q=[];for(const ue of this.features.values())ll(ue,ie,j,q)&&Q.push(cl(ue,ie,j,q));return{features:Q}}getFeatures(){return[...this.features.values()]}}function ll({minX:ae,minY:R,maxX:j,maxY:q},ie,Q,ue){return ae<(Q+1+$n)/ie&&R<(ue+1+$n)/ie&&j>(Q-$n)/ie&&q>(ue-$n)/ie}function pi(ae){const{id:R,geometry:j,properties:q}=ae;if(!j)return;if(j.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ie,coordinates:Q}=j,ue={id:R,type:1,geometry:[],tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},ve=ue.geometry;if(ie==="Point")si(Q,ve,ue);else if(ie==="MultiPoint")for(const ce of Q)si(ce,ve,ue);else if(ie==="LineString")ue.type=2,Qr(Q,ve,ue);else if(ie==="MultiLineString")ue.type=2,Us(Q,ve,ue);else if(ie==="Polygon")ue.type=3,Us(Q,ve,ue,!0);else{if(ie!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");ue.type=3;for(const ce of Q)Us(ce,ve,ue,!0)}return ue}function si([ae,R],j,q){const ie=a.ak(ae);let Q=a.al(R);Q=Q<0?0:Q>1?1:Q,j.push(ie,Q),q.minX=Math.min(q.minX,ie),q.minY=Math.min(q.minY,Q),q.maxX=Math.max(q.maxX,ie),q.maxY=Math.max(q.maxY,Q)}function Qr(ae,R,j,q=!1,ie=!1){const Q=[];for(const ue of ae)si(ue,Q,j);R.push(Q),q&&function(ue,ve){let ce=0;for(let ye=0,ze=ue.length,Oe=ze-2;ye<ze;Oe=ye,ye+=2)ce+=(ue[ye]-ue[Oe])*(ue[ye+1]+ue[Oe+1]);if(ce>0===ve)for(let ye=0,ze=ue.length;ye<ze/2;ye+=2){const Oe=ue[ye],We=ue[ye+1];ue[ye]=ue[ze-2-ye],ue[ye+1]=ue[ze-1-ye],ue[ze-2-ye]=Oe,ue[ze-1-ye]=We}}(Q,ie)}function Us(ae,R,j,q=!1){for(let ie=0;ie<ae.length;ie++)Qr(ae[ie],R,j,q,ie===0)}function cl(ae,R,j,q){const{id:ie,type:Q,geometry:ue,tags:ve}=ae,ce=[];if(Q===1)(function(ye,ze,Oe,We,nt){for(let ut=0;ut<ye.length;ut+=2){const Gt=Math.round(a.a4*(ye[ut+0]*ze-Oe)),At=Math.round(a.a4*(ye[ut+1]*ze-We));nt.push([Gt,At])}})(ue,R,j,q,ce);else for(const ye of ue)ul(ye,R,j,q,ce);return{id:ie,type:Q,geometry:ce,tags:ve}}function ul(ae,R,j,q,ie){const Q=-Vs,ue=a.a4+Vs;let ve;for(let ce=0;ce<ae.length-2;ce+=2){let ye=Math.round(a.a4*(ae[ce+0]*R-j)),ze=Math.round(a.a4*(ae[ce+1]*R-q)),Oe=Math.round(a.a4*(ae[ce+2]*R-j)),We=Math.round(a.a4*(ae[ce+3]*R-q));const nt=Oe-ye,ut=We-ze;ye<Q&&Oe<Q||(ye<Q?(ze+=Math.round(ut*((Q-ye)/nt)),ye=Q):Oe<Q&&(We=ze+Math.round(ut*((Q-ye)/nt)),Oe=Q),ze<Q&&We<Q||(ze<Q?(ye+=Math.round(nt*((Q-ze)/ut)),ze=Q):We<Q&&(Oe=ye+Math.round(nt*((Q-ze)/ut)),We=Q),ye>=ue&&Oe>=ue||(ye>=ue?(ze+=Math.round(ut*((ue-ye)/nt)),ye=ue):Oe>=ue&&(We=ze+Math.round(ut*((ue-ye)/nt)),Oe=ue),ze>=ue&&We>=ue||(ze>=ue?(ye+=Math.round(nt*((ue-ze)/ut)),ze=ue):We>=ue&&(Oe=ye+Math.round(nt*((ue-ze)/ut)),We=ue),ve&&ye===ve[ve.length-1][0]&&ze===ve[ve.length-1][1]||(ve=[[ye,ze]],ie.push(ve)),ve.push([Oe,We])))))}}var li={exports:{}},Ga=a.e2,Nr=a.e1.VectorTileFeature,hl=qa;function qa(ae,R){this.options=R||{},this.features=ae,this.length=ae.length}function ds(ae,R){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=R||4096}qa.prototype.feature=function(ae){return new ds(this.features[ae],this.options.extent)},ds.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var R=0;R<ae.length;R++){for(var j=ae[R],q=[],ie=0;ie<j.length;ie++)q.push(new Ga(j[ie][0],j[ie][1]));this.geometry.push(q)}return this.geometry},ds.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,R=1/0,j=-1/0,q=1/0,ie=-1/0,Q=0;Q<ae.length;Q++)for(var ue=ae[Q],ve=0;ve<ue.length;ve++){var ce=ue[ve];R=Math.min(R,ce.x),j=Math.max(j,ce.x),q=Math.min(q,ce.y),ie=Math.max(ie,ce.y)}return[R,q,j,ie]},ds.prototype.toGeoJSON=Nr.prototype.toGeoJSON;var ri=a.e3,Zs=hl;function er(ae){var R=new ri;return function(j,q){for(var ie in j.layers)q.writeMessage(3,dl,j.layers[ie])}(ae,R),R.finish()}function dl(ae,R){var j;R.writeVarintField(15,ae.version||1),R.writeStringField(1,ae.name||""),R.writeVarintField(5,ae.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<ae.length;j++)q.feature=ae.feature(j),R.writeMessage(2,pl,q);var ie=q.keys;for(j=0;j<ie.length;j++)R.writeStringField(3,ie[j]);var Q=q.values;for(j=0;j<Q.length;j++)R.writeMessage(4,ml,Q[j])}function pl(ae,R){var j=ae.feature;j.id!==void 0&&R.writeVarintField(1,j.id),R.writeMessage(2,fl,ae),R.writeVarintField(3,j.type),R.writeMessage(4,yi,j)}function fl(ae,R){var j=ae.feature,q=ae.keys,ie=ae.values,Q=ae.keycache,ue=ae.valuecache;for(var ve in j.properties){var ce=j.properties[ve],ye=Q[ve];if(ce!==null){ye===void 0&&(q.push(ve),Q[ve]=ye=q.length-1),R.writeVarint(ye);var ze=typeof ce;ze!=="string"&&ze!=="boolean"&&ze!=="number"&&(ce=JSON.stringify(ce));var Oe=ze+":"+ce,We=ue[Oe];We===void 0&&(ie.push(ce),ue[Oe]=We=ie.length-1),R.writeVarint(We)}}}function gt(ae,R){return(R<<3)+(7&ae)}function $s(ae){return ae<<1^ae>>31}function yi(ae,R){for(var j=ae.loadGeometry(),q=ae.type,ie=0,Q=0,ue=j.length,ve=0;ve<ue;ve++){var ce=j[ve],ye=1;q===1&&(ye=ce.length),R.writeVarint(gt(1,ye));for(var ze=q===3?ce.length-1:ce.length,Oe=0;Oe<ze;Oe++){Oe===1&&q!==1&&R.writeVarint(gt(2,ze-1));var We=ce[Oe].x-ie,nt=ce[Oe].y-Q;R.writeVarint($s(We)),R.writeVarint($s(nt)),ie+=We,Q+=nt}q===3&&R.writeVarint(gt(7,1))}}function ml(ae,R){var j=typeof ae;j==="string"?R.writeStringField(1,ae):j==="boolean"?R.writeBooleanField(7,ae):j==="number"&&(ae%1!=0?R.writeDoubleField(3,ae):ae<0?R.writeSVarintField(6,ae):R.writeVarintField(5,ae))}li.exports=er,li.exports.fromVectorTileJs=er,li.exports.fromGeojsonVt=function(ae,R){R=R||{};var j={};for(var q in ae)j[q]=new Zs(ae[q].features,R),j[q].name=q,j[q].version=R.version,j[q].extent=R.extent;return er({layers:j})},li.exports.GeoJSONWrapper=Zs;var _l=a.e4(li.exports);const gl={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},Wa=Math.fround||(Gs=new Float32Array(1),ae=>(Gs[0]=+ae,Gs[0]));var Gs;const en=3,tn=5,Ha=6;class pt{constructor(R){this.options=Object.assign(Object.create(gl),R),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(R){const{log:j,minZoom:q,maxZoom:ie}=this.options;j&&console.time("total time");const Q=`prepare ${R.length} points`;j&&console.time(Q),this.points=R;const ue=[];for(let ce=0;ce<R.length;ce++){const ye=R[ce];if(!ye.geometry)continue;const[ze,Oe]=ye.geometry.coordinates,We=Wa(br(ze)),nt=Wa(Tn(Oe));ue.push(We,nt,1/0,ce,-1,1),this.options.reduce&&ue.push(0)}let ve=this.trees[ie+1]=this._createTree(ue);j&&console.timeEnd(Q);for(let ce=ie;ce>=q;ce--){const ye=+Date.now();ve=this.trees[ce]=this._createTree(this._cluster(ve,ce)),j&&console.log("z%d: %d clusters in %dms",ce,ve.numItems,+Date.now()-ye)}return j&&console.timeEnd("total time"),this}getClusters(R,j){let q=((R[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,R[1]));let Q=R[2]===180?180:((R[2]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)q=-180,Q=180;else if(q>Q){const Oe=this.getClusters([q,ie,180,ue],j),We=this.getClusters([-180,ie,Q,ue],j);return Oe.concat(We)}const ve=this.trees[this._limitZoom(j)],ce=ve.range(br(q),Tn(ue),br(Q),Tn(ie)),ye=ve.data,ze=[];for(const Oe of ce){const We=this.stride*Oe;ze.push(ye[We+tn]>1?yt(ye,We,this.clusterProps):this.points[ye[We+en]])}return ze}getChildren(R){const j=this._getOriginId(R),q=this._getOriginZoom(R),ie="No cluster with the specified id.",Q=this.trees[q];if(!Q)throw new Error(ie);const ue=Q.data;if(j*this.stride>=ue.length)throw new Error(ie);const ve=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ce=Q.within(ue[j*this.stride],ue[j*this.stride+1],ve),ye=[];for(const ze of ce){const Oe=ze*this.stride;ue[Oe+4]===R&&ye.push(ue[Oe+tn]>1?yt(ue,Oe,this.clusterProps):this.points[ue[Oe+en]])}if(ye.length===0)throw new Error(ie);return ye}getLeaves(R,j,q){const ie=[];return this._appendLeaves(ie,R,j=j||10,q=q||0,0),ie}getTile(R,j,q){const ie=this.trees[this._limitZoom(R)],Q=Math.pow(2,R),{extent:ue,radius:ve}=this.options,ce=ve/ue,ye=(q-ce)/Q,ze=(q+1+ce)/Q,Oe={features:[]};return this._addTileFeatures(ie.range((j-ce)/Q,ye,(j+1+ce)/Q,ze),ie.data,j,q,Q,Oe),j===0&&this._addTileFeatures(ie.range(1-ce/Q,ye,1,ze),ie.data,Q,q,Q,Oe),j===Q-1&&this._addTileFeatures(ie.range(0,ye,ce/Q,ze),ie.data,-1,q,Q,Oe),Oe.features.length?Oe:null}getClusterExpansionZoom(R){let j=this._getOriginZoom(R)-1;for(;j<=this.options.maxZoom;){const q=this.getChildren(R);if(j++,q.length!==1)break;R=q[0].properties.cluster_id}return j}_appendLeaves(R,j,q,ie,Q){const ue=this.getChildren(j);for(const ve of ue){const ce=ve.properties;if(ce&&ce.cluster?Q+ce.point_count<=ie?Q+=ce.point_count:Q=this._appendLeaves(R,ce.cluster_id,q,ie,Q):Q<ie?Q++:R.push(ve),R.length===q)break}return Q}_createTree(R){const j=new a.cN(R.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<R.length;q+=this.stride)j.add(R[q],R[q+1]);return j.finish(),j.data=R,j}_addTileFeatures(R,j,q,ie,Q,ue){for(const ve of R){const ce=ve*this.stride,ye=j[ce+tn]>1;let ze,Oe,We;if(ye)ze=qs(j,ce,this.clusterProps),Oe=j[ce],We=j[ce+1];else{const Gt=this.points[j[ce+en]];ze=Gt.properties;const[At,Zt]=Gt.geometry.coordinates;Oe=br(At),We=Tn(Zt)}const nt={type:1,geometry:[[Math.round(this.options.extent*(Oe*Q-q)),Math.round(this.options.extent*(We*Q-ie))]],tags:ze};let ut;ut=ye||this.options.generateId?j[ce+en]:this.points[j[ce+en]].id,ut!==void 0&&(nt.id=ut),ue.features.push(nt)}}_limitZoom(R){return Math.max(this.options.minZoom,Math.min(Math.floor(+R),this.options.maxZoom+1))}_cluster(R,j){const{radius:q,extent:ie,reduce:Q,minPoints:ue}=this.options,ve=q/(ie*Math.pow(2,j)),ce=R.data,ye=[],ze=this.stride;for(let Oe=0;Oe<ce.length;Oe+=ze){if(ce[Oe+2]<=j)continue;ce[Oe+2]=j;const We=ce[Oe],nt=ce[Oe+1],ut=R.within(ce[Oe],ce[Oe+1],ve),Gt=ce[Oe+tn];let At=Gt;for(const Zt of ut){const et=Zt*ze;ce[et+2]>j&&(At+=ce[et+tn])}if(At>Gt&&At>=ue){let Zt,et=We*Gt,gi=nt*Gt,qt=-1;const jt=(Oe/ze<<5)+(j+1)+this.points.length;for(const Oi of ut){const zi=Oi*ze;if(ce[zi+2]<=j)continue;ce[zi+2]=j;const qi=ce[zi+tn];et+=ce[zi]*qi,gi+=ce[zi+1]*qi,ce[zi+4]=jt,Q&&(Zt||(Zt=this._map(ce,Oe,!0),qt=this.clusterProps.length,this.clusterProps.push(Zt)),Q(Zt,this._map(ce,zi)))}ce[Oe+4]=jt,ye.push(et/At,gi/At,1/0,jt,-1,At),Q&&ye.push(qt)}else{for(let Zt=0;Zt<ze;Zt++)ye.push(ce[Oe+Zt]);if(At>1)for(const Zt of ut){const et=Zt*ze;if(!(ce[et+2]<=j)){ce[et+2]=j;for(let gi=0;gi<ze;gi++)ye.push(ce[et+gi])}}}}return ye}_getOriginId(R){return R-this.points.length>>5}_getOriginZoom(R){return(R-this.points.length)%32}_map(R,j,q){if(R[j+tn]>1){const ue=this.clusterProps[R[j+Ha]];return q?Object.assign({},ue):ue}const ie=this.points[R[j+en]].properties,Q=this.options.map(ie);return q&&Q===ie?Object.assign({},Q):Q}}function yt(ae,R,j){return{type:"Feature",id:ae[R+en],properties:qs(ae,R,j),geometry:{type:"Point",coordinates:[(q=ae[R],360*(q-.5)),yl(ae[R+1])]}};var q}function qs(ae,R,j){const q=ae[R+tn],ie=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,Q=ae[R+Ha],ue=Q===-1?{}:Object.assign({},j[Q]);return Object.assign(ue,{cluster:!0,cluster_id:ae[R+en],point_count:q,point_count_abbreviated:ie})}function br(ae){return ae/360+.5}function Tn(ae){const R=Math.sin(ae*Math.PI/180),j=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return j<0?0:j>1?1:j}function yl(ae){const R=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(R))/Math.PI-90}function ps(ae,R,j,q){let ie=q;const Q=R+(j-R>>1);let ue,ve=j-R;const ce=ae[R],ye=ae[R+1],ze=ae[j],Oe=ae[j+1];for(let We=R+3;We<j;We+=3){const nt=xl(ae[We],ae[We+1],ce,ye,ze,Oe);if(nt>ie)ue=We,ie=nt;else if(nt===ie){const ut=Math.abs(We-Q);ut<ve&&(ue=We,ve=ut)}}ie>q&&(ue-R>3&&ps(ae,R,ue,q),ae[ue+2]=ie,j-ue>3&&ps(ae,ue,j,q))}function xl(ae,R,j,q,ie,Q){let ue=ie-j,ve=Q-q;if(ue!==0||ve!==0){const ce=((ae-j)*ue+(R-q)*ve)/(ue*ue+ve*ve);ce>1?(j=ie,q=Q):ce>0&&(j+=ue*ce,q+=ve*ce)}return ue=ae-j,ve=R-q,ue*ue+ve*ve}function Gn(ae,R,j,q){const ie={id:ae??null,type:R,geometry:j,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(R==="Point"||R==="MultiPoint"||R==="LineString")qn(ie,j);else if(R==="Polygon")qn(ie,j[0]);else if(R==="MultiLineString")for(const Q of j)qn(ie,Q);else if(R==="MultiPolygon")for(const Q of j)qn(ie,Q[0]);return ie}function qn(ae,R){for(let j=0;j<R.length;j+=3)ae.minX=Math.min(ae.minX,R[j]),ae.minY=Math.min(ae.minY,R[j+1]),ae.maxX=Math.max(ae.maxX,R[j]),ae.maxY=Math.max(ae.maxY,R[j+1])}function Ws(ae,R,j,q){if(!R.geometry)return;const ie=R.geometry.coordinates;if(ie&&ie.length===0)return;const Q=R.geometry.type,ue=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2);let ve=[],ce=R.id;if(j.promoteId?ce=R.properties[j.promoteId]:j.generateId&&(ce=q||0),Q==="Point")Xa(ie,ve);else if(Q==="MultiPoint")for(const ye of ie)Xa(ye,ve);else if(Q==="LineString")Hs(ie,ve,ue,!1);else if(Q==="MultiLineString"){if(j.lineMetrics){for(const ye of ie)ve=[],Hs(ye,ve,ue,!1),ae.push(Gn(ce,"LineString",ve,R.properties));return}Xs(ie,ve,ue,!1)}else if(Q==="Polygon")Xs(ie,ve,ue,!0);else{if(Q!=="MultiPolygon"){if(Q==="GeometryCollection"){for(const ye of R.geometry.geometries)Ws(ae,{id:ce,geometry:ye,properties:R.properties},j,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ye of ie){const ze=[];Xs(ye,ze,ue,!0),ve.push(ze)}}ae.push(Gn(ce,Q,ve,R.properties))}function Xa(ae,R){R.push(Vr(ae[0]),xr(ae[1]),0)}function Hs(ae,R,j,q){let ie,Q,ue=0;for(let ce=0;ce<ae.length;ce++){const ye=Vr(ae[ce][0]),ze=xr(ae[ce][1]);R.push(ye,ze,0),ce>0&&(ue+=q?(ie*ze-ye*Q)/2:Math.sqrt(Math.pow(ye-ie,2)+Math.pow(ze-Q,2))),ie=ye,Q=ze}const ve=R.length-3;R[2]=1,ps(R,0,ve,j),R[ve+2]=1,R.size=Math.abs(ue),R.start=0,R.end=R.size}function Xs(ae,R,j,q){for(let ie=0;ie<ae.length;ie++){const Q=[];Hs(ae[ie],Q,j,q),R.push(Q)}}function Vr(ae){return ae/360+.5}function xr(ae){const R=Math.sin(ae*Math.PI/180),j=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return j<0?0:j>1?1:j}function ft(ae,R,j,q,ie,Q,ue,ve){if(q/=R,Q>=(j/=R)&&ue<q)return ae;if(ue<j||Q>=q)return null;const ce=[];for(const ye of ae){const ze=ye.geometry;let Oe=ye.type;const We=ie===0?ye.minX:ye.minY,nt=ie===0?ye.maxX:ye.maxY;if(We>=j&&nt<q){ce.push(ye);continue}if(nt<j||We>=q)continue;let ut=[];if(Oe==="Point"||Oe==="MultiPoint")Ys(ze,ut,j,q,ie);else if(Oe==="LineString")fr(ze,ut,j,q,ie,!1,ve.lineMetrics);else if(Oe==="MultiLineString")fs(ze,ut,j,q,ie,!1);else if(Oe==="Polygon")fs(ze,ut,j,q,ie,!0);else if(Oe==="MultiPolygon")for(const Gt of ze){const At=[];fs(Gt,At,j,q,ie,!0),At.length&&ut.push(At)}if(ut.length){if(ve.lineMetrics&&Oe==="LineString"){for(const Gt of ut)ce.push(Gn(ye.id,Oe,Gt,ye.tags));continue}Oe!=="LineString"&&Oe!=="MultiLineString"||(ut.length===1?(Oe="LineString",ut=ut[0]):Oe="MultiLineString"),Oe!=="Point"&&Oe!=="MultiPoint"||(Oe=ut.length===3?"Point":"MultiPoint"),ce.push(Gn(ye.id,Oe,ut,ye.tags))}}return ce.length?ce:null}function Ys(ae,R,j,q,ie){for(let Q=0;Q<ae.length;Q+=3){const ue=ae[Q+ie];ue>=j&&ue<=q&&Ur(R,ae[Q],ae[Q+1],ae[Q+2])}}function fr(ae,R,j,q,ie,Q,ue){let ve=rn(ae);const ce=ie===0?Js:Ya;let ye,ze,Oe=ae.start;for(let At=0;At<ae.length-3;At+=3){const Zt=ae[At],et=ae[At+1],gi=ae[At+2],qt=ae[At+3],jt=ae[At+4],Oi=ie===0?Zt:et,zi=ie===0?qt:jt;let qi=!1;ue&&(ye=Math.sqrt(Math.pow(Zt-qt,2)+Math.pow(et-jt,2))),Oi<j?zi>j&&(ze=ce(ve,Zt,et,qt,jt,j),ue&&(ve.start=Oe+ye*ze)):Oi>q?zi<q&&(ze=ce(ve,Zt,et,qt,jt,q),ue&&(ve.start=Oe+ye*ze)):Ur(ve,Zt,et,gi),zi<j&&Oi>=j&&(ze=ce(ve,Zt,et,qt,jt,j),qi=!0),zi>q&&Oi<=q&&(ze=ce(ve,Zt,et,qt,jt,q),qi=!0),!Q&&qi&&(ue&&(ve.end=Oe+ye*ze),R.push(ve),ve=rn(ae)),ue&&(Oe+=ye)}let We=ae.length-3;const nt=ae[We],ut=ae[We+1],Gt=ie===0?nt:ut;Gt>=j&&Gt<=q&&Ur(ve,nt,ut,ae[We+2]),We=ve.length-3,Q&&We>=3&&(ve[We]!==ve[0]||ve[We+1]!==ve[1])&&Ur(ve,ve[0],ve[1],ve[2]),ve.length&&R.push(ve)}function rn(ae){const R=[];return R.size=ae.size,R.start=ae.start,R.end=ae.end,R}function fs(ae,R,j,q,ie,Q){for(const ue of ae)fr(ue,R,j,q,ie,Q,!1)}function Ur(ae,R,j,q){ae.push(R,j,q)}function Js(ae,R,j,q,ie,Q){const ue=(Q-R)/(q-R);return Ur(ae,Q,j+(ie-j)*ue,1),ue}function Ya(ae,R,j,q,ie,Q){const ue=(Q-j)/(ie-j);return Ur(ae,R+(q-R)*ue,Q,1),ue}function Ks(ae,R){const j=[];for(let q=0;q<ae.length;q++){const ie=ae[q],Q=ie.type;let ue;if(Q==="Point"||Q==="MultiPoint"||Q==="LineString")ue=ms(ie.geometry,R);else if(Q==="MultiLineString"||Q==="Polygon"){ue=[];for(const ve of ie.geometry)ue.push(ms(ve,R))}else if(Q==="MultiPolygon"){ue=[];for(const ve of ie.geometry){const ce=[];for(const ye of ve)ce.push(ms(ye,R));ue.push(ce)}}j.push(Gn(ie.id,Q,ue,ie.tags))}return j}function ms(ae,R){const j=[];j.size=ae.size,ae.start!==void 0&&(j.start=ae.start,j.end=ae.end);for(let q=0;q<ae.length;q+=3)j.push(ae[q]+R,ae[q+1],ae[q+2]);return j}function Qs(ae,R){if(ae.transformed)return ae;const j=1<<ae.z,q=ae.x,ie=ae.y;for(const Q of ae.features){const ue=Q.geometry,ve=Q.type;if(Q.geometry=[],ve===1)for(let ce=0;ce<ue.length;ce+=2)Q.geometry.push(ea(ue[ce],ue[ce+1],R,j,q,ie));else for(let ce=0;ce<ue.length;ce++){const ye=[];for(let ze=0;ze<ue[ce].length;ze+=2)ye.push(ea(ue[ce][ze],ue[ce][ze+1],R,j,q,ie));Q.geometry.push(ye)}}return ae.transformed=!0,ae}function ea(ae,R,j,q,ie,Q){return[Math.round(j*(ae*q-ie)),Math.round(j*(R*q-Q))]}function Wn(ae,R,j,q,ie){const Q=R===ie.maxZoom?0:ie.tolerance/((1<<R)*ie.extent),ue={features:[],numPoints:0,numSimplified:0,numFeatures:ae.length,source:null,x:j,y:q,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ve of ae)ta(ue,ve,Q,ie);return ue}function ta(ae,R,j,q){const ie=R.geometry,Q=R.type,ue=[];if(ae.minX=Math.min(ae.minX,R.minX),ae.minY=Math.min(ae.minY,R.minY),ae.maxX=Math.max(ae.maxX,R.maxX),ae.maxY=Math.max(ae.maxY,R.maxY),Q==="Point"||Q==="MultiPoint")for(let ve=0;ve<ie.length;ve+=3)ue.push(ie[ve],ie[ve+1]),ae.numPoints++,ae.numSimplified++;else if(Q==="LineString")Zr(ue,ie,ae,j,!1,!1);else if(Q==="MultiLineString"||Q==="Polygon")for(let ve=0;ve<ie.length;ve++)Zr(ue,ie[ve],ae,j,Q==="Polygon",ve===0);else if(Q==="MultiPolygon")for(let ve=0;ve<ie.length;ve++){const ce=ie[ve];for(let ye=0;ye<ce.length;ye++)Zr(ue,ce[ye],ae,j,!0,ye===0)}if(ue.length){let ve=R.tags||null;if(Q==="LineString"&&q.lineMetrics){ve={};for(const ye in R.tags)ve[ye]=R.tags[ye];ve.mapbox_clip_start=ie.start/ie.size,ve.mapbox_clip_end=ie.end/ie.size}const ce={geometry:ue,type:Q==="Polygon"||Q==="MultiPolygon"?3:Q==="LineString"||Q==="MultiLineString"?2:1,tags:ve};R.id!==null&&(ce.id=R.id),ae.features.push(ce)}}function Zr(ae,R,j,q,ie,Q){const ue=q*q;if(q>0&&R.size<(ie?ue:q))return void(j.numPoints+=R.length/3);const ve=[];for(let ce=0;ce<R.length;ce+=3)(q===0||R[ce+2]>ue)&&(j.numSimplified++,ve.push(R[ce],R[ce+1])),j.numPoints++;ie&&function(ce,ye){let ze=0;for(let Oe=0,We=ce.length,nt=We-2;Oe<We;nt=Oe,Oe+=2)ze+=(ce[Oe]-ce[nt])*(ce[Oe+1]+ce[nt+1]);if(ze>0===ye)for(let Oe=0,We=ce.length;Oe<We/2;Oe+=2){const nt=ce[Oe],ut=ce[Oe+1];ce[Oe]=ce[We-2-Oe],ce[Oe+1]=ce[We-1-Oe],ce[We-2-Oe]=nt,ce[We-1-Oe]=ut}}(ve,Q),ae.push(ve)}const L1={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class $r{constructor(R,j){const q=(j=this.options=function(Q,ue){for(const ve in ue)Q[ve]=ue[ve];return Q}(Object.create(L1),j)).debug;if(q&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");let ie=function(Q,ue){const ve=[];if(Q.type==="FeatureCollection")for(let ce=0;ce<Q.features.length;ce++)Ws(ve,Q.features[ce],ue,ce);else Ws(ve,Q.type==="Feature"?Q:{geometry:Q},ue);return ve}(R,j);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ie=function(Q,ue){const ve=ue.buffer/ue.extent;let ce=Q;const ye=ft(Q,1,-1-ve,ve,0,-1,2,ue),ze=ft(Q,1,1-ve,2+ve,0,-1,2,ue);return(ye||ze)&&(ce=ft(Q,1,-ve,1+ve,0,-1,2,ue)||[],ye&&(ce=Ks(ye,1).concat(ce)),ze&&(ce=ce.concat(Ks(ze,-1)))),ce}(ie,j),ie.length&&this.splitTile(ie,0,0,0),q&&(ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(R,j,q,ie,Q,ue,ve){const ce=[R,j,q,ie],ye=this.options,ze=ye.debug;for(;ce.length;){ie=ce.pop(),q=ce.pop(),j=ce.pop(),R=ce.pop();const Oe=1<<j,We=Yi(j,q,ie);let nt=this.tiles[We];if(!nt&&(ze>1&&console.time("creation"),nt=this.tiles[We]=Wn(R,j,q,ie,ye),this.tileCoords.push({z:j,x:q,y:ie}),ze)){ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,q,ie,nt.numFeatures,nt.numPoints,nt.numSimplified),console.timeEnd("creation"));const qi=`z${j}`;this.stats[qi]=(this.stats[qi]||0)+1,this.total++}if(nt.source=R,Q==null){if(j===ye.indexMaxZoom||nt.numPoints<=ye.indexMaxPoints)continue}else{if(j===ye.maxZoom||j===Q)continue;if(Q!=null){const qi=Q-j;if(q!==ue>>qi||ie!==ve>>qi)continue}}if(nt.source=null,R.length===0)continue;ze>1&&console.time("clipping");const ut=.5*ye.buffer/ye.extent,Gt=.5-ut,At=.5+ut,Zt=1+ut;let et=null,gi=null,qt=null,jt=null,Oi=ft(R,Oe,q-ut,q+At,0,nt.minX,nt.maxX,ye),zi=ft(R,Oe,q+Gt,q+Zt,0,nt.minX,nt.maxX,ye);R=null,Oi&&(et=ft(Oi,Oe,ie-ut,ie+At,1,nt.minY,nt.maxY,ye),gi=ft(Oi,Oe,ie+Gt,ie+Zt,1,nt.minY,nt.maxY,ye),Oi=null),zi&&(qt=ft(zi,Oe,ie-ut,ie+At,1,nt.minY,nt.maxY,ye),jt=ft(zi,Oe,ie+Gt,ie+Zt,1,nt.minY,nt.maxY,ye),zi=null),ze>1&&console.timeEnd("clipping"),ce.push(et||[],j+1,2*q,2*ie),ce.push(gi||[],j+1,2*q,2*ie+1),ce.push(qt||[],j+1,2*q+1,2*ie),ce.push(jt||[],j+1,2*q+1,2*ie+1)}}getTile(R,j,q){R=+R,j=+j,q=+q;const ie=this.options,{extent:Q,debug:ue}=ie;if(R<0||R>24)return null;const ve=1<<R,ce=Yi(R,j=j+ve&ve-1,q);if(this.tiles[ce])return Qs(this.tiles[ce],Q);ue>1&&console.log("drilling down to z%d-%d-%d",R,j,q);let ye,ze=R,Oe=j,We=q;for(;!ye&&ze>0;)ze--,Oe>>=1,We>>=1,ye=this.tiles[Yi(ze,Oe,We)];return ye&&ye.source?(ue>1&&(console.log("found parent tile z%d-%d-%d",ze,Oe,We),console.time("drilling down")),this.splitTile(ye.source,ze,Oe,We,R,j,q),ue>1&&console.timeEnd("drilling down"),this.tiles[ce]?Qs(this.tiles[ce],Q):null):null}}function Yi(ae,R,j){return 32*((1<<ae)*j+R)+ae}function Ja(ae,R){const j=ae.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);const q=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!q)return R(null,null);const ie=new Mi(q.features);let Q=_l(ie);Q.byteOffset===0&&Q.byteLength===Q.buffer.byteLength||(Q=new Uint8Array(Q)),R(null,{vectorTile:ie,rawData:Q.buffer})}class _s extends pr{constructor(R,j,q,ie,Q,ue){super(R,j,q,ie,Ja,ue),Q&&(this.loadGeoJSON=Q),this._dynamicIndex=new R1}loadData(R,j){const q=R&&R.request,ie=q&&q.collectResourceTiming;this.loadGeoJSON(R,(Q,ue)=>{if(Q||!ue)return j(Q);if(typeof ue!="object")return j(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`));{try{if(R.filter){const ce=a.z(R.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ce.result==="error")throw new Error(ce.value.map(ye=>`${ye.key}: ${ye.message}`).join(", "));ue.features=ue.features.filter(ye=>ce.value.evaluate({zoom:0},ye))}R.dynamic?(ue.type==="Feature"&&(ue={type:"FeatureCollection",features:[ue]}),R.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(ue.features,this.loaded),R.cluster&&(ue.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=R.cluster?new pt(function({superclusterOptions:ce,clusterProperties:ye}){if(!ye||!ce)return ce;const ze={},Oe={},We={accumulated:null,zoom:0},nt={properties:null},ut=Object.keys(ye);for(const Gt of ut){const[At,Zt]=ye[Gt],et=a.z(Zt),gi=a.z(typeof At=="string"?[At,["accumulated"],["get",Gt]]:At);ze[Gt]=et.value,Oe[Gt]=gi.value}return ce.map=Gt=>{nt.properties=Gt;const At={};for(const Zt of ut)At[Zt]=ze[Zt].evaluate(We,nt);return At},ce.reduce=(Gt,At)=>{nt.properties=At;for(const Zt of ut)We.accumulated=Gt[Zt],Gt[Zt]=Oe[Zt].evaluate(We,nt)},ce}(R)).load(ue.features):R.dynamic?this._dynamicIndex:function(ce,ye){return new $r(ce,ye)}(ue,R.geojsonVtOptions)}catch(ce){return j(ce)}const ve={};if(ie){const ce=mi(q);ce&&(ve.resourceTiming={},ve.resourceTiming[R.source]=JSON.parse(JSON.stringify(ce)))}j(null,ve)}})}reloadTile(R,j){const q=this.loaded;return q&&q[R.uid]?R.partial?j(null,void 0):super.reloadTile(R,j):this.loadTile(R,j)}loadGeoJSON(R,j){if(R.request)a.h(R.request,j);else{if(typeof R.data!="string")return j(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`));try{return j(null,JSON.parse(R.data))}catch{return j(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(R,j){try{j(null,this._geoJSONIndex.getClusterExpansionZoom(R.clusterId))}catch(q){j(q)}}getClusterChildren(R,j){try{j(null,this._geoJSONIndex.getChildren(R.clusterId))}catch(q){j(q)}}getClusterLeaves(R,j){try{j(null,this._geoJSONIndex.getLeaves(R.clusterId,R.limit,R.offset))}catch(q){j(q)}}}class ia{constructor(R,j){this.tileID=new a.aQ(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.tileZoom=R.tileZoom,this.uid=R.uid,this.zoom=R.zoom,this.canonical=R.tileID.canonical,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=R.projection,this.brightness=j}parse(R,j,q,ie){this.status="parsing";const Q=new a.aQ(q.tileID.overscaledZ,q.tileID.wrap,q.tileID.canonical.z,q.tileID.canonical.x,q.tileID.canonical.y),ue={},ve=j.familiesBySource[q.source],ce=new a.dQ(Q,q.promoteId);return ce.bucketLayerIDs=[],ce.is3DTile=!0,a.e6(R).then(ye=>{if(!ye)return ie(new Error("Could not parse tile"));const ze=a.e7(ye,1/a.b7(q.tileID.canonical)),Oe=ye.json.extensionsUsed&&ye.json.extensionsUsed.includes("MAPBOX_mesh_features")||ye.json.asset.extras&&ye.json.asset.extras.MAPBOX_mesh_features,We=ye.json.extensionsUsed&&ye.json.extensionsUsed.includes("EXT_meshopt_compression"),nt=new a.Y(this.zoom,{brightness:this.brightness});for(const ut in ve)for(const Gt of ve[ut]){const At=Gt[0];ce.bucketLayerIDs.push(Gt.map(et=>et.id)),At.recalculate(nt,[]);const Zt=new a.e8(ze,Q,Oe,We,this.brightness,ce);Oe||(Zt.needsUpload=!0),ue[At.fqid]=Zt,Zt.evaluate(At)}this.status="done",ie(null,{buckets:ue,featureIndex:ce})}).catch(ye=>ie(new Error(ye.message)))}}class Ni{constructor(R,j,q,ie,Q,ue){this.actor=R,this.layerIndex=j,this.brightness=ue,this.loading={},this.loaded={}}loadTile(R,j){const q=R.uid,ie=this.loading[q]=new ia(R,this.brightness);a.e5(R.request,(Q,ue)=>{const ve=!this.loading[q];return delete this.loading[q],ve||Q?(ie.status="done",ve||(this.loaded[q]=ie),j(Q)):ue&&ue.byteLength!==0?void ie.parse(ue,this.layerIndex,R,(ce,ye)=>{ie.status="done",this.loaded=this.loaded||{},this.loaded[q]=ie,ce||!ye?j(ce):j(null,ye)}):(ie.status="done",this.loaded[q]=ie,j())})}reloadTile(R,j){const q=this.loaded,ie=R.uid;if(q&&q[ie]){const Q=q[ie];Q.projection=R.projection,Q.brightness=R.brightness;const ue=(ve,ce)=>{Q.reloadCallback&&(delete Q.reloadCallback,this.loadTile(R,j)),j(ve,ce)};Q.status==="parsing"?Q.reloadCallback=ue:Q.status==="done"&&this.loadTile(R,j)}}abortTile(R,j){const q=R.uid;this.loading[q]&&delete this.loading[q],j()}removeTile(R,j){const q=this.loaded,ie=R.uid;q&&q[ie]&&delete q[ie],j()}}class Ka{constructor(R){this.self=R,this.actor=new a.e9(R,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.aK({name:"mercator"}),this.workerSourceTypes={vector:pr,geojson:_s,"batched-model":Ni},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(j,q)=>{if(this.workerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.workerSourceTypes[j]=q},this.self.registerRTLTextPlugin=j=>{if(a.ea.isParsed())throw new Error("RTL text plugin already registered.");a.ea.applyArabicShaping=j.applyArabicShaping,a.ea.processBidirectionalText=j.processBidirectionalText,a.ea.processStyledBidirectionalText=j.processStyledBidirectionalText}}clearCaches(R,j,q){delete this.layerIndexes[R],delete this.availableImages[R],delete this.workerSources[R],delete this.demWorkerSources[R],delete this.rasterArrayWorkerSource,q()}checkIfReady(R,j,q){q()}setReferrer(R,j){this.referrer=j}spriteLoaded(R,{scope:j,isLoaded:q}){if(this.isSpriteLoaded[R]||(this.isSpriteLoaded[R]={}),this.isSpriteLoaded[R][j]=q,this.workerSources[R]&&this.workerSources[R][j])for(const ie in this.workerSources[R][j]){const Q=this.workerSources[R][j][ie];for(const ue in Q){const ve=Q[ue];ve instanceof pr&&(ve.isSpriteLoaded=q,ve.fire(new a.g("isSpriteLoaded")))}}}setImages(R,{scope:j,images:q},ie){if(this.availableImages[R]||(this.availableImages[R]={}),this.availableImages[R][j]=q,this.workerSources[R]&&this.workerSources[R][j]){for(const Q in this.workerSources[R][j]){const ue=this.workerSources[R][j][Q];for(const ve in ue)ue[ve].availableImages=q}ie()}else ie()}setProjection(R,j){this.projections[R]=a.aK(j)}setBrightness(R,j,q){this.brightness=j,q()}setLayers(R,j,q){this.getLayerIndex(R,j.scope).replace(j.layers,j.options),q()}updateLayers(R,j,q){this.getLayerIndex(R,j.scope).update(j.layers,j.removedIds,j.options),q()}loadTile(R,j,q){j.projection=this.projections[R]||this.defaultProjection,this.getWorkerSource(R,j.type,j.source,j.scope).loadTile(j,q)}loadDEMTile(R,j,q){this.getDEMWorkerSource(R,j.source,j.scope).loadTile(j,q)}decodeRasterArray(R,j,q){this.getRasterArrayWorkerSource().decodeRasterArray(j,q)}reloadTile(R,j,q){j.projection=this.projections[R]||this.defaultProjection,this.getWorkerSource(R,j.type,j.source,j.scope).reloadTile(j,q)}abortTile(R,j,q){this.getWorkerSource(R,j.type,j.source,j.scope).abortTile(j,q)}removeTile(R,j,q){this.getWorkerSource(R,j.type,j.source,j.scope).removeTile(j,q)}removeSource(R,j,q){if(!(this.workerSources[R]&&this.workerSources[R][j.scope]&&this.workerSources[R][j.scope][j.type]&&this.workerSources[R][j.scope][j.type][j.source]))return;const ie=this.workerSources[R][j.scope][j.type][j.source];delete this.workerSources[R][j.scope][j.type][j.source],ie.removeSource!==void 0?ie.removeSource(j,q):q()}loadWorkerSource(R,j,q){try{this.self.importScripts(j.url),q()}catch(ie){q(ie.toString())}}syncRTLPluginState(R,j,q){try{a.ea.setState(j);const ie=a.ea.getPluginURL();if(a.ea.isLoaded()&&!a.ea.isParsed()&&ie!=null){this.self.importScripts(ie);const Q=a.ea.isParsed();q(Q?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ie}`),Q)}}catch(ie){q(ie.toString())}}setDracoUrl(R,j){this.dracoUrl=j}getAvailableImages(R,j){this.availableImages[R]||(this.availableImages[R]={});let q=this.availableImages[R][j];return q||(q=[]),q}getLayerIndex(R,j){this.layerIndexes[R]||(this.layerIndexes[R]={});let q=this.layerIndexes[R][j];return q||(q=this.layerIndexes[R][j]=new It,q.scope=j),q}getWorkerSource(R,j,q,ie){return this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][ie]||(this.workerSources[R][ie]={}),this.workerSources[R][ie][j]||(this.workerSources[R][ie][j]={}),this.isSpriteLoaded[R]||(this.isSpriteLoaded[R]={}),this.workerSources[R][ie][j][q]||(this.workerSources[R][ie][j][q]=new this.workerSourceTypes[j]({send:(Q,ue,ve,ce,ye,ze)=>{this.actor.send(Q,ue,ve,R,ye,ze)},scheduler:this.actor.scheduler},this.getLayerIndex(R,ie),this.getAvailableImages(R,ie),this.isSpriteLoaded[R][ie],void 0,this.brightness)),this.workerSources[R][ie][j][q]}getDEMWorkerSource(R,j,q){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][q]||(this.demWorkerSources[R][q]={}),this.demWorkerSources[R][q][j]||(this.demWorkerSources[R][q][j]=new Zn),this.demWorkerSources[R][q][j]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new $a),this.rasterArrayWorkerSource}enforceCacheSizeLimit(R,j){a.eb(j)}getWorkerPerformanceMetrics(R,j,q){q(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ka(self)),Ka}),Xt(["./shared"],function(a){var mi=bi;function bi(u){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var h,p,m=new Blob([""],{type:"text/javascript"}),g=URL.createObjectURL(m);try{p=new Worker(g),h=!0}catch{h=!1}return p&&p.terminate(),URL.revokeObjectURL(g),h}()?function(){var h=document.createElement("canvas");h.width=h.height=1;var p=h.getContext("2d");if(!p)return!1;var m=p.getImageData(0,0,1,1);return m&&m.width===h.width}()?(st[o=r&&r.failIfMajorPerformanceCaveat]===void 0&&(st[o]=function(h){var p,m=function(g){var x=document.createElement("canvas"),b=Object.create(bi.webGLContextAttributes);return b.failIfMajorPerformanceCaveat=g,x.getContext("webgl2",b)}(h);if(!m)return!1;try{p=m.createShader(m.VERTEX_SHADER)}catch{return!1}return!(!p||m.isContextLost())&&(m.shaderSource(p,"void main() {}"),m.compileShader(p),m.getShaderParameter(p,m.COMPILE_STATUS)===!0)}(o)),st[o]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var o}(u)}var st={};function It(u,r,o){const h=document.createElement(u);return r!=null&&(h.className=r),o&&o.appendChild(h),h}function _i(u,r,o){const h=document.createElementNS("http://www.w3.org/2000/svg",u);for(const p of Object.keys(r))h.setAttributeNS(null,p,String(r[p]));return o&&o.appendChild(h),h}bi.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Pi=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Sr=Pi&&Pi.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Kr;function pr(){Pi&&Sr&&(Kr=Pi[Sr],Pi[Sr]="none")}function Zn(){Pi&&Sr&&(Pi[Sr]=Kr)}function $a(u){u.preventDefault(),u.stopPropagation(),window.removeEventListener("click",$a,!0)}function dn(){window.addEventListener("click",$a,!0),window.setTimeout(()=>{window.removeEventListener("click",$a,!0)},0)}function Ai(u,r){const o=u.getBoundingClientRect();return Vs(u,o,r)}function Mi(u,r){const o=u.getBoundingClientRect(),h=[];for(let p=0;p<r.length;p++)h.push(Vs(u,o,r[p]));return h}function $n(u){return window.InstallTrigger!==void 0&&u.button===2&&u.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button}function Vs(u,r,o){const h=u.offsetWidth===r.width?1:u.offsetWidth/r.width;return new a.P((o.clientX-r.left)*h,(o.clientY-r.top)*h)}class R1{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,o){this._updatedSourceCaches[r]=o,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const o=r.scope;this._updatedLayers[o]=this._updatedLayers[o]||new Set,this._updatedLayers[o].add(r.id),this.setDirty()}removeLayer(r){const o=r.scope;this._removedLayers[o]=this._removedLayers[o]||{},this._updatedLayers[o]=this._updatedLayers[o]||new Set,this._removedLayers[o][r.id]=r,this._updatedLayers[o].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const o in this._updatedLayers)r[o]=r[o]||{},r[o].updatedIds=Array.from(this._updatedLayers[o].values());for(const o in this._removedLayers)r[o]=r[o]||{},r[o].removedIds=Object.keys(this._removedLayers[o]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(r){this._updatedImages.add(r),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const ll={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pi{constructor(r,o,h,p,m,g){this.length=o.length,this.attributes=h,this.itemSize=o.bytesPerElement,this.dynamicDraw=p,this.instanceCount=g,this.context=r;const x=r.gl;this.buffer=x.createBuffer(),r.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||m||o.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,o){for(let h=0;h<this.attributes.length;h++){const p=o.attributes[this.attributes[h].name];p!==void 0&&r.enableVertexAttribArray(p)}}setVertexAttribPointers(r,o,h){for(let p=0;p<this.attributes.length;p++){const m=this.attributes[p],g=o.attributes[m.name];g!==void 0&&r.vertexAttribPointer(g,m.components,r[ll[m.type]],!1,this.itemSize,m.offset+this.itemSize*(h||0))}}setVertexAttribDivisor(r,o,h){for(let p=0;p<this.attributes.length;p++){const m=o.attributes[this.attributes[p].name];m!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(m,h)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class si{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Qr extends si{getDefault(){return a.C.transparent}set(r){const o=this.current;(r.r!==o.r||r.g!==o.g||r.b!==o.b||r.a!==o.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Us extends si{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class cl extends si{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class ul extends si{getDefault(){return[!0,!0,!0,!0]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class li extends si{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Ga extends si{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Nr extends si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const o=this.current;(r.func!==o.func||r.ref!==o.ref||r.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class hl extends si{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class qa extends si{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=r,this.dirty=!1}}class ds extends si{getDefault(){return[0,1]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class ri extends si{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=r,this.dirty=!1}}class Zs extends si{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class er extends si{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.BLEND):o.disable(o.BLEND),this.current=r,this.dirty=!1}}class dl extends si{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class pl extends si{getDefault(){return a.C.transparent}set(r){const o=this.current;(r.r!==o.r||r.g!==o.g||r.b!==o.b||r.a!==o.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class fl extends si{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class gt extends si{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=r,this.dirty=!1}}class $s extends si{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class yi extends si{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let ml=class extends si{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}};class _l extends si{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class gl extends si{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Wa extends si{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Gs extends si{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class en extends si{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class tn extends si{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Ha extends si{getDefault(){return null}set(r){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class pt extends si{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class yt extends si{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class qs extends si{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class br extends si{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Tn extends si{constructor(r,o){super(r),this.context=r,this.parent=o}getDefault(){return null}}class yl extends Tn{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ps extends Tn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,this.attachment(),o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class xl extends Tn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,this.attachment(),o.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Gn extends ps{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class qn{constructor(r,o,h,p,m){this.context=r,this.width=o,this.height=h;const g=this.framebuffer=r.gl.createFramebuffer();p&&(this.colorAttachment=new yl(r,g)),m&&(this.depthAttachmentType=m,this.depthAttachment=m==="renderbuffer"?new ps(r,g):new xl(r,g))}destroy(){const r=this.context.gl;if(this.colorAttachment){const o=this.colorAttachment.get();o&&r.deleteTexture(o)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const o=this.depthAttachment.get();o&&r.deleteRenderbuffer(o)}else{const o=this.depthAttachment.get();o&&r.deleteTexture(o)}r.deleteFramebuffer(this.framebuffer)}}class Ws{constructor(r,o){this.gl=r,this.clearColor=new Qr(this),this.clearDepth=new Us(this),this.clearStencil=new cl(this),this.colorMask=new ul(this),this.depthMask=new li(this),this.stencilMask=new Ga(this),this.stencilFunc=new Nr(this),this.stencilOp=new hl(this),this.stencilTest=new qa(this),this.depthRange=new ds(this),this.depthTest=new ri(this),this.depthFunc=new Zs(this),this.blend=new er(this),this.blendFunc=new dl(this),this.blendColor=new pl(this),this.blendEquation=new fl(this),this.cullFace=new gt(this),this.cullFaceSide=new $s(this),this.frontFace=new yi(this),this.program=new ml(this),this.activeTexture=new _l(this),this.viewport=new gl(this),this.bindFramebuffer=new Wa(this),this.bindRenderbuffer=new Gs(this),this.bindTexture=new en(this),this.bindVertexBuffer=new tn(this),this.bindElementBuffer=new Ha(this),this.bindVertexArrayOES=new pt(this),this.pixelStoreUnpack=new yt(this),this.pixelStoreUnpackPremultiplyAlpha=new qs(this),this.pixelStoreUnpackFlipY=new br(this),this.options=o?{...o}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,o,h){return new a.I(this,r,o,h)}createVertexBuffer(r,o,h,p,m){return new pi(this,r,o,h,p,m)}createRenderbuffer(r,o,h){const p=this.gl,m=p.createRenderbuffer();return this.bindRenderbuffer.set(m),p.renderbufferStorage(p.RENDERBUFFER,r,o,h),this.bindRenderbuffer.set(null),m}createFramebuffer(r,o,h,p){return new qn(this,r,o,h,p)}clear({color:r,depth:o,stencil:h,colorMask:p}){const m=this.gl;let g=0;r&&(g|=m.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(p||[!0,!0,!0,!0])),o!==void 0&&(g|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),h!==void 0&&(g|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),m.clear(g)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){a.d(r.blendFunction,a.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Xa{constructor(r,o,h,p){const m={width:h[0],height:h[1],data:null},g=r.gl;this.targetColorTexture=new a.T(r,m,g.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new a.T(r,m,g.RGBA,{useMipmap:!1}),this.context=r,this.updateParticleTexture(o,p),this.lastInvalidatedAt=0}updateParticleTexture(r,o){if(this.particleTextureDimension===o.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const h=this.context.gl,p=o.width*o.height;this.particleTexture0=new a.T(this.context,o,h.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,o,h.RGBA,{premultiply:!1,useMipmap:!1});const m=new a.S;m.reserve(p);for(let g=0;g<p;g++)m.emplaceBack(g);this.particleIndexBuffer=this.context.createVertexBuffer(m,a.p.members,!0),this.particleSegment=a.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=o.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=a.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class Hs extends a.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.numModelsLoading={}}loadModel(r,o){return a.l(this.requestManager.transformRequest(o,a.R.Model).url).then(h=>{if(!h)return;const p=a.c(h),m=new a.M(r,void 0,void 0,p);return m.computeBoundsAndApplyParent(),m}).catch(h=>{if(h&&h.status===404)return null;this.fire(new a.f(new Error(`Could not load model ${r} from ${o}: ${h.message}`)))})}load(r,o){this.models[o]||(this.models[o]={});const h=Object.keys(r);this.numModelsLoading[o]=(this.numModelsLoading[o]||0)+h.length;const p=[];for(const m of h)p.push(this.loadModel(m,r[m]));Promise.allSettled(p).then(m=>{for(let g=0;g<m.length;g++){const{status:x,value:b}=m[g];x==="fulfilled"&&b&&(this.models[o][h[g]]={model:b,numReferences:1})}this.numModelsLoading[o]-=h.length,this.fire(new a.g("data",{dataType:"style"}))}).catch(m=>{this.fire(new a.f(new Error(`Could not load models: ${m.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,o){return!!this.getModel(r,o)}getModel(r,o){return this.models[o]||(this.models[o]={}),this.models[o][r]?this.models[o][r].model:void 0}addModel(r,o,h){this.models[h]||(this.models[h]={}),this.hasModel(r,h)&&this.models[h][r].numReferences++,this.load({[r]:this.requestManager.normalizeModelURL(o)},h)}addModels(r,o){this.models[o]||(this.models[o]={});const h={};for(const p in r)this.models[o][p]={},h[p]=this.requestManager.normalizeModelURL(r[p]);this.load(h,o)}addModelsFromBucket(r,o){this.models[o]||(this.models[o]={});const h={};for(const p of r)this.hasModel(p,o)?this.models[o][p].numReferences++:h[p]=this.requestManager.normalizeModelURL(p);this.load(h,o)}removeModel(r,o){if(this.models[o]&&this.models[o][r]&&(this.models[o][r].numReferences--,this.models[o][r].numReferences===0)){const h=this.models[o][r].model;delete this.models[o][r],h.destroy()}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,o){this.models[o]||(this.models[o]={});for(const h in this.models[o])this.models[o][h].model&&this.models[o][h].model.upload(r.context)}}function Xs(u){const{userImage:r}=u;return!!(r&&r.render&&r.render())&&(u.data.replace(new Uint8Array(r.data.buffer)),!0)}class Vr extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(r){this.images[r]={},this.loaded[r]=!1,this.updatedImages[r]={},this.patterns[r]={},this.callbackDispatchedThisFrame[r]={},this.atlasImage[r]=new a.j({width:1,height:1})}isLoaded(){for(const r in this.loaded)if(!this.loaded[r])return!1;return!0}setLoaded(r,o){if(this.loaded[o]!==r&&(this.loaded[o]=r,r)){for(const{ids:h,callback:p}of this.requestors)this._notify(h,o,p);this.requestors=[]}}hasImage(r,o){return!!this.getImage(r,o)}getImage(r,o){return this.images[o][r]}addImage(r,o,h){this._validate(r,h)&&(this.images[o][r]=h)}_validate(r,o){let h=!0;return this._validateStretch(o.stretchX,o.data&&o.data.width)||(this.fire(new a.f(new Error(`Image "${r}" has invalid "stretchX" value`))),h=!1),this._validateStretch(o.stretchY,o.data&&o.data.height)||(this.fire(new a.f(new Error(`Image "${r}" has invalid "stretchY" value`))),h=!1),this._validateContent(o.content,o)||(this.fire(new a.f(new Error(`Image "${r}" has invalid "content" value`))),h=!1),h}_validateStretch(r,o){if(!r)return!0;let h=0;for(const p of r){if(p[0]<h||p[1]<p[0]||o<p[1])return!1;h=p[1]}return!0}_validateContent(r,o){return!(r&&(r.length!==4||r[0]<0||o.data.width<r[0]||r[1]<0||o.data.height<r[1]||r[2]<0||o.data.width<r[2]||r[3]<0||o.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,o,h){h.version=this.images[o][r].version+1,this.images[o][r]=h,this.updatedImages[o][r]=!0}removeImage(r,o){const h=this.images[o][r];delete this.images[o][r],delete this.patterns[o][r],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(r){return Object.keys(this.images[r])}getImages(r,o,h){let p=!0;const m=!!this.loaded[o];if(!m)for(const g of r)this.images[o][g]||(p=!1);m||p?this._notify(r,o,h):this.requestors.push({ids:r,scope:o,callback:h})}getUpdatedImages(r){return this.updatedImages[r]}_notify(r,o,h){const p={};for(const m of r){this.images[o][m]||this.fire(new a.g("styleimagemissing",{id:m}));const g=this.images[o][m];g?p[m]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:a.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,p)}getPixelSize(r){const{width:o,height:h}=this.atlasImage[r];return{width:o,height:h}}getPattern(r,o,h){const p=this.patterns[o][r],m=this.getImage(r,o);if(!m)return null;if(p&&p.position.version===m.version)return p.position;if(p)p.position.version=m.version;else{const g={w:m.data.width+2,h:m.data.height+2,x:0,y:0},x=new a.m(g,m);this.patterns[o][r]={bin:g,position:x}}return this._updatePatternAtlas(o,h),this.patterns[o][r].position}bind(r,o){const h=r.gl;let p=this.atlasTexture[o];p?this.dirty&&(p.update(this.atlasImage[o]),this.dirty=!1):(p=new a.T(r,this.atlasImage[o],h.RGBA),this.atlasTexture[o]=p),p.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(r,o){const h=[];for(const x in this.patterns[r])h.push(this.patterns[r][x].bin);const{w:p,h:m}=a.k(h),g=this.atlasImage[r];g.resize({width:p||1,height:m||1});for(const x in this.patterns[r]){const{bin:b}=this.patterns[r][x],w=b.x+1,T=b.y+1,E=this.images[r][x].data,O=E.width,z=E.height;a.j.copy(E,g,{x:0,y:0},{x:w,y:T},{width:O,height:z},o),a.j.copy(E,g,{x:0,y:z-1},{x:w,y:T-1},{width:O,height:1},o),a.j.copy(E,g,{x:0,y:0},{x:w,y:T+z},{width:O,height:1},o),a.j.copy(E,g,{x:O-1,y:0},{x:w-1,y:T},{width:1,height:z},o),a.j.copy(E,g,{x:0,y:0},{x:w+O,y:T},{width:1,height:z},o)}this.dirty=!0}beginFrame(){for(const r in this.images)this.callbackDispatchedThisFrame[r]={}}dispatchRenderCallbacks(r,o){for(const h of r){if(this.callbackDispatchedThisFrame[o][h])continue;this.callbackDispatchedThisFrame[o][h]=!0;const p=this.images[o][h];Xs(p)&&this.updateImage(h,o,p)}}}function xr(u){const r=u.key,o=u.value,h=u.valueSpec||{},p=u.objectElementValidators||{},m=u.style,g=u.styleSpec;let x=[];const b=a.o(o);if(b!=="object")return[new a.V(r,o,`object expected, ${b} found`)];for(const w in o){const T=w.split(".")[0];let E;p[T]?E=p[T]:h[T]?E=Ni:p["*"]?E=p["*"]:h["*"]&&(E=Ni),E?x=x.concat(E({key:(r&&`${r}.`)+w,value:o[w],valueSpec:h[T]||h["*"],style:m,styleSpec:g,object:o,objectKey:w},o)):x.push(new a.n(r,o[w],`unknown property "${w}"`))}for(const w in h)p[w]||h[w].required&&h[w].default===void 0&&o[w]===void 0&&x.push(new a.V(r,o,`missing required property "${w}"`));return x}function ft(u){const r=u.value,o=u.valueSpec,h=u.style,p=u.styleSpec,m=u.key,g=u.arrayElementValidator||Ni;if(a.o(r)!=="array")return[new a.V(m,r,`array expected, ${a.o(r)} found`)];if(o.length&&r.length!==o.length)return[new a.V(m,r,`array length ${o.length} expected, length ${r.length} found`)];if(o["min-length"]&&r.length<o["min-length"])return[new a.V(m,r,`array length at least ${o["min-length"]} expected, length ${r.length} found`)];let x={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};p.$version<7&&(x.function=o.function),a.o(o.value)==="object"&&(x=o.value);let b=[];for(let w=0;w<r.length;w++)b=b.concat(g({array:r,arrayIndex:w,value:r[w],valueSpec:x,style:h,styleSpec:p,key:`${m}[${w}]`},!0));return b}function Ys(u){const r=u.key,o=u.value,h=u.valueSpec;let p=a.o(o);if(p==="number"&&o!=o&&(p="NaN"),p!=="number")return[new a.V(r,o,`number expected, ${p} found`)];if("minimum"in h){let m=h.minimum;if(a.o(h.minimum)==="array"&&(m=h.minimum[u.arrayIndex]),o<m)return[new a.V(r,o,`${o} is less than the minimum value ${m}`)]}if("maximum"in h){let m=h.maximum;if(a.o(h.maximum)==="array"&&(m=h.maximum[u.arrayIndex]),o>m)return[new a.V(r,o,`${o} is greater than the maximum value ${m}`)]}return[]}function fr(u){const r=u.valueSpec,o=a.u(u.value.type);let h,p,m,g={};const x=o!=="categorical"&&u.value.property===void 0,b=!x,w=a.o(u.value.stops)==="array"&&a.o(u.value.stops[0])==="array"&&a.o(u.value.stops[0][0])==="object",T=xr({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(z){if(o==="identity")return[new a.V(z.key,z.value,'identity function may not have a "stops" property')];let L=[];const k=z.value;return L=L.concat(ft({key:z.key,value:k,valueSpec:z.valueSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:E})),a.o(k)==="array"&&k.length===0&&L.push(new a.V(z.key,k,"array must have at least one stop")),L},default:function(z){return Ni({key:z.key,value:z.value,valueSpec:r,style:z.style,styleSpec:z.styleSpec})}}});return o==="identity"&&x&&T.push(new a.V(u.key,u.value,'missing required property "property"')),o==="identity"||u.value.stops||T.push(new a.V(u.key,u.value,'missing required property "stops"')),o==="exponential"&&u.valueSpec.expression&&!a.s(u.valueSpec)&&T.push(new a.V(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(b&&!a.r(u.valueSpec)?T.push(new a.V(u.key,u.value,"property functions not supported")):x&&!a.t(u.valueSpec)&&T.push(new a.V(u.key,u.value,"zoom functions not supported"))),o!=="categorical"&&!w||u.value.property!==void 0||T.push(new a.V(u.key,u.value,'"property" property is required')),T;function E(z){let L=[];const k=z.value,B=z.key;if(a.o(k)!=="array")return[new a.V(B,k,`array expected, ${a.o(k)} found`)];if(k.length!==2)return[new a.V(B,k,`array length 2 expected, length ${k.length} found`)];if(w){if(a.o(k[0])!=="object")return[new a.V(B,k,`object expected, ${a.o(k[0])} found`)];if(k[0].zoom===void 0)return[new a.V(B,k,"object stop key must have zoom")];if(k[0].value===void 0)return[new a.V(B,k,"object stop key must have value")];const F=a.u(k[0].zoom);if(typeof F!="number")return[new a.V(B,k[0].zoom,"stop zoom values must be numbers")];if(m&&m>F)return[new a.V(B,k[0].zoom,"stop zoom values must appear in ascending order")];F!==m&&(m=F,p=void 0,g={}),L=L.concat(xr({key:`${B}[0]`,value:k[0],valueSpec:{zoom:{}},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:Ys,value:O}}))}else L=L.concat(O({key:`${B}[0]`,value:k[0],valueSpec:{},style:z.style,styleSpec:z.styleSpec},k));return a.v(a.x(k[1]))?L.concat([new a.V(`${B}[1]`,k[1],"expressions are not allowed in function stops.")]):L.concat(Ni({key:`${B}[1]`,value:k[1],valueSpec:r,style:z.style,styleSpec:z.styleSpec}))}function O(z,L){const k=a.o(z.value),B=a.u(z.value),F=z.value!==null?z.value:L;if(h){if(k!==h)return[new a.V(z.key,F,`${k} stop domain type must match previous stop domain type ${h}`)]}else h=k;if(k!=="number"&&k!=="string"&&k!=="boolean"&&typeof B!="number"&&typeof B!="string"&&typeof B!="boolean")return[new a.V(z.key,F,"stop domain value must be a number, string, or boolean")];if(k!=="number"&&o!=="categorical"){let $=`number expected, ${k} found`;return a.r(r)&&o===void 0&&($+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(z.key,F,$)]}return o!=="categorical"||k!=="number"||typeof B=="number"&&isFinite(B)&&Math.floor(B)===B?o!=="categorical"&&k==="number"&&typeof B=="number"&&typeof p=="number"&&p!==void 0&&B<p?[new a.V(z.key,F,"stop domain values must appear in ascending order")]:(p=B,o==="categorical"&&B in g?[new a.V(z.key,F,"stop domain values must be unique")]:(g[B]=!0,[])):[new a.V(z.key,F,`integer expected, found ${String(B)}`)]}}function rn(u){const r=(u.expressionContext==="property"?a.y:a.z)(a.x(u.value),u.valueSpec);if(r.result==="error")return r.value.map(h=>new a.V(`${u.key}${h.key}`,u.value,h.message));const o=r.value.expression||r.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!o.outputDefined())return[new a.V(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!a.A(o))return[new a.V(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter")return fs(o,u);if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!a.B(o,["zoom","feature-state"]))return[new a.V(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!a.D(o))return[new a.V(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function fs(u,r){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const p of r.valueSpec.expression.parameters)o.delete(p);if(o.size===0)return[];const h=[];return u instanceof a.F&&o.has(u.name)?[new a.V(r.key,r.value,`["${u.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(u.eachChild(p=>{h.push(...fs(p,r))}),h)}function Ur(u){const r=u.key,o=u.value,h=u.valueSpec,p=[];return Array.isArray(h.values)?h.values.indexOf(a.u(o))===-1&&p.push(new a.V(r,o,`expected one of [${h.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(h.values).indexOf(a.u(o))===-1&&p.push(new a.V(r,o,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(o)} found`)),p}function Js(u){return a.H(a.x(u.value))?rn(a.q({},u,{expressionContext:"filter",valueSpec:u.styleSpec[`filter_${u.layerType||"fill"}`]})):Ya(u)}function Ya(u){const r=u.value,o=u.key;if(a.o(r)!=="array")return[new a.V(o,r,`array expected, ${a.o(r)} found`)];const h=u.styleSpec;let p,m=[];if(r.length<1)return[new a.V(o,r,"filter array must have at least 1 element")];switch(m=m.concat(Ur({key:`${o}[0]`,value:r[0],valueSpec:h.filter_operator,style:u.style,styleSpec:u.styleSpec})),a.u(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&a.u(r[1])==="$type"&&m.push(new a.V(o,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&m.push(new a.V(o,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=a.o(r[1]),p!=="string"&&m.push(new a.V(`${o}[1]`,r[1],`string expected, ${p} found`)));for(let g=2;g<r.length;g++)p=a.o(r[g]),a.u(r[1])==="$type"?m=m.concat(Ur({key:`${o}[${g}]`,value:r[g],valueSpec:h.geometry_type,style:u.style,styleSpec:u.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&m.push(new a.V(`${o}[${g}]`,r[g],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let g=1;g<r.length;g++)m=m.concat(Ya({key:`${o}[${g}]`,value:r[g],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":p=a.o(r[1]),r.length!==2?m.push(new a.V(o,r,`filter array for "${r[0]}" operator must have 2 elements`)):p!=="string"&&m.push(new a.V(`${o}[1]`,r[1],`string expected, ${p} found`))}return m}function Ks(u,r){const o=u.key,h=u.style,p=u.layer,m=u.styleSpec,g=u.value,x=u.objectKey,b=m[`${r}_${u.layerType}`];if(!b)return[];const w=x.match(/^(.*)-transition$/);if(r==="paint"&&w&&b[w[1]]&&b[w[1]].transition)return Ni({key:o,value:g,valueSpec:m.transition,style:h,styleSpec:m});const T=u.valueSpec||b[x];if(!T)return[new a.n(o,g,`unknown property "${x}"`)];let E;if(a.o(g)==="string"&&a.r(T)&&!T.tokens&&(E=/^{([^}]+)}$/.exec(g))){const z=`\`{ "type": "identity", "property": ${E?JSON.stringify(E[1]):'"_"'} }\``;return[new a.V(o,g,`"${x}" does not support interpolation syntax
Use an identity property function instead: ${z}.`)]}const O=[];if(u.layerType==="symbol")x!=="text-field"||!h||h.glyphs||h.imports||O.push(new a.V(o,g,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&a.J(a.x(g))&&a.u(g.type)==="identity"&&O.push(new a.V(o,g,'"text-font" does not support identity functions'));else if(u.layerType==="model"&&r==="paint"&&p&&p.layout&&p.layout.hasOwnProperty("model-id")&&a.r(T)&&(a.K(T)||a.t(T))){const z=a.y(a.x(g),T),L=z.value.expression||z.value._styleExpression.expression;L&&!a.B(L,["measure-light"])&&(x==="model-emissive-strength"&&a.D(L)&&a.A(L)||O.push(new a.V(o,g,`${x} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return O.concat(Ni({key:u.key,value:g,valueSpec:T,style:h,styleSpec:m,expressionContext:"property",propertyType:r,propertyKey:x}))}function ms(u){return Ks(u,"paint")}function Qs(u){return Ks(u,"layout")}function ea(u){let r=[];const o=u.value,h=u.key,p=u.style,m=u.styleSpec;o.type||o.ref||r.push(new a.V(h,o,'either "type" or "ref" is required'));let g=a.u(o.type);const x=a.u(o.ref);if(o.id){const b=a.u(o.id);for(let w=0;w<u.arrayIndex;w++){const T=p.layers[w];a.u(T.id)===b&&r.push(new a.V(h,o.id,`duplicate layer id "${o.id}", previously used at line ${T.id.__line__}`))}}if("ref"in o){let b;["type","source","source-layer","filter","layout"].forEach(w=>{w in o&&r.push(new a.V(h,o[w],`"${w}" is prohibited for ref layers`))}),p.layers.forEach(w=>{a.u(w.id)===x&&(b=w)}),b?b.ref?r.push(new a.V(h,o.ref,"ref cannot reference another ref layer")):g=a.u(b.type):typeof x=="string"&&r.push(new a.V(h,o.ref,`ref layer "${x}" not found`))}else if(g!=="background"&&g!=="sky"&&g!=="slot")if(o.source){const b=p.sources&&p.sources[o.source],w=b&&a.u(b.type);b?w==="vector"&&g==="raster"?r.push(new a.V(h,o.source,`layer "${o.id}" requires a raster source`)):w==="raster"&&g!=="raster"?r.push(new a.V(h,o.source,`layer "${o.id}" requires a vector source`)):w!=="vector"||o["source-layer"]?w==="raster-dem"&&g!=="hillshade"?r.push(new a.V(h,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="raster-array"||["raster","raster-particle"].includes(g)?g!=="line"||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||w==="geojson"&&b.lineMetrics?g==="raster-particle"&&w!=="raster-array"&&r.push(new a.V(h,o.source,`layer "${o.id}" requires a 'raster-array' source.`)):r.push(new a.V(h,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new a.V(h,o.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new a.V(h,o,`layer "${o.id}" must specify a "source-layer"`)):r.push(new a.V(h,o.source,`source "${o.source}" not found`))}else r.push(new a.V(h,o,'missing required property "source"'));return r=r.concat(xr({key:h,value:o,valueSpec:m.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ni({key:`${h}.type`,value:o.type,valueSpec:m.layer.type,style:u.style,styleSpec:u.styleSpec,object:o,objectKey:"type"}),filter:b=>Js(a.q({layerType:g},b)),layout:b=>xr({layer:o,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":w=>Qs(a.q({layerType:g},w))}}),paint:b=>xr({layer:o,key:b.key,value:b.value,valueSpec:{},style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":w=>ms(a.q({layerType:g,layer:o},w))}})}})),r}function Wn(u){const r=u.value,o=u.key,h=a.o(r);return h!=="string"?[new a.V(o,r,`string expected, ${h} found`)]:[]}const ta={promoteId:function({key:u,value:r}){if(a.o(r)==="string")return Wn({key:u,value:r});{const o=[];for(const h in r)o.push(...Wn({key:`${u}.${h}`,value:r[h]}));return o}}};function Zr(u){const r=u.value,o=u.key,h=u.styleSpec,p=u.style;if(!r.type)return[new a.V(o,r,'"type" is required')];const m=a.u(r.type);let g=[];switch(["vector","raster","raster-dem","raster-array"].includes(m)&&(r.url||r.tiles||g.push(new a.n(o,r,'Either "url" or "tiles" is required.'))),m){case"vector":case"raster":case"raster-dem":case"raster-array":return g=g.concat(xr({key:o,value:r,valueSpec:h[`source_${m.replace("-","_")}`],style:u.style,styleSpec:h,objectElementValidators:ta})),g;case"geojson":if(g=xr({key:o,value:r,valueSpec:h.source_geojson,style:p,styleSpec:h,objectElementValidators:ta}),r.cluster)for(const x in r.clusterProperties){const[b,w]=r.clusterProperties[x],T=typeof b=="string"?[b,["accumulated"],["get",x]]:b;g.push(...rn({key:`${o}.${x}.map`,value:w,expressionContext:"cluster-map"})),g.push(...rn({key:`${o}.${x}.reduce`,value:T,expressionContext:"cluster-reduce"}))}return g;case"video":return xr({key:o,value:r,valueSpec:h.source_video,style:p,styleSpec:h});case"image":return xr({key:o,value:r,valueSpec:h.source_image,style:p,styleSpec:h});case"canvas":return[new a.V(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ur({key:`${o}.type`,value:r.type,valueSpec:{values:L1(h)},style:p,styleSpec:h})}}function L1(u){return u.source.reduce((r,o)=>{const h=u[o];return h.type.type==="enum"&&(r=r.concat(Object.keys(h.type.values))),r},[])}function $r(u){const r=u.value,o=u.styleSpec,h=o.light,p=u.style;let m=[];const g=a.o(r);if(r===void 0)return m;if(g!=="object")return m=m.concat([new a.V("light",r,`object expected, ${g} found`)]),m;for(const x in r){const b=x.match(/^(.*)-transition$/);m=m.concat(b&&h[b[1]]&&h[b[1]].transition?Ni({key:x,value:r[x],valueSpec:o.transition,style:p,styleSpec:o}):h[x]?Ni({key:x,value:r[x],valueSpec:h[x],style:p,styleSpec:o}):[new a.V(x,r[x],`unknown property "${x}"`)])}return m}function Yi(u){const r=u.value;let o=[];if(!r)return o;const h=a.o(r);if(h!=="object")return o=o.concat([new a.V("light-3d",r,`object expected, ${h} found`)]),o;const p=u.styleSpec,m=p["light-3d"],g=u.key,x=u.style,b=u.style.lights;for(const E of["type","id"])if(!(E in r))return o=o.concat([new a.V("light-3d",r,`missing property ${E} on light`)]),o;if(r.type&&b)for(let E=0;E<u.arrayIndex;E++){const O=a.u(r.type),z=b[E];a.u(z.type)===O&&o.push(new a.V(g,r.id,`duplicate light type "${r.type}", previously defined at line ${z.id.__line__}`))}const w=`properties_light_${r.type}`;if(!(w in p))return o=o.concat([new a.V("light-3d",r,`Invalid light type ${r.type}`)]),o;const T=p[w];for(const E in r)if(E==="properties"){const O=r[E],z=a.o(O);if(z!=="object")return o=o.concat([new a.V("properties",O,`object expected, ${z} found`)]),o;for(const L in O)o=o.concat(T[L]?Ni({key:L,value:O[L],valueSpec:T[L],style:x,styleSpec:p}):[new a.n(u.key,O[L],`unknown property "${L}"`)])}else{const O=E.match(/^(.*)-transition$/);o=o.concat(O&&m[O[1]]&&m[O[1]].transition?Ni({key:E,value:r[E],valueSpec:p.transition,style:x,styleSpec:p}):m[E]?Ni({key:E,value:r[E],valueSpec:m[E],style:x,styleSpec:p}):[new a.n(E,r[E],`unknown property "${E}"`)])}return o}function Ja(u){const r=u.value,o=u.key,h=u.style,p=u.styleSpec,m=p.terrain;let g=[];const x=a.o(r);if(r===void 0||x==="null")return g;if(x!=="object")return g=g.concat([new a.V("terrain",r,`object expected, ${x} found`)]),g;for(const b in r){const w=b.match(/^(.*)-transition$/);g=g.concat(w&&m[w[1]]&&m[w[1]].transition?Ni({key:b,value:r[b],valueSpec:p.transition,style:h,styleSpec:p}):m[b]?Ni({key:b,value:r[b],valueSpec:m[b],style:h,styleSpec:p}):[new a.n(b,r[b],`unknown property "${b}"`)])}if(r.source){const b=h.sources&&h.sources[r.source],w=b&&a.u(b.type);b?w!=="raster-dem"&&g.push(new a.V(o,r.source,`terrain cannot be used with a source of type ${String(w)}, it only be used with a "raster-dem" source type`)):g.push(new a.V(o,r.source,`source "${r.source}" not found`))}else g.push(new a.V(o,r,'terrain is missing required property "source"'));return g}function _s(u){const r=u.value,o=u.style,h=u.styleSpec,p=h.fog;let m=[];const g=a.o(r);if(r===void 0)return m;if(g!=="object")return m=m.concat([new a.V("fog",r,`object expected, ${g} found`)]),m;for(const x in r){const b=x.match(/^(.*)-transition$/);m=m.concat(b&&p[b[1]]&&p[b[1]].transition?Ni({key:x,value:r[x],valueSpec:h.transition,style:o,styleSpec:h}):p[x]?Ni({key:x,value:r[x],valueSpec:p[x],style:o,styleSpec:h}):[new a.n(x,r[x],`unknown property "${x}"`)])}return m}const ia={"*":()=>[],array:ft,boolean:function(u){const r=u.value,o=u.key,h=a.o(r);return h!=="boolean"?[new a.V(o,r,`boolean expected, ${h} found`)]:[]},number:Ys,color:function(u){const r=u.key,o=u.value,h=a.o(o);return h!=="string"?[new a.V(r,o,`color expected, ${h} found`)]:a.G(o)===null?[new a.V(r,o,`color expected, "${o}" found`)]:[]},enum:Ur,filter:Js,function:fr,layer:ea,object:xr,source:Zr,model:a.L,light:$r,"light-3d":Yi,terrain:Ja,fog:_s,string:Wn,formatted:function(u){return Wn(u).length===0?[]:rn(u)},resolvedImage:function(u){return Wn(u).length===0?[]:rn(u)},projection:function(u){const r=u.value,o=u.styleSpec,h=o.projection,p=u.style;let m=[];const g=a.o(r);if(g==="object")for(const x in r)m=m.concat(Ni({key:x,value:r[x],valueSpec:h[x],style:p,styleSpec:o}));else g!=="string"&&(m=m.concat([new a.V("projection",r,`object or string expected, ${g} found`)]));return m},import:function(u){const{value:r,styleSpec:o}=u,{data:h,...p}=r;Object.defineProperty(p,"__line__",{value:r.__line__,enumerable:!1});let m=xr(a.q({},u,{value:p,valueSpec:o.import}));return a.u(p.id)===""&&m.push(new a.V(`${u.key}.id`,p,"import id can't be an empty string")),h&&(m=m.concat(ae(h,o,{key:`${u.key}.data`}))),m}};function Ni(u,r=!1){const o=u.value,h=u.valueSpec,p=u.styleSpec;if(h.expression&&a.J(a.u(o)))return fr(u);if(h.expression&&a.v(a.x(o)))return rn(u);if(h.type&&ia[h.type]){const m=ia[h.type](u);return r===!0&&m.length>0&&a.o(u.value)==="array"?rn(u):m}return xr(a.q({},u,{valueSpec:h.type?p[h.type]:h}))}function Ka(u){const r=u.value,o=u.key,h=Wn(u);return h.length||(r.indexOf("{fontstack}")===-1&&h.push(new a.V(o,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&h.push(new a.V(o,r,'"glyphs" url must include a "{range}" token'))),h}function ae(u,r=a.N,o={}){return Ni({key:o.key||"",value:u,valueSpec:r.$root,styleSpec:r,style:u,objectElementValidators:{glyphs:Ka,"*":()=>[]}})}function R(u,r=a.N){return We(ae(u,r))}const j=u=>We(Zr(u)),q=u=>We($r(u)),ie=u=>We(Yi(u)),Q=u=>We(Ja(u)),ue=u=>We(_s(u)),ve=u=>We(ea(u)),ce=u=>We(Js(u)),ye=u=>We(ms(u)),ze=u=>We(Qs(u)),Oe=u=>We(a.L(u));function We(u){return u.slice().sort((r,o)=>r.line&&o.line?r.line-o.line:0)}function nt(u,r){let o=!1;if(r&&r.length)for(const h of r)h instanceof a.n?a.w(h.message):(u.fire(new a.f(new Error(h.message))),o=!0);return o}let ut;class Gt extends a.E{constructor(r,o="flat"){super(),this._transitionable=new a.O(ut||(ut=new a.U({anchor:new a.W(a.N.light.anchor),position:new a.X(a.N.light.position),color:new a.W(a.N.light.color),intensity:new a.W(a.N.light.intensity)}))),this.setLight(r,o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,o,h={}){this._validate(q,r,h)||(this._transitionable.setTransitionOrValue(r),this.id=o)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,o,h){return(!h||h.validate!==!1)&&nt(this,r.call(R,a.Q({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.N})))}}const At=new a.U({source:new a.W(a.N.terrain.source),exaggeration:new a.W(a.N.terrain.exaggeration)});let Zt=class extends a.E{constructor(u,r,o,h){super(),this.scope=o,this._transitionable=new a.O(At,o,h),this._transitionable.setTransitionOrValue(u,h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(u,r){this._transitionable.setTransitionOrValue(u,r)}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}getExaggeration(u){return this._transitioning.possiblyEvaluate(new a.Y(u)).get("exaggeration")}isZoomDependent(){const u=this._transitionable._values.exaggeration;return u!=null&&u.value!=null&&u.value.expression!=null&&u.value.expression instanceof a.Z}};const et=45,gi=65,qt=.05;function jt(u,r,o,h){const p=a.a0(et,gi,o),[m,g]=Oi(u,h);let x=1-Math.min(1,Math.exp((r-m)/(g-m)*-6));return x*=x*x,x=Math.min(1,1.00747*x),x*p*u.alpha}function Oi(u,r){const o=.5/Math.tan(.5*r);return[u.range[0]+o,u.range[1]+o]}function zi(u,r,o,h,p){const m=a.$.transformMat4([],[r,o,h],p.mercatorFogMatrix);return jt(u,a.$.length(m),p.pitch,p._fov)}function qi(u,r,o,h,p,m,g){const x=[[o,h,0],[p,h,0],[p,m,0],[o,m,0]];let b=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(const T of x){const E=a.$.transformMat4([],T,r),O=a.$.length(E);b=Math.min(b,O),w=Math.max(w,O)}return[jt(u,b,g.pitch,g._fov),jt(u,w,g.pitch,g._fov)]}const tr=new a.U({range:new a.W(a.N.fog.range),color:new a.W(a.N.fog.color),"high-color":new a.W(a.N.fog["high-color"]),"space-color":new a.W(a.N.fog["space-color"]),"horizon-blend":new a.W(a.N.fog["horizon-blend"]),"star-intensity":new a.W(a.N.fog["star-intensity"]),"vertical-range":new a.W(a.N.fog["vertical-range"])});class mr extends a.E{constructor(r,o,h,p){super(),this._transitionable=new a.O(tr,h,new Map(p)),this.set(r,p),this._transitioning=this._transitionable.untransitioned(),this._transform=o,this.properties=new a.a1(tr),this.scope=h}get state(){const r=this._transform,o=r.projection.name==="globe",h=a.a2(r.zoom),p=this.properties.get("range"),m=[.5,3];return{range:o?[a.a3(m[0],p[0],h),a.a3(m[1],p[1],h)]:p,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,o,h={}){if(this._validate(ue,r,h))return;const p=a.Q({},r);for(const m of Object.keys(a.N.fog))p[m]===void 0&&(p[m]=a.N.fog[m].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,o)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const o=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.a0(et,gi,r))*o.a}getOpacityAtLatLng(r,o){return this._transform.projection.supportsFog?function(h,p,m){const g=a._.fromLngLat(p),x=m.elevation?m.elevation.getAtPointOrZero(g):0;return zi(h,g.x,g.y,x,m)}(this.state,r,o):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const o=this._transform.calculateFogTileMatrix(r.toUnwrapped());return qi(this.state,o,0,0,a.a4,a.a4,this._transform)}getOpacityForBounds(r,o,h,p,m){return this._transform.projection.supportsFog?qi(this.state,r,o,h,p,m,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Oi(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const o=[4,5,6,7];for(const h of o){const p=r.points[h];let m;if(p[2]>=0)m=p;else{const g=r.points[h-4];m=a.a5(g,p,g[2]/(g[2]-p[2]))}if(zi(this.state,m[0],m[1],0,this._transform)>=qt)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,o,h){return(!h||h.validate!==!1)&&nt(this,r.call(R,a.Q({value:o,style:{glyphs:!0,sprite:!0},styleSpec:a.N})))}}class gs extends a.E{constructor(r,o,h,p){super(),this.scope=h,this._options=r,this.properties=new a.a1(o),this._transitionable=new a.O(o,h,new Map(p)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,o){this._options=r,this._transitionable.setTransitionOrValue(r.properties,o)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let k1,B1;var Qa=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,St=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,vl=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Hn="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",F1=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,j1=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,N1=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,V1=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,U1=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Z1=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,$1=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const eo=[];ra(Qa,eo),ra(vl,eo),ra(St,eo);const to={"_prelude_fog.vertex.glsl":j1,"_prelude_terrain.vertex.glsl":F1,"_prelude_shadow.vertex.glsl":Z1,"_prelude_fog.fragment.glsl":N1,"_prelude_shadow.fragment.glsl":$1,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":V1,"_prelude_raster_particle.glsl":U1},Cl={};Nt("",F1),Nt(N1,j1),Nt($1,Z1),Nt(V1,""),Nt(U1,"");const bl=Nt(St,vl),w3=Qa;var A3={background:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Nt("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Nt(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Nt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Nt("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Nt("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Nt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_alignment;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec4 a_join_normal_inside_polygon;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside_polygon.xy/EXTENT);float isPolygon=a_join_normal_inside_polygon.w;float sideAlignment=abs(isPolygon*u_alignment);scaled_pos.xy+=(1.0-a_join_normal_inside_polygon.z)*mix(wall_offset*0.5,wall_offset*mix(1.0,0.0,max(u_alignment,0.0)),sideAlignment);scaled_pos.xy-=a_join_normal_inside_polygon.z*mix(wall_offset*0.5,wall_offset*mix(0.0,1.0,max(u_alignment,0.0)),sideAlignment);
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Nt(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_alignment;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec4 a_join_normal_inside_polygon;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside_polygon.xy/EXTENT);float isPolygon=a_join_normal_inside_polygon.w;float sideAlignment=abs(isPolygon*u_alignment);pos.xy+=(1.0-a_join_normal_inside_polygon.z)*mix(wall_offset*0.5,wall_offset*mix(1.0,0.0,max(u_alignment,0.0)),sideAlignment);pos.xy-=a_join_normal_inside_polygon.z*mix(wall_offset*0.5,wall_offset*mix(0.0,1.0,max(u_alignment,0.0)),sideAlignment);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_alignment;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec4 a_join_normal_inside_polygon;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside_polygon.xy/EXTENT);float isPolygon=a_join_normal_inside_polygon.w;float sideAlignment=abs(isPolygon*u_alignment);p.xy+=(1.0-a_join_normal_inside_polygon.z)*mix(wall_offset*0.5,wall_offset*mix(1.0,0.0,max(u_alignment,0.0)),sideAlignment);p.xy-=a_join_normal_inside_polygon.z*mix(wall_offset*0.5,wall_offset*mix(0.0,1.0,max(u_alignment,0.0)),sideAlignment);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Nt(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Nt(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Nt(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Nt("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Nt("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Nt(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:Nt(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
out_color*=alpha;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;
#ifdef DEPTH_OCCLUSION
float depthOcclusion=occlusionFadeMultiSample(projected_point);float depthOcclusionMultplier=mix(occlusion_opacity,1.0,depthOcclusion);v_fade_opacity*=depthOcclusionMultplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;
#endif
}`),symbolSDF:Nt(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depthOcclusion=occlusionFadeMultiSample(projected_point);float depthOcclusionMultplier=mix(occlusion_opacity,1.0,depthOcclusion);out_fade_opacity*=depthOcclusionMultplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Nt(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depthOcclusion=occlusionFadeMultiSample(projected_point);float depthOcclusionMultplier=mix(occlusion_opacity,1.0,depthOcclusion);out_fade_opacity*=depthOcclusionMultplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Nt("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Nt(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Hn),skyboxGradient:Nt(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Hn),skyboxCapture:Nt(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Nt(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Nt(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;uniform vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Nt(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Nt(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Nt("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ra(u,r){const o=u.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let h of o)if(h=h.trim(),h[0]==="#"&&h.includes("if")&&!h.includes("endif")){h=h.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const p=h.split(" ");for(const m of p)r.includes(m)||r.push(m)}}function Nt(u,r){const o=/#include\s+"([^"]+)"/g,h=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let p=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);p&&(p=p.map(w=>{const T=w.split(" ");return T[T.length-1]}),p=[...new Set(p)]);const m={},g=[],x=[];if(u=u.replace(o,(w,T)=>(x.push(T),"")),(r=r.replace(o,(w,T)=>(g.push(T),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let b=[...eo];ra(u,b),ra(r,b);for(const w of[...g,...x])to[w]||console.error(`Undefined include: ${w}`),Cl[w]||(Cl[w]=[],ra(to[w],Cl[w])),b=[...b,...Cl[w]];return{fragmentSource:u=u.replace(h,(w,T,E,O,z)=>(m[z]=!0,T==="define"?`
#ifndef HAS_UNIFORM_u_${z}
in ${E} ${O} ${z};
#else
uniform ${E} ${O} u_${z};
#endif
`:T==="initialize"?`
#ifdef HAS_UNIFORM_u_${z}
    ${E} ${O} ${z} = u_${z};
#endif
`:T==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    in ${E} ${O} ${z};
#endif
`:T==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(h,(w,T,E,O,z)=>{const L=O==="float"?"vec2":O,k=z.match(/color/)?"color":L;return T==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${z}
in ${E} ${O} a_${z};
#endif
`:m[z]?T==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${E} ${L} a_${z};
out ${E} ${O} ${z};
#else
uniform ${E} ${O} u_${z};
#endif
`:T==="initialize"?k==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = a_${z};
#else
    ${E} ${O} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = unpack_mix_${k}(a_${z}, u_${z}_t);
#else
    ${E} ${O} ${z} = u_${z};
#endif
`:T==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    in ${E} ${O} a_${z};
    out ${E} ${O} ${z};
#endif
`:T==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    ${z} = a_${z};
#endif
`:void 0:T==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${E} ${L} a_${z};
#else
uniform ${E} ${O} u_${z};
#endif
`:T==="define-instanced"?k==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${z}0;
in vec4 a_${z}1;
in vec4 a_${z}2;
in vec4 a_${z}3;
#else
uniform ${E} ${O} u_${z};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${E} ${L} a_${z};
#else
uniform ${E} ${O} u_${z};
#endif
`:T==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    ${E} ${O} ${z} = a_${z};
#endif
`:k==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${E} ${O} ${z} = a_${z};
#else
    ${E} ${O} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${E} ${O} ${z} = unpack_mix_${k}(a_${z}, u_${z}_t);
#else
    ${E} ${O} ${z} = u_${z};
#endif
`}),staticAttributes:p,usedDefines:b,vertexIncludes:g,fragmentIncludes:x}}class Eh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,o,h,p,m,g,x,b){this.context=r;let w=this.boundPaintVertexBuffers.length!==p.length;for(let E=0;!w&&E<p.length;E++)this.boundPaintVertexBuffers[E]!==p[E]&&(w=!0);let T=this.boundDynamicVertexBuffers.length!==x.length;for(let E=0;!T&&E<x.length;E++)this.boundDynamicVertexBuffers[E]!==x[E]&&(T=!0);if(!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==h||w||T||this.boundIndexBuffer!==m||this.boundVertexOffset!==g)this.freshBind(o,h,p,m,g,x,b);else{r.bindVertexArrayOES.set(this.vao);for(const E of x)E&&(E.bind(),b&&E.instanceCount&&E.setVertexAttribDivisor(r.gl,o,b));m&&m.dynamicDraw&&m.bind()}}freshBind(r,o,h,p,m,g,x){const b=r.numAttributes,w=this.context,T=w.gl;this.vao&&this.destroy(),this.vao=w.gl.createVertexArray(),w.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=p,this.boundVertexOffset=m,this.boundDynamicVertexBuffers=g,o.enableAttributes(T,r),o.bind(),o.setVertexAttribPointers(T,r,m);for(const E of h)E.enableAttributes(T,r),E.bind(),E.setVertexAttribPointers(T,r,m);for(const E of g)E&&(E.enableAttributes(T,r),E.bind(),E.setVertexAttribPointers(T,r,m),x&&E.instanceCount&&E.setVertexAttribDivisor(T,r,x));p&&p.bind(),w.currentNumAttributes=b}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Ih(u,r){const o=Math.pow(2,r.canonical.z),h=r.canonical.y;return[new a._(0,h/o).toLngLat().lat,new a._(0,(h+1)/o).toLngLat().lat]}function Ph(u,r,o,h,p,m,g){const x=u.context,b=x.gl,w=o.hillshadeFBO;if(!w)return;u.prepareDrawTile();const T=u.isTileAffectedByFog(r),E=u.getOrCreateProgram("hillshade",{overrideFog:T});x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,w.colorAttachment.get());const O=((B,F,$,G)=>{const Z=$.paint.get("hillshade-shadow-color"),K=$.paint.get("hillshade-highlight-color"),W=$.paint.get("hillshade-accent-color"),H=$.paint.get("hillshade-emissive-strength");let te=a.ac($.paint.get("hillshade-illumination-direction"));if($.paint.get("hillshade-illumination-anchor")==="viewport")te-=B.transform.angle;else if(B.style&&B.style.enable3dLights()&&B.style.directionalLight){const he=B.style.directionalLight.properties.get("direction"),ne=a.ad(he.x,he.y,he.z);te=a.ac(ne[1])}const re=!B.options.moving;return{u_matrix:G||B.transform.calculateProjMatrix(F.tileID.toUnwrapped(),re),u_image:0,u_latrange:Ih(0,F.tileID),u_light:[$.paint.get("hillshade-exaggeration"),te],u_shadow:Z.toRenderColor($.lut),u_highlight:K.toRenderColor($.lut),u_emissive_strength:H,u_accent:W.toRenderColor($.lut)}})(u,o,h,u.terrain?r.projMatrix:null);u.uploadCommonUniforms(x,E,r.toUnwrapped());const{tileBoundsBuffer:z,tileBoundsIndexBuffer:L,tileBoundsSegments:k}=u.getTileBoundsBuffers(o);E.draw(u,b.TRIANGLES,p,m,g,a.ag.disabled,O,h.id,z,L,k)}function T3(u,r,o){if(!r.needsDEMTextureUpload)return;const h=u.context,p=h.gl;h.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||u.getTileTexture(o.stride);const m=o.getPixels();r.demTexture?r.demTexture.update(m,{premultiply:!1}):r.demTexture=new a.T(h,m,p.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function Oh(u,r,o){const h=u.context,p=h.gl;if(!r.dem)return;const m=r.dem;if(h.activeTexture.set(p.TEXTURE1),T3(u,r,m),!r.demTexture)return;r.demTexture.bind(p.NEAREST,p.CLAMP_TO_EDGE);const g=m.dim;h.activeTexture.set(p.TEXTURE0);let x=r.hillshadeFBO;if(!x){const O=new a.T(h,{width:g,height:g,data:null},p.RGBA);O.bind(p.LINEAR,p.CLAMP_TO_EDGE),x=r.hillshadeFBO=h.createFramebuffer(g,g,!0,"renderbuffer"),x.colorAttachment.set(O.texture)}h.bindFramebuffer.set(x.framebuffer),h.viewport.set([0,0,g,g]);const{tileBoundsBuffer:b,tileBoundsIndexBuffer:w,tileBoundsSegments:T}=u.getMercatorTileBoundsBuffers(),E=[];u.linearFloatFilteringSupported()&&E.push("TERRAIN_DEM_FLOAT_FORMAT"),u.getOrCreateProgram("hillshadePrepare",{defines:E}).draw(u,p.TRIANGLES,a.af.disabled,a.ah.disabled,a.a.unblended,a.ag.disabled,((O,z)=>{const L=z.stride,k=a.ae.create();return a.ae.ortho(k,0,a.a4,-a.a4,0,0,1),a.ae.translate(k,k,[0,-a.a4,0]),{u_matrix:k,u_image:1,u_dimension:[L,L],u_zoom:O.overscaledZ}})(r.tileID,m),o.id,b,w,T),r.needsHillshadePrepare=!1}function G1(u,r,o,h,p){const m=function(x,b){if(x)return p(x);if(b){if(u.url&&b.tiles&&u.tiles&&delete u.tiles,b.variants){if(!Array.isArray(b.variants))return p(new Error("variants must be an array"));for(const T of b.variants){if(T==null||typeof T!="object"||T.constructor!==Object)return p(new Error("variant must be an object"));if(!Array.isArray(T.capabilities))return p(new Error("capabilities must be an array"));if(T.capabilities.length===1&&T.capabilities[0]==="meshopt"){b=a.Q(b,T);break}}}const w=a.ai(a.Q(b,u),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(w.vectorLayers=b.vector_layers,w.vectorLayerIds=w.vectorLayers.map(T=>T.id)),b.raster_layers&&(w.rasterLayers=b.raster_layers,w.rasterLayerIds=w.rasterLayers.map(T=>T.id)),w.tiles=r.canonicalizeTileset(w,u.url),p(null,w)}},g=function(x,b,w){if(!x)return null;if(!b&&!w)return x;w=w||x.worldview_default;const T=Object.values(x.language||{});if(T.length===0)return null;const E=Object.values(x.worldview||{});if(E.length===0)return null;const O=T.every(L=>L===b),z=E.every(L=>L===w);return O&&z?x:b in(x.language_options||{})||w in(x.worldview_options||{})?null:x.language_options&&x.worldview_options?x:null}(u.data,o,h);return g?a.e.frame(()=>m(null,g)):u.url?a.h(r.transformRequest(r.normalizeSourceURL(u.url,null,o,h),a.R.Source),m):a.e.frame(()=>{const{data:x,...b}=u;m(null,b)})}class io{constructor(r,o,h){this.bounds=a.aj.convert(this.validateBounds(r)),this.minzoom=o||0,this.maxzoom=h||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const o=Math.pow(2,r.z),h=Math.floor(a.ak(this.bounds.getWest())*o),p=Math.floor(a.al(this.bounds.getNorth())*o),m=Math.ceil(a.ak(this.bounds.getEast())*o),g=Math.ceil(a.al(this.bounds.getSouth())*o);return r.x>=h&&r.x<m&&r.y>=p&&r.y<g}}class Er extends a.E{constructor(r,o,h,p){super(),this.id=r,this.dispatcher=h,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.Q({type:"raster"},o),a.Q(this,a.ai(o,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new a.g("dataloading",{dataType:"source"})),this._tileJSONRequest=G1(this._options,this.map._requestManager,null,null,(o,h)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new a.f(o)):h&&(a.Q(this,h),h.bounds&&(this.tileBounds=new io(h.bounds,this.minzoom,this.maxzoom)),a.ao(h.tiles),this.fire(new a.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.g("data",{dataType:"source",sourceDataType:"content"}))),r&&r(o)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=a.am(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return a.Q({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,o){const h=a.e.devicePixelRatio>=2,p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),h,this.tileSize);r.request=a.i(this.map._requestManager.transformRequest(p,a.R.Tile),(m,g,x,b)=>(delete r.request,r.aborted?(r.state="unloaded",o(null)):m?(r.state="errored",o(m)):g?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:x,expires:b}),r.setTexture(g,this.map.painter),r.state="loaded",a.an(this.dispatcher),void o(null)):o(null)))}abortTile(r,o){r.request&&(r.request.cancel(),delete r.request),o&&o()}unloadTile(r,o){r.texture&&r.texture instanceof a.T?(r.destroy(!0),r.texture&&r.texture instanceof a.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),o&&o()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class M3 extends a.E{constructor(r,o,h,p){if(super(),this.id=r,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.Q(this,a.ai(o,["url","scheme","tileSize","promoteId"])),this._options=a.Q({type:"vector"},o),this._collectResourceTiming=!!o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new a.ap}load(r){this._loaded=!1,this.fire(new a.g("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map._worldview;this._tileJSONRequest=G1(this._options,this.map._requestManager,o,h,(p,m)=>{this._tileJSONRequest=null,this._loaded=!0,p?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new a.f(p))):m&&(a.Q(this,m),m.bounds&&(this.tileBounds=new io(m.bounds,this.minzoom,this.maxzoom)),a.ao(m.tiles,this.map._requestManager._customAccessToken),this.fire(new a.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.g("data",{dataType:"source",sourceDataType:"content"}))),r&&r(p)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=a.am(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return a.Q({},this._options)}loadTile(r,o){const h=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),p=this.map._requestManager.transformRequest(h,a.R.Tile),m=this.map.style?this.map.style.getLut(this.scope):null,g={request:p,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,lut:m?{image:m.image.clone()}:null,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(g.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=o:r.request=r.actor.send("reloadTile",g,x.bind(this));else if(r.actor=this._tileWorkers[h]=this._tileWorkers[h]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",g,x.bind(this),void 0,!0);else{const b=a.aq.call({deduped:this._deduped},g,(w,T)=>{w||!T?x.call(this,w):(g.data={cacheControl:T.cacheControl,expires:T.expires,rawData:T.rawData.slice(0)},r.actor&&r.actor.send("loadTile",g,x.bind(this),void 0,!0))},!0);r.request={cancel:b}}function x(b,w){return delete r.request,r.aborted?o(null):b&&b.status!==404?o(b):(w&&w.resourceTiming&&(r.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&r.setExpiryData(w),r.loadVectorData(w,this.map.painter),a.an(this.dispatcher),o(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,o){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}const S3=(u,r,o)=>({u_matrix:u,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:o}),q1=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k)=>({u_proj_matrix:Float32Array.from(u),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(h),u_merc_matrix:o,u_zoom_transition:p,u_merc_center:m,u_image0:0,u_frustum_tl:g,u_frustum_tr:x,u_frustum_br:b,u_frustum_bl:w,u_globe_pos:T,u_globe_radius:E,u_viewport:O,u_grid_matrix:k?Float32Array.from(k):new Float32Array(9),u_skirt_height:z,u_far_z_cutoff:L});class ro{constructor(r=0,o=0,h=0,p=0){if(isNaN(r)||r<0||isNaN(o)||o<0||isNaN(h)||h<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=o,this.left=h,this.right=p}interpolate(r,o,h){return o.top!=null&&r.top!=null&&(this.top=a.a3(r.top,o.top,h)),o.bottom!=null&&r.bottom!=null&&(this.bottom=a.a3(r.bottom,o.bottom,h)),o.left!=null&&r.left!=null&&(this.left=a.a3(r.left,o.left,h)),o.right!=null&&r.right!=null&&(this.right=a.a3(r.right,o.right,h)),this}getCenter(r,o){const h=a.au((this.left+r-this.right)/2,0,r),p=a.au((this.top+o-this.bottom)/2,0,o);return new a.P(h,p)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new ro(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ys(u,r){const o=a.ax(u,3);a.ae.fromQuat(u,r),a.aA(u,3,o)}function Ze(u,r){const o=a.aw.identity([]);return a.aw.rotateZ(o,o,-r),a.aw.rotateX(o,o,-u),o}function na(u,r){const o=[u[0],u[1],0],h=[r[0],r[1],0];if(a.$.length(o)>=1e-15){const g=a.$.normalize([],o);a.$.scale(h,g,a.$.dot(h,g)),r[0]=h[0],r[1]=h[1]}const p=a.$.cross([],r,u);if(a.$.len(p)<1e-15)return null;const m=Math.atan2(-p[1],p[0]);return Ze(Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2]),m)}class E3{constructor(r,o){this.position=r,this.orientation=o}get position(){return this._position}set position(r){if(r){const o=r instanceof a._?r:new a._(r[0],r[1],r[2]);this._renderWorldCopies&&(o.x=a.av(o.x,0,1)),this._position=o}else this._position=null}lookAtPoint(r,o){if(this.orientation=null,!this.position)return;const h=this.position,p=this._elevation?this._elevation.getAtPointOrZero(a._.fromLngLat(r)):0,m=a._.fromLngLat(r,p),g=[m.x-h.x,m.y-h.y,m.z-h.z];o||(o=[0,0,1]),o[2]=Math.abs(o[2]),this.orientation=na(g,o)}setPitchBearing(r,o){this.orientation=Ze(a.ac(r),a.ac(-o))}}class sa{constructor(r,o){this._transform=a.ae.identity([]),this.orientation=o,this.position=r}get mercatorPosition(){const r=this.position;return new a._(r[0],r[1],r[2])}get position(){const r=a.ax(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var o;r&&a.aA(this._transform,3,[(o=r)[0],o[1],o[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||a.aw.identity([]),r&&ys(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),o=this.right();return{bearing:Math.atan2(-o[1],o[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,o){this._orientation=Ze(r,o),ys(this._transform,this._orientation)}forward(){const r=a.ax(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=a.ax(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=a.ax(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,o){const h=new Float64Array(16);return a.ae.invert(h,this.getWorldToCamera(r,o)),h}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,o,h){const p=this.position;a.$.scale(p,p,-r);const m=new Float64Array(16);return a.ae.fromScaling(m,[h,h,h]),a.ae.translate(m,m,p),m[10]*=o,m}getWorldToCamera(r,o){const h=new Float64Array(16),p=new Float64Array(4),m=this.position;return a.aw.conjugate(p,this._orientation),a.$.scale(m,m,-r),a.ae.fromQuat(h,p),a.ae.translate(h,h,m),h[1]*=-1,h[5]*=-1,h[9]*=-1,h[13]*=-1,h[8]*=o,h[9]*=o,h[10]*=o,h[11]*=o,h}getCameraToClipPerspective(r,o,h,p){const m=new Float64Array(16);return a.ae.perspective(m,r,o,h,p),m}getCameraToClipOrthographic(r,o,h,p,m,g){const x=new Float64Array(16);return a.ae.ortho(x,r,o,h,p,m,g),x}getDistanceToElevation(r,o=!1){const h=r===0?0:a.ay(r,o?a.az(this.position[1]):this.position[1]),p=this.forward();return(h-this.position[2])/p[2]}clone(){return new sa([...this.position],[...this.orientation])}}const Lt={unknown:0,flipRequired:1,flipNotRequired:2},vr=Math.tan(85*Math.PI/180);function no(u,r,o,h,p,m,g){const x=a.ae.create();if(o)if(m.name==="globe"){const b=a.aC(p,r);a.ae.multiply(x,x,b)}else{const b=a.aD.invert([],g);x[0]=b[0],x[1]=b[1],x[4]=b[2],x[5]=b[3],h||a.ae.rotateZ(x,x,p.angle)}else a.ae.multiply(x,p.labelPlaneMatrix,u);return x}function wl(u,r,o,h,p,m,g){const x=no(u,r,o,h,p,m,g);return m.name==="globe"&&o||(x[2]=x[6]=x[10]=x[14]=0),x}function Al(u,r,o,h,p,m,g){if(o){if(m.name==="globe"){const x=no(u,r,o,h,p,m,g);return a.ae.invert(x,x),a.ae.multiply(x,u,x),x}{const x=a.ae.clone(u),b=a.ae.identity([]);return b[0]=g[0],b[1]=g[1],b[4]=g[2],b[5]=g[3],a.ae.multiply(x,x,b),h||a.ae.rotateZ(x,x,-p.angle),x}}return p.glCoordMatrix}function nn(u,r,o,h){const p=[u,r,o,1];o?a.aB.transformMat4(p,p,h):X1(p,p,h);const m=p[3];return p[0]/=m,p[1]/=m,p[2]/=m,p}function Pt(u,r){return Math.min(.5+u/r*.5,1.5)}function W1(u,r){const o=u[0]/u[3],h=u[1]/u[3];return o>=-r[0]&&o<=r[0]&&h>=-r[1]&&h<=r[1]}function aa(u,r,o,h,p,m,g,x,b,w){const T=o.transform,E=h?u.textSizeData:u.iconSizeData,O=a.aE(E,o.transform.zoom),z=T.projection.name==="globe",L=[256/o.width*2+1,256/o.height*2+1],k=h?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;k.clear();let B=null;z&&(B=h?u.text.globeExtVertexArray:u.icon.globeExtVertexArray);const F=u.lineVertexArray,$=h?u.text.placedSymbolArray:u.icon.placedSymbolArray,G=o.transform.width/o.transform.height;let Z,K=!1;for(let W=0;W<$.length;W++){const H=$.get(W),{numGlyphs:te,writingMode:re}=H;if(re!==a.aF.vertical||K||Z===a.aF.horizontal||(K=!0),Z=re,(H.hidden||re===a.aF.vertical)&&!K){xs(te,k);continue}K=!1;const he=new a.P(H.tileAnchorX,H.tileAnchorY);let{x:ne,y:J,z:ge}=T.projection.projectTilePoint(he.x,he.y,w.canonical);if(b){const[Ue,$e,Je]=b(he);ne+=Ue,J+=$e,ge+=Je}const me=[ne,J,ge,1];if(a.aB.transformMat4(me,me,r),!W1(me,L)){xs(te,k);continue}const oe=me[3],Pe=Pt(o.transform.getCameraToCenterDistance(T.projection),oe),Me=a.aG(E,O,H),de=g?Me/Pe:Me*Pe,Ce=nn(ne,J,ge,p);if(Ce[3]<=0){xs(te,k);continue}let se={};const Se=g?null:b,Ie=ir(H,de,!1,x,r,p,m,u.glyphOffsetArray,F,k,B,Ce,he,se,G,Se,T.projection,w,g);K=Ie.useVertical,Se&&Ie.needsFlipping&&(se={}),(Ie.notEnoughRoom||K||Ie.needsFlipping&&ir(H,de,!0,x,r,p,m,u.glyphOffsetArray,F,k,B,Ce,he,se,G,Se,T.projection,w,g).notEnoughRoom)&&xs(te,k)}h?(u.text.dynamicLayoutVertexBuffer.updateData(k),B&&u.text.globeExtVertexBuffer&&u.text.globeExtVertexBuffer.updateData(B)):(u.icon.dynamicLayoutVertexBuffer.updateData(k),B&&u.icon.globeExtVertexBuffer&&u.icon.globeExtVertexBuffer.updateData(B))}function so(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k){const{lineStartIndex:B,glyphStartIndex:F,segment:$}=x,G=F+x.numGlyphs,Z=B+x.lineLength,K=r.getoffsetX(F),W=r.getoffsetX(G-1),H=oa(u*K,o,h,p,m,g,$,B,Z,b,w,T,E,O,!0,z,L,k);if(!H)return null;const te=oa(u*W,o,h,p,m,g,$,B,Z,b,w,T,E,O,!0,z,L,k);return te?{first:H,last:te}:null}function H1(u,r,o,h){return u===a.aF.horizontal&&Math.abs(h)>Math.abs(o)?{useVertical:!0}:u===a.aF.vertical?h>0?{needsFlipping:!0}:null:r!==Lt.unknown&&function(p,m){return p===0||Math.abs(m/p)>vr}(o,h)?r===Lt.flipRequired?{needsFlipping:!0}:null:o<0?{needsFlipping:!0}:null}function ir(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F,$){const G=r/24,Z=u.lineOffsetX*G,K=u.lineOffsetY*G,{lineStartIndex:W,glyphStartIndex:H,numGlyphs:te,segment:re,writingMode:he,flipState:ne}=u,J=W+u.lineLength,ge=me=>{if(T){const[de,Ce,se]=me.up,Se=w.length;a.aH(T,Se+0,de,Ce,se),a.aH(T,Se+1,de,Ce,se),a.aH(T,Se+2,de,Ce,se),a.aH(T,Se+3,de,Ce,se)}const[oe,Pe,Me]=me.point;a.aI(w,oe,Pe,Me,me.angle)};if(te>1){const me=so(G,x,Z,K,o,E,O,u,b,m,z,k,!1,B,F,$);if(!me)return{notEnoughRoom:!0};if(h&&!o){let[oe,Pe,Me]=me.first.point,[de,Ce,se]=me.last.point;[oe,Pe]=nn(oe,Pe,Me,g),[de,Ce]=nn(de,Ce,se,g);const Se=H1(he,ne,(de-oe)*L,Ce-Pe);if(u.flipState=Se&&Se.needsFlipping?Lt.flipRequired:Lt.flipNotRequired,Se)return Se}ge(me.first);for(let oe=H+1;oe<H+te-1;oe++){const Pe=oa(G*x.getoffsetX(oe),Z,K,o,E,O,re,W,J,b,m,z,k,!1,!1,B,F,$);if(!Pe)return w.length-=4*(oe-H),{notEnoughRoom:!0};ge(Pe)}ge(me.last)}else{if(h&&!o){const oe=nn(O.x,O.y,0,p),Pe=W+re+1,Me=new a.P(b.getx(Pe),b.gety(Pe)),de=nn(Me.x,Me.y,0,p),Ce=de[3]>0?de:Tl(O,Me,oe,1,p,void 0,B,F.canonical),se=H1(he,ne,(Ce[0]-oe[0])*L,Ce[1]-oe[1]);if(u.flipState=se&&se.needsFlipping?Lt.flipRequired:Lt.flipNotRequired,se)return se}const me=oa(G*x.getoffsetX(H),Z,K,o,E,O,re,W,J,b,m,z,k,!1,!1,B,F,$);if(!me)return{notEnoughRoom:!0};ge(me)}return{}}function I3(u,r,o,h,p){const{x:m,y:g,z:x}=h.projectTilePoint(u.x,u.y,r);if(!p)return nn(m,g,x,o);const[b,w,T]=p(u);return nn(m+b,g+w,x+T,o)}function Tl(u,r,o,h,p,m,g,x){const b=I3(u.sub(r)._unit()._add(u),x,p,g,m);return a.$.sub(b,o,b),a.$.normalize(b,b),a.$.scaleAndAdd(b,o,b,h)}function oa(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F){const $=h?u-r:u+r;let G=$>0?1:-1,Z=0;h&&(G*=-1,Z=Math.PI),G<0&&(Z+=Math.PI);let K=x+g+(G>0?0:1)|0,W=p,H=p,te=0,re=0;const he=Math.abs($),ne=[],J=[];let ge=m,me=ge;const oe=()=>Tl(me,ge,H,he-te+1,T,O,k,B.canonical);for(;te+re<=he;){if(K+=G,K<x||K>=b)return null;if(H=W,me=ge,ne.push(H),z&&J.push(me),ge=new a.P(w.getx(K),w.gety(K)),W=E[K],!W){const $e=I3(ge,B.canonical,T,k,O);W=$e[3]>0?E[K]=$e:oe()}te+=re,re=a.$.distance(H,W)}L&&O&&(E[K]&&(W=oe(),re=a.$.distance(H,W)),E[K]=W);const Pe=(he-te)/re,Me=ge.sub(me)._mult(Pe)._add(me),de=a.$.sub([],W,H),Ce=a.$.scaleAndAdd([],H,de,Pe);let se=[0,0,1],Se=de[0],Ie=de[1];if(F&&(se=k.upVector(B.canonical,Me.x,Me.y),se[0]!==0||se[1]!==0||se[2]!==1)){const $e=[se[2],0,-se[0]],Je=a.$.cross([],se,$e);a.$.normalize($e,$e),a.$.normalize(Je,Je),Se=a.$.dot(de,$e),Ie=a.$.dot(de,Je)}if(o){const $e=a.$.cross([],se,de);a.$.normalize($e,$e),a.$.scaleAndAdd(Ce,Ce,$e,o*G)}const Ue=Z+Math.atan2(Ie,Se);return ne.push(Ce),z&&J.push(Me),{point:Ce,angle:Ue,path:ne,tilePath:J,up:se}}function xs(u,r){const o=r.length,h=o+4*u;r.resize(h),r.float32.fill(-1/0,4*o,4*h)}function X1(u,r,o){const h=r[0],p=r[1];return u[0]=o[0]*h+o[4]*p+o[12],u[1]=o[1]*h+o[5]*p+o[13],u[3]=o[3]*h+o[7]*p+o[15],u}const Ml=(u,r,o)=>(1-o)*u+o*r,ao=u=>u*u*u*u*u;class oo{constructor(r,o,h,p,m,g,x){this.tileSize=512,this._renderWorldCopies=m===void 0||m,this._minZoom=r||0,this._maxZoom=o||22,this._minPitch=h??0,this._maxPitch=p??60,this.setProjection(g),this.setMaxBounds(x),this.width=0,this.height=0,this._center=new a.aJ(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ro,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new sa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const r=new oo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,o=!1){const h=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||h)&&this._updateCameraOnTerrain(),(r||h)&&this._constrainCamera(o),this._calcMatrices()}getProjection(){return a.ai(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const o=this.projection?this.getProjection():void 0;this.projection=a.aK(this.projectionOptions);const h=this.getProjection(),p=!a.d(o,h);return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.aK({name:"mercator"});const o=r!==this.projection.name;return o&&this._calcMatrices(),o}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.ay(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.av(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const o=-r*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=a.aD.create(),a.aD.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const o=a.au(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=a.ac(r),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const o=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._setZoom(o),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,o=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!o||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;o||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&h.exaggeration()&&this._centerAltitudeValidForExaggeration!==h.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*h.exaggeration(),this._centerAltitudeValidForExaggeration=h.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=h.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,o=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],h=this.horizonLineFromTop();let p=0,m=0;for(let g=0;g<o.length;g++){const x=new a.P(o[g][0]*this.width,h+o[g][1]*(this.height-h)),b=r.pointCoordinate(x);if(!b)continue;const w=1/Math.hypot(b[0]-this._camera.position[0],b[1]-this._camera.position[1]);p+=b[3]*w,m+=w}return m===0?NaN:p/m}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,o=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),h=this.pixelsPerMeter/this.worldSize*o,p=this._mercatorZfromZoom(r),m=this._mercatorZfromZoom(this._maxZoom),g=Math.max(p-h,m);this._setZoom(this._zoomFromMercatorZ(g))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const o=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let h;h=r.z<this._camera.position[2]?[o.x,o.y,o.z]:[r.x,r.y,r.z];const p=a.$.length(a.$.sub([],this._camera.position,h));return a.au(this._zoomFromMercatorZ(p),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let o=!1;if(r.orientation&&!a.aw.exactEquals(r.orientation,this._camera.orientation)&&(o=this._setCameraOrientation(r.orientation)),r.position){const h=[r.position.x,r.position.y,r.position.z];a.$.exactEquals(h,this._camera.position)||(this._setCameraPosition(h),o=!0)}o&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,o=new E3;return o.position=new a._(r[0],r[1],r[2]),o.orientation=this._camera.orientation,o._elevation=this.elevation,o._renderWorldCopies=this.renderWorldCopies,o}_setCameraOrientation(r){if(!a.aw.length(r))return!1;a.aw.normalize(r,r);const o=a.$.transformQuat([],[0,0,-1],r),h=a.$.transformQuat([],[0,-1,0],r);if(h[2]<0)return!1;const p=na(o,h);return!!p&&(this._camera.orientation=p,!0)}_setCameraPosition(r){const o=this.zoomScale(this.minZoom)*this.tileSize,h=this.zoomScale(this.maxZoom)*this.tileSize,p=this.cameraToCenterDistance;r[2]=a.au(r[2],p/h,p/o),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,o,h){this._unmodified=!1,this._edgeInsets.interpolate(r,o,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const o=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(r){const o=[new a.aL(0,r)];if(this.renderWorldCopies){const h=this.pointCoordinate(new a.P(0,0)),p=this.pointCoordinate(new a.P(this.width,0)),m=this.pointCoordinate(new a.P(this.width,this.height)),g=this.pointCoordinate(new a.P(0,this.height)),x=Math.floor(Math.min(h.x,p.x,m.x,g.x)),b=Math.floor(Math.max(h.x,p.x,m.x,g.x)),w=1;for(let T=x-w;T<=b+w;T++)T!==0&&o.push(new a.aL(T,r))}return o}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,o,h){let p=[];const m=h!==void 0,g=!m;if(g&&this.zoom<o||m&&h[0]===0&&h[1]===0)return p;const x=new Set,b=(T,E,O,z,L)=>{const k=a.b2(E,T,O,z,L);x.has(k)||(p.push(new a.aQ(T,E,O,z,L)),x.add(k))};for(let T=0;T<r.length;T++){const E=r[T];if(g&&E.canonical.z!==o)continue;const O=E.canonical,z=E.overscaledZ,L=E.wrap,k=1<<O.z,B=O.x+1<k,F=O.x>0,$=O.y+1<k,G=O.y>0,Z=E.wrap-(F?0:1),K=E.wrap+(B?0:1),W=F?O.x-1:k-1,H=B?O.x+1:0;if(m)h[0]<0?(b(z,K,O.z,H,O.y),h[1]<0&&$&&(b(z,L,O.z,O.x,O.y+1),b(z,K,O.z,H,O.y+1)),h[1]>0&&G&&(b(z,L,O.z,O.x,O.y-1),b(z,K,O.z,H,O.y-1))):h[0]>0?(b(z,Z,O.z,W,O.y),h[1]<0&&$&&(b(z,L,O.z,O.x,O.y+1),b(z,Z,O.z,W,O.y+1)),h[1]>0&&G&&(b(z,L,O.z,O.x,O.y-1),b(z,Z,O.z,W,O.y-1))):h[1]<0&&$?b(z,L,O.z,O.x,O.y+1):G&&b(z,L,O.z,O.x,O.y-1);else{const te=E.visibleQuadrants;1&te&&(b(z,Z,O.z,W,O.y),G&&(b(z,L,O.z,O.x,O.y-1),b(z,Z,O.z,W,O.y-1))),2&te&&(b(z,K,O.z,H,O.y),G&&(b(z,L,O.z,O.x,O.y-1),b(z,K,O.z,H,O.y-1))),4&te&&(b(z,Z,O.z,W,O.y),$&&(b(z,L,O.z,O.x,O.y+1),b(z,Z,O.z,W,O.y+1))),8&te&&(b(z,K,O.z,H,O.y),$&&(b(z,L,O.z,O.x,O.y+1),b(z,K,O.z,H,O.y+1)))}}const w=[];for(const T of p)p.some(E=>T.isChildOf(E))||w.push(T);if(p=w.filter(T=>!r.some(E=>!!(T.overscaledZ<o&&E.isChildOf(T))||T.equals(E)||T.isChildOf(E))),g){const T=1<<o,E=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),O=[T*E.x,T*E.y],z=4,L=z*z;p=p.filter(k=>{const B=k.canonical.x+.5-O[0],F=k.canonical.y+.5-O[1];return B*B+F*F<L})}return p}coveringTiles(r){let o=this.coveringZoomLevel(r);const h=o,p=this.elevation&&this.elevation.exaggeration(),m=p&&!r.isTerrainDEM,g=this.projection.name==="mercator";if(r.minzoom!==void 0&&o<r.minzoom)return[];r.maxzoom!==void 0&&o>r.maxzoom&&(o=r.maxzoom);const x=this.locationCoordinate(this.center),b=this.center.lat,w=1<<o,T=[w*x.x,w*x.y,0],E=this.projection.name==="globe",O=!E,z=a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,O),L=E?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),k=w*a.ay(1,this.center.lat),B=this._camera.position[2]/a.ay(1,this.center.lat),F=[w*L.x,w*L.y,B*(O?1:k)],$=E||p,G=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Z=this.isLODDisabled(!0)?o:0;let K;if(this._elevation&&r.isTerrainDEM)K=1e4*this._elevation.exaggeration();else if(this._elevation){const de=this._elevation.getMinMaxForVisibleTiles();K=de?de.max:this._centerAltitude}else K=this._centerAltitude;const W=r.isTerrainDEM?-K:this._elevation?this._elevation.getMinElevationBelowMSL():0,H=this.projection.isReprojectedInTileSpace?a.aN(this):1,te=de=>{const se=new a._(de.x+25e-6,de.y,de.z),Se=new a._(de.x,de.y+25e-6,de.z),Ie=de.toLngLat(),Ue=se.toLngLat(),$e=Se.toLngLat(),Je=this.locationCoordinate(Ie),qe=this.locationCoordinate(Ue),ot=this.locationCoordinate($e),Ct=Math.hypot(qe.x-Je.x,qe.y-Je.y),ct=Math.hypot(ot.x-Je.x,ot.y-Je.y);return Math.sqrt(Ct*ct)*H/25e-6},re=de=>{const Ce=K,se=W;return{aabb:a.aR(this,w,0,0,0,de,se,Ce,this.projection),zoom:0,x:0,y:0,minZ:se,maxZ:Ce,wrap:de,fullyVisible:!1}},he=[];let ne=[];const J=o,ge=r.reparseOverscaled?h:o,me=(B-this._centerAltitude)*k,oe=de=>{if(!this._elevation||!de.tileID||!g)return;const Ce=this._elevation.getMinMaxForTile(de.tileID),se=de.aabb;Ce?(se.min[2]=Ce.min,se.max[2]=Ce.max,se.center[2]=(se.min[2]+se.max[2])/2):(de.shouldSplit=Me(de),de.shouldSplit||(se.min[2]=se.max[2]=se.center[2]=this._centerAltitude))},Pe=(de,Ce)=>{if(.707*Ce<de)return 1;const se=Ce/de;return se/(1.4144271570014144+(Math.pow(1.1,se-1.4144271570014144+1)-1)/(1.1-1)-1)},Me=de=>{if(de.zoom<Z)return!0;if(de.zoom===J)return!1;if(de.shouldSplit!=null)return de.shouldSplit;const Ce=de.aabb.distanceX(F),se=de.aabb.distanceY(F);let Se=me,Ie=1;if(E){Se=de.aabb.distanceZ(F);const ct=Math.pow(2,de.zoom),Tt=a.az((de.y+1)/ct),kt=a.az(de.y/ct),hi=Math.min(Math.max(b,Tt),kt),ai=a.b6(hi)/a.b6(b);if(Ie=hi===b?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ai/this._mercatorScaleRatio),this.zoom<=a.b3&&de.zoom===J-1&&ai>=.9)return!0}else if(m&&(Se=de.aabb.distanceZ(F)*k),this.projection.isReprojectedInTileSpace&&h<=5){const ct=Math.pow(2,de.zoom),Tt=te(new a._((de.x+.5)/ct,(de.y+.5)/ct));Ie=Tt>.85?1:Tt}if(!g){const ct=Math.sqrt(Ce*Ce+se*se+Se*Se);let Tt=(1<<J-de.zoom)*G*Ie;return Tt*=Pe(Math.max(Se,me),ct),ct<Tt}let Ue=Number.MAX_VALUE,$e=0;const Je=de.aabb.getCorners(),qe=[];for(const ct of Je){a.$.sub(qe,ct,F),E||(m?qe[2]*=k:qe[2]=me);const Tt=a.$.dot(qe,this._camera.forward());Tt<Ue&&(Ue=Tt,$e=Math.abs(qe[2]))}let ot=(1<<J-de.zoom)*G*Ie;if(ot*=Pe(Math.max($e,me),Ue),Ue<ot)return!0;const Ct=de.aabb.closestPoint(T);return Ct[0]===T[0]&&Ct[1]===T[1]};if(this.renderWorldCopies)for(let de=1;de<=3;de++)he.push(re(-de)),he.push(re(de));for(he.push(re(0));he.length>0;){const de=he.pop(),Ce=de.x,se=de.y;let Se=de.fullyVisible;const Ie=()=>this.projection.name==="globe"&&(de.y===0||de.y===(1<<de.zoom)-1);if(!Se){let Ue=$?de.aabb.intersects(z):de.aabb.intersectsFlat(z);if(Ue===0&&Ie()){const $e=new a.aO(de.zoom,Ce,se);Ue=a.aP(this,w,$e,!0).intersects(z)}if(Ue===0)continue;Se=Ue===2}if(de.zoom!==J&&Me(de))for(let Ue=0;Ue<4;Ue++){const $e=(Ce<<1)+Ue%2,Je=(se<<1)+(Ue>>1),qe={aabb:g?de.aabb.quadrant(Ue):a.aR(this,w,de.zoom+1,$e,Je,de.wrap,de.minZ,de.maxZ,this.projection),zoom:de.zoom+1,x:$e,y:Je,wrap:de.wrap,fullyVisible:Se,tileID:void 0,shouldSplit:void 0,minZ:de.minZ,maxZ:de.maxZ};m&&!E&&(qe.tileID=new a.aQ(de.zoom+1===J?ge:de.zoom+1,de.wrap,de.zoom+1,$e,Je),oe(qe)),he.push(qe)}else{const Ue=de.zoom===J?ge:de.zoom;if(r.minzoom&&r.minzoom>Ue)continue;let $e=0;if(!Se){let Ct=$?de.aabb.intersectsPrecise(z):de.aabb.intersectsPreciseFlat(z);if(Ct===0&&Ie()){const ct=new a.aO(de.zoom,Ce,se);Ct=a.aP(this,w,ct,!0).intersectsPrecise(z)}if(Ct===0)continue;if(r.calculateQuadrantVisibility)if(z.containsPoint(de.aabb.center))$e=15;else for(let ct=0;ct<4;ct++)de.aabb.quadrant(ct).intersects(z)!==0&&($e|=1<<ct)}const Je=T[0]-(.5+Ce+(de.wrap<<de.zoom))*(1<<o-de.zoom),qe=T[1]-.5-se,ot=de.tileID?de.tileID:new a.aQ(Ue,de.wrap,de.zoom,Ce,se);r.calculateQuadrantVisibility&&(ot.visibleQuadrants=$e),ne.push({tileID:ot,distanceSq:Je*Je+qe*qe})}}if(this.fogCullDistSq){const de=this.fogCullDistSq,Ce=this.horizonLineFromTop();ne=ne.filter(se=>{const Se=[0,0,0,1],Ie=[a.a4,a.a4,0,1],Ue=this.calculateFogTileMatrix(se.tileID.toUnwrapped());a.aB.transformMat4(Se,Se,Ue),a.aB.transformMat4(Ie,Ie,Ue);const $e=a.aB.min([],Se,Ie),Je=a.aB.max([],Se,Ie),qe=a.aS($e,Je);if(qe===0)return!0;let ot=!1;const Ct=this._elevation;if(Ct&&qe>de&&Ce!==0){const ct=this.calculateProjMatrix(se.tileID.toUnwrapped());let Tt;r.isTerrainDEM||(Tt=Ct.getMinMaxForTile(se.tileID)),Tt||(Tt={min:W,max:K});const kt=a.b4(this.rotation),hi=[kt[0]*a.a4,kt[1]*a.a4,Tt.max];a.$.transformMat4(hi,hi,ct),ot=(1-hi[1])*this.height*.5<Ce}return qe<de||ot})}return ne.sort((de,Ce)=>de.distanceSq-Ce.distanceSq).map(de=>de.tileID)}resize(r,o){this.width=r,this.height=o,this.pixelsToGLUnits=[2/r,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const o=a.au(r.lat,-a.aT,a.aT),h=this.projection.project(r.lng,o);return new a.P(h.x*this.worldSize,h.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.ay(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,o){let h,p;const m=this.centerPoint;if(this.projection.name==="globe"){const x=this.worldSize;h=(o.x-m.x)/x,p=(o.y-m.y)/x}else{const x=this.pointCoordinate(o),b=this.pointCoordinate(m);h=x.x-b.x,p=x.y-b.y}const g=this.locationCoordinate(r);this.setLocation(new a._(g.x-h,g.y-p))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r){return this.projection.locationPoint(this,r)}locationPoint3D(r){return this.projection.locationPoint(this,r,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r){return this.coordinateLocation(this.pointCoordinate3D(r))}locationCoordinate(r,o){const h=o?a.ay(o,r.lat):void 0,p=this.projection.project(r.lng,r.lat);return new a._(p.x,p.y,h)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,o){const h=o??this._centerAltitude,p=[r.x,r.y,0,1],m=[r.x,r.y,1,1];a.aB.transformMat4(p,p,this.pixelMatrixInverse),a.aB.transformMat4(m,m,this.pixelMatrixInverse);const g=m[3];a.aB.scale(p,p,1/p[3]),a.aB.scale(m,m,1/g);const x=p[2],b=m[2];return{p0:p,p1:m,t:x===b?0:(h-x)/(b-x)}}screenPointToMercatorRay(r){const o=[r.x,r.y,0,1],h=[r.x,r.y,1,1];return a.aB.transformMat4(o,o,this.pixelMatrixInverse),a.aB.transformMat4(h,h,this.pixelMatrixInverse),a.aB.scale(o,o,1/o[3]),a.aB.scale(h,h,1/h[3]),o[2]=a.ay(o[2],this._center.lat)*this.worldSize,h[2]=a.ay(h[2],this._center.lat)*this.worldSize,a.aB.scale(o,o,1/this.worldSize),a.aB.scale(h,h,1/this.worldSize),new a.aU([o[0],o[1],o[2]],a.$.normalize([],a.$.sub([],h,o)))}rayIntersectionCoordinate(r){const{p0:o,p1:h,t:p}=r,m=a.ay(o[2],this._center.lat),g=a.ay(h[2],this._center.lat);return new a._(a.a3(o[0],h[0],p)/this.worldSize,a.a3(o[1],h[1],p)/this.worldSize,a.a3(m,g,p))}pointCoordinate(r,o=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,o)}pointCoordinate3D(r){if(!this.elevation)return this.pointCoordinate(r);let o=this.projection.pointCoordinate3D(this,r.x,r.y);if(o)return new a._(o[0],o[1],o[2]);let h=0,p=this.horizonLineFromTop();if(r.y>p)return this.pointCoordinate(r);const m=.02*p,g=r.clone();for(let x=0;x<10&&p-h>m;x++){g.y=a.a3(h,p,.66);const b=this.projection.pointCoordinate3D(this,g.x,g.y);b?(p=g.y,o=b):h=g.y}return o?new a._(o[0],o[1],o[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=a.aV)return!this.isPointAboveHorizon(r);const o=this.pointCoordinate(r);return o.y>=0&&o.y<=1}_coordinatePoint(r,o){const h=o&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,p=[r.x*this.worldSize,r.y*this.worldSize,h+r.toAltitude(),1];return a.aB.transformMat4(p,p,this.pixelMatrix),p[3]>0?new a.P(p[0]/p[3],p[1]/p[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:o}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,p=this.width-this._edgeInsets.right,m=this.pointLocation3D(new a.P(o,r)),g=this.pointLocation3D(new a.P(p,r)),x=this.pointLocation3D(new a.P(p,h)),b=this.pointLocation3D(new a.P(o,h));let w=Math.min(m.lng,g.lng,x.lng,b.lng),T=Math.max(m.lng,g.lng,x.lng,b.lng),E=Math.min(m.lat,g.lat,x.lat,b.lat),O=Math.max(m.lat,g.lat,x.lat,b.lat);const z=Math.pow(2,-this.zoom)/16*270,L=this.projection.name==="globe"?1:4,k=(B,F,$,G,Z)=>{const K=(B+$)/2,W=(F+G)/2,H=new a.P(K,W),{lng:te,lat:re}=this.pointLocation3D(H),he=Math.max(0,w-te,E-re,te-T,re-O);w=Math.min(w,te),T=Math.max(T,te),E=Math.min(E,re),O=Math.max(O,re),(Z<L||he>z)&&(k(B,F,K,W,Z+1),k(K,W,$,G,Z+1))};if(k(o,r,p,r,1),k(p,r,p,h,1),k(p,h,o,h,1),k(o,h,o,r,1),this.projection.name==="globe"){const[B,F]=a.aW(this);B?(O=90,T=180,w=-180):F&&(E=-90,T=180,w=-180)}return new a.aj(new a.aJ(w,E),new a.aJ(T,O))}_getBoundsRectangular(r,o){const{top:h,left:p}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,g=this.width-this._edgeInsets.right,x=new a.P(p,h),b=new a.P(g,h),w=new a.P(g,m),T=new a.P(p,m);let E=this.pointCoordinate(x,r),O=this.pointCoordinate(b,r);const z=this.pointCoordinate(w,o),L=this.pointCoordinate(T,o),k=(B,F)=>(F.y-B.y)/(F.x-B.x);return E.y>1&&O.y>=0?E=new a._((1-L.y)/k(L,E)+L.x,1):E.y<0&&O.y<=1&&(E=new a._(-L.y/k(L,E)+L.x,0)),O.y>1&&E.y>=0?O=new a._((1-z.y)/k(z,O)+z.x,1):O.y<0&&E.y<=1&&(O=new a._(-z.y/k(z,O)+z.x,0)),new a.aj().extend(this.coordinateLocation(E)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(L)).extend(this.coordinateLocation(z))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const o=r.visibleDemTiles.reduce((h,p)=>{if(p.dem){const m=p.dem.tree;h.min=Math.min(h.min,m.minimums[0]),h.max=Math.max(h.max,m.maximums[0])}return h},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(o.min*r.exaggeration(),o.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const o=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,h=this.height/2-o*(1-this._horizonShift);return r?Math.max(0,h):h}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-a.aT,this.maxLat=a.aT,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.ak(this.minLng)*this.tileSize,this.worldMaxX=a.ak(this.maxLng)*this.tileSize,this.worldMinY=a.al(this.maxLat)*this.tileSize,this.worldMaxY=a.al(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,o){return this.projection.createTileMatrix(this,o,r)}calculateDistanceTileData(r){const o=r.key,h=this._distanceTileDataCache;if(h[o])return h[o];const p=r.canonical,m=1/this.height,g=this.cameraWorldSize,x=g/this.zoomScale(p.z),b=(p.x+Math.pow(2,p.z)*r.wrap)*x,w=p.y*x,T=this.point;T.x*=g/this.worldSize,T.y*=g/this.worldSize;const E=this.angle,O=Math.sin(-E),z=-Math.cos(-E);return h[o]={bearing:[O,z],center:[(T.x-b)*m,(T.y-w)*m],scale:x/a.a4*m},h[o]}calculateFogTileMatrix(r){const o=r.key,h=this._fogTileMatrixCache;if(h[o])return h[o];const p=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return a.ae.multiply(p,this.worldToFogMatrix,p),h[o]=new Float32Array(p),h[o]}calculateProjMatrix(r,o=!1,h=!1){const p=r.key;let m;if(m=h?this._expandedProjMatrixCache:o?this._alignedProjMatrixCache:this._projMatrixCache,m[p])return m[p];const g=this.calculatePosMatrix(r,this.worldSize);let x;return x=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.expandedFarZProjMatrix:o?this.alignedProjMatrix:this.projMatrix,a.ae.multiply(g,x,g),m[p]=new Float32Array(g),m[p]}calculatePixelsToTileUnitsMatrix(r){const o=r.tileID.key,h=this._pixelsToTileUnitsCache;if(h[o])return h[o];const p=a.aX(r,this);return h[o]=p,h[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,o=a.ae.fromScaling([],[r,r,r]);return a.ae.multiply(o,o,this.globeMatrix),o}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const o=a.ay(1,this._center.lat)*this.worldSize,h=this._computeCameraPosition(o),p=this._camera.forward(),m=a.ay(1,this._center.lat);h[2]/=m,p[2]/=m,a.$.normalize(p,p);const g=r.raycast(h,p,r.exaggeration());if(g){const x=a.$.scaleAndAdd([],h,p,g),b=new a._(x[0],x[1],a.ay(x[2],a.az(x[1]))),w=(b.z+a.$.length([b.x-h[0],b.y-h[1],b.z-h[2]*m]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(w),this._centerAltitude=b.toAltitude(),this._center=this.coordinateLocation(b),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const o=this._elevation,h=a.ay(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(h),m=o.getAtPointOrZero(new a._(...p)),g=this.pixelsPerMeter/this.worldSize*m,x=this._minimumHeightOverTerrain(),b=p[2]-g;if(b<=x)if(b<0||r){const w=this.locationCoordinate(this._center,this._centerAltitude),T=[p[0],p[1],w.z-p[2]],E=a.$.length(T);T[2]-=(x-b)/this._pixelsPerMercatorPixel;const O=a.$.length(T);if(O===0)return;a.$.scale(T,T,E/O*this._pixelsPerMercatorPixel),this._camera.position=[p[0],p[1],w.z*this._pixelsPerMercatorPixel-T[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const O=this.center;return O.lat=a.au(O.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&(O.lng=a.au(O.lng,this.minLng,this.maxLng)),this.center=O,void(this._constraining=!1)}const o=this._unmodified,{x:h,y:p}=this.point;let m=0,g=h,x=p;const b=this.width/2,w=this.height/2,T=this.worldMinY*this.scale,E=this.worldMaxY*this.scale;if(p-w<T&&(x=T+w),p+w>E&&(x=E-w),E-T<this.height&&(m=Math.max(m,this.height/(E-T)),x=(E+T)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const O=this.worldMinX*this.scale,z=this.worldMaxX*this.scale,L=this.worldSize/2-(O+z)/2;g=(h+L+this.worldSize)%this.worldSize-L,g-b<O&&(g=O+b),g+b>z&&(g=z-b),z-O<this.width&&(m=Math.max(m,this.width/(z-O)),g=(z+O)/2)}g===h&&x===p||(this.center=this.unproject(new a.P(g,x))),m&&(this.zoom+=this.scaleZoom(m)),this._constrainCamera(),this._unmodified=o,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,o=this.projection.name==="globe",h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.ay(1,this.center.lat)/a.ay(1,a.b5));const p=a.aY(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const m=this.projection.zAxisUnit==="meters"?h:1,g=this._camera.getWorldToCamera(this.worldSize,m);let x;const b=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(b[8]=2*-r.x/this.width,b[9]=2*r.y/this.height,this.isOrthographic){let re=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),he=re*this.aspect,ne=-he,J=-re;he-=r.x,ne-=r.x,re+=r.y,J+=r.y,x=this._camera.getCameraToClipOrthographic(ne,he,J,re,this._nearZ,this._farZ),((ge,me,oe,Pe)=>{for(let Me=0;Me<16;Me++)ge[Me]=Ml(me[Me],oe[Me],Pe)})(x,x,b,ao(this.pitch>=15?1:this.pitch/15))}else x=b;const w=a.ae.mul([],b,g);let T=a.ae.mul([],x,g);if(this.projection.isReprojectedInTileSpace){const re=this.locationCoordinate(this.center),he=a.ae.identity([]);a.ae.translate(he,he,[re.x*this.worldSize,re.y*this.worldSize,0]),a.ae.multiply(he,he,a.aZ(this)),a.ae.translate(he,he,[-re.x*this.worldSize,-re.y*this.worldSize,0]),a.ae.multiply(T,T,he),a.ae.multiply(w,w,he),this.inverseAdjustmentMatrix=a.a_(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.ae.scale([],T,[this.worldSize,this.worldSize,this.worldSize/m,1]),this.projMatrix=T,this.invProjMatrix=a.ae.invert(new Float64Array(16),this.projMatrix),o){const re=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);re[8]=2*-r.x/this.width,re[9]=2*r.y/this.height,this.expandedFarZProjMatrix=a.ae.mul([],re,g)}else this.expandedFarZProjMatrix=this.projMatrix;const E=a.ae.invert([],x);this.frustumCorners=a.a$.fromInvProjectionMatrix(E,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!o);const O=new Float32Array(16);a.ae.identity(O),a.ae.scale(O,O,[1,-1,1]),a.ae.rotateX(O,O,this._pitch),a.ae.rotateZ(O,O,this.angle);const z=a.ae.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.ae.clone(z);const L=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;z[8]=2*-r.x/this.width,z[9]=2*(r.y+L)/this.height,this.skyboxMatrix=a.ae.multiply(O,z,O);const k=this.point,B=k.x,F=k.y,$=this.width%2/2,G=this.height%2/2,Z=Math.cos(this.angle),K=Math.sin(this.angle),W=B-Math.round(B)+Z*$+K*G,H=F-Math.round(F)+Z*G+K*$,te=new Float64Array(T);if(a.ae.translate(te,te,[W>.5?W-1:W,H>.5?H-1:H,0]),this.alignedProjMatrix=te,T=a.ae.create(),a.ae.scale(T,T,[this.width/2,-this.height/2,1]),a.ae.translate(T,T,[1,-1,0]),this.labelPlaneMatrix=T,T=a.ae.create(),a.ae.scale(T,T,[1,-1,1]),a.ae.translate(T,T,[-1,-1,0]),a.ae.scale(T,T,[2/this.width,2/this.height,1]),this.glCoordMatrix=T,this.pixelMatrix=a.ae.multiply(new Float64Array(16),this.labelPlaneMatrix,w),this._calcFogMatrices(),this._distanceTileDataCache={},T=a.ae.invert(new Float64Array(16),this.pixelMatrix),!T)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=T,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.b0(this);const re=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.$.transformMat4(re,re,g),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=T;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,o=this.cameraPixelsPerMeter,h=this._camera.position,p=1/this.height/this._pixelsPerMercatorPixel,m=[r,r,o];a.$.scale(m,m,p),a.$.scale(h,h,-1),a.$.multiply(h,h,m);const g=a.ae.create();a.ae.translate(g,g,h),a.ae.scale(g,g,m),this.mercatorFogMatrix=g,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,o,p)}_computeCameraPosition(r){const o=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,h=this._camera.forward(),p=this.point,m=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*o-r/this.worldSize*this._centerAltitude;return[p.x/this.worldSize-h[0]*m,p.y/this.worldSize-h[1]*m,r/this.worldSize*this._centerAltitude-h[2]*m]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const o=this._maxCameraBoundsDistance()*Math.cos(this._pitch),h=this._camera.position[2],p=r[2];let m=1;this.projection.wrap&&(this.center=this.center.wrap()),p>0&&(m=Math.min((o-h)/p,1)),this._camera.position=a.$.scaleAndAdd([],this._camera.position,r,m),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,o=this._camera.forward(),{pitch:h,bearing:p}=this._camera.getPitchBearing(),m=a.ay(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,g=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.ac(this._maxPitch)),x=Math.max((r[2]-m)/Math.cos(h),g),b=this._zoomFromMercatorZ(x);a.$.scaleAndAdd(r,r,o,x),this._pitch=a.au(h,a.ac(this.minPitch),a.ac(this.maxPitch)),this.angle=a.av(p,-Math.PI,Math.PI),this._setZoom(a.au(b,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a._(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let o=0,h=a.aV,p=0,m=1/0;for(;h-o>1e-6&&h>o;){const g=o+.5*(h-o),x=this.tileSize*Math.pow(2,g),b=this.getCameraToCenterDistance(this.projection,g,x),w=this.scaleZoom(b/(r*this.tileSize)),T=Math.abs(g-w);T<m&&(m=T,p=g),g<w?o=g:h=g}return p}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,o){const h=Math.min(r.x,o.x),p=Math.max(r.x,o.x),m=Math.min(r.y,o.y),g=Math.max(r.y,o.y);if(m<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const x=[new a.P(h,m),new a.P(p,g),new a.P(h,g),new a.P(p,m)],b=this.renderWorldCopies?-3:0,w=this.renderWorldCopies?4:1;for(const T of x){const E=this.pointRayIntersection(T);if(E.t<0)return!0;const O=this.rayIntersectionCoordinate(E);if(O.x<b||O.y<0||O.x>w||O.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.b1(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(r,o){const h=a.$.length(a.$.sub([],this._camera.position,r)),p=this._zoomFromMercatorZ(h)+o;return h-this._mercatorZfromZoom(p)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([o,h,p],m){const g=[o,h,p,1];a.aB.transformMat4(g,g,m);const x=g[3]=Math.max(g[3],1e-6);return g[0]/=x,g[1]/=x,g[2]/=x,g}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,r))}}getCameraToCenterDistance(r,o=this.zoom,h=this.worldSize){const p=a.aY(r,o,this.width,this.height,1024),m=r.pixelSpaceConversion(this.center.lat,h,p);let g=.5/Math.tan(.5*this._fov)*this.height*m;return this.isOrthographic&&(g=Ml(1,g,ao(this.pitch>=15?1:this.pitch/15))),g}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.ae.multiply(r,r,this.globeMatrix),r}getFrustum(r){return a.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const rr={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},Cr=(u,r)=>{if(r>0&&u.terrain&&a.w("Cutoff is currently disabled on terrain"),r<=0||u.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const o=u.transform,h=Math.max(Math.abs(o._zoom-(u.minCutoffZoom-1)),1),p=o.isLODDisabled(!1)?a.a0(60,45,o.pitch):a.a0(30,15,o.pitch),m=o._farZ-o._nearZ,g=r*o.height,x=((1-(b=p))*o.cameraToCenterDistance+b*(o._farZ+g))*h;var b;return{shouldRenderCutoff:p<1,uniformValues:{u_cutoff_params:[o._nearZ,o._farZ,(x-o._nearZ)/m,(x-g-o._nearZ)/m]}}},nr={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Di{constructor(r,o){this.aabb=r,this.lastCascade=o}}class Xn{add(r,o){const h=this.receivers[r.key];h!==void 0?(h.aabb.min[0]=Math.min(h.aabb.min[0],o.min[0]),h.aabb.min[1]=Math.min(h.aabb.min[1],o.min[1]),h.aabb.min[2]=Math.min(h.aabb.min[2],o.min[2]),h.aabb.max[0]=Math.max(h.aabb.max[0],o.max[0]),h.aabb.max[1]=Math.max(h.aabb.max[1],o.max[1]),h.aabb.max[2]=Math.max(h.aabb.max[2],o.max[2])):this.receivers[r.key]=new Di(o,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,o,h){const p=a.b8.fromPoints(r.points);let m=0;for(const g in this.receivers){const x=this.receivers[g];if(!x||!p.intersectsAabb(x.aabb))continue;x.aabb.min=p.closestPoint(x.aabb.min),x.aabb.max=p.closestPoint(x.aabb.max);const b=x.aabb.getCorners();for(let w=0;w<h.length;w++){let T=!0;for(const E of b){const O=[E[0]*o,E[1]*o,E[2]];if(a.$.transformMat4(O,O,h[w].matrix),O[0]<-1||O[0]>1||O[1]<-1||O[1]>1){T=!1;break}}if(x.lastCascade=w,m=Math.max(m,w),T)break}}return m+1}}class zh{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Xn,this._depthMode=new a.af(r.context.gl.LEQUAL,a.af.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(nr,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(nr,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(nr,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,o){const h=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!o||!o.properties)return;const p=o.properties.get("shadow-intensity");if(!o.shadowsEnabled()||p<=0||(this._shadowLayerCount=h.style.order.reduce((L,k)=>{const B=h.style._mergedLayers[k];return L+(B.hasShadowPass()&&!B.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const m=h.context,g=nr.shadowMapResolution,x=nr.shadowMapResolution;if(this._cascades.length===0||nr.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let L=0;L<nr.cascadeCount;++L){const k=h._shadowMapDebug,B=m.gl,F=m.createFramebuffer(g,x,k,"texture"),$=new a.T(m,{width:g,height:x,data:null},B.DEPTH_COMPONENT);if(F.depthAttachment.set($.texture),k){const G=new a.T(m,{width:g,height:x,data:null},B.RGBA);F.colorAttachment.set(G.texture)}this._cascades.push({framebuffer:F,texture:$,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.aM,scale:0})}}this.shadowDirection=ca(o);let b=0;if(r.elevation){const L=r.elevation,k=[1e4,-1e4];L.visibleDemTiles.filter(B=>B.dem).forEach(B=>{const F=B.dem.tree;k[0]=Math.min(k[0],F.minimums[0]),k[1]=Math.max(k[1],F.maximums[0])}),k[0]!==1e4&&(b=(k[1]-k[0])*L.exaggeration())}const w=1.5*r.cameraToCenterDistance,T=3*w,E=new Float64Array(16);for(let L=0;L<this._cascades.length;++L){const k=this._cascades[L];let B=r.height/50,F=1;nr.cascadeCount===1?F=T:L===0?F=w:(B=w,F=T);const[$,G]=Y1(r,this.shadowDirection,B,F,nr.shadowMapResolution,b);k.scale=r.scale,k.matrix=$,k.boundingSphereRadius=G,a.ae.invert(E,k.matrix),k.frustum=a.aM.fromInvProjectionMatrix(E,1,0,!0),k.far=F}const O=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[O].far,this._cascades[O].far],this._uniformValues.u_shadow_intensity=p,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/nr.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=nr.shadowMapResolution,this._uniformValues.u_shadowmap_0=rr.ShadowMap0,this._uniformValues.u_shadowmap_1=rr.ShadowMap0+1,this._groundShadowTiles=h.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const z=h.transform.elevation;for(const L of this._groundShadowTiles){let k={min:0,max:0};if(z){const B=z.getMinMaxForTile(L);B&&(k=B)}this.addShadowReceiver(L.toUnwrapped(),k.min,k.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,o){if(!this.enabled)return;const h=this.painter,p=h.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(h.transform.getFrustum(0),h.transform.worldSize,this._cascades),p.viewport.set([0,0,nr.shadowMapResolution,nr.shadowMapResolution]);for(let m=0;m<this._numCascadesToRender;++m){h.currentShadowCascade=m,p.bindFramebuffer.set(this._cascades[m].framebuffer.framebuffer),p.clear({color:a.C.white,depth:1});for(const g of r.order){const x=r._mergedLayers[g];if(!x.hasShadowPass()||x.isHidden(h.transform.zoom))continue;const b=r.getLayerSourceCache(x),w=b?o[b.id]:void 0;(x.type==="model"||w&&w.length)&&h.renderLayer(h,b,x,w)}}h.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,o=r.style,h=r.context,p=o.directionalLight,m=o.ambientLight;if(!p||!m)return;const g=[],x=Cr(r,r.longestCutoffRange);x.shouldRenderCutoff&&g.push("RENDER_CUTOFF");const b=lo(o,p,m),w=new a.af(h.gl.LEQUAL,a.af.ReadOnly,r.depthRangeFor3D);for(const T of this._groundShadowTiles){const E=T.toUnwrapped(),O=r.isTileAffectedByFog(T),z=r.getOrCreateProgram("groundShadow",{defines:g,overrideFog:O});this.setupShadows(E,z),r.uploadCommonUniforms(h,z,E,null,x);const L={u_matrix:r.transform.calculateProjMatrix(E),u_ground_shadow_factor:b};z.draw(r,h.gl.TRIANGLES,w,a.ah.disabled,a.a.multiply,a.ag.disabled,L,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,{},r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?a.a.unblended:a.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const o=this.painter.transform,h=o.calculatePosMatrix(r,o.worldSize);return a.ae.multiply(h,this._cascades[this.painter.currentShadowCascade].matrix,h),Float32Array.from(h)}calculateShadowPassMatrixFromMatrix(r){return a.ae.multiply(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,o,h,p=0){if(!this.enabled)return;const m=this.painter.transform,g=this.painter.context,x=g.gl,b=this._uniformValues,w=new Float64Array(16),T=m.calculatePosMatrix(r,m.worldSize);for(let E=0;E<this._cascades.length;E++)a.ae.multiply(w,this._cascades[E].matrix,T),b[E===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(w),g.activeTexture.set(x.TEXTURE0+rr.ShadowMap0+E),this._cascades[E].texture.bind(x.NEAREST,x.CLAMP_TO_EDGE);if(this.useNormalOffset=!!h,this.useNormalOffset){const E=a.b7(r.canonical),O=2/m.tileSize*a.a4/nr.shadowMapResolution,z=O*this._cascades[0].boundingSphereRadius,L=O*this._cascades[this._cascades.length-1].boundingSphereRadius,k=(h==="vector-tile"?1:3)/Math.pow(2,p-r.canonical.z-(1-m.zoom+Math.floor(m.zoom)));b.u_shadow_normal_offset=[E,z*k,L*k],b.u_shadow_bias=[6e-5,.0012,.012]}else b.u_shadow_bias=[36e-5,.0012,.012];o.setShadowUniformValues(g,b)}setupShadowsFromMatrix(r,o,h=!1){if(!this.enabled)return;const p=this.painter.context,m=p.gl,g=this._uniformValues,x=new Float64Array(16);for(let b=0;b<nr.cascadeCount;b++)a.ae.multiply(x,this._cascades[b].matrix,r),g[b===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(x),p.activeTexture.set(m.TEXTURE0+rr.ShadowMap0+b),this._cascades[b].texture.bind(m.NEAREST,m.CLAMP_TO_EDGE);if(this.useNormalOffset=h,h){const b=nr.normalOffset;g.u_shadow_normal_offset=[1,b,b],g.u_shadow_bias=[6e-5,.0012,.012]}else g.u_shadow_bias=[36e-5,.0012,.012];o.setShadowUniformValues(p,g)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,o,h,p){if(p[2]>=0)return{};const m=function(b,w,T){const E=T/(1<<b.canonical.z);return new a.b8([b.canonical.x*E+b.wrap*T,b.canonical.y*E+b.wrap*T,0],[(b.canonical.x+1)*E+b.wrap*T,(b.canonical.y+1)*E+b.wrap*T,w])}(r,o,h).getCorners(),g=o/-p[2];p[0]<0?(a.$.add(m[0],m[0],[p[0]*g,0,0]),a.$.add(m[3],m[3],[p[0]*g,0,0])):p[0]>0&&(a.$.add(m[1],m[1],[p[0]*g,0,0]),a.$.add(m[2],m[2],[p[0]*g,0,0])),p[1]<0?(a.$.add(m[0],m[0],[0,p[1]*g,0]),a.$.add(m[1],m[1],[0,p[1]*g,0])):p[1]>0&&(a.$.add(m[2],m[2],[0,p[1]*g,0]),a.$.add(m[3],m[3],[0,p[1]*g,0]));const x={};return x.vertices=m,x.planes=[la(m[1],m[0],m[4]),la(m[2],m[1],m[5]),la(m[3],m[2],m[6]),la(m[0],m[3],m[7])],x}addShadowReceiver(r,o,h){this._receivers.add(r,a.b8.fromTileIdAndHeight(r,o,h))}getMaxCascadeForTile(r){const o=this._receivers.get(r);return o&&o.lastCascade?o.lastCascade:0}}function la(u,r,o){const h=a.$.sub([],o,r),p=a.$.sub([],u,r),m=a.$.cross([],h,p),g=a.$.length(m);return g===0?[0,0,1,0]:(a.$.scale(m,m,1/g),[m[0],m[1],m[2],-a.$.dot(m,r)])}function ca(u){const r=u.properties.get("direction"),o=a.ad(r.x,r.y,r.z);o[2]=a.au(o[2],0,75);const h=a.b9([o[0],o[1],o[2]]);return a.$.fromValues(h.x,h.y,h.z)}function lo(u,r,o){const h=r.properties.get("color"),p=r.properties.get("intensity"),m=r.properties.get("direction"),g=[m.x,m.y,m.z],x=o.properties.get("color"),b=o.properties.get("intensity"),w=Math.max(a.$.dot([0,0,1],g),0),T=[0,0,0];a.$.scale(T,x.toRenderColor(u.getLut(r.scope)).toArray01Linear().slice(0,3),b);const E=[0,0,0];return a.$.scale(E,h.toRenderColor(u.getLut(o.scope)).toArray01Linear().slice(0,3),w*p),a.ba([T[0]>0?T[0]/(T[0]+E[0]):0,T[1]>0?T[1]/(T[1]+E[1]):0,T[2]>0?T[2]/(T[2]+E[2]):0])}function Y1(u,r,o,h,p,m){const g=u.zoom,x=u.scale,b=u.worldSize,w=1/b,T=u.aspect,E=Math.sqrt(1+T*T)*Math.tan(.5*u.fovX),O=E*E,z=h-o,L=h+o;let k,B;O>z/L?(k=h,B=h*E):(k=.5*L*(1+O),B=.5*Math.sqrt(z*z+2*(h*h+o*o)*O+L*L*O*O));const F=u.projection.pixelsPerMeter(u.center.lat,b),$=u._camera.getCameraToWorldMercator(),G=[0,0,-k*w];a.$.transformMat4(G,G,$);let Z=B*w;const K=u._edgeInsets;if(!(K.left===0&&K.top===0&&K.right===0&&K.bottom===0||K.left===K.right&&K.top===K.bottom)){const Se=u._camera.getWorldToCamera(u.worldSize,u.projection.zAxisUnit==="meters"?F:1),Ie=u._camera.getCameraToClipPerspective(u._fov,u.width/u.height,o,h);Ie[8]=2*-u.centerOffset.x/u.width,Ie[9]=2*u.centerOffset.y/u.height;const Ue=new Float64Array(16);a.ae.mul(Ue,Ie,Se);const $e=new Float64Array(16);a.ae.invert($e,Ue);const Je=a.aM.fromInvProjectionMatrix($e,b,g,!0);for(const qe of Je.points){const ot=((W=qe)[0]/=x,W[1]/=x,W[2]=a.ay(W[2],u._center.lat),W);Z=Math.max(Z,a.$.len(a.$.subtract([],G,ot)))}}var W;Z*=p/(p-1);const H=Math.acos(r[2]),te=Math.atan2(-r[0],-r[1]),re=new sa;re.position=G,re.setPitchBearing(H,te);const he=re.getWorldToCamera(b,F),ne=Z*b,J=Math.min(u._mercatorZfromZoom(17)*b*-2,-2*ne),ge=re.getCameraToClipOrthographic(-ne,ne,-ne,ne,J,(ne+m*F)/r[2]),me=new Float64Array(16);a.ae.multiply(me,ge,he);const oe=a.$.fromValues(Math.floor(1e6*G[0])/1e6*b,Math.floor(1e6*G[1])/1e6*b,0),Pe=.5*p,Me=[0,0,0];a.$.transformMat4(Me,oe,me),a.$.scale(Me,Me,Pe);const de=[Math.floor(Me[0]),Math.floor(Me[1]),Math.floor(Me[2])],Ce=[0,0,0];a.$.sub(Ce,Me,de),a.$.scale(Ce,Ce,-1/Pe);const se=new Float64Array(16);return a.ae.identity(se),a.ae.translate(se,se,Ce),a.ae.multiply(me,se,me),[me,ne]}function co(u,r){return u!=null&&r!=null&&!(!u.hasData()||!r.hasData())&&u.demTexture!=null&&r.demTexture!=null&&u.tileID.key!==r.tileID.key}const Yn=new class{constructor(){this.operations={}}newMorphing(u,r,o,h,p){if(u in this.operations){const m=this.operations[u];m.to.tileID.key!==o.tileID.key&&(m.queued=o)}else this.operations[u]={startTime:h,phase:0,duration:p,from:r,to:o,queued:null}}getMorphValuesForProxy(u){if(!(u in this.operations))return null;const r=this.operations[u];return{from:r.from,to:r.to,phase:r.phase}}update(u){for(const r in this.operations){const o=this.operations[r];for(o.phase=(u-o.startTime)/o.duration;o.phase>=1||!this._validOp(o);)if(!this._nextOp(o,u)){delete this.operations[r];break}}}_nextOp(u,r){return!!u.queued&&(u.from=u.to,u.to=u.queued,u.queued=null,u.phase=0,u.startTime=r,!0)}_validOp(u){return u.from.hasData()&&u.to.hasData()}},uo={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Jn(u,r,o){if(r===0)return 0;const h=r<1&&o===514?.25/r:1;return 6*Math.pow(1.5,22-u)*Math.max(r,1)*h}function ho(u,r){const o=1<<u.z;return!r&&(u.x===0||u.x===o-1)||u.y===0||u.y===o-1}const po=u=>({u_matrix:u});function Sl(u,r,o,h,p){if(p>0){const m=a.e.now(),g=(m-u.timeAdded)/p,x=r?(m-r.timeAdded)/p:-1,b=o.getSource(),w=h.coveringZoomLevel({tileSize:b.tileSize,roundZoom:b.roundZoom}),T=!r||Math.abs(r.tileID.overscaledZ-w)>Math.abs(u.tileID.overscaledZ-w),E=T&&u.refreshedUponExpiration?1:a.au(T?g:1-x,0,1);return u.refreshedUponExpiration&&g>=1&&(u.refreshedUponExpiration=!1),r?{opacity:1,mix:1-E}:{opacity:E,mix:0}}return{opacity:1,mix:0}}class Kn extends Er{constructor(r,o,h,p){super(r,o,h,p),this.type="raster-array",this.maxzoom=22,this._options=a.Q({type:"raster-array"},o)}triggerRepaint(r){const o=this.map.painter._terrain,h=this.map.style.getSourceCache(this.id);o&&o.enabled&&h&&o._clearRenderCacheForTile(h.id,r.tileID),this.map.triggerRepaint()}loadTile(r,o){const h=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),p=this.map._requestManager.transformRequest(h,a.R.Tile);r.requestParams=p,r.actor||(r.actor=this.dispatcher.getActor()),r.request=r.fetchHeader(void 0,(m,g,x,b)=>{if(delete r.request,r.aborted)return r.state="unloaded",o(null);if(m)return m.code===20?void 0:(r.state="errored",o(m));this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:x,expires:b}),r.state="empty",o(null)})}unloadTile(r,o){const h=r.texture;h&&h instanceof a.T?(r.destroy(!0),this.map.painter.saveTileTexture(h)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,o,h){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(o,h,(p,m)=>{if(p)return r.state="errored",this.fire(new a.f(p)),void this.triggerRepaint(r);m&&(r.setTexture(m,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const o=this.rasterLayers.find(({id:m})=>m===r),h=o&&o.fields,p=h&&h.bands&&h.bands;return p?p[0]:0}getTextureDescriptor(r,o,h){if(!r)return;const p=o.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!p)return;let m=null;o instanceof a.bm?m=o.paint.get("raster-array-band"):o instanceof a.bn&&(m=o.paint.get("raster-particle-array-band"));const g=m||this.getInitialBand(p);if(g!=null)if(r.textureDescriptor){if(!r.updateNeeded(p,g)||h)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,p,g)}}const El={vector:M3,raster:Er,"raster-dem":class extends Er{constructor(u,r,o,h){super(u,r,o,h),this.type="raster-dem",this.maxzoom=22,this._options=a.Q({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(u,r){const o=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function h(p,m){p&&(u.state="errored",r(p)),m&&(u.dem=m,u.dem.onDeserialize(),u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0,u.state="loaded",r(null))}u.request=a.i(this.map._requestManager.transformRequest(o,a.R.Tile),(function(p,m,g,x){if(delete u.request,u.aborted)u.state="unloaded",r(null);else if(p)u.state="errored",r(p);else if(m){this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:g,expires:x});const b=ImageBitmap&&m instanceof ImageBitmap&&a.bk(),w=1-(m.width-a.bl(m.width))/2;w<1||u.neighboringTiles||(u.neighboringTiles=this._getNeighboringTiles(u.tileID));const T=b?m:a.e.getImageData(m,w),E={uid:u.uid,coord:u.tileID,source:this.id,scope:this.scope,rawImageData:T,encoding:this.encoding,padding:w};u.actor&&u.state!=="expired"||(u.actor=this.dispatcher.getActor(),u.actor.send("loadDEMTile",E,h.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(u){const r=u.canonical,o=Math.pow(2,r.z),h=(r.x-1+o)%o,p=r.x===0?u.wrap-1:u.wrap,m=(r.x+1+o)%o,g=r.x+1===o?u.wrap+1:u.wrap,x={};return x[new a.aQ(u.overscaledZ,p,r.z,h,r.y).key]={backfilled:!1},x[new a.aQ(u.overscaledZ,g,r.z,m,r.y).key]={backfilled:!1},r.y>0&&(x[new a.aQ(u.overscaledZ,p,r.z,h,r.y-1).key]={backfilled:!1},x[new a.aQ(u.overscaledZ,u.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},x[new a.aQ(u.overscaledZ,g,r.z,m,r.y-1).key]={backfilled:!1}),r.y+1<o&&(x[new a.aQ(u.overscaledZ,p,r.z,h,r.y+1).key]={backfilled:!1},x[new a.aQ(u.overscaledZ,u.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},x[new a.aQ(u.overscaledZ,g,r.z,m,r.y+1).key]={backfilled:!1}),x}},"raster-array":Kn,geojson:class extends a.E{constructor(u,r,o,h){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(h),this._data=r.data,this._options=a.Q({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const p=a.a4/this.tileSize;this.workerOptions=a.Q({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*p,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*p,extent:a.a4,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:a.a4,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*p,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(u){this.map=u,this.setData(this._data)}setData(u){return this._data=u,this._updateWorkerData(),this}updateData(u){if(!this._options.dynamic)return this.fire(new a.f(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof u!="string"&&(u.type==="Feature"&&(u={type:"FeatureCollection",features:[u]}),u.type!=="FeatureCollection"))return this.fire(new a.f(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof u!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const o of this._data.features)r.set(o.id,o);for(const o of u.features)r.set(o.id,o);this._data.features=[...r.values()]}else this._data=u;return this._updateWorkerData(!0),this}getClusterExpansionZoom(u,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:u,source:this.id,scope:this.scope},r),this}getClusterChildren(u,r){return this.actor.send("geojson.getClusterChildren",{clusterId:u,source:this.id,scope:this.scope},r),this}getClusterLeaves(u,r,o,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:u,limit:r,offset:o},h),this}_updateWorkerData(u=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.g("dataloading",{dataType:"source"})),this._loaded=!1;const r=a.Q({append:u},this.workerOptions);r.scope=this.scope;const o=this._data;typeof o=="string"?(r.request=this.map._requestManager.transformRequest(a.e.resolveURL(o),a.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(h,p)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new a.f(h));else{const m={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(m.resourceTiming=p.resourceTiming[this.id]),u&&(this._partialReload=!0),this.fire(new a.g("data",m)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(u),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(u,r){const o=u.actor?"reloadTile":"loadTile";u.actor=this.actor;const h=this.map.style?this.map.style.getLut(this.scope):null,p=this._partialReload,m={type:this.type,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:h?{image:h.image.clone()}:null,scope:this.scope,pixelRatio:a.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:p};u.request=this.actor.send(o,m,(g,x)=>p&&!x?(u.state="loaded",r(null)):(delete u.request,u.destroy(),u.aborted?r(null):g?r(g):(u.loadVectorData(x,this.map.painter,o==="reloadTile"),r(null))),void 0,o==="loadTile")}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.aborted=!0}unloadTile(u,r){this.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope}),u.destroy()}onRemove(u){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.Q({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.bo{constructor(u,r,o,h){super(u,r,o,h),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const u=this.options;this.urls=[];for(const r of u.urls)this.urls.push(this.map._requestManager.transformRequest(r,a.R.Source).url);a.bp(this.urls,(r,o)=>{this._loaded=!0,r?this.fire(new a.f(r)):o&&(this.video=o,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const r=this.video.seekable;u<r.start(0)||u>r.end(0)?this.fire(new a.f(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const u=this.map.painter.context,r=u.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(u,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(u)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.bo,model:class extends a.E{constructor(u,r,o,h){super(),this.id=u,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const u=[];for(const r in this._options.models){const o=this._options.models[r],h=a.l(this.map._requestManager.transformRequest(o.uri,a.R.Model).url).then(p=>{if(!p)return;const m=a.c(p),g=new a.M(r,o.position,o.orientation,m);g.computeBoundsAndApplyParent(),this.models.push(g)}).catch(p=>{this.fire(new a.f(new Error(`Could not load model ${r} from ${o.uri}: ${p.message}`)))});u.push(h)}return Promise.allSettled(u).then(()=>{this._loaded=!0,this.fire(new a.g("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this.fire(new a.f(new Error(`Could not load models: ${r.message}`)))})}onAdd(u){this.map=u,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(u,r){}serialize(){return{type:"model"}}},"batched-model":class extends a.E{constructor(u,r,o,h){super(),this.type="batched-model",this.id=u,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=o,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(h)}onAdd(u){this.map=u,this.load()}load(u){this._loaded=!1,this.fire(new a.g("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,o=this.map._worldview;this._tileJSONRequest=G1(this._options,this.map._requestManager,r,o,(h,p)=>{this._tileJSONRequest=null,this._loaded=!0,h?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),o&&o.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${o}`),this.fire(new a.f(h))):p&&(a.Q(this,p),p.bounds&&(this.tileBounds=new io(p.bounds,this.minzoom,this.maxzoom)),a.ao(p.tiles,this.map._requestManager._customAccessToken),this.fire(new a.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.g("data",{dataType:"source",sourceDataType:"content"}))),u&&u(h)})}hasTransition(){return!1}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loaded(){return this._loaded}loadTile(u,r){const o=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),h={request:this.map._requestManager.transformRequest(o,a.R.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:u.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(u.actor&&u.state!=="expired")if(u.state==="loading")u.reloadCallback=r;else{if(u.buckets){const m=Object.values(u.buckets);for(const g of m)g.dirty=!0;return void(u.state="loaded")}u.request=u.actor.send("reloadTile",h,p.bind(this))}else u.actor=this.dispatcher.getActor(),u.request=u.actor.send("loadTile",h,p.bind(this),void 0,!0);function p(m,g){return u.aborted?r(null):m&&m.status!==404?r(m):(g&&(g.resourceTiming&&(u.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&u.setExpiryData(g),u.buckets={...u.buckets,...g.buckets},g.featureIndex&&(u.latestFeatureIndex=g.featureIndex)),u.state="loaded",void r(null))}}serialize(){return a.Q({},this._options)}},canvas:class extends a.bo{constructor(u,r,o,h){super(u,r,o,h),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(m=>typeof m!="number"))||this.fire(new a.f(new a.V(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.f(new a.V(`sources.${u}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new a.f(new a.V(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new a.f(new a.V(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.f(new a.V(`sources.${u}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.f(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(u){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!u&&!this._playing||this.texture instanceof a.bq||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}},custom:class extends a.E{constructor(u,r,o,h){super(),this.id=u,this.type="custom",this._dataType="raster",this._dispatcher=o,this._implementation=r,this.setEventedParent(h),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.f(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.f(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new io(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),a.Q(this,a.ai(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.ai(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.g("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.g("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(u){this.map=u,this._loaded=!1,this.fire(new a.g("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(u),this.load()}onRemove(u){this._implementation.onRemove&&this._implementation.onRemove(u)}hasTile(u){if(this._implementation.hasTile){const{x:r,y:o,z:h}=u.canonical;return this._implementation.hasTile({x:r,y:o,z:h})}return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,r){const{x:o,y:h,z:p}=u.tileID.canonical,m=new AbortController;u.request=Promise.resolve(this._implementation.loadTile({x:o,y:h,z:p},{signal:m.signal})).then((function(g){return delete u.request,u.aborted?(u.state="unloaded",r(null)):g===void 0?(u.state="errored",r(null)):g===null?(this.loadTileData(u,{width:this.tileSize,height:this.tileSize,data:null}),u.state="loaded",r(null)):function(x){return x instanceof ImageData||x instanceof HTMLCanvasElement||x instanceof ImageBitmap||x instanceof HTMLImageElement}(g)?(this.loadTileData(u,g),u.state="loaded",void r(null)):(u.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(g=>{g.code!==20&&(u.state="errored",r(g))}),u.request.cancel=()=>m.abort()}loadTileData(u,r){u.setTexture(r,this.map.painter)}unloadTile(u,r){if(u.texture&&u.texture instanceof a.T?(u.destroy(!0),u.texture&&u.texture instanceof a.T&&this.map.painter.saveTileTexture(u.texture)):u.destroy(),this._implementation.unloadTile){const{x:o,y:h,z:p}=u.tileID.canonical;this._implementation.unloadTile({x:o,y:h,z:p})}r&&r()}abortTile(u,r){u.request&&u.request.cancel&&(u.request.cancel(),delete u.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(u=>({x:u.canonical.x,y:u.canonical.y,z:u.canonical.z}))}_clearTiles(){const u=a.am(this.id,this.scope);this.map.style.clearSource(u)}_update(){this.fire(new a.g("data",{dataType:"source",sourceDataType:"content"}))}}},Il=function(u,r,o,h){const p=new El[r.type](u,r,o,h);if(p.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${p.id}`);return a.br(["load","abort","unload","serialize","prepare"],p),p};class P3 extends a.bx{constructor(r){const o={type:"raster-dem",maxzoom:r.transform.maxZoom},h=new a.by(a.bz(),null),p=Il("mock-dem",o,h,r.style);super("mock-dem",p,!1),p.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,o){r.state="loaded",o(null)}}class O3 extends a.bx{constructor(r){const o=Il("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new a.by(a.bz(),null),r.style);super("proxy",o,!1),o.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,o,h){if(r.freezeTileCoverage)return;this.transform=r;const p=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((m,g)=>{if(m[g.key]="",!this._tiles[g.key]){const x=new a.bA(g,this._source.tileSize*g.overscaleFactor(),r.tileZoom);x.state="loaded",this._tiles[g.key]=x}return m},{});for(const m in this._tiles)m in p||(this.freeFBO(m),this._tiles[m].unloadVectorData(),delete this._tiles[m])}freeFBO(r){const o=this.proxyCachedFBO[r];if(o!==void 0){const h=Object.values(o);this.renderCachePool.push(...h),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class J1 extends a.aQ{constructor(r,o,h){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=o,this.projMatrix=h}}class sr extends a.bs{constructor(r,o){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[h,p,m]=function(b){const w=new a.bv,T=new a.bw,E=131;w.reserve(17161),T.reserve(33800);const O=a.a4/128,z=a.a4+O/2,L=z+O;for(let B=-O;B<L;B+=O)for(let F=-O;F<L;F+=O){const $=F<0||F>z||B<0||B>z?24575:0,G=a.au(Math.round(F),0,a.a4),Z=a.au(Math.round(B),0,a.a4);w.emplaceBack(G+$,Z)}const k=(B,F)=>{const $=F*E+B;T.emplaceBack($+1,$,$+E),T.emplaceBack($+E,$+E+1,$+1)};for(let B=1;B<129;B++)for(let F=1;F<129;F++)k(F,B);return[0,129].forEach(B=>{for(let F=0;F<130;F++)k(F,B),k(B,F)}),[w,T,32768]}(),g=r.context;this.gridBuffer=g.createVertexBuffer(h,a.bt.members),this.gridIndexBuffer=g.createIndexBuffer(p),this.gridSegments=a.b.simpleSegment(0,0,h.length,p.length),this.gridNoSkirtSegments=a.b.simpleSegment(0,0,h.length,m),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new O3(o.map),this.orthoMatrix=a.ae.create(),a.ae.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.a4,0,a.a4,0,1);const x=g.gl;this._overlapStencilMode=new a.ah({func:x.GEQUAL,mask:255},0,255,x.KEEP,x.KEEP,x.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=o,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new P3(o.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,o,h){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const p=r.terrain.properties,m=r.terrain.drapeRenderMode===0,g=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.e.now();const x=r.terrain&&r.terrain.scope,b=p.get("source"),w=m?this._mockSourceCache:r.getSourceCache(b,x);if(!w)return void a.w(`Couldn't find terrain source "${b}".`);if(this.sourceCache=w,this._exaggeration=g?this.calculateExaggeration(o):p.get("exaggeration"),!o.projection.requiresDraping&&g&&this._exaggeration===0)return void this._disable();this.enabled=!0;const T=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const E=this.getScaledDemTileSize();this.sourceCache.update(o,E,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),o.updateElevation(!0,h),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(o),this._emptyDEMTextureDirty=!0,this._previousZoom=o.zoom}else this._disable()}calculateExaggeration(r){const o=this._previousCameraAltitude,h=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=h;const p=o!=null?h-o:Number.MAX_VALUE;if(Math.abs(p)<2)return this._exaggeration;const m=r.zoom,g=this._style.terrain;if(!this._previousUpdateTimestamp)return g.getExaggeration(m);let x=m-this._previousZoom;const b=this._previousUpdateTimestamp;let w=m;this._evaluationZoom!=null&&(w=this._evaluationZoom,Math.abs(m-w)>.5&&(x=.5*(m-w+x)),x*p<0&&(w+=x)),this._evaluationZoom=w;const T=g.getExaggeration(w),E=T===g.getExaggeration(Math.max(0,w-.1));if(E&&Math.abs(T-this._exaggeration)<.01)return T;let O=Math.min(.1,.00375*(this._updateTimestamp-b));return(E||T<.1||Math.abs(x)<1e-4)&&(O=Math.min(.2,4*O)),a.a3(this._exaggeration,T,O)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const o=this.proxySourceCache,h=this.painter.transform;this._initializing&&(this._initializing=h._centerAltitude===0&&this.getAtPointOrZero(a._.fromLngLat(h.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const p=this.proxyCoords=o.getIds().map(b=>{const w=o.getTileByID(b).tileID;return w.projMatrix=h.calculateProjMatrix(w.toUnwrapped()),w});(function(b,w){const T=w.transform.pointCoordinate(w.transform.getCameraPoint()),E=new a.P(T.x,T.y);b.sort((O,z)=>{if(z.overscaledZ-O.overscaledZ)return z.overscaledZ-O.overscaledZ;const L=new a.P(O.canonical.x+(1<<O.canonical.z)*O.wrap,O.canonical.y),k=new a.P(z.canonical.x+(1<<z.canonical.z)*z.wrap,z.canonical.y),B=E.mult(1<<O.canonical.z);return B.x-=.5,B.y-=.5,B.distSqr(L)-B.distSqr(k)})})(p,this.painter);const m=this.proxyToSource||{};this.proxyToSource={},p.forEach(b=>{this.proxyToSource[b.key]={}}),this.terrainTileForTile={};const g=this._style._mergedSourceCaches;for(const b in g){const w=g[b];if(!w.used||(w!==this.sourceCache&&this.resetTileLookupCache(w.id),this._setupProxiedCoordsForOrtho(w,r[b],m),w.usedForTerrain))continue;const T=r[b];w.getSource().reparseOverscaled&&this._assignTerrainTiles(T)}this.proxiedCoords[o.id]=p.map(b=>new J1(b,b.key,this.orthoMatrix)),this._assignTerrainTiles(p),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(m),this.renderingToTexture=!1;const x={};this._visibleDemTiles=[];for(const b of this.proxyCoords){const w=this.terrainTileForTile[b.key];if(!w)continue;const T=w.tileID.key;T in x||(this._visibleDemTiles.push(w),x[T]=T)}}_assignTerrainTiles(r){this._initializing||r.forEach(o=>{if(this.terrainTileForTile[o.key])return;const h=this._findTileCoveringTileID(o,this.sourceCache);h&&(this.terrainTileForTile[o.key]=h)})}_prepareDEMTextures(){const r=this.painter.context,o=r.gl;for(const h in this.terrainTileForTile){const p=this.terrainTileForTile[h],m=p.dem;!m||p.demTexture&&!p.needsDEMTextureUpload||(r.activeTexture.set(o.TEXTURE1),T3(this.painter,p,m))}}_prepareDemTileUniforms(r,o,h,p){if(!o||o.demTexture==null)return!1;const m=r.tileID.canonical,g=Math.pow(2,o.tileID.canonical.z-m.z),x=p||"";return h[`u_dem_tl${x}`]=[m.x*g%1,m.y*g%1],h[`u_dem_scale${x}`]=g,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const o=this._visibleDemTiles.reduce((h,p)=>{if(!p.dem)return h;const m=p.dem.tree.minimums[0];return m>0&&r++,h+m},0);return r?o/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,o=r.gl;r.activeTexture.set(o.TEXTURE2);const h=this._getLoadedAreaMinimum(),[p,m]=(()=>{const x=new a.bB({width:1,height:1},new Float32Array([h]));return[o.R32F,x]})();this._emptyDEMTextureDirty=!1;let g=this._emptyDEMTexture;return g?g.update(m,{premultiply:!1}):g=this._emptyDEMTexture=new a.T(r,m,p,{premultiply:!1}),g}setupElevationDraw(r,o,h){const p=this.painter.context,m=p.gl,g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};g.u_exaggeration=this.exaggeration();let x=null,b=null,w=1;if(h&&h.morphing&&this._useVertexMorphing){const z=h.morphing.srcDemTile,L=h.morphing.dstDemTile;w=h.morphing.phase,z&&L&&(this._prepareDemTileUniforms(r,z,g,"_prev")&&(b=z),this._prepareDemTileUniforms(r,L,g)&&(x=L))}const T=z=>z&&z.demTexture&&this.painter.linearFloatFilteringSupported()?m.LINEAR:m.NEAREST;let E=null;var O;if(this.enabled?b&&x?(E=x.demTexture,p.activeTexture.set(m.TEXTURE4),b.demTexture.bind(T(b),m.CLAMP_TO_EDGE),g.u_dem_lerp=w):(x=this.terrainTileForTile[r.tileID.key],E=this._prepareDemTileUniforms(r,x,g)?x.demTexture:this.emptyDEMTexture):E=this.emptyDEMTexture,p.activeTexture.set(m.TEXTURE2),E&&(g.u_dem_size=(O=E).size[0]===1?1:O.size[0]-2,E.bind(T(x),m.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(h&&h.useDepthForOcclusion,o,g),h&&h.useMeterToDem&&x){const z=(1<<x.tileID.canonical.z)*a.ay(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;g.u_meter_to_dem=z}if(h&&h.labelPlaneMatrixInv&&(g.u_label_plane_matrix_inv=h.labelPlaneMatrixInv),o.setTerrainUniformValues(p,g),this.painter.transform.projection.name==="globe"){const z=this.globeUniformValues(this.painter.transform,r.tileID.canonical,h&&h.useDenormalizedUpVectorScale);o.setGlobeUniformValues(p,z)}}globeUniformValues(r,o,h){const p=r.projection;return{u_tile_tl_up:p.upVector(o,0,0),u_tile_tr_up:p.upVector(o,a.a4,0),u_tile_br_up:p.upVector(o,a.a4,a.a4),u_tile_bl_up:p.upVector(o,0,a.a4),u_tile_up_scale:h?a.bu(1):p.upVectorScale(o,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const o=this.painter,h=this.painter.context;r.length!==0&&(h.bindFramebuffer.set(null),h.viewport.set([0,0,o.width,o.height]),o.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(p,m,g,x,b){if(p.transform.projection.name==="globe")(function(w,T,E,O,z){const L=w.context,k=L.gl;let B,F;const $=w.transform,G=a.bc(w,L,$),Z=(ge,me)=>{if(F===me)return;const oe=[uo[me],"PROJECTION_GLOBE_VIEW"];G&&oe.push("CUSTOM_ANTIALIASING");const Pe=w.isTileAffectedByFog(ge);B=w.getOrCreateProgram("globeRaster",{defines:oe,overrideFog:Pe}),F=me},K=w.colorModeForRenderPass(),W=new a.af(k.LEQUAL,a.af.ReadWrite,w.depthRangeFor3D);Yn.update(z);const H=a.bd($),te=[a.ak($.center.lng),a.al($.center.lat)],re=w.globeSharedBuffers,he=[$.width*a.e.devicePixelRatio,$.height*a.e.devicePixelRatio],ne=Float32Array.from($.globeMatrix),J={useDenormalizedUpVectorScale:!0};{const ge=w.transform,me=Jn(ge.zoom,T.exaggeration(),T.sourceCache._source.tileSize);F=-1;const oe=k.TRIANGLES;for(const Pe of O){const Me=E.getTile(Pe),de=a.ah.disabled,Ce=T.prevTerrainTileForTile[Pe.key],se=T.terrainTileForTile[Pe.key];co(Ce,se)&&Yn.newMorphing(Pe.key,Ce,se,z,250),L.activeTexture.set(k.TEXTURE0),Me.texture&&Me.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE);const Se=Yn.getMorphValuesForProxy(Pe.key),Ie=Se?1:0;Se&&a.q(J,{morphing:{srcDemTile:Se.from,dstDemTile:Se.to,phase:a.bb(Se.phase)}});const Ue=a.be(Pe.canonical),$e=a.bf(Ue.getCenter().lat),Je=a.bg(Pe.canonical,Ue,$e,ge.worldSize/ge._pixelsPerMercatorPixel),qe=a.bh(a.bi(Pe.canonical)),ot=q1(ge.expandedFarZProjMatrix,ne,H,qe,a.a2(ge.zoom),te,ge.frustumCorners.TL,ge.frustumCorners.TR,ge.frustumCorners.BR,ge.frustumCorners.BL,ge.globeCenterInViewSpace,ge.globeRadius,he,me,ge._farZ,Je);if(Z(Pe,Ie),B&&(T.setupElevationDraw(Me,B,J),w.uploadCommonUniforms(L,B,Pe.toUnwrapped()),re)){const[Ct,ct,Tt]=re.getGridBuffers($e,me!==0);B.draw(w,oe,W,de,K,a.ag.backCCW,ot,"globe_raster",Ct,ct,Tt)}}}if(re&&(w.renderDefaultNorthPole||w.renderDefaultSouthPole)){const ge=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];G&&ge.push("CUSTOM_ANTIALIASING"),B=w.getOrCreateProgram("globeRaster",{defines:ge});for(const me of O){const{x:oe,y:Pe,z:Me}=me.canonical,de=Pe===0,Ce=Pe===(1<<Me)-1,[se,Se,Ie,Ue]=re.getPoleBuffers(Me,!1);if(Ue&&(de||Ce)){const $e=E.getTile(me);L.activeTexture.set(k.TEXTURE0),$e.texture&&$e.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE);let Je=a.bj(Me,oe,$);const qe=a.bh(a.bi(me.canonical)),ot=(Ct,ct)=>Ct.draw(w,k.TRIANGLES,W,a.ah.disabled,K,a.ag.disabled,q1($.expandedFarZProjMatrix,Je,Je,qe,0,te,$.frustumCorners.TL,$.frustumCorners.TR,$.frustumCorners.BR,$.frustumCorners.BL,$.globeCenterInViewSpace,$.globeRadius,he,0,$._farZ),"globe_pole_raster",ct,Ie,Ue);T.setupElevationDraw($e,B,J),w.uploadCommonUniforms(L,B,me.toUnwrapped()),de&&w.renderDefaultNorthPole&&ot(B,se),Ce&&w.renderDefaultSouthPole&&(Je=a.ae.scale(a.ae.create(),Je,[1,-1,1]),ot(B,Se))}}}})(p,m,g,x,b);else{const w=p.context,T=w.gl;let E,O;const z=p.shadowRenderer,L=Cr(p,p.longestCutoffRange),k=K=>{if(O===K)return;const W=[];W.push(uo[K]),L.shouldRenderCutoff&&W.push("RENDER_CUTOFF"),E=p.getOrCreateProgram("terrainRaster",{defines:W}),O=K},B=p.colorModeForRenderPass(),F=new a.af(T.LEQUAL,a.af.ReadWrite,p.depthRangeFor3D);Yn.update(b);const $=p.transform,G=Jn($.zoom,m.exaggeration(),m.sourceCache._source.tileSize);let Z=[0,0,0];if(z){const K=p.style.directionalLight,W=p.style.ambientLight;K&&W&&(Z=lo(p.style,K,W))}{O=-1;const K=T.TRIANGLES,[W,H]=[m.gridIndexBuffer,m.gridSegments];for(const te of x){const re=g.getTile(te),he=a.ah.disabled,ne=m.prevTerrainTileForTile[te.key],J=m.terrainTileForTile[te.key];co(ne,J)&&Yn.newMorphing(te.key,ne,J,b,250),w.activeTexture.set(T.TEXTURE0),re.texture&&re.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE);const ge=Yn.getMorphValuesForProxy(te.key),me=ge?1:0;let oe;ge&&(oe={morphing:{srcDemTile:ge.from,dstDemTile:ge.to,phase:a.bb(ge.phase)}});const Pe=S3(te.projMatrix,ho(te.canonical,$.renderWorldCopies)?G/10:G,Z);if(k(me),!E)continue;m.setupElevationDraw(re,E,oe);const Me=te.toUnwrapped();z&&z.setupShadows(Me,E),p.uploadCommonUniforms(w,E,Me,null,L),E.draw(p,K,F,he,B,a.ag.backCCW,Pe,"terrain_raster",m.gridBuffer,W,H)}}}}(o,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,o.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const o=this.painter,h=this.painter.context,p=this.proxySourceCache,m=this.proxiedCoords[p.id],g=this._drapedRenderBatches.shift(),x=o.style.order,b=[];let w=0;for(const T of m){const E=p.getTileByID(T.proxyTileKey),O=p.proxyCachedFBO[T.key]?p.proxyCachedFBO[T.key][r]:void 0,z=O!==void 0?p.renderCache[O]:this.pool[w++],L=O!==void 0;if(E.texture=z.tex,L&&!z.dirty){b.push(E.tileID);continue}let k;h.bindFramebuffer.set(z.fb.framebuffer),this.renderedToTile=!1,z.dirty&&(h.clear({color:a.C.transparent,stencil:0}),z.dirty=!1);for(let B=g.start;B<=g.end;++B){const F=o.style._mergedLayers[x[B]];if(F.isHidden(o.transform.zoom))continue;const $=o.style.getLayerSourceCache(F),G=$?this.proxyToSource[T.key][$.id]:[T];if(!G)continue;const Z=G;h.viewport.set([0,0,z.fb.width,z.fb.height]),k!==($?$.id:null)&&(this._setupStencil(z,G,F,$),k=$?$.id:null),o.renderLayer(o,$,F,Z)}if(this._drapedRenderBatches.length===0)for(const B of this._pendingGroundEffectLayers){const F=o.style._mergedLayers[x[B]];if(F.isHidden(o.transform.zoom))continue;const $=o.style.getLayerSourceCache(F),G=$?this.proxyToSource[T.key][$.id]:[T];if(!G)continue;const Z=G;h.viewport.set([0,0,z.fb.width,z.fb.height]),k!==($?$.id:null)&&(this._setupStencil(z,G,F,$),k=$?$.id:null),o.renderLayer(o,$,F,Z)}this.renderedToTile?(z.dirty=!0,b.push(E.tileID)):L||--w,w===5&&(w=0,this.renderToBackBuffer(b))}return this.renderToBackBuffer(b),this.renderingToTexture=!1,h.bindFramebuffer.set(null),h.viewport.set([0,0,o.width,o.height]),g.end+1}postRender(){}isLayerOrderingCorrect(r){const o=r.order.length;let h=-1,p=o;for(let m=0;m<o;++m)this._style.isLayerDraped(r._mergedLayers[r.order[m]])?h=Math.max(h,m):p=Math.min(p,m);return p>h}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(o=>o.dem).forEach(o=>{r=Math.min(r,o.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,o,h){if(!this._visibleDemTiles)return null;const p=this._visibleDemTiles.filter(m=>m.dem).map(m=>{const g=m.tileID,x=1<<g.overscaledZ,{x:b,y:w}=g.canonical,T=b/x,E=(b+1)/x,O=w/x,z=(w+1)/x;return{minx:T,miny:O,maxx:E,maxy:z,t:m.dem.tree.raycastRoot(T,O,E,z,r,o,h),tile:m}});p.sort((m,g)=>(m.t!==null?m.t:Number.MAX_VALUE)-(g.t!==null?g.t:Number.MAX_VALUE));for(const m of p){if(m.t==null)return null;const g=m.tile.dem.tree.raycast(m.minx,m.miny,m.maxx,m.maxy,r,o,h);if(g!=null)return g}return null}_createFBO(){const r=this.painter.context,o=r.gl,h=this.drapeBufferSize;r.activeTexture.set(o.TEXTURE0);const p=new a.T(r,{width:h[0],height:h[1],data:null},o.RGBA);p.bind(o.LINEAR,o.CLAMP_TO_EDGE);const m=r.createFramebuffer(h[0],h[1],!0,null);return m.colorAttachment.set(p.texture),m.depthAttachment=new Gn(r,m.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,h[0],h[1]),this._stencilRef=0,m.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):m.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&o.texParameterf(o.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:m,tex:p,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const o=this._style._mergedLayers[r],h=o.isHidden(this.painter.transform.zoom);return o.type==="custom"?!h&&o.shouldRedrape():!h&&o.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const h of this._style.getSources())if(h instanceof M3){r=!0;break}if(!r)return;const o={};for(let h=0;h<this._style.order.length;++h){const p=this._style._mergedLayers[this._style.order[h]],m=this._style.getLayerSourceCache(p);if(m&&!o[m.id]&&!p.isHidden(this.painter.transform.zoom)&&p.type==="line"&&p.widthExpression()instanceof a.Z){o[m.id]=!0;for(const g of this.proxyCoords){const x=this.proxyToSource[g.key][m.id];if(x)for(const b of x)this._clearRenderCacheForTile(m.id,b)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const h in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[h]._source instanceof Er){r=!0;break}if(!r)return;const o={};for(let h=0;h<this._style.order.length;++h){const p=this._style._mergedLayers[this._style.order[h]],m=this._style.getLayerSourceCache(p);if(!m||o[m.id]||p.isHidden(this.painter.transform.zoom)||p.type!=="raster")continue;const g=p.paint.get("raster-fade-duration");for(const x of this.proxyCoords){const b=this.proxyToSource[x.key][m.id];if(b)for(const w of b){const T=Sl(m.getTile(w),m.findLoadedParent(w,0),m,this.painter.transform,g);(T.opacity!==1||T.mix!==0)&&this._clearRenderCacheForTile(m.id,w)}}}}_setupDrapedRenderBatches(){const r=this._style.order,o=r.length;if(o===0)return;const h=[];this._pendingGroundEffectLayers=[];let p,m=0,g=this._style._mergedLayers[r[m]];for(;!this._style.isLayerDraped(g)&&g.isHidden(this.painter.transform.zoom)&&++m<o;)g=this._style._mergedLayers[r[m]];for(;m<o;++m){const x=this._style._mergedLayers[r[m]];x.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(x)?p===void 0&&(p=m):(x.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(m),p!==void 0&&(h.push({start:p,end:m-1}),p=void 0)))}if(p!==void 0&&h.push({start:p,end:m-1}),h.length!==0){const x=h[h.length-1];this._pendingGroundEffectLayers.every(b=>b>x.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=h}_setupRenderCache(r){const o=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,o.renderCache.length>o.renderCachePool.length){const g=Object.values(o.proxyCachedFBO);o.proxyCachedFBO={};for(let x=0;x<g.length;++x){const b=Object.values(g[x]);o.renderCachePool.push(...b)}}return}this._clearRasterLayersFromRenderCache();const h=this.proxyCoords,p=this._tilesDirty;for(let g=h.length-1;g>=0;g--){const x=h[g];if(o.getTileByID(x.key),o.proxyCachedFBO[x.key]!==void 0){const b=r[x.key],w=this.proxyToSource[x.key];let T=0;for(const E in w){const O=w[E],z=b[E];if(!z||z.length!==O.length||O.some((L,k)=>L!==z[k]||p[E]&&p[E].hasOwnProperty(L.key))){T=-1;break}++T}for(const E in o.proxyCachedFBO[x.key])o.renderCache[o.proxyCachedFBO[x.key][E]].dirty=T<0||T!==Object.values(b).length}}const m=[...this._drapedRenderBatches];m.sort((g,x)=>x.end-x.start-(g.end-g.start));for(const g of m)for(const x of h){if(o.proxyCachedFBO[x.key])continue;let b=o.renderCachePool.pop();b===void 0&&o.renderCache.length<50&&(b=o.renderCache.length,o.renderCache.push(this._createFBO())),b!==void 0&&(o.proxyCachedFBO[x.key]={},o.proxyCachedFBO[x.key][g.start]=b,o.renderCache[b].dirty=!0)}this._tilesDirty={}}_setupStencil(r,o,h,p){if(!p||!this._sourceTilesOverlap[p.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const m=this.painter.context,g=m.gl;if(o.length<=1)return void(this._overlapStencilType=!1);let x;if(h.isTileClipped())x=o.length,this._overlapStencilMode.test={func:g.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(o[0].overscaledZ>o[o.length-1].overscaledZ))return void(this._overlapStencilType=!1);x=1,this._overlapStencilMode.test={func:g.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+x>255&&(m.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=x,this._overlapStencilMode.ref=this._stencilRef,h.isTileClipped()&&this._renderTileClippingMasks(o,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):a.ah.disabled}_renderTileClippingMasks(r,o){const h=this.painter,p=this.painter.context,m=p.gl;h._tileClippingMaskIDs={},p.setColorMode(a.a.disabled),p.setDepthMode(a.af.disabled);const g=h.getOrCreateProgram("clippingMask");for(const x of r){const b=h._tileClippingMaskIDs[x.key]=--o;g.draw(h,m.TRIANGLES,a.af.disabled,new a.ah({func:m.ALWAYS,mask:0},b,255,m.KEEP,m.KEEP,m.REPLACE),a.a.disabled,a.ag.disabled,po(x.projMatrix),"$clipping",h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}}pointCoordinate(r){const o=this.painter.transform;if(r.x<0||r.x>o.width||r.y<0||r.y>o.height)return null;const h=[r.x,r.y,1,1];a.aB.transformMat4(h,h,o.pixelMatrixInverse),a.aB.scale(h,h,1/h[3]),h[0]/=o.worldSize,h[1]/=o.worldSize;const p=o._camera.position,m=a.ay(1,o.center.lat),g=[p[0],p[1],p[2]/m,0],x=a.$.subtract([],h.slice(0,3),g);a.$.normalize(x,x);const b=this.raycast(g,x,this._exaggeration);return b!==null&&b?(a.$.scaleAndAdd(g,g,x,b),g[3]=g[2],g[2]*=m,g):null}_setupProxiedCoordsForOrtho(r,o,h){if(r.getSource()instanceof a.bo)return this._setupProxiedCoordsForImageSource(r,o,h);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const p=this.proxiedCoords[r.id]=[],m=this.proxyCoords;for(let b=0;b<m.length;b++){const w=m[b],T=this._findTileCoveringTileID(w,r);if(T){const E=this._createProxiedId(w,T,h[w.key]&&h[w.key][r.id]);p.push(E),this.proxyToSource[w.key][r.id]=[E]}}let g=!1;const x=new Set;for(let b=0;b<o.length;b++){const w=r.getTile(o[b]);if(!w||!w.hasData())continue;const T=this._findTileCoveringTileID(w.tileID,this.proxySourceCache);if(T&&T.tileID.canonical.z!==w.tileID.canonical.z){const E=this.proxyToSource[T.tileID.key][r.id],O=this._createProxiedId(T.tileID,w,h[T.tileID.key]&&h[T.tileID.key][r.id]);E?E.splice(E.length-1,0,O):this.proxyToSource[T.tileID.key][r.id]=[O];const z=this.proxyToSource[T.tileID.key][r.id];x.has(z)||x.add(z),p.push(O),g=!0}}if(this._sourceTilesOverlap[r.id]=g,g&&this._debugParams.sortTilesHiZFirst)for(const b of x)b.sort((w,T)=>T.overscaledZ-w.overscaledZ)}_setupProxiedCoordsForImageSource(r,o,h){if(!r.getSource().loaded())return;const p=this.proxiedCoords[r.id]=[],m=this.proxyCoords,g=r.getSource(),x=g.tileID;if(!x)return;const b=new a.P(x.x,x.y)._div(1<<x.z),w=g.coordinates.map(a._.fromLngLat).reduce((E,O)=>(E.min.x=Math.min(E.min.x,O.x-b.x),E.min.y=Math.min(E.min.y,O.y-b.y),E.max.x=Math.max(E.max.x,O.x-b.x),E.max.y=Math.max(E.max.y,O.y-b.y),E),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),T=(E,O)=>{const z=E.wrap+E.canonical.x/(1<<E.canonical.z),L=E.canonical.y/(1<<E.canonical.z),k=a.a4/(1<<E.canonical.z),B=O.wrap+O.canonical.x/(1<<O.canonical.z),F=O.canonical.y/(1<<O.canonical.z);return z+k<B+w.min.x||z>B+w.max.x||L+k<F+w.min.y||L>F+w.max.y};for(let E=0;E<m.length;E++){const O=m[E];for(let z=0;z<o.length;z++){const L=r.getTile(o[z]);if(!L||!L.hasData()||T(O,L.tileID))continue;const k=this._createProxiedId(O,L,h[O.key]&&h[O.key][r.id]),B=this.proxyToSource[O.key][r.id];B?B.push(k):this.proxyToSource[O.key][r.id]=[k],p.push(k)}}}_createProxiedId(r,o,h){let p=this.orthoMatrix;if(h){const m=h.find(g=>g.key===o.tileID.key);if(m)return m}if(o.tileID.key!==r.key){const m=r.canonical.z-o.tileID.canonical.z;let g,x,b;p=a.ae.create();const w=o.tileID.wrap-r.wrap<<r.overscaledZ;m>0?(g=a.a4>>m,x=g*((o.tileID.canonical.x<<m)-r.canonical.x+w),b=g*((o.tileID.canonical.y<<m)-r.canonical.y)):(g=a.a4<<-m,x=a.a4*(o.tileID.canonical.x-(r.canonical.x+w<<-m)),b=a.a4*(o.tileID.canonical.y-(r.canonical.y<<-m))),a.ae.ortho(p,0,g,0,g,0,1),a.ae.translate(p,p,[x,b,0])}return new J1(o.tileID,r.key,p)}_findTileCoveringTileID(r,o){let h=o.getTile(r);if(h&&h.hasData())return h;const p=this._findCoveringTileCache[o.id],m=p[r.key];if(h=m?o.getTileByID(m):null,h&&h.hasData()||m===null)return h;let g=h?h.tileID:r,x=g.overscaledZ;const b=o.getSource().minzoom,w=[];if(!m){const E=o.getSource().maxzoom;if(r.canonical.z>=E){const O=r.canonical.z-E;o.getSource().reparseOverscaled?(x=Math.max(r.canonical.z+2,o.transform.tileZoom),g=new a.aQ(x,r.wrap,E,r.canonical.x>>O,r.canonical.y>>O)):O!==0&&(x=E,g=new a.aQ(x,r.wrap,E,r.canonical.x>>O,r.canonical.y>>O))}g.key!==r.key&&(w.push(g.key),h=o.getTile(g))}const T=E=>{w.forEach(O=>{p[O]=E}),w.length=0};for(x-=1;x>=b&&(!h||!h.hasData());x--){h&&T(h.tileID.key);const E=g.calculateScaledKey(x);if(h=o.getTileByID(E),h&&h.hasData())break;const O=p[E];if(O===null)break;O===void 0?w.push(E):h=o.getTileByID(O)}return T(h?h.tileID.key:null),h&&h.hasData()?h:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,o){let h=this._tilesDirty[r];h||(h=this._tilesDirty[r]={}),h[o.key]=!0}}function z3(u,r,o){const h=function(x,b,w){const T=a.$.dot(b,x),E=a.$.dot(w,[.2126,.7152,.0722]),O=(L,k,B)=>(1-B)*L+B*k,z=O(1-.3*Math.min(E,1),1,Math.min(T+1,1));return O(.92,1,Math.asin(a.au(b[2],-1,1))/Math.PI+.5)*z}(u,[0,0,1],r),p=[0,0,0];a.$.scale(p,o.slice(0,3),h);const m=[0,0,0];a.$.scale(m,r.slice(0,3),u[2]);const g=[0,0,0];return a.$.add(g,p,m),a.ba(g)}const K1=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],D3=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Q1{static cacheKey(r,o,h,p){let m=`${o}${p?p.cacheKey:""}`;for(const g of h)r.usedDefines.includes(g)&&(m+=`/${g}`);return m}constructor(r,o,h,p,m,g){const x=r.gl;this.program=x.createProgram(),this.configuration=p,this.name=o,this.fixedDefines=[...g];const b=p?p.getBinderAttributes():[],w=(h.staticAttributes||[]).concat(b);let T=p?p.defines():[];T=T.concat(g.map(B=>`#define ${B}`));const E=`#version 300 es
`;let O=E+T.concat("precision mediump float;",w3,bl.fragmentSource).join(`
`);for(const B of h.fragmentIncludes)O+=`
${to[B]}`;O+=`
${h.fragmentSource}`;let z=E+T.concat("precision highp float;",w3,bl.vertexSource).join(`
`);for(const B of h.vertexIncludes)z+=`
${to[B]}`;z+=`
${h.vertexSource}`;const L=x.createShader(x.FRAGMENT_SHADER);if(x.isContextLost())return void(this.failedToCreate=!0);x.shaderSource(L,O),x.compileShader(L),x.attachShader(this.program,L);const k=x.createShader(x.VERTEX_SHADER);if(x.isContextLost())this.failedToCreate=!0;else{x.shaderSource(k,z),x.compileShader(k),x.attachShader(this.program,k),this.attributes={},this.numAttributes=w.length;for(let B=0;B<this.numAttributes;B++)if(w[B]){const F=w[B].startsWith("a_")?w[B]:`a_${w[B]}`;x.bindAttribLocation(this.program,B,F),this.attributes[F]=B}x.linkProgram(this.program),x.deleteShader(k),x.deleteShader(L),this.fixedUniforms=m(r),this.binderUniforms=p?p.getUniforms(r):[],(g.includes("TERRAIN")||o.indexOf("symbol")!==-1||o.indexOf("circle")!==-1)&&(this.terrainUniforms=(B=>({u_dem:new a.a8(B),u_dem_prev:new a.a8(B),u_dem_tl:new a.a9(B),u_dem_scale:new a.ab(B),u_dem_tl_prev:new a.a9(B),u_dem_scale_prev:new a.ab(B),u_dem_size:new a.ab(B),u_dem_lerp:new a.ab(B),u_exaggeration:new a.ab(B),u_depth:new a.a8(B),u_depth_size_inv:new a.a9(B),u_depth_range_unpack:new a.a9(B),u_occluder_half_size:new a.ab(B),u_occlusion_depth_offset:new a.ab(B),u_meter_to_dem:new a.ab(B),u_label_plane_matrix_inv:new a.a7(B)}))(r)),g.includes("GLOBE")&&(this.globeUniforms=(B=>({u_tile_tl_up:new a.ar(B),u_tile_tr_up:new a.ar(B),u_tile_br_up:new a.ar(B),u_tile_bl_up:new a.ar(B),u_tile_up_scale:new a.ab(B)}))(r)),g.includes("FOG")&&(this.fogUniforms=(B=>({u_fog_matrix:new a.a7(B),u_fog_range:new a.a9(B),u_fog_color:new a.at(B),u_fog_horizon_blend:new a.ab(B),u_fog_vertical_limit:new a.a9(B),u_fog_temporal_offset:new a.ab(B),u_frustum_tl:new a.ar(B),u_frustum_tr:new a.ar(B),u_frustum_br:new a.ar(B),u_frustum_bl:new a.ar(B),u_globe_pos:new a.ar(B),u_globe_radius:new a.ab(B),u_globe_transition:new a.ab(B),u_is_globe:new a.a8(B),u_viewport:new a.a9(B)}))(r)),g.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(B=>({u_cutoff_params:new a.at(B)}))(r)),g.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(B=>({u_lighting_ambient_color:new a.ar(B),u_lighting_directional_dir:new a.ar(B),u_lighting_directional_color:new a.ar(B),u_ground_radiance:new a.ar(B)}))(r)),g.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(B=>({u_light_matrix_0:new a.a7(B),u_light_matrix_1:new a.a7(B),u_fade_range:new a.a9(B),u_shadow_normal_offset:new a.ar(B),u_shadow_intensity:new a.ab(B),u_shadow_texel_size:new a.ab(B),u_shadow_map_resolution:new a.ab(B),u_shadow_direction:new a.ar(B),u_shadow_bias:new a.ar(B),u_shadowmap_0:new a.a8(B),u_shadowmap_1:new a.a8(B)}))(r))}}setTerrainUniformValues(r,o){if(!this.terrainUniforms)return;const h=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in o)h[p]&&h[p].set(this.program,p,o[p])}}setGlobeUniformValues(r,o){if(!this.globeUniforms)return;const h=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in o)h[p]&&h[p].set(this.program,p,o[p])}}setFogUniformValues(r,o){if(!this.fogUniforms)return;const h=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in o)h[p].set(this.program,p,o[p])}}setCutoffUniformValues(r,o){if(!this.cutoffUniforms)return;const h=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in o)h[p].set(this.program,p,o[p])}}setLightsUniformValues(r,o){if(!this.lightsUniforms)return;const h=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const p in o)h[p].set(this.program,p,o[p])}}setShadowUniformValues(r,o){if(this.failedToCreate||!this.shadowUniforms)return;const h=this.shadowUniforms;r.program.set(this.program);for(const p in o)h[p].set(this.program,p,o[p])}_drawDebugWireframe(r,o,h,p,m,g,x,b,w,T){const E=r.options.wireframe;if(E.terrain===!1&&E.layers2D===!1&&E.layers3D===!1)return;const O=r.context;if(!(!(!E.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!E.layers2D||r._terrain&&r._terrain.renderingToTexture||!K1.includes(this.name))||!(!E.layers3D||!D3.includes(this.name))))return;const z=O.gl,L=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,m,O);if(!L)return;const k=[...this.fixedDefines];k.push("DEBUG_WIREFRAME");const B=r.getOrCreateProgram(this.name,{config:this.configuration,defines:k});O.program.set(B.program);const F=(Z,K,W)=>{if(K[Z]&&W[Z])for(const H in K[Z])W[Z][H]&&W[Z][H].set(W.program,H,K[Z][H].current)};w&&w.setUniforms(B.program,O,B.binderUniforms,x,{zoom:b}),F("fixedUniforms",this,B),F("terrainUniforms",this,B),F("globeUniforms",this,B),F("fogUniforms",this,B),F("lightsUniforms",this,B),F("shadowUniforms",this,B),L.bind(),O.setColorMode(new a.a([z.ONE,z.ONE_MINUS_SRC_ALPHA,z.ZERO,z.ONE],a.C.transparent,[!0,!0,!0,!1])),O.setDepthMode(new a.af(o.func===z.LESS?z.LEQUAL:o.func,a.af.ReadOnly,o.range)),O.setStencilMode(a.ah.disabled);const $=3*g.primitiveLength*2,G=3*g.primitiveOffset*2*2;T&&T>1?z.drawElementsInstanced(z.LINES,$,z.UNSIGNED_SHORT,G,T):z.drawElements(z.LINES,$,z.UNSIGNED_SHORT,G),m.bind(),O.program.set(this.program),O.setDepthMode(o),O.setStencilMode(h),O.setColorMode(p)}draw(r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B){const F=r.context,$=F.gl;if(this.failedToCreate)return;F.program.set(this.program),F.setDepthMode(h),F.setStencilMode(p),F.setColorMode(m),F.setCullFace(g);for(const K of Object.keys(this.fixedUniforms))this.fixedUniforms[K].set(this.program,K,x[K]);L&&L.setUniforms(this.program,F,this.binderUniforms,O,{zoom:z});const G={[$.POINTS]:1,[$.LINES]:2,[$.TRIANGLES]:3,[$.LINE_STRIP]:1}[o],Z=B&&B>0?1:void 0;for(const K of E.get()){const W=K.vaos||(K.vaos={});(W[b]||(W[b]=new Eh)).bind(F,this,w,L?L.getPaintVertexBuffers():[],T,K.vertexOffset,k||[],Z),B&&B>1?$.drawElementsInstanced(o,K.primitiveLength*G,$.UNSIGNED_SHORT,K.primitiveOffset*G*2,B):T?$.drawElements(o,K.primitiveLength*G,$.UNSIGNED_SHORT,K.primitiveOffset*G*2):$.drawArrays(o,K.vertexOffset,K.vertexLength),o===$.TRIANGLES&&T&&this._drawDebugWireframe(r,h,p,m,T,K,O,z,L,B)}}}function ec(u,r){const o=Math.pow(2,r.tileID.overscaledZ),h=r.tileSize*Math.pow(2,u.transform.tileZoom)/o,p=h*(r.tileID.canonical.x+r.tileID.wrap*o),m=h*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.bD(r,1,u.transform.tileZoom),u_pixel_coord_upper:[p>>16,m>>16],u_pixel_coord_lower:[65535&p,65535&m]}}const R3=a.ae.create(),pn=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F)=>{const $=r.style.light,G=$.properties.get("position"),Z=[G.x,G.y,G.z],K=a.bE.create();$.properties.get("anchor")==="viewport"&&(a.bE.fromRotation(K,-r.transform.angle),a.$.transformMat3(Z,Z,K));const W=$.properties.get("color"),H=r.transform,te={u_matrix:u,u_lightpos:Z,u_lightintensity:$.properties.get("intensity"),u_lightcolor:[W.r,W.g,W.b],u_vertical_gradient:+o,u_opacity:h,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:R3,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:p,u_edge_radius:m,u_alignment:g,u_width_scale:x,u_flood_light_color:z,u_vertical_scale:L,u_flood_light_intensity:k,u_ground_shadow_factor:B,u_emissive_strength:F};return H.projection.name==="globe"&&(te.u_tile_id=[b.canonical.x,b.canonical.y,1<<b.canonical.z],te.u_zoom_transition=T,te.u_inv_rot_matrix=O,te.u_merc_center=E,te.u_up_dir=H.projection.upVector(new a.aO(0,0,0),E[0]*a.a4,E[1]*a.a4),te.u_height_lift=w),te},Pl=(u,r,o,h,p)=>({u_matrix:u,u_edge_radius:r,u_alignment:o,u_width_scale:h,u_vertical_scale:p}),L3=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k)=>{const B=pn(u,r,o,h,p,m,g,x,b,T,E,O,z,L,k,1,[0,0,0],0),F={u_height_factor:-Math.pow(2,b.overscaledZ)/w.tileSize/8};return a.Q(B,ec(r,w),F)},fo=(u,r)=>({u_matrix:u,u_emissive_strength:r}),Ol=(u,r,o,h)=>a.Q(fo(u,r),ec(o,h)),zl=(u,r,o)=>({u_matrix:u,u_world:o,u_emissive_strength:r}),mo=(u,r,o,h,p)=>a.Q(Ol(u,r,o,h),{u_world:p}),ua=(u,r,o,h)=>{const p=a.a4/o.tileSize;return{u_matrix:u,u_camera_to_center_distance:r.getCameraToCenterDistance(h),u_extrude_scale:[r.pixelsToGLUnits[0]/p,r.pixelsToGLUnits[1]/p]}},Dl=(u,r,o=1)=>({u_matrix:u,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:o}),k3=a.ae.create(),B3=(u,r,o,h,p,m,g)=>{const x=u.transform,b=x.projection.name==="globe",w=b?a.bF(x.zoom,r.canonical)*x._pixelsPerMercatorPixel:a.bD(o,1,m),T={u_matrix:r.projMatrix,u_extrude_scale:w,u_intensity:g,u_inv_rot_matrix:k3,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(b){T.u_inv_rot_matrix=h,T.u_merc_center=p,T.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],T.u_zoom_transition=a.a2(x.zoom);const E=p[0]*a.a4,O=p[1]*a.a4;T.u_up_dir=x.projection.upVector(new a.aO(0,0,0),E,O)}return T};function tc(u,[r,o,h,p],[m,g]){if(m===g)return[0,0,0,0];const x=255*(u-1)/(u*(g-m));return[r*x,o*x,h*x,p*x]}function _o(u,r,[o,h]){return o===h?0:.5/u+(r-o)*(u-1)/(u*(h-o))}const Rl=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F,$,G,Z)=>({u_matrix:u,u_normalize_matrix:r,u_globe_matrix:o,u_merc_matrix:h,u_grid_matrix:p,u_tl_parent:m,u_scale_parent:w,u_fade_t:T.mix,u_opacity:T.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:a.bG(E.paint.get("raster-saturation")),u_contrast_factor:a.bH(E.paint.get("raster-contrast")),u_spin_weights:ic(E.paint.get("raster-hue-rotate")),u_perspective_transform:O,u_raster_elevation:z,u_zoom_transition:g,u_merc_center:x,u_cutoff_params:b,u_colorization_mix:tc(a.bI,k,F),u_colorization_offset:_o(a.bI,B,F),u_color_ramp:L,u_texture_offset:[G/($+2*G),$/($+2*G)],u_texture_res:[$+2*G,$+2*G],u_emissive_strength:Z});function ic(u){u*=Math.PI/180;const r=Math.sin(u),o=Math.cos(u);return[(2*o+1)/3,(-Math.sqrt(3)*r-o+1)/3,(Math.sqrt(3)*r-o+1)/3]}const fn=.05,vs=(u,r,o,h,p,m,g,x,b,w,T,E)=>({u_matrix:u,u_normalize_matrix:r,u_globe_matrix:o,u_merc_matrix:h,u_grid_matrix:p,u_tl_parent:m,u_scale_parent:w,u_fade_t:T.mix,u_opacity:T.opacity,u_image0:0,u_image1:1,u_raster_elevation:E,u_zoom_transition:g,u_merc_center:x,u_cutoff_params:b}),Dh=(u,r,o,h,p,m,g,x,b,w)=>({u_particle_texture:u,u_particle_texture_side_len:r,u_tile_offset:o,u_velocity:h,u_color_ramp:m,u_velocity_res:p,u_max_speed:g,u_uv_offset:x,u_data_scale:[255*b[0],255*b[1]],u_data_offset:w,u_particle_pos_scale:1.1,u_particle_pos_offset:[fn,fn]}),F3=(u,r,o,h,p,m,g,x,b,w)=>({u_particle_texture:u,u_particle_texture_side_len:r,u_velocity:o,u_velocity_res:h,u_max_speed:p,u_speed_factor:m,u_reset_rate:g,u_rand_seed:Math.random(),u_uv_offset:x,u_data_scale:[255*b[0],255*b[1]],u_data_offset:w,u_particle_pos_scale:1.1,u_particle_pos_offset:[fn,fn]}),go=a.ae.create(),ha=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F)=>{const $=p.transform,G={u_is_size_zoom_constant:+(u==="constant"||u==="source"),u_is_size_feature_constant:+(u==="constant"||u==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:$.getCameraToCenterDistance(k),u_rotate_symbol:+o,u_aspect_ratio:$.width/$.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:m,u_label_plane_matrix:g,u_coord_matrix:x,u_is_text:+b,u_pitch_with_map:+h,u_texsize:w,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:go,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:go,u_up_vector:[0,-1,0],u_color_adj_mat:B,u_icon_transition:F||0};return k.name==="globe"&&(G.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],G.u_zoom_transition=E,G.u_inv_rot_matrix=z,G.u_merc_center=O,G.u_camera_forward=$._camera.forward(),G.u_ecef_origin=a.bJ($.globeMatrix,T.toUnwrapped()),G.u_tile_matrix=Float32Array.from($.globeMatrix),G.u_up_vector=L),G},yo=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B)=>a.Q(ha(u,r,o,h,p,m,g,x,b,w,E,O,z,L,k,B),{u_gamma_scale:h?p.transform.getCameraToCenterDistance(B)*Math.cos(p.terrain?0:p.transform._pitch):1,u_device_pixel_ratio:a.e.devicePixelRatio,u_is_halo:+T,undefined:void 0}),rc=(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k)=>a.Q(yo(u,r,o,h,p,m,g,x,!0,b,!0,T,E,O,z,L,k),{u_texsize_icon:w,u_texture_icon:1}),nc=(u,r,o,h)=>({u_matrix:u,u_emissive_strength:r,u_opacity:o,u_color:h}),Rh=(u,r,o,h,p,m,g,x)=>a.Q(function(b,w,T,E,O){const{width:z,height:L}=E.imageManager.getPixelSize(w),k=Math.pow(2,O.tileID.overscaledZ),B=O.tileSize*Math.pow(2,E.transform.tileZoom)/k,F=B*(O.tileID.canonical.x+O.tileID.wrap*k),$=B*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:T.tl,u_pattern_br:T.br,u_texsize:[z,L],u_pattern_size:T.displaySize,u_tile_units_to_pixels:1/a.bD(O,1,E.transform.tileZoom),u_pixel_coord_upper:[F>>16,$>>16],u_pixel_coord_lower:[65535&F,65535&$]}}(0,m,g,h,x),{u_matrix:u,u_emissive_strength:r,u_opacity:o}),Gr=new Float32Array(a.ae.identity([])),Cs=(u,r,o,h,p,m,g,x,b,w,T,E,O,z=[0,0,0],L)=>{const k=p.style.light,B=k.properties.get("position"),F=[-B.x,-B.y,B.z],$=a.bE.create();k.properties.get("anchor")==="viewport"&&(a.bE.fromRotation($,-p.transform.angle),a.$.transformMat3(F,F,$));const G=T.alphaMode==="MASK",Z=k.properties.get("color").toRenderColor(null),K=O.paint.get("model-ambient-occlusion-intensity"),W=O.paint.get("model-color").constantOr(a.C.white).toRenderColor(null),H=O.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:u,u_lighting_matrix:r,u_normal_matrix:o,u_node_matrix:h||Gr,u_lightpos:F,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_camera_pos:z,u_opacity:m,u_baseTextureIsAlpha:0,u_alphaMask:+G,u_alphaCutoff:T.alphaCutoff,u_baseColorFactor:[g.r,g.g,g.b,g.a],u_emissiveFactor:[x[0],x[1],x[2],1],u_metallicFactor:b,u_roughnessFactor:w,u_baseColorTexture:rr.BaseColor,u_metallicRoughnessTexture:rr.MetallicRoughness,u_normalTexture:rr.Normal,u_occlusionTexture:rr.Occlusion,u_emissionTexture:rr.Emission,u_lutTexture:rr.LUT,u_color_mix:[W.r,W.g,W.b,H],u_aoIntensity:K,u_emissive_strength:E,u_occlusionTextureTransform:L||[0,0,0,0]}},sc=(u,r=Gr,o=Gr)=>({u_matrix:u,u_instance:r,u_node_matrix:o}),j3={fillExtrusion:u=>({u_matrix:new a.a7(u),u_lightpos:new a.ar(u),u_lightintensity:new a.ab(u),u_lightcolor:new a.ar(u),u_vertical_gradient:new a.ab(u),u_opacity:new a.ab(u),u_edge_radius:new a.ab(u),u_alignment:new a.ab(u),u_width_scale:new a.ab(u),u_ao:new a.a9(u),u_tile_id:new a.ar(u),u_zoom_transition:new a.ab(u),u_inv_rot_matrix:new a.a7(u),u_merc_center:new a.a9(u),u_up_dir:new a.ar(u),u_height_lift:new a.ab(u),u_flood_light_color:new a.ar(u),u_vertical_scale:new a.ab(u),u_flood_light_intensity:new a.ab(u),u_ground_shadow_factor:new a.ar(u),u_emissive_strength:new a.ab(u)}),fillExtrusionDepth:u=>({u_matrix:new a.a7(u),u_edge_radius:new a.ab(u),u_alignment:new a.ab(u),u_width_scale:new a.ab(u),u_vertical_scale:new a.ab(u)}),fillExtrusionPattern:u=>({u_matrix:new a.a7(u),u_lightpos:new a.ar(u),u_lightintensity:new a.ab(u),u_lightcolor:new a.ar(u),u_vertical_gradient:new a.ab(u),u_height_factor:new a.ab(u),u_edge_radius:new a.ab(u),u_alignment:new a.ab(u),u_width_scale:new a.ab(u),u_ao:new a.a9(u),u_tile_id:new a.ar(u),u_zoom_transition:new a.ab(u),u_inv_rot_matrix:new a.a7(u),u_merc_center:new a.a9(u),u_up_dir:new a.ar(u),u_height_lift:new a.ab(u),u_image:new a.a8(u),u_texsize:new a.a9(u),u_pixel_coord_upper:new a.a9(u),u_pixel_coord_lower:new a.a9(u),u_tile_units_to_pixels:new a.ab(u),u_opacity:new a.ab(u)}),fillExtrusionGroundEffect:u=>({u_matrix:new a.a7(u),u_opacity:new a.ab(u),u_ao_pass:new a.ab(u),u_meter_to_tile:new a.ab(u),u_ao:new a.a9(u),u_flood_light_intensity:new a.ab(u),u_flood_light_color:new a.ar(u),u_attenuation:new a.ab(u),u_edge_radius:new a.ab(u),u_fb:new a.a8(u),u_fb_size:new a.ab(u)}),fill:u=>({u_matrix:new a.a7(u),u_emissive_strength:new a.ab(u)}),fillPattern:u=>({u_matrix:new a.a7(u),u_emissive_strength:new a.ab(u),u_image:new a.a8(u),u_texsize:new a.a9(u),u_pixel_coord_upper:new a.a9(u),u_pixel_coord_lower:new a.a9(u),u_tile_units_to_pixels:new a.ab(u)}),fillOutline:u=>({u_matrix:new a.a7(u),u_emissive_strength:new a.ab(u),u_world:new a.a9(u)}),fillOutlinePattern:u=>({u_matrix:new a.a7(u),u_emissive_strength:new a.ab(u),u_world:new a.a9(u),u_image:new a.a8(u),u_texsize:new a.a9(u),u_pixel_coord_upper:new a.a9(u),u_pixel_coord_lower:new a.a9(u),u_tile_units_to_pixels:new a.ab(u)}),circle:a.bK,collisionBox:u=>({u_matrix:new a.a7(u),u_camera_to_center_distance:new a.ab(u),u_extrude_scale:new a.a9(u)}),collisionCircle:u=>({u_matrix:new a.a7(u),u_inv_matrix:new a.a7(u),u_camera_to_center_distance:new a.ab(u),u_viewport_size:new a.a9(u)}),debug:u=>({u_color:new a.aa(u),u_matrix:new a.a7(u),u_overlay:new a.a8(u),u_overlay_scale:new a.ab(u)}),clippingMask:u=>({u_matrix:new a.a7(u)}),heatmap:u=>({u_extrude_scale:new a.ab(u),u_intensity:new a.ab(u),u_matrix:new a.a7(u),u_inv_rot_matrix:new a.a7(u),u_merc_center:new a.a9(u),u_tile_id:new a.ar(u),u_zoom_transition:new a.ab(u),u_up_dir:new a.ar(u)}),heatmapTexture:u=>({u_image:new a.a8(u),u_color_ramp:new a.a8(u),u_opacity:new a.ab(u)}),hillshade:u=>({u_matrix:new a.a7(u),u_image:new a.a8(u),u_latrange:new a.a9(u),u_light:new a.a9(u),u_shadow:new a.aa(u),u_highlight:new a.aa(u),u_emissive_strength:new a.ab(u),u_accent:new a.aa(u)}),hillshadePrepare:u=>({u_matrix:new a.a7(u),u_image:new a.a8(u),u_dimension:new a.a9(u),u_zoom:new a.ab(u)}),line:a.bL,linePattern:a.bM,raster:u=>({u_matrix:new a.a7(u),u_normalize_matrix:new a.a7(u),u_globe_matrix:new a.a7(u),u_merc_matrix:new a.a7(u),u_grid_matrix:new a.as(u),u_tl_parent:new a.a9(u),u_scale_parent:new a.ab(u),u_fade_t:new a.ab(u),u_opacity:new a.ab(u),u_image0:new a.a8(u),u_image1:new a.a8(u),u_brightness_low:new a.ab(u),u_brightness_high:new a.ab(u),u_saturation_factor:new a.ab(u),u_contrast_factor:new a.ab(u),u_spin_weights:new a.ar(u),u_perspective_transform:new a.a9(u),u_raster_elevation:new a.ab(u),u_zoom_transition:new a.ab(u),u_merc_center:new a.a9(u),u_cutoff_params:new a.at(u),u_colorization_mix:new a.at(u),u_colorization_offset:new a.ab(u),u_color_ramp:new a.a8(u),u_texture_offset:new a.a9(u),u_texture_res:new a.a9(u),u_emissive_strength:new a.ab(u)}),rasterParticle:u=>({u_matrix:new a.a7(u),u_normalize_matrix:new a.a7(u),u_globe_matrix:new a.a7(u),u_merc_matrix:new a.a7(u),u_grid_matrix:new a.as(u),u_tl_parent:new a.a9(u),u_scale_parent:new a.ab(u),u_fade_t:new a.ab(u),u_opacity:new a.ab(u),u_image0:new a.a8(u),u_image1:new a.a8(u),u_raster_elevation:new a.ab(u),u_zoom_transition:new a.ab(u),u_merc_center:new a.a9(u),u_cutoff_params:new a.at(u)}),rasterParticleTexture:u=>({u_texture:new a.a8(u),u_opacity:new a.ab(u)}),rasterParticleDraw:u=>({u_particle_texture:new a.a8(u),u_particle_texture_side_len:new a.ab(u),u_tile_offset:new a.a9(u),u_velocity:new a.a8(u),u_color_ramp:new a.a8(u),u_velocity_res:new a.a9(u),u_max_speed:new a.ab(u),u_uv_offset:new a.a9(u),u_data_scale:new a.a9(u),u_data_offset:new a.ab(u),u_particle_pos_scale:new a.ab(u),u_particle_pos_offset:new a.a9(u)}),rasterParticleUpdate:u=>({u_particle_texture:new a.a8(u),u_particle_texture_side_len:new a.ab(u),u_velocity:new a.a8(u),u_velocity_res:new a.a9(u),u_max_speed:new a.ab(u),u_speed_factor:new a.ab(u),u_reset_rate:new a.ab(u),u_rand_seed:new a.ab(u),u_uv_offset:new a.a9(u),u_data_scale:new a.a9(u),u_data_offset:new a.ab(u),u_particle_pos_scale:new a.ab(u),u_particle_pos_offset:new a.a9(u)}),symbolIcon:u=>({u_is_size_zoom_constant:new a.a8(u),u_is_size_feature_constant:new a.a8(u),u_size_t:new a.ab(u),u_size:new a.ab(u),u_camera_to_center_distance:new a.ab(u),u_rotate_symbol:new a.a8(u),u_aspect_ratio:new a.ab(u),u_fade_change:new a.ab(u),u_matrix:new a.a7(u),u_label_plane_matrix:new a.a7(u),u_coord_matrix:new a.a7(u),u_is_text:new a.a8(u),u_pitch_with_map:new a.a8(u),u_texsize:new a.a9(u),u_tile_id:new a.ar(u),u_zoom_transition:new a.ab(u),u_inv_rot_matrix:new a.a7(u),u_merc_center:new a.a9(u),u_camera_forward:new a.ar(u),u_tile_matrix:new a.a7(u),u_up_vector:new a.ar(u),u_ecef_origin:new a.ar(u),u_texture:new a.a8(u),u_icon_transition:new a.ab(u),u_color_adj_mat:new a.a7(u)}),symbolSDF:u=>({u_is_size_zoom_constant:new a.a8(u),u_is_size_feature_constant:new a.a8(u),u_size_t:new a.ab(u),u_size:new a.ab(u),u_camera_to_center_distance:new a.ab(u),u_rotate_symbol:new a.a8(u),u_aspect_ratio:new a.ab(u),u_fade_change:new a.ab(u),u_matrix:new a.a7(u),u_label_plane_matrix:new a.a7(u),u_coord_matrix:new a.a7(u),u_is_text:new a.a8(u),u_pitch_with_map:new a.a8(u),u_texsize:new a.a9(u),u_texture:new a.a8(u),u_gamma_scale:new a.ab(u),u_device_pixel_ratio:new a.ab(u),u_tile_id:new a.ar(u),u_zoom_transition:new a.ab(u),u_inv_rot_matrix:new a.a7(u),u_merc_center:new a.a9(u),u_camera_forward:new a.ar(u),u_tile_matrix:new a.a7(u),u_up_vector:new a.ar(u),u_ecef_origin:new a.ar(u),u_is_halo:new a.a8(u)}),symbolTextAndIcon:u=>({u_is_size_zoom_constant:new a.a8(u),u_is_size_feature_constant:new a.a8(u),u_size_t:new a.ab(u),u_size:new a.ab(u),u_camera_to_center_distance:new a.ab(u),u_rotate_symbol:new a.a8(u),u_aspect_ratio:new a.ab(u),u_fade_change:new a.ab(u),u_matrix:new a.a7(u),u_label_plane_matrix:new a.a7(u),u_coord_matrix:new a.a7(u),u_is_text:new a.a8(u),u_pitch_with_map:new a.a8(u),u_texsize:new a.a9(u),u_texsize_icon:new a.a9(u),u_texture:new a.a8(u),u_texture_icon:new a.a8(u),u_gamma_scale:new a.ab(u),u_device_pixel_ratio:new a.ab(u),u_is_halo:new a.a8(u)}),background:u=>({u_matrix:new a.a7(u),u_emissive_strength:new a.ab(u),u_opacity:new a.ab(u),u_color:new a.aa(u)}),backgroundPattern:u=>({u_matrix:new a.a7(u),u_emissive_strength:new a.ab(u),u_opacity:new a.ab(u),u_image:new a.a8(u),u_pattern_tl:new a.a9(u),u_pattern_br:new a.a9(u),u_texsize:new a.a9(u),u_pattern_size:new a.a9(u),u_pixel_coord_upper:new a.a9(u),u_pixel_coord_lower:new a.a9(u),u_tile_units_to_pixels:new a.ab(u)}),terrainRaster:u=>({u_matrix:new a.a7(u),u_image0:new a.a8(u),u_skirt_height:new a.ab(u),u_ground_shadow_factor:new a.ar(u)}),skybox:u=>({u_matrix:new a.a7(u),u_sun_direction:new a.ar(u),u_cubemap:new a.a8(u),u_opacity:new a.ab(u),u_temporal_offset:new a.ab(u)}),skyboxGradient:u=>({u_matrix:new a.a7(u),u_color_ramp:new a.a8(u),u_center_direction:new a.ar(u),u_radius:new a.ab(u),u_opacity:new a.ab(u),u_temporal_offset:new a.ab(u)}),skyboxCapture:u=>({u_matrix_3f:new a.as(u),u_sun_direction:new a.ar(u),u_sun_intensity:new a.ab(u),u_color_tint_r:new a.at(u),u_color_tint_m:new a.at(u),u_luminance:new a.ab(u)}),globeRaster:u=>({u_proj_matrix:new a.a7(u),u_globe_matrix:new a.a7(u),u_normalize_matrix:new a.a7(u),u_merc_matrix:new a.a7(u),u_zoom_transition:new a.ab(u),u_merc_center:new a.a9(u),u_image0:new a.a8(u),u_grid_matrix:new a.as(u),u_skirt_height:new a.ab(u),u_far_z_cutoff:new a.ab(u),u_frustum_tl:new a.ar(u),u_frustum_tr:new a.ar(u),u_frustum_br:new a.ar(u),u_frustum_bl:new a.ar(u),u_globe_pos:new a.ar(u),u_globe_radius:new a.ab(u),u_viewport:new a.a9(u)}),globeAtmosphere:u=>({u_frustum_tl:new a.ar(u),u_frustum_tr:new a.ar(u),u_frustum_br:new a.ar(u),u_frustum_bl:new a.ar(u),u_horizon:new a.ab(u),u_transition:new a.ab(u),u_fadeout_range:new a.ab(u),u_color:new a.at(u),u_high_color:new a.at(u),u_space_color:new a.at(u),u_temporal_offset:new a.ab(u),u_horizon_angle:new a.ab(u)}),model:u=>({u_matrix:new a.a7(u),u_lighting_matrix:new a.a7(u),u_normal_matrix:new a.a7(u),u_node_matrix:new a.a7(u),u_lightpos:new a.ar(u),u_lightintensity:new a.ab(u),u_lightcolor:new a.ar(u),u_camera_pos:new a.ar(u),u_opacity:new a.ab(u),u_baseColorFactor:new a.at(u),u_emissiveFactor:new a.at(u),u_metallicFactor:new a.ab(u),u_roughnessFactor:new a.ab(u),u_baseTextureIsAlpha:new a.a8(u),u_alphaMask:new a.a8(u),u_alphaCutoff:new a.ab(u),u_baseColorTexture:new a.a8(u),u_metallicRoughnessTexture:new a.a8(u),u_normalTexture:new a.a8(u),u_occlusionTexture:new a.a8(u),u_emissionTexture:new a.a8(u),u_lutTexture:new a.a8(u),u_color_mix:new a.at(u),u_aoIntensity:new a.ab(u),u_emissive_strength:new a.ab(u),u_occlusionTextureTransform:new a.at(u)}),modelDepth:u=>({u_matrix:new a.a7(u),u_instance:new a.a7(u),u_node_matrix:new a.a7(u)}),groundShadow:u=>({u_matrix:new a.a7(u),u_ground_shadow_factor:new a.ar(u)}),stars:u=>({u_matrix:new a.a7(u),u_up:new a.ar(u),u_right:new a.ar(u),u_intensity_multiplier:new a.ab(u)}),occlusion:u=>({u_matrix:new a.a7(u),u_anchorPos:new a.ar(u),u_screenSizePx:new a.a9(u),u_occluderSizePx:new a.a9(u),u_color:new a.at(u)})};function bs(u,r,o){const h=r.createTileMatrix(u,u.worldSize,o.toUnwrapped());return a.ae.multiply(new Float32Array(16),u.projMatrix,h)}function N3(u,r,o){if(r.projection.name===o.projection.name)return u.projMatrix;const h=o.clone();return h.setProjection(r.projection),bs(h,r.getProjection(),u)}function ac(u,r,o){return r.name===o.projection.name?u.projMatrix:bs(o,r,u)}let da;function V3(u,r,o,h,p,m,g){const x=u.context,b=x.gl,w=u.transform,T=u.getOrCreateProgram("collisionBox"),E=[];let O=0,z=0;for(let Z=0;Z<h.length;Z++){const K=h[Z],W=r.getTile(K),H=W.getBucket(o);if(!H)continue;const te=N3(K,H,w);let re=te;p[0]===0&&p[1]===0||(re=u.translatePosMatrix(te,W,p,m));const he=g?H.textCollisionBox:H.iconCollisionBox,ne=H.collisionCircleArray;if(ne.length>0){const J=a.ae.create(),ge=re;a.ae.mul(J,H.placementInvProjMatrix,w.glCoordMatrix),a.ae.mul(J,J,H.placementViewportMatrix),E.push({circleArray:ne,circleOffset:z,transform:ge,invTransform:J,projection:H.getProjection()}),O+=ne.length/4,z=O}he&&(u.terrain&&u.terrain.setupElevationDraw(W,T),T.draw(u,b.LINES,a.af.disabled,a.ah.disabled,u.colorModeForRenderPass(),a.ag.disabled,ua(re,w,W,H.getProjection()),o.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,w.zoom,null,[he.collisionVertexBuffer,he.collisionVertexBufferExt]))}if(!g||!E.length)return;const L=u.getOrCreateProgram("collisionCircle"),k=new a.bN;k.resize(4*O),k._trim();let B=0;for(const Z of E)for(let K=0;K<Z.circleArray.length/4;K++){const W=4*K,H=Z.circleArray[W+0],te=Z.circleArray[W+1],re=Z.circleArray[W+2],he=Z.circleArray[W+3];k.emplace(B++,H,te,re,he,0),k.emplace(B++,H,te,re,he,1),k.emplace(B++,H,te,re,he,2),k.emplace(B++,H,te,re,he,3)}(!da||da.length<2*O)&&(da=function(Z){const K=2*Z,W=new a.bw;W.resize(K),W._trim();for(let H=0;H<K;H++){const te=6*H;W.uint16[te+0]=4*H+0,W.uint16[te+1]=4*H+1,W.uint16[te+2]=4*H+2,W.uint16[te+3]=4*H+2,W.uint16[te+4]=4*H+3,W.uint16[te+5]=4*H+0}return W}(O));const F=x.createIndexBuffer(da,!0),$=x.createVertexBuffer(k,a.bO.members,!0);for(const Z of E){const K={u_matrix:Z.transform,u_inv_matrix:Z.invTransform,u_camera_to_center_distance:(G=w).getCameraToCenterDistance(Z.projection),u_viewport_size:[G.width,G.height]};L.draw(u,b.TRIANGLES,a.af.disabled,a.ah.disabled,u.colorModeForRenderPass(),a.ag.disabled,K,o.id,$,F,a.b.simpleSegment(0,2*Z.circleOffset,Z.circleArray.length,Z.circleArray.length/2),null,w.zoom)}var G;$.destroy(),F.destroy()}const xo=a.ae.create();function U3(u){const r=u._camera.getWorldToCamera(u.worldSize,1),o=a.ae.multiply([],r,u.globeMatrix);a.ae.invert(o,o);const h=[0,0,0],p=[0,1,0,0];return a.aB.transformMat4(p,p,o),h[0]=p[0],h[1]=p[1],h[2]=p[2],a.$.normalize(h,h),h}function Z3({width:u,height:r,anchor:o,textOffset:h,textScale:p},m){const{horizontalAlign:g,verticalAlign:x}=a.bS(o),b=-(g-.5)*u,w=-(x-.5)*r,T=a.bR(o,h);return new a.P((b/p+T[0])*m,(w/p+T[1])*m)}function Lh(u,r,o,h,p,m,g,x,b,w,T){const E=u.text.placedSymbolArray,O=u.text.dynamicLayoutVertexArray,z=u.icon.dynamicLayoutVertexArray,L={},k=u.getProjection(),B=ac(x,k,m),F=m.elevation,$=k.upVectorScale(x.canonical,m.center.lat,m.worldSize).metersToTile;O.clear();for(let G=0;G<E.length;G++){const Z=E.get(G),{tileAnchorX:K,tileAnchorY:W,numGlyphs:H}=Z,te=Z.hidden||!Z.crossTileID||u.allowVerticalPlacement&&!Z.placedOrientation?null:h[Z.crossTileID];if(te){let re=0,he=0,ne=0;if(F){const se=F?F.getAtTileOffset(x,K,W):0,[Se,Ie,Ue]=k.upVector(x.canonical,K,W);re=se*Se*$,he=se*Ie*$,ne=se*Ue*$}let[J,ge,me,oe]=nn(Z.projectedAnchorX+re,Z.projectedAnchorY+he,Z.projectedAnchorZ+ne,o?B:g);const Pe=Pt(m.getCameraToCenterDistance(k),oe);let Me=p.evaluateSizeForFeature(u.textSizeData,w,Z)*Pe/a.bP;o&&(Me*=u.tilePixelRatio/b);const de=Z3(te,Me);o?({x:J,y:ge,z:me}=k.projectTilePoint(K+de.x,W+de.y,x.canonical),[J,ge,me]=nn(J+re,ge+he,me+ne,g)):(r&&de._rotate(-m.angle),J+=de.x,ge+=de.y,me=0);const Ce=u.allowVerticalPlacement&&Z.placedOrientation===a.aF.vertical?Math.PI/2:0;for(let se=0;se<H;se++)a.aI(O,J,ge,me,Ce);T&&Z.associatedIconIndex>=0&&(L[Z.associatedIconIndex]={x:J,y:ge,z:me,angle:Ce})}else xs(H,O)}if(T){z.clear();const G=u.icon.placedSymbolArray;for(let Z=0;Z<G.length;Z++){const K=G.get(Z),{numGlyphs:W}=K,H=L[Z];if(K.hidden||!H)xs(W,z);else{const{x:te,y:re,z:he,angle:ne}=H;for(let J=0;J<W;J++)a.aI(z,te,re,he,ne)}}u.icon.dynamicLayoutVertexBuffer.updateData(z)}u.text.dynamicLayoutVertexBuffer.updateData(O)}function vo(u,r,o,h,p,m,g={}){const x=o.paint.get("icon-translate"),b=o.paint.get("text-translate"),w=o.paint.get("icon-translate-anchor"),T=o.paint.get("text-translate-anchor"),E=o.layout.get("icon-rotation-alignment"),O=o.layout.get("text-rotation-alignment"),z=o.layout.get("icon-pitch-alignment"),L=o.layout.get("text-pitch-alignment"),k=o.layout.get("icon-keep-upright"),B=o.layout.get("text-keep-upright"),F=o.paint.get("icon-color-saturation"),$=o.paint.get("icon-color-contrast"),G=o.paint.get("icon-color-brightness-min"),Z=o.paint.get("icon-color-brightness-max");o.paint.get("icon-occlusion-opacity").constantOr(0),o.paint.get("text-occlusion-opacity").constantOr(0);const K=u.context,W=K.gl,H=u.transform,te=E==="map",re=O==="map",he=z==="map",ne=L==="map",J=o.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ge=!1;const me=u.depthModeForSublayer(0,a.af.ReadOnly),oe=[a.ak(H.center.lng),a.al(H.center.lat)],Pe=o.layout.get("text-variable-anchor"),Me=H.projection.name==="globe",de=[],Ce=[0,-1,0];for(const se of h){const Se=r.getTile(se),Ie=Se.getBucket(o);if(!Ie||Ie.projection.name==="mercator"&&Me||Ie.fullyClipped)continue;const Ue=Ie.projection.name==="globe",$e=Ue?a.a2(H.zoom):0,Je=ac(se,Ie.getProjection(),H),qe=H.calculatePixelsToTileUnitsMatrix(Se),ot=Pe&&Ie.hasTextData(),Ct=Ie.hasIconTextFit()&&ot&&Ie.hasIconData(),ct=Ie.getProjection().createInversionMatrix(H,se.canonical),Tt=$t=>{H.depthOcclusionForSymbolsAndCircles&&(o.hasInitialOcclusionOpacityProperties||u.terrain)&&($t.push("DEPTH_D24"),$t.push("DEPTH_OCCLUSION"))},kt=()=>{const $t=te&&o.layout.get("symbol-placement")!=="point",zt=[];Tt(zt);const dt=$t||Ct,Ri=o.paint.get("icon-image-cross-fade").constantOr(0);u.terrainRenderModeElevated()&&he&&zt.push("PITCH_WITH_MAP_TERRAIN"),Ue&&(zt.push("PROJECTION_GLOBE_VIEW"),dt&&zt.push("PROJECTED_POS_ON_VIEWPORT")),Ri>0&&zt.push("ICON_TRANSITION"),Ie.icon.zOffsetVertexBuffer&&zt.push("Z_OFFSET"),F===0&&$===0&&G===0&&Z===1||zt.push("COLOR_ADJUSTMENT");const Li=Ie.icon.programConfigurations.get(o.id),lr=u.getOrCreateProgram(Ie.sdfIcons?"symbolSDF":"symbolIcon",{config:Li,defines:zt});let cr;const Ji=Se.imageAtlasTexture?Se.imageAtlasTexture.size:[0,0],ur=Ie.iconSizeData,Wi=a.aE(ur,H.zoom),Ki=he||H.pitch!==0,Le=no(Je,Se.tileID.canonical,he,te,H,Ie.getProjection(),qe),Qe=Al(Je,Se.tileID.canonical,he,te,H,Ie.getProjection(),qe),gr=u.translatePosMatrix(Qe,Se,x,w,!0),ci=u.translatePosMatrix(Je,Se,x,w),_e=dt?xo:Le,Pn=te&&!he&&!$t;let on=Ce;!Me&&!H.mercatorFromTransition||te||(on=U3(H));const On=Ue?on:Ce;if(Ie.sdfIcons&&!Ie.iconsInText)cr=yo(ur.kind,Wi,Pn,he,u,ci,_e,gr,!1,Ji,!0,se,$e,oe,ct,On,Ie.getProjection());else{const Os=o.getColorAdjustmentMatrix(F,$,G,Z);cr=ha(ur.kind,Wi,Pn,he,u,ci,_e,gr,!1,Ji,se,$e,oe,ct,On,Ie.getProjection(),Os,Ri)}const zn=Se.imageAtlasTexture?Se.imageAtlasTexture:null,s1=o.layout.get("icon-size").constantOr(0)!==1||Ie.iconsNeedLinear,a1=Ie.sdfIcons||u.options.rotating||u.options.zooming||s1||Ki?W.LINEAR:W.NEAREST,ns=Ie.sdfIcons&&o.paint.get("icon-halo-width").constantOr(1)!==0,zc=u.terrain&&he&&$t?a.ae.invert(a.ae.create(),Le):xo;if($t&&Ie.icon){const Os=H.elevation,o1=Os?Os.getAtTileOffsetFunc(se,H.center.lat,H.worldSize,Ie.getProjection()):null,Aa=wl(Je,Se.tileID.canonical,he,te,H,Ie.getProjection(),qe);aa(Ie,Je,u,!1,Aa,Qe,he,k,o1,se)}return{program:lr,buffers:Ie.icon,uniformValues:cr,atlasTexture:zn,atlasTextureIcon:null,atlasInterpolation:a1,atlasInterpolationIcon:null,isSDF:Ie.sdfIcons,hasHalo:ns,tile:Se,labelPlaneMatrixInv:zc}},hi=()=>{const $t=re&&o.layout.get("symbol-placement")!=="point",zt=[],dt=$t||Pe||Ct;u.terrainRenderModeElevated()&&ne&&zt.push("PITCH_WITH_MAP_TERRAIN"),Ue&&(zt.push("PROJECTION_GLOBE_VIEW"),dt&&zt.push("PROJECTED_POS_ON_VIEWPORT")),Ie.text.zOffsetVertexBuffer&&zt.push("Z_OFFSET"),Tt(zt);const Ri=Ie.text.programConfigurations.get(o.id),Li=u.getOrCreateProgram(Ie.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:Ri,defines:zt});let lr,cr=[0,0],Ji=null;const ur=Ie.textSizeData;Ie.iconsInText&&(cr=Se.imageAtlasTexture?Se.imageAtlasTexture.size:[0,0],Ji=Se.imageAtlasTexture?Se.imageAtlasTexture:null,lr=ne||H.pitch!==0||u.options.rotating||u.options.zooming||ur.kind==="composite"||ur.kind==="camera"?W.LINEAR:W.NEAREST);const Wi=Se.glyphAtlasTexture?Se.glyphAtlasTexture.size:[0,0],Ki=a.aE(ur,H.zoom),Le=no(Je,Se.tileID.canonical,ne,re,H,Ie.getProjection(),qe),Qe=Al(Je,Se.tileID.canonical,ne,re,H,Ie.getProjection(),qe),gr=u.translatePosMatrix(Qe,Se,b,T,!0),ci=u.translatePosMatrix(Je,Se,b,T),_e=dt?xo:Le,Pn=re&&!ne&&!$t;let on=Ce;!Me&&!H.mercatorFromTransition||re||(on=U3(H));const On=Ue?on:Ce;let zn;zn=Ie.iconsInText?rc(ur.kind,Ki,Pn,ne,u,ci,_e,gr,Wi,cr,se,$e,oe,ct,On,Ie.getProjection()):yo(ur.kind,Ki,Pn,ne,u,ci,_e,gr,!0,Wi,!0,se,$e,oe,ct,On,Ie.getProjection());const s1=Se.glyphAtlasTexture?Se.glyphAtlasTexture:null,a1=W.LINEAR,ns=o.paint.get("text-halo-width").constantOr(1)!==0,zc=u.terrain&&ne&&$t?a.ae.invert(a.ae.create(),Le):xo;if($t&&Ie.text){const Os=H.elevation,o1=Os?Os.getAtTileOffsetFunc(se,H.center.lat,H.worldSize,Ie.getProjection()):null,Aa=wl(Je,Se.tileID.canonical,ne,re,H,Ie.getProjection(),qe);aa(Ie,Je,u,!0,Aa,Qe,ne,B,o1,se)}return{program:Li,buffers:Ie.text,uniformValues:zn,atlasTexture:s1,atlasTextureIcon:Ji,atlasInterpolation:a1,atlasInterpolationIcon:lr,isSDF:!0,hasHalo:ns,tile:Se,labelPlaneMatrixInv:zc}},ai=Ie.icon.segments.get().length,Bt=Ie.text.segments.get().length,ni=ai&&!g.onlyText?kt():null,Et=Bt&&!g.onlyIcons?hi():null,Ot=o.paint.get("icon-opacity").constantOr(1),bt=o.paint.get("text-opacity").constantOr(1);if(J&&Ie.canOverlap){ge=!0;const $t=Ot&&!g.onlyText?Ie.icon.segments.get():[],zt=bt&&!g.onlyIcons?Ie.text.segments.get():[];for(const dt of $t)de.push({segments:new a.b([dt]),sortKey:dt.sortKey,state:ni});for(const dt of zt)de.push({segments:new a.b([dt]),sortKey:dt.sortKey,state:Et})}else g.onlyText||de.push({segments:Ot?Ie.icon.segments:new a.b([]),sortKey:0,state:ni}),g.onlyIcons||de.push({segments:bt?Ie.text.segments:new a.b([]),sortKey:0,state:Et})}ge&&de.sort((se,Se)=>se.sortKey-Se.sortKey);for(const se of de){const Se=se.state;if(Se)if(u.terrain?u.terrain.setupElevationDraw(Se.tile,Se.program,{useDepthForOcclusion:H.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Se.labelPlaneMatrixInv}):u.setupDepthForOcclusion(H.depthOcclusionForSymbolsAndCircles,Se.program),K.activeTexture.set(W.TEXTURE0),Se.atlasTexture&&Se.atlasTexture.bind(Se.atlasInterpolation,W.CLAMP_TO_EDGE,!0),Se.atlasTextureIcon&&(K.activeTexture.set(W.TEXTURE1),Se.atlasTextureIcon&&Se.atlasTextureIcon.bind(Se.atlasInterpolationIcon,W.CLAMP_TO_EDGE,!0)),u.uploadCommonLightUniforms(u.context,Se.program),Se.hasHalo){const Ie=Se.uniformValues;Ie.u_is_halo=1,oc(Se.buffers,se.segments,o,u,Se.program,me,p,m,Ie,2),Ie.u_is_halo=0}else{if(Se.isSDF){const Ie=Se.uniformValues;Se.hasHalo&&(Ie.u_is_halo=1,oc(Se.buffers,se.segments,o,u,Se.program,me,p,m,Ie,1)),Ie.u_is_halo=0}oc(Se.buffers,se.segments,o,u,Se.program,me,p,m,Se.uniformValues,1)}}}function oc(u,r,o,h,p,m,g,x,b,w){const T=[u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer,u.iconTransitioningVertexBuffer,u.globeExtVertexBuffer,u.zOffsetVertexBuffer];p.draw(h,h.context.gl.TRIANGLES,m,g,x,a.ag.disabled,b,o.id,u.layoutVertexBuffer,u.indexBuffer,r,o.paint,h.transform.zoom,u.programConfigurations.get(o.id),T,w)}function Co(u,r,o,h,p,m,g){const x=u.context.gl,b=o.paint.get("fill-pattern"),w=b&&b.constantOr(1);let T,E,O,z,L;g?(E=w&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",T=x.LINES):(E=w?"fillPattern":"fill",T=x.TRIANGLES);for(const k of h){const B=r.getTile(k);if(w&&!B.patternsLoaded())continue;const F=B.getBucket(o);if(!F)continue;u.prepareDrawTile();const $=F.programConfigurations.get(o.id),G=u.isTileAffectedByFog(k),Z=u.getOrCreateProgram(E,{config:$,overrideFog:G});w&&(u.context.activeTexture.set(x.TEXTURE0),B.imageAtlasTexture&&B.imageAtlasTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),$.updatePaintBuffers());const K=b.constantOr(null);if(K&&B.imageAtlas){const te=B.imageAtlas.patternPositions[K.toString()];te&&$.setConstantPatternPositions(te)}const W=u.translatePosMatrix(k.projMatrix,B,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor")),H=o.paint.get("fill-emissive-strength");if(g){z=F.indexBuffer2,L=F.segments2;const te=u.terrain&&u.terrain.renderingToTexture?u.terrain.drapeBufferSize:[x.drawingBufferWidth,x.drawingBufferHeight];O=E==="fillOutlinePattern"&&w?mo(W,H,u,B,te):zl(W,H,te)}else z=F.indexBuffer,L=F.segments,O=w?Ol(W,H,u,B):fo(W,H);u.uploadCommonUniforms(u.context,Z,k.toUnwrapped()),Z.draw(u,T,p,u.stencilModeForClipping(k),m,a.ag.disabled,O,o.id,F.layoutVertexBuffer,z,L,o.paint,u.transform.zoom,$,void 0)}}function ws(u,r,o,h,p,m,g,x){o.resetLayerRenderingStats(u);const b=u.context,w=b.gl,T=u.transform,E=o.paint.get("fill-extrusion-pattern"),O=E.constantOr(1),z=o.paint.get("fill-extrusion-opacity"),L=u.style.enable3dLights(),k=o.paint.get(L&&!O?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),B=[o.paint.get("fill-extrusion-ambient-occlusion-intensity"),k],F=o.layout.get("fill-extrusion-edge-radius"),$=F>0&&!o.paint.get("fill-extrusion-rounded-roof"),G=$?0:F,Z=T.projection.name==="globe"?a.b_():0,K=T.projection.name==="globe",W=K?a.a2(T.zoom):0,H=[a.ak(T.center.lng),a.al(T.center.lat)],te=o.paint.get("fill-extrusion-flood-light-color").toRenderColor(o.lut).toArray01().slice(0,3),re=o.paint.get("fill-extrusion-flood-light-intensity"),he=o.paint.get("fill-extrusion-vertical-scale"),ne=o.paint.get("fill-extrusion-line-width").constantOr(1)!==0,J=Cr(u,o.paint.get("fill-extrusion-cutoff-fade-range")),ge=o.paint.get("fill-extrusion-emissive-strength"),me=[];K&&me.push("PROJECTION_GLOBE_VIEW"),B[0]>0&&me.push("FAUX_AO"),$&&me.push("ZERO_ROOF_RADIUS"),x&&me.push("HAS_CENTROID"),re>0&&me.push("FLOOD_LIGHT"),J.shouldRenderCutoff&&me.push("RENDER_CUTOFF"),ne&&me.push("RENDER_WALL_MODE");const oe=(()=>{const Ue=o.paint.get("fill-extrusion-line-alignment");switch(Ue){case"inside":return 1;case"outside":return-1;case"center":return 0;default:return a.w(`Unsupported value for fill-extrusion-line-alignment: ${Ue}`),0}})();let Pe;const Me=u.renderPass==="shadow",de=u.shadowRenderer,Ce=Me&&!!de;u.shadowRenderer&&(u.shadowRenderer.useNormalOffset=!0);let se=[0,0,0];if(de){const Ue=u.style.directionalLight,$e=u.style.ambientLight;Ue&&$e&&(se=lo(u.style,Ue,$e)),Pe=me.concat(["SHADOWS_SINGLE_CASCADE"])}const Se=Ce?"fillExtrusionDepth":O?"fillExtrusionPattern":"fillExtrusion",Ie=o.getLayerRenderingStats();for(const Ue of h){const $e=r.getTile(Ue),Je=$e.getBucket(o);if(!Je||Je.projection.name!==T.projection.name)continue;let qe=!1;de&&(qe=de.getMaxCascadeForTile(Ue.toUnwrapped())===0);const ot=u.isTileAffectedByFog(Ue),Ct=Je.programConfigurations.get(o.id),ct=u.getOrCreateProgram(Se,{config:Ct,defines:qe?Pe:me,overrideFog:ot});if(u.terrain&&u.terrain.setupElevationDraw($e,ct,{useMeterToDem:!0}),!Je.centroidVertexBuffer){const Et=ct.attributes.a_centroid_pos;Et!==void 0&&w.vertexAttrib2f(Et,0,0)}!Me&&de&&de.setupShadows($e.tileID.toUnwrapped(),ct,"vector-tile",$e.tileID.overscaledZ),O&&(u.context.activeTexture.set(w.TEXTURE0),$e.imageAtlasTexture&&$e.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),Ct.updatePaintBuffers());const Tt=E.constantOr(null);if(Tt&&$e.imageAtlas){const Et=$e.imageAtlas.patternPositions[Tt.toString()];Et&&Ct.setConstantPatternPositions(Et)}const kt=o.paint.get("fill-extrusion-vertical-gradient"),hi=1/Je.tileToMeter;let ai;if(Me&&de){if(mn($e.tileID,Je,u))continue;const Et=de.calculateShadowPassMatrixFromTile($e.tileID.toUnwrapped());ai=Pl(Et,G,oe,hi,he)}else{const Et=u.translatePosMatrix(Ue.expandedProjMatrix,$e,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ot=T.projection.createInversionMatrix(T,Ue.canonical);ai=O?L3(Et,u,kt,z,B,G,oe,hi,Ue,$e,Z,W,H,Ot,te,he):pn(Et,u,kt,z,B,G,oe,hi,Ue,Z,W,H,Ot,te,he,re,se,ge)}u.uploadCommonUniforms(b,ct,Ue.toUnwrapped(),null,J);let Bt=Je.segments;if(T.projection.name==="mercator"&&!Me&&(Bt=Je.getVisibleSegments($e.tileID,u.terrain,u.transform.getFrustum(0)),!Bt.get().length))continue;if(Ie)if(Me)for(const Et of Bt.get())Ie.numRenderedVerticesInShadowPass+=Et.primitiveLength;else for(const Et of Bt.get())Ie.numRenderedVerticesInTransparentPass+=Et.primitiveLength;const ni=[];(u.terrain||x)&&ni.push(Je.centroidVertexBuffer),K&&ni.push(Je.layoutVertexExtBuffer),ne&&ni.push(Je.wallVertexBuffer),ct.draw(u,b.gl.TRIANGLES,p,m,g,a.ag.backCCW,ai,o.id,Je.layoutVertexBuffer,Je.indexBuffer,Bt,o.paint,u.transform.zoom,Ct,ni)}u.shadowRenderer&&(u.shadowRenderer.useNormalOffset=!1)}function pa(u,r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F,$){const G=u.context,Z=G.gl,K=u.transform,W=u.transform.zoom,H=[],te=Cr(u,o.paint.get("fill-extrusion-cutoff-fade-range"));w==="clear"?(H.push("CLEAR_SUBPASS"),$&&(H.push("CLEAR_FROM_TEXTURE"),G.activeTexture.set(Z.TEXTURE0),$.bind(Z.LINEAR,Z.CLAMP_TO_EDGE))):w==="sdf"&&H.push("SDF_SUBPASS"),B&&H.push("HAS_CENTROID"),te.shouldRenderCutoff&&H.push("RENDER_CUTOFF");const re=o.layout.get("fill-extrusion-edge-radius"),he=(ne,J,ge,me,oe)=>{const Pe=J.programConfigurations.get(o.id),Me=u.isTileAffectedByFog(ne),de=u.getOrCreateProgram("fillExtrusionGroundEffect",{config:Pe,defines:H,overrideFog:Me}),Ce=((Se,Ie,Ue,$e,Je,qe,ot,Ct,ct,Tt,kt)=>({u_matrix:Ie,u_opacity:Ue,u_ao_pass:$e?1:0,u_meter_to_tile:Je,u_ao:qe,u_flood_light_intensity:ot,u_flood_light_color:Ct,u_attenuation:ct,u_edge_radius:Tt,u_fb:0,u_fb_size:kt}))(0,me,T,b,oe,[E,O*oe],z,L,k,W>=17?0:re*oe,$?$.size[0]:0),se=[];B&&se.push(J.hiddenByLandmarkVertexBuffer),u.uploadCommonUniforms(G,de,ne.toUnwrapped(),null,te),de.draw(u,G.gl.TRIANGLES,p,m,g,x,Ce,o.id,J.vertexBuffer,J.indexBuffer,ge,o.paint,W,Pe,se)};for(const ne of h){const J=r.getTile(ne),ge=J.getBucket(o);if(!ge||ge.projection.name!==K.projection.name||!ge.groundEffect||ge.groundEffect&&!ge.groundEffect.hasData())continue;const me=ge.groundEffect,oe=1/ge.tileToMeter;{const Pe=u.translatePosMatrix(ne.projMatrix,J,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Me=me.getDefaultSegment();he(ne,me,Me,Pe,oe)}if(F)for(let Pe=0;Pe<4;Pe++){const Me=a.b$[Pe](ne),de=r.getTile(Me);if(!de)continue;const Ce=de.getBucket(o);if(!Ce||Ce.projection.name!==K.projection.name||!Ce.groundEffect||Ce.groundEffect&&!Ce.groundEffect.hasData())continue;const se=Ce.groundEffect;let Se,Ie;Pe===0?(Se=[-a.a4,0,0],Ie=1):Pe===1?(Se=[a.a4,0,0],Ie=0):Pe===2?(Se=[0,-a.a4,0],Ie=3):(Se=[0,a.a4,0],Ie=2);const Ue=se.regionSegments[Ie];if(!Ue)continue;const $e=new Float32Array(16);a.ae.translate($e,ne.projMatrix,Se),he(ne,se,Ue,u.translatePosMatrix($e,J,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),oe)}}}function kh(u,r,o,h,p,m,g){h.centroidVertexArray.length===0&&h.createCentroidsBuffer();const x=m?m.findDEMTileFor(o):null;if(!(x&&x.dem||g))return;const b=F=>new a.P(Math.ceil((F+a.c2)*a.c3),0),w=F=>{const $=r.getSource().minzoom,G=K=>{const W=r.getTileByID(K);if(W&&W.hasData())return W.getBucket(p)},Z=[0,-1,1];for(const K of Z){if(F.overscaledZ+K<$)continue;const W=G(F.calculateScaledKey(F.overscaledZ+K));if(W)return W}},T=[0,0,0],E=(F,$)=>(T[0]=Math.min(F.min.y,$.min.y),T[1]=Math.max(F.max.y,$.max.y),T[2]=a.a4-$.min.x>F.max.x?$.min.x-a.a4:F.max.x,T),O=(F,$)=>(T[0]=Math.min(F.min.x,$.min.x),T[1]=Math.max(F.max.x,$.max.x),T[2]=a.a4-$.min.y>F.max.y?$.min.y-a.a4:F.max.y,T),z=[(F,$)=>E(F,$),(F,$)=>E($,F),(F,$)=>O(F,$),(F,$)=>O($,F)],L=(F,$,G,Z,K,W,H)=>{if(!m)return 0;const te=[[W?G:F,W?F:G,0],[W?G:$,W?$:G,0]],re=H<0?a.a4+H:H,he=[W?re:(F+$)/2,W?(F+$)/2:re,0];return G===0&&H<0||G!==0&&H>0?m.getForTilePoints(K,[he],!0,Z):te.push(he),m.getForTilePoints(o,te,!0,x),Math.max(te[0][2],te[1][2],he[2])/m.exaggeration()};for(let F=0;F<4;F++){const $=h.borderFeatureIndices[F];if($.length===0)continue;const G=a.b$[F](o),Z=w(G);if(!(Z&&Z instanceof a.c0)||h.borderDoneWithNeighborZ[F]===Z.canonical.z)continue;Z.centroidVertexArray.length===0&&Z.createCentroidsBuffer();const K=m?m.findDEMTileFor(G):null;if(!(K&&K.dem||g))continue;const W=(F<2?1:5)-F,H=Z.borderDoneWithNeighborZ[W]!==h.canonical.z,te=Z.borderFeatureIndices[W];let re=0;if(h.canonical.z!==Z.canonical.z){for(const he of $)h.showCentroid(h.featuresOnBorder[he]);if(H)for(const he of te)Z.showCentroid(Z.featuresOnBorder[he]);h.borderDoneWithNeighborZ[F]=Z.canonical.z,Z.borderDoneWithNeighborZ[W]=h.canonical.z}for(const he of $){const ne=h.featuresOnBorder[he],J=h.centroidData[ne.centroidDataIndex],ge=ne.borders[F];let me;for(;re<te.length;){me=Z.featuresOnBorder[te[re]];const oe=me.borders[W];if(oe[1]>ge[0]+3||oe[0]>ge[0]-3)break;Z.showCentroid(me),re++}if(me&&re<te.length){const oe=re;let Pe=0;for(;!(me.borders[W][0]>ge[1]-3)&&(Pe++,++re!==te.length);)me=Z.featuresOnBorder[te[re]];if(me=Z.featuresOnBorder[te[oe]],Pe>1){const Ce=me.borders[W];Math.abs(ge[0]-Ce[0])<3&&Math.abs(ge[1]-Ce[1])<3&&(Pe=1,re=oe+1)}else if(Pe===0){h.showCentroid(ne);continue}const Me=Z.centroidData[me.centroidDataIndex];g&&Pe===1&&(((k=J).flags|(B=Me).flags)&a.c1?(k.flags|=a.c1,B.flags|=a.c1):(k.flags&=~a.c1,B.flags&=~a.c1));const de=ne.intersectsCount()>1||me.intersectsCount()>1;if(Pe>1)re=oe,J.centroidXY=Me.centroidXY=new a.P(0,0);else if(K&&K.dem&&!de){const Ce=z[F](J,Me),se=F%2?a.a4-1:0,Se=L(Ce[0],Math.min(a.a4-1,Ce[1]),se,K,G,F<2,Ce[2]);J.centroidXY=Me.centroidXY=b(Se)}else de?J.centroidXY=Me.centroidXY=new a.P(0,0):(J.centroidXY=h.encodeBorderCentroid(ne),Me.centroidXY=Z.encodeBorderCentroid(me));h.writeCentroidToBuffer(J),Z.writeCentroidToBuffer(Me)}else h.showCentroid(ne)}h.borderDoneWithNeighborZ[F]=Z.canonical.z,Z.borderDoneWithNeighborZ[W]=h.canonical.z}var k,B;(h.needsCentroidUpdate||!h.centroidVertexBuffer&&h.centroidVertexArray.length!==0)&&h.uploadCentroid(u)}const $3=[1,0,0],Bh=[0,1,0],Ll=[0,0,1];function mn(u,r,o){const h=o.transform,p=o.shadowRenderer;if(!p)return!0;const m=u.toUnwrapped(),g=h.tileSize*p._cascades[o.currentShadowCascade].scale;let x=r.maxHeight;if(h.elevation){const k=h.elevation.getMinMaxForTile(u);k&&(x+=k.max)}const b=[...p.shadowDirection];b[2]=-b[2];const w=p.computeSimplifiedTileShadowVolume(m,x,g,b);if(!w)return!1;const T=[$3,Bh,Ll,b,[b[0],0,b[2]],[0,b[1],b[2]]],E=h.projection.name==="globe",O=h.scaleZoom(g),z=a.aM.fromInvProjectionMatrix(h.invProjMatrix,h.worldSize,O,!E),L=p.getCurrentCascadeFrustum();return z.intersectsPrecise(w.vertices,w.planes,T)===0||L.intersectsPrecise(w.vertices,w.planes,T)===0}function bo(u){return[u[0]*a.c4,u[1]*a.c4,u[2]*a.c4,0]}function kl(u,r,o,h,p,m,g,x,b){const w=h.getSource(),T=o.globeSharedBuffers;if(!T)return;let E,O,z;if(r&&(E=h.getTile(r)),w instanceof a.bo?(O=w.texture,z=a.bj(0,0,o.transform)):E&&r&&(O=E.texture,z=a.bj(r.canonical.z,r.canonical.x,o.transform)),!O||!z)return;u||(z=a.ae.scale(a.ae.create(),z,[1,-1,1]));const L=o.context,k=L.gl,B=p.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR,F=o.colorModeForDrapableLayerRenderPass(m),$=g.defines;$.push("GLOBE_POLES");const G=new a.af(k.LEQUAL,a.af.ReadWrite,o.depthRangeFor3D),Z=Float32Array.from(o.transform.expandedFarZProjMatrix),K=Float32Array.from(a.bh(a.bi(new a.aO(0,0,0))));o.terrain&&o.terrain.prepareDrawTile(),L.activeTexture.set(k.TEXTURE0),O.bind(B,k.CLAMP_TO_EDGE),L.activeTexture.set(k.TEXTURE1),O.bind(B,k.CLAMP_TO_EDGE),O.useMipmap&&L.extTextureFilterAnisotropic&&o.transform.pitch>20&&k.texParameterf(k.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);const[W,H,te,re]=r?T.getPoleBuffers(r.canonical.z,!1):T.getPoleBuffers(0,!0),he=p.paint.get("raster-elevation");let ne;u?(ne=W,o.renderDefaultNorthPole=he!==0):(ne=H,o.renderDefaultSouthPole=he!==0);const J=bo(g.mix),ge=((oe,Pe,Me,de,Ce,se,Se,Ie,Ue,$e,Je,qe,ot)=>Rl(oe,Pe,Me,new Float32Array(16),new Float32Array(9),[0,0],de,[0,0],[0,0,0,0],1,{opacity:1,mix:0},se,[0,0],Ie,2,$e,Je,qe,1,0,ot))(Z,K,z,a.a2(o.transform.zoom),0,p,0,he,0,J,g.offset,g.range,m),me=o.getOrCreateProgram("raster",{defines:$});o.uploadCommonUniforms(L,me,null),me.draw(o,k.TRIANGLES,G,b,F,x,ge,p.id,ne,te,re)}function lc(u){const r=u._nearZ,o=u.projection.farthestPixelDistance(u),h=o-r,p=.2*u.height,m=r+p;return[r,o,(m-p-r)/h,(m-r)/h]}function As(u,r,o,h){if(u)return r instanceof Kn&&u instanceof a.c5?r.getTextureDescriptor(u,o,!0):{texture:u.texture,mix:bo(h.mix),offset:h.offset,buffer:0,tileSize:1}}function G3(u,r,o){if(!u)return null;const h=r.getTextureDescriptor(u,o,!0);if(!h)return null;let{texture:p,mix:m,offset:g,tileSize:x,buffer:b,format:w}=h;if(!p||!w)return null;let T=!1;return w==="uint32"&&(T=!0,m[3]=0,m=tc(a.c6,m,[0,o.paint.get("raster-particle-max-speed")]),g=_o(a.c6,g,[0,o.paint.get("raster-particle-max-speed")])),{texture:p,textureOffset:[b/(x+2*b),x/(x+2*b)],tileSize:x,scalarData:T,scale:m,offset:g,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[w]]}}function Bl(u){const r=u._nearZ,o=u.projection.farthestPixelDistance(u),h=o-r,p=.2*u.height,m=r+p;return[r,o,(m-p-r)/h,(m-r)/h]}const cc=new a.C(1,0,0,1),Fl=new a.C(0,1,0,1),uc=new a.C(0,0,1,1),Yt=new a.C(1,0,1,1),Fh=new a.C(0,1,1,1);function lt(u,r,o,h,p,m,g){const x=u.context,b=u.transform,w=x.gl,T=b.projection.name==="globe",E=T?["PROJECTION_GLOBE_VIEW"]:[];let O=a.ae.clone(o.projMatrix);if(T&&a.a2(b.zoom)>0){const J=a.c7(o.canonical,b),ge=a.c8(J);O=a.ae.multiply(new Float32Array(16),b.globeMatrix,ge),a.ae.multiply(O,b.projMatrix,O)}const z=a.ae.create();z[12]+=2*p/(a.e.devicePixelRatio*b.width),z[13]+=2*m/(a.e.devicePixelRatio*b.height),a.ae.multiply(O,z,O);const L=u.getOrCreateProgram("debug",{defines:E}),k=r.getTileByID(o.key);u.terrain&&u.terrain.setupElevationDraw(k,L);const B=a.af.disabled,F=a.ah.disabled,$=u.colorModeForRenderPass(),G="$debug";x.activeTexture.set(w.TEXTURE0),u.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),T?k._makeGlobeTileDebugBuffers(u.context,b):k._makeDebugTileBoundsBuffers(u.context,b.projection);const Z=k._tileDebugBuffer||u.debugBuffer,K=k._tileDebugIndexBuffer||u.debugIndexBuffer,W=k._tileDebugSegments||u.debugSegments;if(L.draw(u,w.LINE_STRIP,B,F,$,a.ag.disabled,Dl(O,h),G,Z,K,W,null,null,null,[k._globeTileDebugBorderBuffer]),g){const J=k.latestRawTileData,ge=Math.floor((J&&J.byteLength||0)/1024);let me=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(me+=` => ${o.overscaledZ}`),me+=` ${k.state}`,me+=` ${ge}kb`,function(oe,Pe){oe.initDebugOverlayCanvas();const Me=oe.debugOverlayCanvas,de=oe.context.gl,Ce=oe.debugOverlayCanvas.getContext("2d");Ce.clearRect(0,0,Me.width,Me.height),Ce.shadowColor="white",Ce.shadowBlur=2,Ce.lineWidth=1.5,Ce.strokeStyle="white",Ce.textBaseline="top",Ce.font="bold 36px Open Sans, sans-serif",Ce.fillText(Pe,5,5),Ce.strokeText(Pe,5,5),oe.debugOverlayTexture.update(Me),oe.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(u,me)}const H=r.getTile(o).tileSize,te=512/Math.min(H,512)*(o.overscaledZ/b.zoom)*.5,re=k._tileDebugTextBuffer||u.debugBuffer,he=k._tileDebugTextIndexBuffer||u.quadTriangleIndexBuffer,ne=k._tileDebugTextSegments||u.debugSegments;L.draw(u,w.TRIANGLES,B,F,a.a.alphaBlended,a.ag.disabled,Dl(O,a.C.transparent,te),G,re,he,ne,null,null,null,[k._globeTileDebugTextBuffer])}function hc(u,r,o,h){fa(u,0,r+o/2,u.transform.width,o,h)}function wo(u,r,o,h){fa(u,r-o/2,0,o,u.transform.height,h)}function fa(u,r,o,h,p,m){const g=u.context,x=g.gl;x.enable(x.SCISSOR_TEST),x.scissor(r*a.e.devicePixelRatio,o*a.e.devicePixelRatio,h*a.e.devicePixelRatio,p*a.e.devicePixelRatio),g.clear({color:m}),x.disable(x.SCISSOR_TEST)}const _n=a.c9([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:dc}=_n;function Ir(u,r,o,h){u.emplaceBack(r,o,h)}class Ye{constructor(r){this.vertexArray=new a.ca,this.indices=new a.bw,Ir(this.vertexArray,-1,-1,1),Ir(this.vertexArray,1,-1,1),Ir(this.vertexArray,-1,1,1),Ir(this.vertexArray,1,1,1),Ir(this.vertexArray,-1,-1,-1),Ir(this.vertexArray,1,-1,-1),Ir(this.vertexArray,-1,1,-1),Ir(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,dc),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=a.b.simpleSegment(0,0,36,12)}}function Vt(u,r,o,h,p,m){const g=u.context.gl,x=r.paint.get("sky-atmosphere-color"),b=r.paint.get("sky-atmosphere-halo-color"),w=r.paint.get("sky-atmosphere-sun-intensity"),T=((E,O,z,L,k)=>({u_matrix_3f:E,u_sun_direction:O,u_sun_intensity:z,u_color_tint_r:[L.r,L.g,L.b,L.a],u_color_tint_m:[k.r,k.g,k.b,k.a],u_luminance:5e-5}))(a.bE.fromMat4(a.bE.create(),h),p,w,x,b);g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_CUBE_MAP_POSITIVE_X+m,r.skyboxTexture,0),o.draw(u,g.TRIANGLES,a.af.disabled,a.ah.disabled,a.a.unblended,a.ag.frontCW,T,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Kt=a.c9([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class qr{constructor(r){const o=new a.cb;o.emplaceBack(-1,1,1,0,0),o.emplaceBack(1,1,1,1,0),o.emplaceBack(1,-1,1,1,1),o.emplaceBack(-1,-1,1,0,1);const h=new a.bw;h.emplaceBack(0,1,2),h.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(o,Kt.members),this.indexBuffer=r.createIndexBuffer(h),this.segments=a.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ma=a.c9([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Wt{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class jl{constructor(r){this.colorModeAlphaBlendedWriteRGB=new a.a([a.cc,a.cd,a.cc,a.cd],a.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new a.a([a.cc,a.ce,a.cc,a.ce],a.C.transparent,[!1,!1,!1,!0]),this.params=new Wt,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const o=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new qr(o);const h=this.params.sizeRange,p=this.params.intensityRange,m=function(T){const E=a.ch(30),O=[];for(let z=0;z<T;++z){const L=2*Math.PI*E(),k=Math.acos(1-2*E())-.5*Math.PI;O.push(a.$.fromValues(Math.cos(k)*Math.cos(L),Math.cos(k)*Math.sin(L),Math.sin(k)))}return O}(this.params.starsCount),g=a.ch(300),x=new a.cf,b=new a.bw;let w=0;for(let T=0;T<m.length;++T){const E=a.$.scale([],m[T],200),O=Math.max(0,1+.01*h*(1*g()-.5)),z=Math.max(0,1+.01*p*(1*g()-.5));x.emplaceBack(E[0],E[1],E[2],-1,-1,O,z),x.emplaceBack(E[0],E[1],E[2],1,-1,O,z),x.emplaceBack(E[0],E[1],E[2],1,1,O,z),x.emplaceBack(E[0],E[1],E[2],-1,1,O,z),b.emplaceBack(w+0,w+1,w+2),b.emplaceBack(w+0,w+2,w+3),w+=4}this.starsVx=o.createVertexBuffer(x,ma.members),this.starsIdx=o.createIndexBuffer(b),this.starsSegments=a.b.simpleSegment(0,0,x.length,b.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,o){const h=r.context,p=h.gl,m=r.transform,g=new a.af(p.LEQUAL,a.af.ReadOnly,[0,1]),x=a.a2(m.zoom),b=r.style.getLut(o.scope),w=o.properties.get("color").toRenderColor(b).toArray01(),T=o.properties.get("high-color").toRenderColor(b).toArray01(),E=o.properties.get("space-color").toRenderColor(b).toArray01PremultipliedAlpha(),O=5e-4,z=a.cg(o.properties.get("horizon-blend"),0,1,O,.25),L=a.bc(r,h,m)&&z===O?m.worldSize/(2*Math.PI*1.025)-1:m.globeRadius,k=r.frameCounter/1e3%1,B=a.$.length(m.globeCenterInViewSpace),F=Math.sqrt(Math.pow(B,2)-Math.pow(L,2)),$=Math.acos(F/B),G=Z=>{const K=m.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Z&&K.push("ALPHA_PASS");const W=r.getOrCreateProgram("globeAtmosphere",{defines:K}),H=((re,he,ne,J,ge,me,oe,Pe,Me,de,Ce,se)=>({u_frustum_tl:re,u_frustum_tr:he,u_frustum_br:ne,u_frustum_bl:J,u_horizon:ge,u_transition:me,u_fadeout_range:oe,u_color:Pe,u_high_color:Me,u_space_color:de,u_temporal_offset:Ce,u_horizon_angle:se}))(m.frustumCorners.TL,m.frustumCorners.TR,m.frustumCorners.BR,m.frustumCorners.BL,m.frustumCorners.horizon,x,z,w,T,E,k,$);r.uploadCommonUniforms(h,W);const te=this.atmosphereBuffer;te&&W.draw(r,p.TRIANGLES,g,a.ah.disabled,Z?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,a.ag.backCW,H,Z?"atmosphere_glow_alpha":"atmosphere_glow",te.vertexBuffer,te.indexBuffer,te.segments)};G(!1),G(!0)}drawStars(r,o){const h=a.au(o.properties.get("star-intensity"),0,1);if(h===0)return;const p=r.context,m=p.gl,g=r.transform,x=r.getOrCreateProgram("stars"),b=a.aw.identity([]);a.aw.rotateX(b,b,-g._pitch),a.aw.rotateZ(b,b,-g.angle),a.aw.rotateX(b,b,a.ac(g._center.lat)),a.aw.rotateY(b,b,-a.ac(g._center.lng));const w=a.ae.fromQuat(new Float32Array(16),b),T=a.ae.multiply([],g.starsProjMatrix,w),E=a.bE.fromMat4([],w),O=a.bE.invert([],E),z=[0,1,0];a.$.transformMat3(z,z,O),a.$.scale(z,z,this.params.sizeMultiplier);const L=[1,0,0];a.$.transformMat3(L,L,O),a.$.scale(L,L,this.params.sizeMultiplier);const k=(B=z,F=L,$=h,{u_matrix:Float32Array.from(T),u_up:B,u_right:F,u_intensity_multiplier:$});var B,F,$;r.uploadCommonUniforms(p,x),this.starsVx&&this.starsIdx&&x.draw(r,m.TRIANGLES,a.af.disabled,a.ah.disabled,this.colorModeAlphaBlendedWriteRGB,a.ag.disabled,k,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function _a(u,r){const o=[...u],h=r.cameraWorldSizeForFog/r.worldSize,p=a.ae.identity([]);return a.ae.scale(p,p,[h,h,1]),a.ae.multiply(o,p,o),a.ae.multiply(o,r.worldToFogMatrix,o),o}function Ts(u,r,o,h,p){const m=o.material,g=h.context,{baseColorTexture:x,metallicRoughnessTexture:b}=m.pbrMetallicRoughness,{normalTexture:w,occlusionTexture:T,emissionTexture:E}=m;function O(z,L,k){if(z&&(u.push(L),g.activeTexture.set(g.gl.TEXTURE0+k),z.gfxTexture)){const{minFilter:B,magFilter:F,wrapS:$,wrapT:G}=z.sampler;z.gfxTexture.bindExtraParam(B,F,$,G)}}O(x,"HAS_TEXTURE_u_baseColorTexture",rr.BaseColor),O(b,"HAS_TEXTURE_u_metallicRoughnessTexture",rr.MetallicRoughness),O(w,"HAS_TEXTURE_u_normalTexture",rr.Normal),O(T,"HAS_TEXTURE_u_occlusionTexture",rr.Occlusion),O(E,"HAS_TEXTURE_u_emissionTexture",rr.Emission),p&&(p.texture||(p.texture=new a.cj(h.context,p.image,[p.image.height,p.image.height,p.image.height],g.gl.RGBA)),g.activeTexture.set(g.gl.TEXTURE0+rr.LUT),p.texture&&p.texture.bind(g.gl.LINEAR,g.gl.CLAMP_TO_EDGE),u.push("APPLY_LUT_ON_GPU")),o.texcoordBuffer&&(u.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(o.texcoordBuffer)),o.colorBuffer&&(u.push(o.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(o.colorBuffer)),o.normalBuffer&&(u.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(o.normalBuffer)),o.pbrBuffer&&(u.push("HAS_ATTRIBUTE_a_pbr"),u.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(o.pbrBuffer)),m.alphaMode!=="OPAQUE"&&m.alphaMode!=="MASK"||u.push("UNPREMULT_TEXTURE_IN_SHADER"),m.defined||u.push("DIFFUSE_SHADED"),u.push("USE_STANDARD_DERIVATIVES")}function ar(u,r,o,h,p,m){const g=o.paint.get("model-opacity"),x=r.context,b=new a.af(r.context.gl.LEQUAL,a.af.ReadWrite,r.depthRangeFor3D),w=r.transform,T=u.mesh,E=T.material,O=E.pbrMetallicRoughness,z=r.style.fog;let L;L=r.transform.projection.zAxisUnit==="pixels"?[...u.nodeModelMatrix]:a.ae.multiply([],h.zScaleMatrix,u.nodeModelMatrix),a.ae.multiply(L,h.negCameraPosMatrix,L);const k=a.ae.invert([],L);a.ae.transpose(k,k);const B=o.paint.get("model-emissive-strength").constantOr(0),F=Cs(new Float32Array(u.worldViewProjection),new Float32Array(L),new Float32Array(k),null,r,g,O.baseColorFactor.toRenderColor(null),E.emissiveFactor,O.metallicFactor,O.roughnessFactor,E,B,o),$={defines:[]},G=[];Ts($.defines,G,T,r,o.lut);const Z=r.shadowRenderer;Z&&(Z.useNormalOffset=!1);let K=null;if(z){const te=_a(u.nodeModelMatrix,r.transform);if(K=new Float32Array(te),w.projection.name!=="globe"){const re=T.aabb.min,he=T.aabb.max,[ne,J]=z.getOpacityForBounds(te,re[0],re[1],he[0],he[1]);$.overrideFog=ne>=qt||J>=qt}}const W=Cr(r,o.paint.get("model-cutoff-fade-range"));W.shouldRenderCutoff&&$.defines.push("RENDER_CUTOFF");const H=r.getOrCreateProgram("model",$);r.uploadCommonUniforms(x,H,null,K,W),r.renderPass!=="shadow"&&Z&&Z.setupShadowsFromMatrix(u.nodeModelMatrix,H),H.draw(r,x.gl.TRIANGLES,b,p,m,T.material.doubleSided?a.ag.disabled:a.ag.backCCW,F,o.id,T.vertexBuffer,T.indexBuffer,T.segments,o.paint,r.transform.zoom,void 0,G)}function Si(u,r,o,h,p,m,g){let x;x=u.projection.name==="globe"?a.ck(o,u):[...o],a.ae.multiply(x,x,r.matrix);const b=a.ae.multiply([],h,x);if(r.meshes)for(const w of r.meshes){if(w.material.alphaMode!=="BLEND"){g.push({mesh:w,depth:0,modelIndex:p,worldViewProjection:b,nodeModelMatrix:x});continue}const T=a.$.transformMat4([],w.centroid,b);T[2]>0&&m.push({mesh:w,depth:T[2],modelIndex:p,worldViewProjection:b,nodeModelMatrix:x})}if(r.children)for(const w of r.children)Si(u,w,o,h,p,m,g)}function pc(u,r,o,h){const p=o.shadowRenderer;if(!p)return;const m=p.getShadowPassDepthMode(),g=p.getShadowPassColorMode(),x=p.calculateShadowPassMatrixFromMatrix(r),b=sc(x);o.getOrCreateProgram("modelDepth",{defines:o._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(o,o.context.gl.TRIANGLES,m,a.ah.disabled,g,a.ag.backCCW,b,h.id,u.vertexBuffer,u.indexBuffer,u.segments,h.paint,o.transform.zoom,void 0,void 0)}function Ao(u,r,o){const h=r.updateZoomBasedPaintProperties(),p=function(m,g,x){let b,w,T,E=m.terrain?m.terrain.exaggeration():0;if(m.terrain&&E>0){const O=m.terrain,z=O.findDEMTileFor(x);z&&z.dem?b=a.cm.create(O,x,z):E=0}if(E===0&&(g.terrainElevationMin=0,g.terrainElevationMax=0),E===g.validForExaggeration&&(E===0||b&&b._demTile&&b._demTile.tileID===g.validForDEMTile.id&&b._dem._timestamp===g.validForDEMTile.timestamp))return!1;for(const O in g.instancesPerModel){const z=g.instancesPerModel[O];for(let L=0;L<z.instancedDataArray.length;++L){const k=(b?E*b.getElevationAt(0|z.instancedDataArray.float32[16*L],0|z.instancedDataArray.float32[16*L+1],!0,!0):0)+z.instancesEvaluatedElevation[L];z.instancedDataArray.float32[16*L+6]=k,w=w?Math.min(g.terrainElevationMin,k):k,T=T?Math.max(g.terrainElevationMax,k):k}}return g.terrainElevationMin=w||0,g.terrainElevationMax=T||0,g.validForExaggeration=E,g.validForDEMTile=b&&b._demTile?{id:b._demTile.tileID,timestamp:b._dem._timestamp}:{id:void 0,timestamp:0},!0}(u,r,o);(h||p)&&(r.uploaded=!1,r.upload(u.context))}const Wr={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.b8([0,0,0],[a.a4,a.a4,0])};function To(u,r){const o=1<<u.canonical.z,h=r.getFreeCameraOptions().position,p=r.elevation,m=u.canonical.x/o,g=(u.canonical.x+1)/o,x=u.canonical.y/o,b=(u.canonical.y+1)/o;let w=r._centerAltitude;if(p){const z=p.getMinMaxForTile(u);z&&z.max>w&&(w=z.max)}const T=a.au(h.x,m,g)-h.x,E=a.au(h.y,x,b)-h.y,O=a.ay(w,r.center.lat)-h.z;return r._zoomFromMercatorZ(Math.sqrt(T*T+E*E+O*O))}function Nl(u,r,o,h,p,m,g){const x=u.context,b=u.renderPass==="shadow",w=u.shadowRenderer,T=b&&w?w.getShadowPassDepthMode():new a.af(x.gl.LEQUAL,a.af.ReadWrite,u.depthRangeFor3D),E=u.isTileAffectedByFog(m);if(o.meshes)for(const O of o.meshes){const z=["MODEL_POSITION_ON_GPU"],L=[];let k,B,F;h.instancedDataArray.length>20&&z.push("INSTANCED_ARRAYS");const $=Cr(u,r.paint.get("model-cutoff-fade-range"));if($.shouldRenderCutoff&&z.push("RENDER_CUTOFF"),b&&w)k=u.getOrCreateProgram("modelDepth",{defines:z}),B=sc(g.shadowTileMatrix,g.shadowTileMatrix,Float32Array.from(o.matrix)),F=w.getShadowPassColorMode();else{Ts(z,L,O,u,r.lut),k=u.getOrCreateProgram("model",{defines:z,overrideFog:E});const Z=O.material,K=Z.pbrMetallicRoughness,W=r.paint.get("model-opacity"),H=r.paint.get("model-emissive-strength").constantOr(0);B=Cs(m.expandedProjMatrix,Float32Array.from(o.matrix),new Float32Array(16),null,u,W,K.baseColorFactor.toRenderColor(null),Z.emissiveFactor,K.metallicFactor,K.roughnessFactor,Z,H,r,p),w&&(g.shadowUniformsInitialized?k.setShadowUniformValues(x,w.getShadowUniformValues()):(w.setupShadows(m.toUnwrapped(),k,"model-tile",m.overscaledZ),g.shadowUniformsInitialized=!0)),F=$.shouldRenderCutoff||W<1||Z.alphaMode!=="OPAQUE"?a.a.alphaBlended:a.a.unblended}u.uploadCommonUniforms(x,k,m.toUnwrapped(),null,$);const G=O.material.doubleSided?a.ag.disabled:a.ag.backCCW;if(h.instancedDataArray.length>20)L.push(h.instancedDataBuffer),k.draw(u,x.gl.TRIANGLES,T,a.ah.disabled,F,G,B,r.id,O.vertexBuffer,O.indexBuffer,O.segments,r.paint,u.transform.zoom,void 0,L,h.instancedDataArray.length);else{const Z=b?"u_instance":"u_normal_matrix";for(let K=0;K<h.instancedDataArray.length;++K)B[Z]=new Float32Array(h.instancedDataArray.arrayBuffer,64*K,16),k.draw(u,x.gl.TRIANGLES,T,a.ah.disabled,F,G,B,r.id,O.vertexBuffer,O.indexBuffer,O.segments,r.paint,u.transform.zoom,void 0,L)}}if(o.children)for(const O of o.children)Nl(u,r,O,h,p,m,g)}const Vl=[1,-1,1];function _r(u,r,o,h){if(!o.modelManager)return!0;const p=o.modelManager;if(!o.shadowRenderer)return!0;const m=o.shadowRenderer,g=r.aabb;let x=!0,b=u.maxHeight;if(b===0){let T=0;for(const E in u.instancesPerModel){const O=p.getModel(E,h);O?T=Math.max(T,Math.max(Math.max(O.aabb.max[0],O.aabb.max[1]),O.aabb.max[2])):x=!1}b=u.maxScale*T*1.41+u.maxVerticalOffset,x&&(u.maxHeight=b)}g.max[2]=b,g.min[2]+=u.terrainElevationMin,g.max[2]+=u.terrainElevationMax,a.$.transformMat4(g.min,g.min,r.tileMatrix),a.$.transformMat4(g.max,g.max,r.tileMatrix);const w=g.intersects(m.getCurrentCascadeFrustum());return o.currentShadowCascade===0&&(u.isInsideFirstShadowMapFrustum=w===2),w===0}function Pr(u,r){const o=u.uniformValues.u_cutoff_params[0],h=u.uniformValues.u_cutoff_params[1],p=u.uniformValues.u_cutoff_params[2],m=u.uniformValues.u_cutoff_params[3];return h===o||m===p?1:a.au(((r-o)/(h-o)-p)/(m-p),0,1)}function q3(u,r,o,h){if(r.pitch<20)return 1;const p=r.getWorldToCameraMatrix(),m=a.ae.multiply([],p,u),g=[...o.min,1];let x=a.aB.transformMat4([],g,m),b=x,w=x;g[1]=o.max[1],x=a.aB.transformMat4([],g,m),b=x[1]<b[1]?x:b,w=x[1]>w[1]?x:w,g[0]=o.max[0],x=a.aB.transformMat4([],g,m),b=x[1]<b[1]?x:b,w=x[1]>w[1]?x:w,g[1]=o.min[1],x=a.aB.transformMat4([],g,m),b=x[1]<b[1]?x:b,w=x[1]>w[1]?x:w;const T=a.au(h[0],0,1),E=100*r.pixelsPerMeter*a.au(h[1],0,1),O=a.au(h[2],0,1),z=a.$.lerp([],b,w,T),L=Math.tan(.5*r.fovX),k=-z[2]*L;if(E===0)return z[1]<-Math.abs(k)?O:1;const B=(-Math.abs(k)-z[1])/E,F=(G,Z,K)=>(1-K)*G+K*Z,$=a.au(F(1,O,B),O,1);return F(1,$,a.au((r.pitch-20)/20,0,1))}class ga{}class Vi{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,o,h){{const E=this._storage.get(o.id);if(E)return E.lastUsedFrameIdx=r,E.buf}const p=h.gl,m=p.getBufferParameter(p.ELEMENT_ARRAY_BUFFER,p.BUFFER_SIZE),g=new ArrayBuffer(m),x=new Int16Array(g);p.getBufferSubData(p.ELEMENT_ARRAY_BUFFER,0,new Int16Array(g));const b=new a.co;for(let E=0;E<m/2;E+=3){const O=x[E],z=x[E+1],L=x[E+2];b.emplaceBack(O,z),b.emplaceBack(z,L),b.emplaceBack(L,O)}const w=h.bindVertexArrayOES.current,T=new ga;return T.buf=new a.I(h,b),T.lastUsedFrameIdx=r,this._storage.set(o.id,T),h.bindVertexArrayOES.set(w),T.buf}update(r){for(const[o,h]of this._storage)r-h.lastUsedFrameIdx>30&&(h.buf.destroy(),this._storage.delete(o))}destroy(){for(const[r,o]of this._storage)o.buf.destroy(),this._storage.delete(r)}}class sn{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const an={symbol:function(u,r,o,h,p){if(u.renderPass!=="translucent")return;const m=a.ah.disabled,g=u.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(w,T,E,O,z,L,k){const B=T.transform,F=z==="map",$=L==="map";for(const G of w){const Z=O.getTile(G),K=Z.getBucket(E);if(!K||!K.text||!K.text.segments.get().length)continue;const W=a.aE(K.textSizeData,B.zoom),H=ac(G,K.getProjection(),B),te=B.calculatePixelsToTileUnitsMatrix(Z),re=no(H,Z.tileID.canonical,$,F,B,K.getProjection(),te),he=K.hasIconTextFit()&&K.hasIconData();if(W){const ne=Math.pow(2,B.zoom-Z.tileID.overscaledZ);Lh(K,F,$,k,a.bQ,B,re,G,ne,W,he)}}}(h,u,o,r,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),p);const x=o.paint.get("icon-opacity").constantOr(1)!==0,b=o.paint.get("text-opacity").constantOr(1)!==0;o.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(x||b)?vo(u,r,o,h,m,g):(x&&vo(u,r,o,h,m,g,{onlyIcons:!0}),b&&vo(u,r,o,h,m,g,{onlyText:!0})),r.map.showCollisionBoxes&&(V3(u,r,o,h,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),V3(u,r,o,h,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(u,r,o,h){if(u.renderPass!=="translucent")return;const p=o.paint.get("circle-opacity"),m=o.paint.get("circle-stroke-width"),g=o.paint.get("circle-stroke-opacity"),x=o.layout.get("circle-sort-key").constantOr(1)!==void 0,b=o.paint.get("circle-emissive-strength");if(p.constantOr(1)===0&&(m.constantOr(1)===0||g.constantOr(1)===0))return;const w=u.context,T=w.gl,E=u.transform,O=u.depthModeForSublayer(0,a.af.ReadOnly),z=a.ah.disabled,L=u.colorModeForDrapableLayerRenderPass(b),k=E.projection.name==="globe",B=[a.ak(E.center.lng),a.al(E.center.lat)],F=[];for(let G=0;G<h.length;G++){const Z=h[G],K=r.getTile(Z),W=K.getBucket(o);if(!W||W.projection.name!==E.projection.name)continue;const H=W.programConfigurations.get(o.id),te=a.bT(o),re=u.isTileAffectedByFog(Z);k&&te.push("PROJECTION_GLOBE_VIEW"),te.push("DEPTH_D24"),u.terrain&&E.depthOcclusionForSymbolsAndCircles&&te.push("DEPTH_OCCLUSION");const he=u.getOrCreateProgram("circle",{config:H,defines:te,overrideFog:re}),ne=W.layoutVertexBuffer,J=W.globeExtVertexBuffer,ge=W.indexBuffer,me=E.projection.createInversionMatrix(E,Z.canonical),oe={programConfiguration:H,program:he,layoutVertexBuffer:ne,globeExtVertexBuffer:J,indexBuffer:ge,uniformValues:a.bU(u,Z,K,me,B,o),tile:K};if(x){const Pe=W.segments.get();for(const Me of Pe)F.push({segments:new a.b([Me]),sortKey:Me.sortKey,state:oe})}else F.push({segments:W.segments,sortKey:0,state:oe})}x&&F.sort((G,Z)=>G.sortKey-Z.sortKey);const $={useDepthForOcclusion:E.depthOcclusionForSymbolsAndCircles};for(const G of F){const{programConfiguration:Z,program:K,layoutVertexBuffer:W,globeExtVertexBuffer:H,indexBuffer:te,uniformValues:re,tile:he}=G.state,ne=G.segments;u.terrain&&u.terrain.setupElevationDraw(he,K,$),u.uploadCommonUniforms(w,K,he.tileID.toUnwrapped()),K.draw(u,T.TRIANGLES,O,z,L,a.ag.disabled,re,o.id,W,te,ne,o.paint,E.zoom,Z,[H])}},heatmap:function(u,r,o,h){if(o.paint.get("heatmap-opacity")!==0)if(u.renderPass==="offscreen"){const p=u.context,m=p.gl,g=a.ah.disabled,x=new a.a([m.ONE,m.ONE,m.ONE,m.ONE],a.C.transparent,[!0,!0,!0,!0]);(function(z,L,k,B){const F=z.gl,$=L.width*B,G=L.height*B;z.activeTexture.set(F.TEXTURE1),z.viewport.set([0,0,$,G]);let Z=k.heatmapFbo;if(!Z||Z&&(Z.width!==$||Z.height!==G)){Z&&Z.destroy();const K=F.createTexture();F.bindTexture(F.TEXTURE_2D,K),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.LINEAR),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.LINEAR),Z=k.heatmapFbo=z.createFramebuffer($,G,!0,null),function(W,H,te,re,he,ne){const J=W.gl;J.texImage2D(J.TEXTURE_2D,0,W.extRenderToTextureHalfFloat?J.RGBA16F:J.RGBA,he,ne,0,J.RGBA,W.extRenderToTextureHalfFloat?J.HALF_FLOAT:J.UNSIGNED_BYTE,null),re.colorAttachment.set(te)}(z,0,K,Z,$,G)}else F.bindTexture(F.TEXTURE_2D,Z.colorAttachment.get()),z.bindFramebuffer.set(Z.framebuffer)})(p,u,o,u.transform.projection.name==="globe"?.5:.25),p.clear({color:a.C.transparent});const b=u.transform,w=b.projection.name==="globe",T=w?["PROJECTION_GLOBE_VIEW"]:[],E=w?a.ag.frontCCW:a.ag.disabled,O=[a.ak(b.center.lng),a.al(b.center.lat)];for(let z=0;z<h.length;z++){const L=h[z];if(r.hasRenderableParent(L))continue;const k=r.getTile(L),B=k.getBucket(o);if(!B||B.projection.name!==b.projection.name)continue;const F=u.isTileAffectedByFog(L),$=B.programConfigurations.get(o.id),G=u.getOrCreateProgram("heatmap",{config:$,defines:T,overrideFog:F}),{zoom:Z}=u.transform;u.terrain&&u.terrain.setupElevationDraw(k,G),u.uploadCommonUniforms(p,G,L.toUnwrapped());const K=b.projection.createInversionMatrix(b,L.canonical);G.draw(u,m.TRIANGLES,a.af.disabled,g,x,E,B3(u,L,k,K,O,Z,o.paint.get("heatmap-intensity")),o.id,B.layoutVertexBuffer,B.indexBuffer,B.segments,o.paint,u.transform.zoom,$,w?[B.globeExtVertexBuffer]:null)}p.viewport.set([0,0,u.width,u.height])}else u.renderPass==="translucent"&&(u.context.setColorMode(u.colorModeForRenderPass()),function(p,m){const g=p.context,x=g.gl,b=m.heatmapFbo;if(!b)return;g.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,b.colorAttachment.get()),g.activeTexture.set(x.TEXTURE1);let w=m.colorRampTexture;w||(w=m.colorRampTexture=new a.T(g,m.colorRamp,x.RGBA)),w.bind(x.LINEAR,x.CLAMP_TO_EDGE),p.getOrCreateProgram("heatmapTexture").draw(p,x.TRIANGLES,a.af.disabled,a.ah.disabled,p.colorModeForRenderPass(),a.ag.disabled,((T,E,O,z)=>({u_image:0,u_color_ramp:1,u_opacity:E.paint.get("heatmap-opacity")}))(0,m),m.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,m.paint,p.transform.zoom)}(u,o))},line:function(u,r,o,h){if(u.renderPass!=="translucent")return;const p=o.paint.get("line-opacity"),m=o.paint.get("line-width");if(p.constantOr(1)===0||m.constantOr(1)===0)return;const g=o.paint.get("line-emissive-strength"),x=o.paint.get("line-occlusion-opacity"),b=u.context,w=b.gl,T=o.layout.get("line-z-offset"),E=!T.isConstant()||!!T.constantOr(0),O=E?new a.af(u.depthOcclusion?w.GREATER:w.LEQUAL,a.af.ReadOnly,u.depthRangeFor3D):u.depthModeForSublayer(0,a.af.ReadOnly),z=u.colorModeForDrapableLayerRenderPass(g),L=u.terrain&&u.terrain.renderingToTexture,k=L?1:a.e.devicePixelRatio,B=o.paint.get("line-dasharray"),F=B.constantOr(1),$=o.layout.get("line-cap"),G=B.constantOr(null),Z=$.constantOr(null),K=o.paint.get("line-pattern"),W=K.constantOr(1),H=K.constantOr(null),te=o.paint.get("line-opacity").constantOr(1);let re=!W&&te!==1||u.depthOcclusion&&x>0&&x<1;const he=o.paint.get("line-gradient"),ne=W?"linePattern":"line",J=a.bV(o);let ge;if(L&&u.terrain&&u.terrain.clipOrMaskOverlapStencilType()&&(re=!1),x!==0&&u.depthOcclusion){const oe=o.paint._values["line-opacity"];oe&&oe.value&&oe.value.kind==="constant"?ge=oe.value:a.w(`Occlusion opacity for layer ${o.id} is supported only when line-opacity isn't data-driven.`)}if(E&&(u.forceTerrainMode=!0),!E&&x!==0&&u.terrain&&!L)return void a.w(`Occlusion opacity for layer ${o.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const me=re&&E?u.stencilModeFor3D():a.ah.disabled;for(const oe of h){const Pe=r.getTile(oe);if(W&&!Pe.patternsLoaded())continue;const Me=Pe.getBucket(o);if(!Me)continue;u.prepareDrawTile();const de=Me.programConfigurations.get(o.id),Ce=u.isTileAffectedByFog(oe),se=u.getOrCreateProgram(ne,{config:de,defines:E?[...J,"ELEVATED"]:J,overrideFog:Ce});if(H&&Pe.imageAtlas){const qe=Pe.imageAtlas.patternPositions[H.toString()];qe&&de.setConstantPatternPositions(qe)}if(!W&&G&&Z&&Pe.lineAtlas){const qe=Pe.lineAtlas.getDash(G,Z);qe&&de.setConstantPatternPositions(qe)}let[Se,Ie]=o.paint.get("line-trim-offset");(Z==="round"||Z==="square")&&Se!==Ie&&(Se===0&&(Se-=1),Ie===1&&(Ie+=1));const Ue=L?oe.projMatrix:null,$e=W?a.bW(u,Pe,o,Ue,k,[Se,Ie]):a.bX(u,Pe,o,Ue,Me.lineClipsArray.length,k,[Se,Ie]);if(he){const qe=Me.gradients[o.id];let ot=qe.texture;if(o.gradientVersion!==qe.version){let Ct=256;if(o.stepInterpolant){const ct=r.getSource().maxzoom,Tt=oe.canonical.z===ct?Math.ceil(1<<u.transform.maxZoom-oe.canonical.z):1;Ct=a.au(a.bY(Me.maxLineLength/a.a4*1024*Tt),256,b.maxTextureSize)}qe.gradient=a.bZ({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Ct,image:qe.gradient||void 0,clips:Me.lineClipsArray}),qe.texture?qe.texture.update(qe.gradient):qe.texture=new a.T(b,qe.gradient,w.RGBA),qe.version=o.gradientVersion,ot=qe.texture}b.activeTexture.set(w.TEXTURE1),ot.bind(o.stepInterpolant?w.NEAREST:w.LINEAR,w.CLAMP_TO_EDGE)}F&&(b.activeTexture.set(w.TEXTURE0),Pe.lineAtlasTexture&&Pe.lineAtlasTexture.bind(w.LINEAR,w.REPEAT),de.updatePaintBuffers()),W&&(b.activeTexture.set(w.TEXTURE0),Pe.imageAtlasTexture&&Pe.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),de.updatePaintBuffers()),E&&u.terrain.setupElevationDraw(Pe,se),u.uploadCommonUniforms(b,se,oe.toUnwrapped());const Je=qe=>{ge!=null&&(ge.value=te*x),se.draw(u,w.TRIANGLES,O,qe,z,a.ag.disabled,$e,o.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,o.paint,u.transform.zoom,de,[Me.layoutVertexBuffer2,Me.patternVertexBuffer,Me.zOffsetVertexBuffer]),ge!=null&&(ge.value=te)};if(re&&!E){const qe=u.stencilModeForClipping(oe).ref;qe===0&&L&&b.clear({stencil:0});const ot={func:w.EQUAL,mask:255};$e.u_alpha_discard_threshold=.8,Je(new a.ah(ot,qe,255,w.KEEP,w.KEEP,w.INVERT)),$e.u_alpha_discard_threshold=0,Je(new a.ah(ot,qe,255,w.KEEP,w.KEEP,w.KEEP))}else re&&E&&($e.u_alpha_discard_threshold=.001),Je(E?me:u.stencilModeForClipping(oe))}re&&(u.resetStencilClippingMasks(),L&&b.clear({stencil:0})),x===0||u.depthOcclusion||L||u.layersWithOcclusionOpacity.push(u.currentLayer),E&&(u.forceTerrainMode=!1)},fill:function(u,r,o,h){const p=o.paint.get("fill-color"),m=o.paint.get("fill-opacity");if(m.constantOr(1)===0)return;const g=o.paint.get("fill-emissive-strength"),x=u.colorModeForDrapableLayerRenderPass(g),b=o.paint.get("fill-pattern"),w=u.opaquePassEnabledForLayer()&&!b.constantOr(1)&&p.constantOr(a.C.transparent).a===1&&m.constantOr(0)===1?"opaque":"translucent";if(u.renderPass===w){const T=u.depthModeForSublayer(1,u.renderPass==="opaque"?a.af.ReadWrite:a.af.ReadOnly);Co(u,r,o,h,T,x,!1)}if(u.renderPass==="translucent"&&o.paint.get("fill-antialias")){const T=u.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,a.af.ReadOnly);Co(u,r,o,h,T,x,!0)}},"fill-extrusion":function(u,r,o,h){const p=o.paint.get("fill-extrusion-opacity"),m=u.context,g=m.gl,x=u.terrain,b=x&&x.renderingToTexture;if(p===0)return;const w=u.conflationActive&&u.style.isLayerClipped(o,r.getSource()),T=u.style.order.indexOf(o.fqid);if(w&&function(E,O,z,L,k){for(const B of L){const F=O.getTile(B).getBucket(z);F&&(F.updateReplacement(B,E.replacementSource,k),F.uploadCentroid(E.context))}}(u,r,o,h,T),x||w)for(const E of h){const O=r.getTile(E).getBucket(o);O&&kh(u.context,r,E,O,o,x,w)}if(u.renderPass==="shadow"&&u.shadowRenderer){const E=u.shadowRenderer;if(x&&p<.65&&o._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.Z)return;const O=E.getShadowPassDepthMode(),z=E.getShadowPassColorMode();ws(u,r,o,h,O,a.ah.disabled,z,w)}else if(u.renderPass==="translucent"){const E=!o.paint.get("fill-extrusion-pattern").constantOr(1),O=o.paint.get("fill-extrusion-color").constantOr(a.C.white);if(!b&&O.a!==0){const z=new a.af(u.context.gl.LEQUAL,a.af.ReadWrite,u.depthRangeFor3D);p===1&&E?ws(u,r,o,h,z,a.ah.disabled,a.a.unblended,w):(ws(u,r,o,h,z,a.ah.disabled,a.a.disabled,w),ws(u,r,o,h,z,u.stencilModeFor3D(),u.colorModeForRenderPass(),w),u.resetStencilClippingMasks())}if(u.style.enable3dLights()&&E&&(!x&&u.transform.projection.name!=="globe"||b)){const z=o.paint.get("fill-extrusion-opacity"),L=o.paint.get("fill-extrusion-ambient-occlusion-intensity"),k=o.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),B=o.paint.get("fill-extrusion-flood-light-intensity"),F=o.paint.get("fill-extrusion-flood-light-color").toRenderColor(o.lut).toArray01().slice(0,3),$=L>0&&k>0,G=B>0,Z=(W,H,te)=>(1-te)*W+te*H,K=W=>{const H=u.depthModeForSublayer(1,a.af.ReadOnly,g.LEQUAL,!0),te=o.paint.get(W?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),re=Z(.1,3,te),he=u._showOverdrawInspector;if(!he){const ne=new a.ah({func:g.ALWAYS,mask:255},255,255,g.KEEP,g.KEEP,g.REPLACE),J=new a.a([g.ONE,g.ONE,g.ONE,g.ONE],a.C.transparent,[!1,!1,!1,!0],g.MIN);pa(u,r,o,h,H,ne,J,a.ag.disabled,W,"sdf",z,L,k,B,F,re,w,!1)}{const ne=he?a.ah.disabled:new a.ah({func:g.EQUAL,mask:255},255,255,g.KEEP,g.DECR,g.DECR),J=he?u.colorModeForRenderPass():new a.a([g.ONE_MINUS_DST_ALPHA,g.DST_ALPHA,g.ONE,g.ONE],a.C.transparent,[!0,!0,!0,!0]);pa(u,r,o,h,H,ne,J,a.ag.disabled,W,"color",z,L,k,B,F,re,w,!1)}};if(b){const W=(H,te,re)=>{const he=u.depthModeForSublayer(1,a.af.ReadOnly,g.LEQUAL,!1),ne=o.paint.get(H?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),J=Z(.1,3,ne);{const ge=new a.a([g.ONE,g.ONE,g.ONE,g.ONE],a.C.transparent,[!1,!1,!1,!0]);pa(u,r,o,h,he,a.ah.disabled,ge,a.ag.disabled,H,"clear",z,L,k,B,F,J,w,te)}{const ge=new a.ah({func:g.ALWAYS,mask:255},255,255,g.KEEP,g.KEEP,g.REPLACE),me=new a.a([g.ONE,g.ONE,g.ONE,g.ONE],a.C.transparent,[!1,!1,!1,!0],g.MIN);pa(u,r,o,h,he,ge,me,a.ag.disabled,H,"sdf",z,L,k,B,F,J,w,te)}{const ge=H?g.ZERO:g.ONE_MINUS_DST_ALPHA,me=new a.ah({func:g.EQUAL,mask:255},255,255,g.KEEP,g.DECR,g.DECR),oe=new a.a([ge,g.DST_ALPHA,g.ONE_MINUS_DST_ALPHA,g.ZERO],a.C.transparent,[!0,!0,!0,!0]);pa(u,r,o,h,he,me,oe,a.ag.disabled,H,"color",z,L,k,B,F,J,w,te)}{const ge=new a.a([g.ONE,g.ONE,g.ONE,H?g.ZERO:g.ONE],a.C.transparent,[!1,!1,!1,!0],H?g.FUNC_ADD:g.MAX);pa(u,r,o,h,he,a.ah.disabled,ge,a.ag.disabled,H,"clear",z,L,k,B,F,J,w,te,re)}};if($||G){let H;if(u.prepareDrawTile(),x){const te=x.drapeBufferSize[0],re=x.drapeBufferSize[1];H=x.framebufferCopyTexture,H&&(!H||H.size[0]===te&&H.size[1]===re)||(H&&H.destroy(),H=x.framebufferCopyTexture=new a.T(m,new a.j({width:te,height:re}),g.RGBA)),H.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.copyTexImage2D(g.TEXTURE_2D,0,g.RGBA,0,0,te,re,0)}$&&W(!0,!1,H),G&&W(!1,!0,H)}}else $&&K(!0),G&&K(!1),($||G)&&u.resetStencilClippingMasks()}}},hillshade:function(u,r,o,h){if(u.renderPass!=="offscreen"&&u.renderPass!=="translucent"||u.style.disableElevatedTerrain)return;const p=u.context,m=u.terrain&&u.terrain.renderingToTexture,[g,x]=u.renderPass!=="translucent"||m?[{},h]:u.stencilConfigForOverlap(h);for(const b of x){const w=r.getTile(b);if(w.needsHillshadePrepare&&u.renderPass==="offscreen")Oh(u,w,o);else if(u.renderPass==="translucent"){const T=u.depthModeForSublayer(0,a.af.ReadOnly),E=o.paint.get("hillshade-emissive-strength"),O=u.colorModeForDrapableLayerRenderPass(E),z=m&&u.terrain?u.terrain.stencilModeForRTTOverlap(b):g[b.overscaledZ];Ph(u,b,w,o,T,z,O)}}p.viewport.set([0,0,u.width,u.height]),u.resetStencilClippingMasks()},raster:function(u,r,o,h,p,m){if(u.renderPass!=="translucent"||o.paint.get("raster-opacity")===0)return;const g=u.transform.projection.name==="globe",x=o.paint.get("raster-elevation")!==0,b=x&&g;if(u.renderElevatedRasterBackface&&!b)return;const w=u.context,T=w.gl,E=r.getSource(),O=function(W,H,te,re){const he=H.paint.get("raster-color"),ne=W.type==="raster-array",J=[],ge=H.paint.get("raster-resampling"),me=H.paint.get("raster-color-mix");let oe=H.paint.get("raster-color-range");const Pe=[me[0],me[1],me[2],0],Me=me[3];let de=ge==="nearest"?re.NEAREST:re.LINEAR;if(ne&&(J.push("RASTER_ARRAY"),he||J.push("RASTER_COLOR"),ge==="linear"&&J.push("RASTER_ARRAY_LINEAR"),de=re.NEAREST,!oe&&W.rasterLayers)){const Ce=W.rasterLayers.find(({id:se})=>se===H.sourceLayer);Ce&&Ce.fields&&Ce.fields.range&&(oe=Ce.fields.range)}if(oe=oe||[0,1],he){J.push("RASTER_COLOR"),te.activeTexture.set(re.TEXTURE2),H.updateColorRamp(oe);let Ce=H.colorRampTexture;Ce||(Ce=H.colorRampTexture=new a.T(te,H.colorRamp,re.RGBA)),Ce.bind(re.LINEAR,re.CLAMP_TO_EDGE)}return{mix:Pe,range:oe,offset:Me,defines:J,resampling:de}}(E,o,w,T);if(E instanceof a.bo&&!h.length&&!g)return;const z=o.paint.get("raster-emissive-strength"),L=u.colorModeForDrapableLayerRenderPass(z),k=u.terrain&&u.terrain.renderingToTexture,B=!u.options.moving,F=o.paint.get("raster-resampling")==="nearest"?T.NEAREST:T.LINEAR;if(E instanceof a.bo&&!h.length&&(E.onNorthPole||E.onSouthPole)){const W=x?u.stencilModeFor3D():a.ah.disabled;return void kl(!!E.onNorthPole,null,u,r,o,z,O,a.ag.disabled,W)}if(!h.length)return;const[$,G]=E instanceof a.bo||k?[{},h]:u.stencilConfigForOverlap(h),Z=G[G.length-1].overscaledZ;b&&O.defines.push("PROJECTION_GLOBE_VIEW"),x&&O.defines.push("RENDER_CUTOFF");const K=(W,H,te)=>{for(const re of W){const he=re.toUnwrapped(),ne=r.getTile(re);if(k&&(!ne||!ne.hasData()))continue;w.activeTexture.set(T.TEXTURE0);const J=As(ne,E,o,O);if(!J||!J.texture)continue;const{texture:ge,mix:me,offset:oe,tileSize:Pe,buffer:Me}=J;let de,Ce;k?(de=a.af.disabled,Ce=re.projMatrix):x?(de=new a.af(T.LEQUAL,a.af.ReadWrite,u.depthRangeFor3D),Ce=g?Float32Array.from(u.transform.expandedFarZProjMatrix):u.transform.calculateProjMatrix(he,B)):(de=u.depthModeForSublayer(re.overscaledZ-Z,o.paint.get("raster-opacity")===1?a.af.ReadWrite:a.af.ReadOnly,T.LESS),Ce=u.transform.calculateProjMatrix(he,B));const se=u.terrain&&k?u.terrain.stencilModeForRTTOverlap(re):$[re.overscaledZ],Se=m?0:o.paint.get("raster-fade-duration");ne.registerFadeDuration(Se);const Ie=r.findLoadedParent(re,0),Ue=Sl(ne,Ie,r,u.transform,Se);let $e,Je;u.terrain&&u.terrain.prepareDrawTile(),w.activeTexture.set(T.TEXTURE0),ge.bind(F,T.CLAMP_TO_EDGE),w.activeTexture.set(T.TEXTURE1),Ie?(Ie.texture&&Ie.texture.bind(F,T.CLAMP_TO_EDGE),$e=Math.pow(2,Ie.tileID.overscaledZ-ne.tileID.overscaledZ),Je=[ne.tileID.canonical.x*$e%1,ne.tileID.canonical.y*$e%1]):ge.bind(F,T.CLAMP_TO_EDGE),ge.useMipmap&&w.extTextureFilterAnisotropic&&u.transform.pitch>20&&T.texParameterf(T.TEXTURE_2D,w.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,w.extTextureFilterAnisotropicMax);const qe=u.transform;let ot;const Ct=x?lc(qe):[0,0,0,0];let ct,Tt,kt,hi,ai,Bt=0;if(b&&E instanceof a.bo&&E.coordinates.length>3)ct=Float32Array.from(a.bh(a.bi(new a.aO(0,0,0)))),Tt=Float32Array.from(qe.globeMatrix),kt=Float32Array.from(a.bd(qe)),hi=[a.ak(qe.center.lng),a.al(qe.center.lat)],ot=E.elevatedGlobePerspectiveTransform,ai=E.elevatedGlobeGridMatrix||new Float32Array(9);else if(b){const bt=a.be(re.canonical);Bt=a.bf(bt.getCenter().lat),ct=Float32Array.from(a.bh(a.bi(re.canonical))),Tt=Float32Array.from(qe.globeMatrix),kt=Float32Array.from(a.bd(qe)),hi=[a.ak(qe.center.lng),a.al(qe.center.lat)],ot=[0,0],ai=Float32Array.from(a.bg(re.canonical,bt,Bt,qe.worldSize/qe._pixelsPerMercatorPixel))}else ot=E instanceof a.bo?E.perspectiveTransform:[0,0],ct=new Float32Array(16),Tt=new Float32Array(9),kt=new Float32Array(16),hi=[0,0],ai=new Float32Array(9);const ni=Rl(Ce,ct,Tt,kt,ai,Je||[0,0],a.a2(u.transform.zoom),hi,Ct,$e||1,Ue,o,ot,x?o.paint.get("raster-elevation"):0,2,me,oe,O.range,Pe,Me,z),Et=u.isTileAffectedByFog(re),Ot=u.getOrCreateProgram("raster",{defines:O.defines,overrideFog:Et});if(u.uploadCommonUniforms(w,Ot,he),E instanceof a.bo){const bt=E.elevatedGlobeVertexBuffer,$t=E.elevatedGlobeIndexBuffer;if(k||!g)E.boundsBuffer&&E.boundsSegments&&Ot.draw(u,T.TRIANGLES,de,a.ah.disabled,L,a.ag.disabled,ni,o.id,E.boundsBuffer,u.quadTriangleIndexBuffer,E.boundsSegments);else if(bt&&$t){const zt=qe.zoom<=a.b3?E.elevatedGlobeSegments:E.getSegmentsForLongitude(qe.center.lng);zt&&Ot.draw(u,T.TRIANGLES,de,a.ah.disabled,L,H,ni,o.id,bt,$t,zt)}}else if(b){de=new a.af(T.LEQUAL,a.af.ReadOnly,u.depthRangeFor3D);const bt=u.globeSharedBuffers;if(bt){const[$t,zt,dt]=bt.getGridBuffers(Bt,!1);Ot.draw(u,T.TRIANGLES,de,te||se,u.colorModeForRenderPass(),H,ni,o.id,$t,zt,dt)}}else{const{tileBoundsBuffer:bt,tileBoundsIndexBuffer:$t,tileBoundsSegments:zt}=u.getTileBoundsBuffers(ne);Ot.draw(u,T.TRIANGLES,de,se,L,a.ag.disabled,ni,o.id,bt,$t,zt)}}if(!(E instanceof a.bo)&&b)for(const re of W){const he=re.canonical.y===(1<<re.canonical.z)-1;re.canonical.y===0&&kl(!0,re,u,r,o,z,O,H,te||a.ah.disabled),he&&kl(!1,re,u,r,o,z,O,H===a.ag.frontCW?a.ag.backCW:a.ag.frontCW,te||a.ah.disabled)}};b?K(G,u.renderElevatedRasterBackface?a.ag.backCW:a.ag.frontCW,u.stencilModeFor3D()):K(G,a.ag.disabled,void 0),u.resetStencilClippingMasks()},"raster-particle":function(u,r,o,h,p,m){u.renderPass==="offscreen"&&function(g,x,b,w){if(!w.length)return;const T=g.context,E=T.gl,O=x.getSource();if(!(O instanceof Kn))return;const z=Math.ceil(Math.sqrt(b.paint.get("raster-particle-count")));let L=b.particlePositionRGBAImage;if(!L||L.width!==z){const G=function(Z){const K=Z*Z,W=new Uint8Array(4*K),H=function(re){return re|=0,re=Math.imul(2747636419^re,2654435769),re=Math.imul(re^re>>>16,2654435769),((re=Math.imul(re^re>>>16,2654435769))>>>0)/4294967296},te=1/1.1;for(let re=0;re<K;re++){const he=te*(H(2*re+0)+fn),ne=te*(H(2*re+1)+fn),J=255*he%1,ge=255*ne%1,me=J,oe=ne-ge/255,Pe=ge;W[4*re+0]=255*(he-J/255),W[4*re+1]=255*me,W[4*re+2]=255*oe,W[4*re+3]=255*Pe}return W}(z);L=b.particlePositionRGBAImage=new a.j({width:z,height:z},G)}let k=b.particleFramebuffer;k?k.width!==z&&(k.destroy(),k=b.particleFramebuffer=T.createFramebuffer(z,z,!0,null)):k=b.particleFramebuffer=T.createFramebuffer(z,z,!0,null);const B=[];for(const G of w){const Z=x.getTile(G);if(!(Z instanceof a.c5))continue;const K=G3(Z,O,b);if(!K)continue;const W=[Z.tileSize,Z.tileSize];let H=b.tileFramebuffer;H||(H=b.tileFramebuffer=T.createFramebuffer(W[0],W[1],!0,null));let te=Z.rasterParticleState;te||(te=Z.rasterParticleState=new Xa(T,G,W,L));const re=te.update(b.lastInvalidatedAt);te.particleTextureDimension!==z&&te.updateParticleTexture(G,L);const he=te.targetColorTexture;te.targetColorTexture=te.backgroundColorTexture,te.backgroundColorTexture=he;const ne=te.particleTexture0;te.particleTexture0=te.particleTexture1,te.particleTexture1=ne,B.push([G,K,te,re])}if(B.length===0)return;const F=a.e.now(),$=b.previousDrawTimestamp?.001*(F-b.previousDrawTimestamp):.0167;if(b.previousDrawTimestamp=F,b.hasColorMap()){T.activeTexture.set(E.TEXTURE0+2);let G=b.colorRampTexture;G||(G=b.colorRampTexture=new a.T(T,b.colorRamp,E.RGBA)),G.bind(E.LINEAR,E.CLAMP_TO_EDGE)}T.bindFramebuffer.set(b.tileFramebuffer.framebuffer),function(G,Z,K){const W=G.context,H=W.gl,te=Z.tileFramebuffer;W.activeTexture.set(H.TEXTURE0);const re={u_texture:0,u_opacity:1.05*(ne=Z.paint.get("raster-particle-fade-opacity-factor"))/(ne+.05)},he=G.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ne;for(const J of K){const[,,ge,me]=J;te.colorAttachment.set(ge.targetColorTexture.texture),W.viewport.set([0,0,te.width,te.height]),W.clear({color:a.C.transparent}),me&&(ge.backgroundColorTexture.bind(H.NEAREST,H.CLAMP_TO_EDGE),he.draw(G,H.TRIANGLES,a.af.disabled,a.ah.disabled,a.a.alphaBlended,a.ag.disabled,re,Z.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments))}}(g,b,B),function(G,Z,K,W){const H=G.context,te=H.gl,re=K.tileFramebuffer,he=G.transform.projection.name==="globe",ne=K.paint.get("raster-particle-max-speed");for(const J of W){const[ge,me,oe]=J;H.activeTexture.set(te.TEXTURE0+0),me.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE),re.colorAttachment.set(oe.targetColorTexture.texture);const Pe=G.getOrCreateProgram("rasterParticleDraw",{defines:me.defines,overrideFog:!1});H.activeTexture.set(te.TEXTURE0+1);const Me=me.scalarData?[]:[0,1,2,3].map(se=>a.b$[se](ge));Me.push(ge);const de=ge.canonical.x,Ce=ge.canonical.y;for(const se of Me){const Se=Z.getTile(he?se.wrapped():se);if(!Se)continue;const Ie=Se.rasterParticleState;if(!Ie)continue;const Ue=se.canonical.x+(1<<se.canonical.z)*(se.wrap-ge.wrap),$e=se.canonical.y;Ie.particleTexture0.bind(te.NEAREST,te.CLAMP_TO_EDGE);const Je=Dh(1,Ie.particleTexture0.size[0],[Ue-de,$e-Ce],0,me.texture.size,2,ne,me.textureOffset,me.scale,me.offset);Pe.draw(G,te.POINTS,a.af.disabled,a.ah.disabled,a.a.alphaBlended,a.ag.disabled,Je,K.id,Ie.particleIndexBuffer,void 0,Ie.particleSegment)}}}(g,x,b,B),T.bindFramebuffer.set(b.particleFramebuffer.framebuffer),function(G,Z,K,W){const H=G.context,te=H.gl,re=Z.paint.get("raster-particle-max-speed"),he=W*Z.paint.get("raster-particle-speed-factor")*.15,ne=function(ge){return Math.pow(ge,6)}(.01+1*Z.paint.get("raster-particle-reset-rate-factor")),J=Z.particleFramebuffer;H.viewport.set([0,0,J.width,J.height]);for(const ge of K){const[,me,oe]=ge;H.activeTexture.set(te.TEXTURE0+0),me.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE),H.activeTexture.set(te.TEXTURE0+1);const Pe=oe.particleTexture0;Pe.bind(te.NEAREST,te.CLAMP_TO_EDGE);const Me=F3(1,Pe.size[0],0,me.texture.size,re,he,ne,me.textureOffset,me.scale,me.offset);J.colorAttachment.set(oe.particleTexture1.texture),H.clear({color:a.C.transparent}),G.getOrCreateProgram("rasterParticleUpdate",{defines:me.defines}).draw(G,te.TRIANGLES,a.af.disabled,a.ah.disabled,a.a.unblended,a.ag.disabled,Me,Z.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments)}}(g,b,B,$)}(u,r,o,h),u.renderPass==="translucent"&&(function(g,x,b,w,T){const E=g.context,O=E.gl,z=x.getSource().tileSize,L=5*(1-a.a0(a.aV,a.aV+1,g.transform.zoom))*z+b.paint.get("raster-particle-elevation"),k=!g.options.moving,B=g.transform.projection.name==="globe";if(!w.length)return;const[F,$]=g.stencilConfigForOverlap(w),G=[];B&&G.push("PROJECTION_GLOBE_VIEW");const Z=g.stencilModeFor3D();for(const K of $){const W=K.toUnwrapped(),H=x.getTile(K);if(!H.rasterParticleState)continue;const te=H.rasterParticleState,re=100;H.registerFadeDuration(re);const he=x.findLoadedParent(K,0),ne=Sl(H,he,x,g.transform,re);let J,ge;g.terrain&&g.terrain.prepareDrawTile(),E.activeTexture.set(O.TEXTURE0),te.targetColorTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),E.activeTexture.set(O.TEXTURE1),he&&he.rasterParticleState?(he.rasterParticleState.targetColorTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),J=Math.pow(2,he.tileID.overscaledZ-H.tileID.overscaledZ),ge=[H.tileID.canonical.x*J%1,H.tileID.canonical.y*J%1]):te.targetColorTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE);const me=B?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(W,k),oe=g.transform,Pe=Bl(oe),Me=a.be(K.canonical),de=a.bf(Me.getCenter().lat);let Ce,se,Se,Ie,Ue;B?(Ce=Float32Array.from(a.bh(a.bi(K.canonical))),se=Float32Array.from(oe.globeMatrix),Se=Float32Array.from(a.bd(oe)),Ie=[a.ak(oe.center.lng),a.al(oe.center.lat)],Ue=Float32Array.from(a.bg(K.canonical,Me,de,oe.worldSize/oe._pixelsPerMercatorPixel))):(Ce=new Float32Array(16),se=new Float32Array(9),Se=new Float32Array(16),Ie=[0,0],Ue=new Float32Array(9));const $e=vs(me,Ce,se,Se,Ue,ge||[0,0],a.a2(g.transform.zoom),Ie,Pe,J||1,ne,L),Je=g.isTileAffectedByFog(K),qe=g.getOrCreateProgram("rasterParticle",{defines:G,overrideFog:Je});if(g.uploadCommonUniforms(E,qe,W),B){const ot=new a.af(O.LEQUAL,a.af.ReadOnly,g.depthRangeFor3D),Ct=0,ct=g.globeSharedBuffers;if(ct){const[Tt,kt,hi]=ct.getGridBuffers(de,Ct!==0);qe.draw(g,O.TRIANGLES,ot,Z,a.a.alphaBlended,g.renderElevatedRasterBackface?a.ag.frontCCW:a.ag.backCCW,$e,b.id,Tt,kt,hi)}}else{const ot=g.depthModeForSublayer(0,a.af.ReadOnly),Ct=F[K.overscaledZ],{tileBoundsBuffer:ct,tileBoundsIndexBuffer:Tt,tileBoundsSegments:kt}=g.getTileBoundsBuffers(H);qe.draw(g,O.TRIANGLES,ot,Ct,a.a.alphaBlended,a.ag.disabled,$e,b.id,ct,Tt,kt)}}g.resetStencilClippingMasks()}(u,r,o,h),u.style.map.triggerRepaint())},background:function(u,r,o,h){const p=o.paint.get("background-color"),m=o.paint.get("background-opacity"),g=o.paint.get("background-emissive-strength");if(m===0)return;const x=u.context,b=x.gl,w=u.transform,T=w.tileSize,E=o.paint.get("background-pattern");let O;if(E!==void 0&&(E===null||(O=u.imageManager.getPattern(E.toString(),o.scope,u.style.getLut(o.scope)),!O)))return;const z=!E&&p.a===1&&m===1&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass!==z)return;const L=a.ah.disabled,k=u.depthModeForSublayer(0,z==="opaque"?a.af.ReadWrite:a.af.ReadOnly),B=u.colorModeForDrapableLayerRenderPass(g),F=E?"backgroundPattern":"background";let $,G=h;G||($=u.getBackgroundTiles(),G=Object.values($).map(Z=>Z.tileID)),E&&(x.activeTexture.set(b.TEXTURE0),u.imageManager.bind(u.context,o.scope));for(const Z of G){const K=u.isTileAffectedByFog(Z),W=u.getOrCreateProgram(F,{overrideFog:K}),H=Z.toUnwrapped(),te=h?Z.projMatrix:u.transform.calculateProjMatrix(H);u.prepareDrawTile();const re=r?r.getTile(Z):$?$[Z.key]:new a.bA(Z,T,w.zoom,u),he=E?Rh(te,g,m,u,0,o.scope,O,{tileID:Z,tileSize:T}):nc(te,g,m,p.toRenderColor(o.lut));u.uploadCommonUniforms(x,W,H);const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:J,tileBoundsSegments:ge}=u.getTileBoundsBuffers(re);W.draw(u,b.TRIANGLES,k,L,B,a.ag.disabled,he,o.id,ne,J,ge)}},sky:function(u,r,o){const h=u._atmosphere?a.a2(u.transform.zoom):1,p=o.paint.get("sky-opacity")*h;if(p===0)return;const m=u.context,g=o.paint.get("sky-type"),x=new a.af(m.gl.LEQUAL,a.af.ReadOnly,[0,1]),b=u.frameCounter/1e3%1;g==="atmosphere"?u.renderPass==="offscreen"?o.needsSkyboxCapture(u)&&(function(w,T,E,O){const z=w.context,L=z.gl;let k=T.skyboxFbo;if(!k){k=T.skyboxFbo=z.createFramebuffer(32,32,!0,null),T.skyboxGeometry=new Ye(z),T.skyboxTexture=z.gl.createTexture(),L.bindTexture(L.TEXTURE_CUBE_MAP,T.skyboxTexture),L.texParameteri(L.TEXTURE_CUBE_MAP,L.TEXTURE_WRAP_S,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_CUBE_MAP,L.TEXTURE_WRAP_T,L.CLAMP_TO_EDGE),L.texParameteri(L.TEXTURE_CUBE_MAP,L.TEXTURE_MIN_FILTER,L.LINEAR),L.texParameteri(L.TEXTURE_CUBE_MAP,L.TEXTURE_MAG_FILTER,L.LINEAR);for(let G=0;G<6;++G)L.texImage2D(L.TEXTURE_CUBE_MAP_POSITIVE_X+G,0,L.RGBA,32,32,0,L.RGBA,L.UNSIGNED_BYTE,null)}z.bindFramebuffer.set(k.framebuffer),z.viewport.set([0,0,32,32]);const B=T.getCenter(w,!0),F=w.getOrCreateProgram("skyboxCapture"),$=new Float64Array(16);a.ae.identity($),a.ae.rotateY($,$,.5*-Math.PI),Vt(w,T,F,$,B,0),a.ae.identity($),a.ae.rotateY($,$,.5*Math.PI),Vt(w,T,F,$,B,1),a.ae.identity($),a.ae.rotateX($,$,.5*-Math.PI),Vt(w,T,F,$,B,2),a.ae.identity($),a.ae.rotateX($,$,.5*Math.PI),Vt(w,T,F,$,B,3),a.ae.identity($),Vt(w,T,F,$,B,4),a.ae.identity($),a.ae.rotateY($,$,Math.PI),Vt(w,T,F,$,B,5),z.viewport.set([0,0,w.width,w.height])}(u,o),o.markSkyboxValid(u)):u.renderPass==="sky"&&function(w,T,E,O,z){const L=w.context,k=L.gl,B=w.transform,F=w.getOrCreateProgram("skybox");L.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,T.skyboxTexture);const $=((G,Z,K,W,H)=>({u_matrix:G,u_sun_direction:Z,u_cubemap:0,u_opacity:W,u_temporal_offset:H}))(B.skyboxMatrix,T.getCenter(w,!1),0,O,z);w.uploadCommonUniforms(L,F),F.draw(w,k.TRIANGLES,E,a.ah.disabled,w.colorModeForRenderPass(),a.ag.backCW,$,"skybox",T.skyboxGeometry.vertexBuffer,T.skyboxGeometry.indexBuffer,T.skyboxGeometry.segment)}(u,o,x,p,b):g==="gradient"&&u.renderPass==="sky"&&function(w,T,E,O,z){const L=w.context,k=L.gl,B=w.transform,F=w.getOrCreateProgram("skyboxGradient");T.skyboxGeometry||(T.skyboxGeometry=new Ye(L)),L.activeTexture.set(k.TEXTURE0);let $=T.colorRampTexture;$||($=T.colorRampTexture=new a.T(L,T.colorRamp,k.RGBA)),$.bind(k.LINEAR,k.CLAMP_TO_EDGE);const G=((Z,K,W,H,te)=>({u_matrix:Z,u_color_ramp:0,u_center_direction:K,u_radius:a.ac(W),u_opacity:H,u_temporal_offset:te}))(B.skyboxMatrix,T.getCenter(w,!1),T.paint.get("sky-gradient-radius"),O,z);w.uploadCommonUniforms(L,F),F.draw(w,k.TRIANGLES,E,a.ah.disabled,w.colorModeForRenderPass(),a.ag.backCW,G,"skyboxGradient",T.skyboxGeometry.vertexBuffer,T.skyboxGeometry.indexBuffer,T.skyboxGeometry.segment)}(u,o,x,p,b)},debug:function(u,r,o,h,p,m){for(let g=0;g<o.length;g++)if(p){const w=new a.C(h.r*.8,h.g*.8,h.b*.8,1);lt(u,r,o[g],h,-1,-1,m),lt(u,r,o[g],h,-1,1,m),lt(u,r,o[g],h,1,1,m),lt(u,r,o[g],h,1,-1,m),lt(u,r,o[g],w,0,0,m)}else lt(u,r,o[g],h,0,0,m)},custom:function(u,r,o,h){const p=u.context,m=o.implementation;if(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes("custom")||u.terrain&&(u.terrain.renderingToTexture||u.renderPass==="offscreen")&&o.isDraped(r)){if(u.renderPass==="offscreen"){const g=m.prerender;if(g){if(u.setCustomLayerDefaults(),p.setColorMode(u.colorModeForRenderPass()),u.transform.projection.name==="globe"){const x=u.transform.pointMerc;g.call(m,p.gl,u.transform.customLayerMatrix(),u.transform.getProjection(),u.transform.globeToMercatorMatrix(),a.a2(u.transform.zoom),[x.x,x.y],u.transform.pixelsPerMeterRatio)}else g.call(m,p.gl,u.transform.customLayerMatrix());p.setDirty(),u.setBaseState()}}else if(u.renderPass==="translucent"){if(u.terrain&&u.terrain.renderingToTexture){const x=m.renderToTile;if(x){const b=h[0].canonical,w=new a._(b.x+h[0].wrap*(1<<b.z),b.y,b.z);p.setDepthMode(a.af.disabled),p.setStencilMode(a.ah.disabled),p.setColorMode(u.colorModeForRenderPass()),u.setCustomLayerDefaults(),x.call(m,p.gl,w),p.setDirty(),u.setBaseState()}return}u.setCustomLayerDefaults(),p.setColorMode(u.colorModeForRenderPass()),p.setStencilMode(a.ah.disabled);const g=m.renderingMode==="3d"?new a.af(u.context.gl.LEQUAL,a.af.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,a.af.ReadOnly);if(p.setDepthMode(g),u.transform.projection.name==="globe"){const x=u.transform.pointMerc;m.render(p.gl,u.transform.customLayerMatrix(),u.transform.getProjection(),u.transform.globeToMercatorMatrix(),a.a2(u.transform.zoom),[x.x,x.y],u.transform.pixelsPerMeterRatio)}else m.render(p.gl,u.transform.customLayerMatrix());p.setDirty(),u.setBaseState(),p.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(u,r,o,h){if(u.renderPass==="opaque")return;const p=o.paint.get("model-opacity");if(p===0)return;const m=o.paint.get("model-cast-shadows");if(u.renderPass==="shadow"&&(!m||u.terrain&&p<.65&&o._transitionablePaint._values["model-opacity"].value.expression instanceof a.Z))return;const g=u.shadowRenderer,x=o.paint.get("model-receive-shadows");g&&(g.useNormalOffset=!0,x||(g.enabled=!1));const b=()=>{g&&(g.useNormalOffset=!0,x||(g.enabled=!0))},w=r.getSource();if(u.renderPass==="light-beam"&&w.type!=="batched-model")return;if(w.type==="vector"||w.type==="geojson")return function(F,$,G,Z,K){const W=F.transform;if(W.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${W.projection.name} projection is not yet implemented`);const H=W.getFreeCameraOptions().position;if(!F.modelManager)return;const te=F.modelManager;G.modelManager=te;const re=F.shadowRenderer;if(!G._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const he=G._unevaluatedLayout._values["model-id"],ne={...G.layout.get("model-id").parameters},J=F.style.order.indexOf(G.fqid);for(const ge of Z){const me=$.getTile(ge).getBucket(G);if(!me||me.projection.name!==W.projection.name)continue;const oe=me.getModelUris();oe&&!me.modelsRequested&&(te.addModelsFromBucket(oe,K),me.modelsRequested=!0);const Pe=To(ge,W);ne.zoom=Pe;const Me=he.possiblyEvaluate(ne);if(Ao(F,me,ge),Wr.shadowUniformsInitialized=!1,Wr.useSingleShadowCascade=!!re&&re.getMaxCascadeForTile(ge.toUnwrapped())===0,F.renderPass==="shadow"&&re){if(F.currentShadowCascade===1&&me.isInsideFirstShadowMapFrustum)continue;const se=W.calculatePosMatrix(ge.toUnwrapped(),W.worldSize);if(Wr.tileMatrix.set(se),Wr.shadowTileMatrix=Float32Array.from(re.calculateShadowPassMatrixFromMatrix(se)),Wr.aabb.min.fill(0),Wr.aabb.max[0]=Wr.aabb.max[1]=a.a4,Wr.aabb.max[2]=0,_r(me,Wr,F,G.scope))continue}const de=1<<ge.canonical.z,Ce=[((H.x-ge.wrap)*de-ge.canonical.x)*a.a4,(H.y*de-ge.canonical.y)*a.a4,H.z*de*a.a4];F.conflationActive&&Object.keys(me.instancesPerModel).length>0&&F.style.isLayerClipped(G,$.getSource())&&me.updateReplacement(ge,F.replacementSource,J,K)&&(me.uploaded=!1,me.upload(F.context));for(let se in me.instancesPerModel){const Se=me.instancesPerModel[se];Se.features.length>0&&(se=Me.evaluate(Se.features[0].feature,{}));const Ie=te.getModel(se,K);if(Ie&&Ie.uploaded)for(const Ue of Ie.nodes)Nl(F,G,Ue,Se,Ce,ge,Wr)}}}(u,r,o,h,w.type==="vector"?o.scope:""),void b();if(!w.loaded())return;if(w.type==="batched-model")return function(F,$,G,Z){G.resetLayerRenderingStats(F);const K=F.context,W=F.transform,H=F.style.fog,te=F.shadowRenderer;if(W.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${W.projection.name} projection is not yet implemented`);const re=F.transform.getFreeCameraOptions().position,he=a.$.scale([],[re.x,re.y,re.z],F.transform.worldSize);a.$.negate(he,he);const ne=a.ae.identity([]),J=a.ci(W.center.lat,W.zoom),ge=a.ae.fromScaling([],[1,1,1/J]);a.ae.translate(ne,ne,he);const me=G.paint.get("model-opacity"),oe=new a.af(K.gl.LEQUAL,a.af.ReadWrite,F.depthRangeFor3D),Pe=new a.af(K.gl.LEQUAL,a.af.ReadOnly,F.depthRangeFor3D),Me=new a.b8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),de=F.renderPass==="shadow",Ce=de&&te?te.getCurrentCascadeFrustum():W.getFrustum(W.scaleZoom(W.worldSize)),se=G.paint.get("model-front-cutoff"),Se=se[2]<1,Ie=Cr(F,G.paint.get("model-cutoff-fade-range")),Ue=G.getLayerRenderingStats();(function($e,Je,qe,ot){const Ct=$e.terrain?$e.terrain.exaggeration():0,ct=$e.transform.zoom;for(const Tt of ot){const kt=Je.getTile(Tt).getBucket(qe);kt&&($e.conflationActive&&kt.updateReplacement(Tt,$e.replacementSource),kt.evaluateScale($e,qe),$e.terrain&&Ct>0&&kt.elevationUpdate($e.terrain,Ct,Tt,qe.source),kt.needsReEvaluation($e,ct,qe)&&kt.evaluate(qe))}})(F,$,G,Z),function(){let $e,Je,qe;Se?($e=Z.length-1,Je=-1,qe=-1):($e=0,Je=Z.length,qe=1);for(let ot=$e;ot!==Je;ot+=qe){const Ct=Z[ot],ct=$.getTile(Ct).getBucket(G);if(!ct||!ct.uploaded)continue;let Tt=!1;te&&(Tt=te.getMaxCascadeForTile(Ct.toUnwrapped())===0);const kt=W.calculatePosMatrix(Ct.toUnwrapped(),W.worldSize),hi=ct.modelTraits,ai=[];for(const Bt of ct.getNodesInfo()){if(Bt.hiddenByReplacement||!Bt.node.meshes)continue;const ni=Bt.node;let Et=0;F.terrain&&ni.elevation&&(Et=ni.elevation*F.terrain.exaggeration());const Ot=Bt.evaluatedScale;if(Ot[0]<=1&&Ot[1]<=1&&Ot[2]<=1&&(()=>{const Ji=Bt.aabb;return Me.min=[...Ji.min],Me.max=[...Ji.max],Me.min[2]+=Et,Me.max[2]+=Et,a.$.transformMat4(Me.min,Me.min,kt),a.$.transformMat4(Me.max,Me.max,kt),Me})().intersects(Ce)===0)continue;const bt=[...kt],$t=ni.anchor?ni.anchor[0]:0,zt=ni.anchor?ni.anchor[1]:0;a.ae.translate(bt,bt,[$t*(Ot[0]-1),zt*(Ot[1]-1),Et]),a.$.exactEquals(Ot,a.cl)||a.ae.scale(bt,bt,Ot);const dt=a.ae.multiply([],bt,ni.matrix),Ri=a.ae.multiply([],W.expandedFarZProjMatrix,dt),Li=a.ae.multiply([],W.expandedFarZProjMatrix,bt),lr=a.aB.transformMat4([],[$t,zt,Et,1],Ri)[2];ni.hidden=!1;let cr=me;de||(Se&&(cr*=q3(bt,W,Bt.aabb,se)),cr*=Pr(Ie,lr)),cr!==0?ai.push({nodeInfo:Bt,depth:lr,opacity:cr,wvpForNode:Ri,wvpForTile:Li,nodeModelMatrix:dt,tileModelMatrix:bt}):ni.hidden=!0}de||ai.sort((Bt,ni)=>!Se||Bt.opacity===1&&ni.opacity===1?Bt.depth<ni.depth?-1:1:Bt.opacity===1?-1:ni.opacity===1?1:Bt.depth>ni.depth?-1:1);for(const Bt of ai){const ni=Bt.nodeInfo,Et=ni.node;let Ot=a.ae.multiply([],ge,Bt.tileModelMatrix);a.ae.multiply(Ot,ne,Ot);const bt=a.ae.invert([],Ot);a.ae.transpose(bt,bt),a.ae.scale(bt,bt,Vl),Ot=a.ae.multiply(Ot,Ot,Et.matrix);const $t=F.renderPass==="light-beam",zt=hi&a.cn.HasMapboxMeshFeatures,dt=zt?0:ni.evaluatedRMEA[0][2];for(let Ri=0;Ri<Et.meshes.length;++Ri){const Li=Et.meshes[Ri],lr=Ri===Et.lightMeshIndex;let cr=Bt.wvpForNode;if(lr){if(!$t&&!F.terrain&&F.shadowRenderer){F.currentLayer<F.firstLightBeamLayer&&(F.firstLightBeamLayer=F.currentLayer);continue}cr=Bt.wvpForTile}else if($t)continue;const Ji={defines:[]},ur=[];if(Ts(Ji.defines,ur,Li,F,G.lut),zt||Ji.defines.push("DIFFUSE_SHADED"),Tt&&Ji.defines.push("SHADOWS_SINGLE_CASCADE"),Ue&&(de?Ue.numRenderedVerticesInShadowPass+=Li.vertexArray.length:Ue.numRenderedVerticesInTransparentPass+=Li.vertexArray.length),de){pc(Li,Bt.nodeModelMatrix,F,G);continue}let Wi=null;if(H){const _e=_a(Bt.nodeModelMatrix,F.transform);if(Wi=new Float32Array(_e),W.projection.name!=="globe"){const Pn=Li.aabb.min,on=Li.aabb.max,[On,zn]=H.getOpacityForBounds(_e,Pn[0],Pn[1],on[0],on[1]);Ji.overrideFog=On>=qt||zn>=qt}}const Ki=Li.material;let Le;Ki.occlusionTexture&&Ki.occlusionTexture.offsetScale&&(Le=Ki.occlusionTexture.offsetScale,Ji.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!de&&te&&(te.useNormalOffset=!!Li.normalBuffer);const Qe=F.getOrCreateProgram("model",Ji);!de&&te&&te.setupShadowsFromMatrix(Bt.tileModelMatrix,Qe,te.useNormalOffset),F.uploadCommonUniforms(K,Qe,null,Wi);const gr=Ki.pbrMetallicRoughness;gr.metallicFactor=.9,gr.roughnessFactor=.5;const ci=Cs(new Float32Array(cr),new Float32Array(Ot),new Float32Array(bt),new Float32Array(Et.matrix),F,Bt.opacity,gr.baseColorFactor.toRenderColor(null),Ki.emissiveFactor,gr.metallicFactor,gr.roughnessFactor,Ki,dt,G,[0,0,0],Le);!lr&&(ni.hasTranslucentParts||Bt.opacity<1)&&Qe.draw(F,K.gl.TRIANGLES,oe,a.ah.disabled,a.a.disabled,a.ag.backCCW,ci,G.id,Li.vertexBuffer,Li.indexBuffer,Li.segments,G.paint,F.transform.zoom,void 0,ur),Qe.draw(F,K.gl.TRIANGLES,lr?Pe:oe,a.ah.disabled,lr||Bt.opacity<1||ni.hasTranslucentParts?a.a.alphaBlended:a.a.unblended,a.ag.backCCW,ci,G.id,Li.vertexBuffer,Li.indexBuffer,Li.segments,G.paint,F.transform.zoom,void 0,ur)}}}}()}(u,r,o,h),void b();if(w.type!=="model")return;const T=w.getModels(),E=[],O=u.transform.getFreeCameraOptions().position,z=a.$.scale([],[O.x,O.y,O.z],u.transform.worldSize);a.$.negate(z,z);const L=[],k=[];let B=0;for(const F of T){const $=o.paint.get("model-rotation").constantOr(null),G=o.paint.get("model-scale").constantOr(null),Z=o.paint.get("model-translation").constantOr(null);F.computeModelMatrix(u,$,G,Z,!0,!0,!1);const K=a.ae.identity([]),W=a.ci(F.position.lat,u.transform.zoom),H=a.ae.fromScaling([],[1,1,1/W]);a.ae.translate(K,K,z),E.push({zScaleMatrix:H,negCameraPosMatrix:K});for(const te of F.nodes)Si(u.transform,te,F.matrix,u.transform.expandedFarZProjMatrix,B,L,k);B++}if(L.sort((F,$)=>$.depth-F.depth),u.renderPass!=="shadow"){if(p===1)for(const F of k)ar(F,u,o,E[F.modelIndex],a.ah.disabled,u.colorModeForRenderPass());else{for(const F of k)ar(F,u,o,E[F.modelIndex],a.ah.disabled,a.a.disabled);for(const F of k)ar(F,u,o,E[F.modelIndex],u.stencilModeFor3D(),u.colorModeForRenderPass());u.resetStencilClippingMasks()}for(const F of L)ar(F,u,o,E[F.modelIndex],a.ah.disabled,u.colorModeForRenderPass());b()}else{for(const F of k)pc(F.mesh,F.nodeModelMatrix,u,o);for(const F of L)pc(F.mesh,F.nodeModelMatrix,u,o);b()}}},Zi={model:function(u,r,o){const h=r.getSource();if(!h.loaded())return;if(h.type==="vector"||h.type==="geojson")return void(o.modelManager&&o.modelManager.upload(o,h.type==="vector"?u.scope:""));if(h.type==="batched-model"||h.type!=="model")return;const p=h.getModels();for(const m of p)m.upload(o.context)},raster:function(u,r,o){const h=r.getSource();if(!(h instanceof Kn&&h.loaded()))return;const p=u.sourceLayer||h.rasterLayerIds&&h.rasterLayerIds[0];if(!p)return;const m=u.paint.get("raster-array-band")||h.getInitialBand(p);if(m==null)return;const g=r.getIds().map(x=>r.getTileByID(x));for(const x of g)x.updateNeeded(p,m)&&h.prepareTile(x,p,m)},"raster-particle":function(u,r,o){const h=r.getSource();if(!(h instanceof Kn&&h.loaded()))return;const p=u.sourceLayer||h.rasterLayerIds&&h.rasterLayerIds[0];if(!p)return;const m=u.paint.get("raster-particle-array-band")||h.getInitialBand(p);if(m==null)return;const g=r.getIds().map(x=>r.getTileByID(x));for(const x of g)x.updateNeeded(p,m)&&h.prepareTile(x,p,m)}};class fc{constructor(r,o,h,p){this.context=new Ws(r,o),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=p,this._timeStamp=a.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const m=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const x of m)this._debugParams.enabledLayers[x]=!0;p.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),p.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),p.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),p.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),p.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const x of m)p.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],x);this.occlusionParams=new sn(p),this.setup(),this.numSublayers=a.bx.maxUnderzooming+a.bx.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.cp,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new zh(this),this._wireframeDebugCache=new Vi,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const g=new a.j({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,g,r.RGBA)}updateTerrain(r,o){const h=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(h||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new sr(this,r));const p=this._terrain;this.transform.elevation=h?p:null,p.update(r,this.transform,o),this.transform.elevation&&!p.enabled&&(this.transform.elevation=null)}_updateFog(r){const o=r.fog;if(!o||this.transform.projection.name==="globe"||o.getOpacity(this.transform.pitch)<1||o.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[h,p]=o.getFovAdjustedRange(this.transform._fov);if(h>p)return void(this.transform.fogCullDistSq=null);const m=h+.78*(p-h);this.transform.fogCullDistSq=m*m}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new sr(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,o){if(this.width=r*a.e.devicePixelRatio,this.height=o*a.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style.order)this.style._mergedLayers[h].resize()}setup(){const r=this.context,o=new a.bv;o.emplaceBack(0,0),o.emplaceBack(a.a4,0),o.emplaceBack(0,a.a4),o.emplaceBack(a.a4,a.a4),this.tileExtentBuffer=r.createVertexBuffer(o,a.bt.members),this.tileExtentSegments=a.b.simpleSegment(0,0,4,2);const h=new a.bv;h.emplaceBack(0,0),h.emplaceBack(a.a4,0),h.emplaceBack(0,a.a4),h.emplaceBack(a.a4,a.a4),this.debugBuffer=r.createVertexBuffer(h,a.bt.members),this.debugSegments=a.b.simpleSegment(0,0,4,5);const p=new a.bv;p.emplaceBack(-1,-1),p.emplaceBack(1,-1),p.emplaceBack(-1,1),p.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(p,a.bt.members),this.viewportSegments=a.b.simpleSegment(0,0,4,2);const m=new a.cq;m.emplaceBack(0,0,0,0),m.emplaceBack(a.a4,0,a.a4,0),m.emplaceBack(0,a.a4,0,a.a4),m.emplaceBack(a.a4,a.a4,a.a4,a.a4),this.mercatorBoundsBuffer=r.createVertexBuffer(m,a.cr.members),this.mercatorBoundsSegments=a.b.simpleSegment(0,0,4,2);const g=new a.bw;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(g);const x=new a.cs;for(const w of[0,1,3,2,0])x.emplaceBack(w);this.debugIndexBuffer=r.createIndexBuffer(x),this.emptyTexture=new a.T(r,new a.j({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA),this.identityMat=a.ae.create();const b=this.context.gl;this.stencilClearMode=new a.ah({func:b.ALWAYS,mask:0},0,255,b.ZERO,b.ZERO,b.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,a.af.disabled,this.stencilClearMode,a.a.disabled,a.ag.disabled,po(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,o,h){if(!o||this.currentStencilSource===o.id||!r.isTileClipped()||!h||h.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let x=!1;for(const b of h)if(this._tileClippingMaskIDs[b.key]===void 0){x=!0;break}if(!x)return}this.currentStencilSource=o.id;const p=this.context,m=p.gl;this.nextStencilID+h.length>256&&this.clearStencil(),p.setColorMode(a.a.disabled),p.setDepthMode(a.af.disabled);const g=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of h){const b=o.getTile(x),w=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,{tileBoundsBuffer:T,tileBoundsIndexBuffer:E,tileBoundsSegments:O}=this.getTileBoundsBuffers(b);g.draw(this,m.TRIANGLES,a.af.disabled,new a.ah({func:m.ALWAYS,mask:0},w,255,m.KEEP,m.KEEP,m.REPLACE),a.a.disabled,a.ag.disabled,po(x.projMatrix),"$clipping",T,E,O)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,o=this.context.gl;return new a.ah({func:o.NOTEQUAL,mask:255},r,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const o=this.context.gl;return new a.ah({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(r){const o=this.context.gl,h=r.sort((g,x)=>x.overscaledZ-g.overscaledZ),p=h[h.length-1].overscaledZ,m=h[0].overscaledZ-p+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const g={};for(let x=0;x<m;x++)g[x+p]=new a.ah({func:o.GEQUAL,mask:255},x+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[g,h]}return[{[p]:a.ah.disabled},h]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new a.a([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new a.C(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.a.unblended:a.a.alphaBlended}colorModeForDrapableLayerRenderPass(r){const o=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new a.a([o.ONE,o.ONE_MINUS_SRC_ALPHA,o.CONSTANT_ALPHA,o.ONE_MINUS_SRC_ALPHA],new a.C(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,o,h,p=!1){if(this.depthOcclusion)return new a.af(this.context.gl.GREATER,a.af.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!p)return a.af.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new a.af(h||this.context.gl.LEQUAL,o,[m,m])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,o=Math.ceil(this.width),h=Math.ceil(this.height),p=this.context.bindFramebuffer.get(),m=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===o&&this.depthFBO.height===h||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),o!==0&&h!==0&&(this.depthFBO=new qn(this.context,o,h,!1,"texture"),this.depthTexture=new a.T(this.context,{width:o,height:h,data:null},r.DEPTH_STENCIL),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(p),r.bindTexture(r.TEXTURE_2D,m),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,o,h,0,0,o,h,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,o)=>r+o/this._fpsHistory.length,0))}render(r,o){const h=a.e.now();this._dt=h-this._timeStamp,this._timeStamp=h,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=o;const p=this.style._mergedLayers,m=this.style.order.filter(ne=>{const J=p[ne];return!(J.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[J.type]});let g=!1,x=!1;for(const ne of m){const J=p[ne];J.type==="circle"&&(g=!0),J.type==="symbol"&&(J.hasInitialOcclusionOpacityProperties?x=!0:g=!0)}const b=m.map(ne=>p[ne]),w=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(a.e.now()),this.imageManager.beginFrame();let T=0,E=!1;for(const ne in w){const J=w[ne];J.used&&(J.prepare(this.context),J.getSource().usedInConflation&&++T)}let O=!1;for(const ne of b)ne.isHidden(this.transform.zoom)||(ne.type==="clip"&&(O=!0),this.prepareLayer(ne));const z={},L={},k={},B={},F={};for(const ne in w){const J=w[ne];z[ne]=J.getVisibleCoordinates(),L[ne]=z[ne].slice().reverse(),k[ne]=J.getVisibleCoordinates(!0).reverse(),B[ne]=J.getShadowCasterCoordinates(),F[ne]=J.sortCoordinatesByDistance(z[ne])}const $=ne=>{const J=this.style.getLayerSourceCache(ne);return J&&J.used?J.getSource():null};if(T||O){const ne=[],J=[];let ge=0;for(const me of b)this.isSourceForClippingOrConflation(me,$(me))&&(ne.push(me),J.push(ge)),ge++;if(ne&&(O||ne.length>1)){const me=[];for(let oe=0;oe<ne.length;oe++){const Pe=ne[oe],Me=J[oe],de=this.style.getLayerSourceCache(Pe);if(!de||!de.used||!de.getSource().usedInConflation&&Pe.type!=="clip")continue;let Ce=a.cv,se=a.cw.None;const Se=[];if(Pe.type==="clip"){Ce=Me;for(const Ie of Pe.layout.get("clip-layer-types"))se|=Ie==="model"?a.cw.Model:Ie==="symbol"?a.cw.Symbol:a.cw.FillExtrusion;for(const Ie of Pe.layout.get("clip-layer-scope"))Se.push(Ie)}me.push({layer:Pe.fqid,cache:de,order:Ce,clipMask:se,clipScope:Se})}this.replacementSource.setSources(me),E=!0}}E||this.replacementSource.clear(),this.conflationActive=E,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ne=0;ne<b.length;ne++){const J=b[ne],ge=J.cutoffRange();if(this.longestCutoffRange=Math.max(ge,this.longestCutoffRange),ge>0){const me=$(J);me&&(this.minCutoffZoom=Math.max(me.minzoom,this.minCutoffZoom)),J.minzoom&&(this.minCutoffZoom=Math.max(J.minzoom,this.minCutoffZoom))}J.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ne),this._lastOcclusionLayer=ne)}const G=this.style&&this.style.fog;G?(this._fogVisible=G.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=G.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0);const Z=this._shadowRenderer;if(Z){Z.updateShadowParameters(this.transform,this.style.directionalLight);for(const ne in w)for(const J of z[ne]){let ge={min:0,max:0};this.terrain&&(ge=this.terrain.getMinMaxForTile(J)||ge),Z.addShadowReceiver(J.toUnwrapped(),ge.min,ge.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.ct(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new jl(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!a.cu(this.context.gl))return;this.renderPass="offscreen";for(const ne of b){const J=r.getLayerSourceCache(ne);if(!ne.hasOffscreenPass()||ne.isHidden(this.transform.zoom))continue;const ge=J?L[J.id]:void 0;(ne.type==="custom"||ne.type==="raster"||ne.type==="raster-particle"||ne.isSky()||ge&&ge.length)&&this.renderLayer(this,J,ne,ge)}this.depthRangeFor3D=[0,1-(b.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,B)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const K=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),W=(()=>{if(o.showOverdrawInspector)return a.C.black;const ne=this.style.fog;if(ne&&this.transform.projection.supportsFog){const J=this.style.getLut(ne.scope);if(!K){const ge=ne.properties.get("color").toRenderColor(J).toArray01();return new a.C(...ge)}if(K){const ge=ne.properties.get("space-color").toRenderColor(J).toArray01();return new a.C(...ge)}}return a.C.transparent})();if(this.context.clear({color:W,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&K&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const ne=b[this.currentLayer],J=r.getLayerSourceCache(ne);if(ne.isSky())continue;const ge=J?(ne.is3D()?F:L)[J.id]:void 0;this._renderTileClippingMasks(ne,J,ge),this.renderLayer(this,J,ne,ge)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&K&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.a2(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const ne=b[this.currentLayer],J=r.getLayerSourceCache(ne);ne.isSky()&&this.renderLayer(this,J,ne,J?L[J.id]:void 0)}function H(ne,J){let ge;return J&&(ge=(ne.type==="symbol"?k:ne.is3D()?F:L)[J.id]),ge}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<m.length;){const ne=b[this.currentLayer];if(ne.type==="raster"||ne.type==="raster-particle"){const J=r.getLayerSourceCache(ne);this.renderLayer(this,J,ne,H(ne,J))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let te=0;Z&&(te=Z.getShadowCastingLayerCount());let re=!1,he=-1;for(let ne=0;ne<m.length;++ne){const J=b[ne];J.isHidden(this.transform.zoom)||J.is3D()&&(he=ne)}for(x&&he===-1&&(g=!0);this.currentLayer<m.length;){const ne=b[this.currentLayer],J=r.getLayerSourceCache(ne);if(ne.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ne)){if(ne.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(g&&!re&&this.terrain&&!this.transform.isOrthographic&&(re=!0,this.blitDepth()),x&&he!==-1&&this.currentLayer===he+1&&!this.transform.isOrthographic&&this.blitDepth(),ne.is3D()||this.terrain||this._renderTileClippingMasks(ne,J,J?z[J.id]:void 0),this.renderLayer(this,J,ne,H(ne,J)),!this.terrain&&Z&&te>0&&ne.hasShadowPass()&&--te==0&&(Z.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const ge=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=ge;this.currentLayer++){const me=b[this.currentLayer];if(!me.hasLightBeamPass())continue;const oe=r.getLayerSourceCache(me);this.renderLayer(this,oe,me,oe?L[oe.id]:void 0)}this.currentLayer=ge,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const ge=this.currentLayer;this.depthOcclusion=!0;for(const me of this.layersWithOcclusionOpacity){this.currentLayer=me;const oe=b[this.currentLayer],Pe=r.getLayerSourceCache(oe),Me=Pe?L[Pe.id]:void 0;oe.is3D()||this.terrain||this._renderTileClippingMasks(oe,Pe,Pe?z[Pe.id]:void 0),this.renderLayer(this,Pe,oe,Me)}this.depthOcclusion=!1,this.currentLayer=ge,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ne=null;b.forEach(J=>{const ge=r.getLayerSourceCache(J);ge&&!J.isHidden(this.transform.zoom)&&ge.getVisibleCoordinates().length&&(!ne||ne.getSource().maxzoom<ge.getSource().maxzoom)&&(ne=ge)}),ne&&this.options.showTileBoundaries&&an.debug(this,ne,ne.getVisibleCoordinates(),a.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&an.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ne){const J=ne.transform.padding;hc(ne,ne.transform.height-(J.top||0),3,cc),hc(ne,J.bottom||0,3,Fl),wo(ne,J.left||0,3,uc),wo(ne,ne.transform.width-(J.right||0),3,Yt);const ge=ne.transform.centerPoint;(function(me,oe,Pe,Me){fa(me,oe-1,Pe-10,2,20,Me),fa(me,oe-10,Pe-1,20,2,Me)})(ne,ge.x,ne.transform.height-ge.y,Fh)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),E||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:o}=this.transform.projection,h=!o||!o.includes(r.type);if(Zi[r.type]&&(h||this.terrain&&r.type==="custom")){const p=this.style.getLayerSourceCache(r);Zi[r.type](r,p,this)}this.gpuTimingEnd()}renderLayer(r,o,h,p){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="sky"||h.type==="custom"||h.type==="model"||h.type==="raster"||h.type==="raster-particle"||p&&p.length)&&(this.id=h.id,this.gpuTimingStart(h),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(h.type)&&(!r.terrain||h.type!=="custom")||h.type==="clip"||an[h.type](r,o,h,p,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery,h=this.context.gl;let p=this.gpuTimers[r.id];p||(p=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:h.createQuery()}),p.calls++,h.beginQuery(o.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,o=this.context.gl,h=o.createQuery();this.deferredRenderGpuTimeQueries.push(h),o.beginQuery(r.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const o={};for(const h in r){const p=r[h],m=this.context.extTimerQuery,g=m.getQueryParameter(p.query,this.context.gl.QUERY_RESULT)/1e6;m.deleteQueryEXT(p.query),o[h]=g}return o}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const o=this.context.extTimerQuery,h=this.context.gl;let p=0;for(const m of r)p+=o.getQueryParameter(m,h.QUERY_RESULT)/1e6,o.deleteQueryEXT(m);return p}translatePosMatrix(r,o,h,p,m){if(!h[0]&&!h[1])return r;const g=m?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(g){const w=Math.sin(g),T=Math.cos(g);h=[h[0]*T-h[1]*w,h[0]*w+h[1]*T]}const x=[m?h[0]:a.bD(o,h[0],this.transform.zoom),m?h[1]:a.bD(o,h[1],this.transform.zoom),0],b=new Float32Array(16);return a.ae.translate(b,r,x),b}saveTileTexture(r){const o=r.size[0],h=this._tileTextures[o];h?h.push(r):this._tileTextures[o]=[r]}getTileTexture(r){const o=this._tileTextures[r];return o&&o.length>0?o.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,o,h){const p=h===void 0?this.terrain&&this.terrain.renderingToTexture:h,m=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(m.push("LIGHTING_3D_MODE"),m.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):p||m.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||m.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?m.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):m.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(m.push("TERRAIN"),this.linearFloatFilteringSupported()&&m.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&m.push("GLOBE"),!this._fogVisible||p||o!==void 0&&!o||m.push("FOG","FOG_DITHERING"),p&&m.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&m.push("OVERDRAW_INSPECTOR"),m}getOrCreateProgram(r,o){this.cache=this.cache||{};const h=o&&o.defines||[],p=o&&o.config,m=this.currentGlobalDefines(r,o&&o.overrideFog,o&&o.overrideRtt).concat(h),g=Q1.cacheKey(A3[r],r,m,p);return this.cache[g]||(this.cache[g]=new Q1(this.context,r,A3[r],p,j3[r],m)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,o){if(this.style.enable3dLights()){const h=this.style.directionalLight,p=this.style.ambientLight;if(h&&p){const m=((g,x,b)=>{const w=g.properties.get("direction"),T=g.properties.get("color").toRenderColor(b.getLut(g.scope)).toArray01(),E=g.properties.get("intensity"),O=x.properties.get("color").toRenderColor(b.getLut(x.scope)).toArray01(),z=x.properties.get("intensity"),L=[w.x,w.y,w.z],k=a.bC(O,z),B=a.bC(T,E);return{u_lighting_ambient_color:k,u_lighting_directional_dir:L,u_lighting_directional_color:B,u_ground_radiance:z3(L,B,k)}})(h,p,this.style);o.setLightsUniformValues(r,m)}}}uploadCommonUniforms(r,o,h,p,m){if(this.uploadCommonLightUniforms(r,o),this.terrain&&this.terrain.renderingToTexture)return;const g=this.style.fog;if(g){const x=g.getOpacity(this.transform.pitch),b=((w,T,E,O,z,L,k,B,F,$,G,Z)=>{const K=w.transform,W=T.properties.get("color").toRenderColor(w.style.getLut(T.scope)).toArray01();W[3]=O;const H=w.frameCounter/1e3%1,[te,re]=T.properties.get("vertical-range");return{u_fog_matrix:E?K.calculateFogTileMatrix(E):Z||w.identityMat,u_fog_range:T.getFovAdjustedRange(K._fov),u_fog_color:W,u_fog_horizon_blend:T.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(te,re),re],u_fog_temporal_offset:H,u_frustum_tl:z,u_frustum_tr:L,u_frustum_br:k,u_frustum_bl:B,u_globe_pos:F,u_globe_radius:$,u_viewport:G,u_globe_transition:a.a2(K.zoom),u_is_globe:+(K.projection.name==="globe")}})(this,g,h,x,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.e.devicePixelRatio,this.transform.height*a.e.devicePixelRatio],p);o.setFogUniformValues(r,b)}m&&o.setCutoffUniformValues(r,m.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,o=r.createTexture();return r.bindTexture(r.TEXTURE_2D,o),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),o}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,o=this._backgroundTiles={},h=this.transform.coveringTiles({tileSize:512});for(const p of h)o[p.key]=r[p.key]||new a.bA(p,512,this.transform.tileZoom,this);return o}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,o){return!(!r.is3D()||r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||r.sourceLayer!=="building")&&r.type!=="clip"&&(!o||o.type!=="batched-model"))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let o=this._cachedTileFogOpacities[r.key];return o||(this._cachedTileFogOpacities[r.key]=o=this.style.fog.getOpacityForTile(r)),o[0]>=qt||o[1]>=qt}setupDepthForOcclusion(r,o,h){const p=this.context,m=p.gl,g=!!h;var x;h||(h={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),p.activeTexture.set(m.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE),h.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],h.u_depth_range_unpack=[2/((x=this.depthRangeFor3D)[1]-x[0]),-1-2*x[0]/(x[1]-x[0])],h.u_occluder_half_size=.5*this.occlusionParams.occluderSize,h.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE),p.activeTexture.set(m.TEXTURE0),g||o.setTerrainUniformValues(p,h)}}class Or{constructor(r,o,h,p){this.screenBounds=r,this.cameraPoint=o,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=h,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,p)}static createFromScreenPoints(r,o){let h,p;if(r instanceof a.P||typeof r[0]=="number"){const m=a.P.convert(r);h=[m],p=o.isPointAboveHorizon(m)}else{const m=a.P.convert(r[0]),g=a.P.convert(r[1]);h=[m,g],p=a.cx(m,g).every(x=>o.isPointAboveHorizon(x))}return new Or(h,o.getCameraPoint(),p,o)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return a.cx(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const o=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],p=a.cx(o,h,0,!1);return this.cameraPoint.y>h.y&&(this.cameraPoint.x>o.x&&this.cameraPoint.x<h.x?p.splice(3,0,this.cameraPoint):this.cameraPoint.x>=h.x?p[2]=this.cameraPoint:this.cameraPoint.x<=o.x&&(p[3]=this.cameraPoint)),a.cy(p,r)}bufferedCameraGeometryGlobe(r){const o=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],p=a.cx(o,h,r),m=this.cameraPoint.clone();switch(3*((m.y>o.y)+(m.y>h.y))+((m.x>o.x)+(m.x>h.x))){case 0:p[0]=m,p[4]=m.clone();break;case 1:p.splice(1,0,m);break;case 2:p[1]=m;break;case 3:p.splice(4,0,m);break;case 5:p.splice(2,0,m);break;case 6:p[3]=m;break;case 7:p.splice(3,0,m);break;case 8:p[2]=m}return p}containsTile(r,o,h,p=0){const m=r.queryPadding/o._pixelsPerMercatorPixel+1,g=h?this._bufferedCameraMercator(m,o):this._bufferedScreenMercator(m,o);let x=r.tileID.wrap+(g.unwrapped?p:0);const b=g.polygon.map(B=>a.cz(r.tileTransform,B,x));if(!a.cA(b,0,0,a.a4,a.a4))return;x=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?p:0);const w=this.screenGeometryMercator.polygon.map(B=>a.cB(r.tileTransform,B,x)),T=w.map(B=>new a.P(B[0],B[1])),E=o.getFreeCameraOptions().position||new a._(0,0,0),O=a.cB(r.tileTransform,E,x),z=w.map(B=>{const F=a.$.sub(B,B,O);return a.$.normalize(F,F),new a.aU(O,F)}),L=a.bD(r,1,o.zoom)*o._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:T,tilespaceRays:z,bufferedTilespaceGeometry:b,bufferedTilespaceBounds:(k=a.cC(b),k.min.x=a.au(k.min.x,0,a.a4),k.min.y=a.au(k.min.y,0,a.a4),k.max.x=a.au(k.max.x,0,a.a4),k.max.y=a.au(k.max.y,0,a.a4),k),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:L};var k}_bufferedScreenMercator(r,o){const h=Qn(r);if(this._screenRaycastCache[h])return this._screenRaycastCache[h];{let p;return p=o.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),o):{polygon:this.bufferedScreenGeometry(r).map(m=>o.pointCoordinate3D(m)),unwrapped:!0},this._screenRaycastCache[h]=p,p}}_bufferedCameraMercator(r,o){const h=Qn(r);if(this._cameraRaycastCache[h])return this._cameraRaycastCache[h];{let p;return p=o.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),o):{polygon:this.bufferedCameraGeometry(r).map(m=>o.pointCoordinate3D(m)),unwrapped:!0},this._cameraRaycastCache[h]=p,p}}_projectAndResample(r,o){const h=function(m,g){const x=a.ae.multiply([],g.pixelMatrix,g.globeMatrix),b=[0,-a.cF,0,1],w=[0,a.cF,0,1],T=[0,0,0,1];a.aB.transformMat4(b,b,x),a.aB.transformMat4(w,w,x),a.aB.transformMat4(T,T,x);const E=new a.P(b[0]/b[3],b[1]/b[3]),O=new a.P(w[0]/w[3],w[1]/w[3]),z=a.cD(m,E)&&b[3]<T[3],L=a.cD(m,O)&&w[3]<T[3];if(!z&&!L)return null;const k=function(H,te,re){for(let he=1;he<H.length;he++){const ne=Mn(te.pointCoordinate3D(H[he-1]).x),J=Mn(te.pointCoordinate3D(H[he]).x);if(re<0){if(ne<J)return{idx:he,t:-ne/(J-1-ne)}}else if(J<ne)return{idx:he,t:(1-ne)/(J+1-ne)}}return null}(m,g,z?-1:1);if(!k)return null;const{idx:B,t:F}=k;let $=B>1?Ms(m.slice(0,B),g):[],G=B<m.length?Ms(m.slice(B),g):[];$=$.map(H=>new a.P(Mn(H.x),H.y)),G=G.map(H=>new a.P(Mn(H.x),H.y));const Z=[...$];Z.length===0&&Z.push(G[G.length-1]);const K=a.a3(Z[Z.length-1].y,(G.length===0?$[0]:G[0]).y,F);let W;return W=z?[new a.P(0,K),new a.P(0,0),new a.P(1,0),new a.P(1,K)]:[new a.P(1,K),new a.P(1,1),new a.P(0,1),new a.P(0,K)],Z.push(...W),G.length===0?Z.push($[0]):Z.push(...G),{polygon:Z.map(H=>new a._(H.x,H.y)),unwrapped:!1}}(r,o);if(h)return h;const p=function(m,g){let x=!1,b=-1/0,w=0;for(let E=0;E<m.length-1;E++)m[E].x>b&&(b=m[E].x,w=E);for(let E=0;E<m.length-1;E++){const O=(w+E)%(m.length-1),z=m[O],L=m[O+1];Math.abs(z.x-L.x)>.5&&(z.x<L.x?(z.x+=1,O===0&&(m[m.length-1].x+=1)):(L.x+=1,O+1===m.length-1&&(m[0].x+=1)),x=!0)}const T=a.ak(g.center.lng);return x&&T<Math.abs(T-1)&&m.forEach(E=>{E.x-=1}),{polygon:m,unwrapped:x}}(Ms(r,o).map(m=>new a.P(Mn(m.x),m.y)),o);return{polygon:p.polygon.map(m=>new a._(m.x,m.y)),unwrapped:p.unwrapped}}}function Ms(u,r){return a.cE(u,o=>{const h=r.pointCoordinate3D(o);o.x=h.x,o.y=h.y},1/256)}function Mn(u){return u<0?1+u%1:u%1}function Qn(u){return 100*u|0}function jh(u,r){const o=a.ae.identity([]);return a.ae.scale(o,o,[.5*u.width,.5*-u.height,1]),a.ae.translate(o,o,[1,-1,0]),a.ae.multiply(o,o,u.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(o)}function Sn(u,r,o,h,p,m,g,x=!1){const b=u.tilesIn(h,g,x);b.sort(mc);const w=[];for(const E of b)w.push({wrappedTileID:E.tile.tileID.wrapped().key,queryResults:E.tile.queryRenderedFeatures(r,o,u._state,E,p,m,jh(u.transform,E.tile.tileID),x)});const T=function(E){const O={},z={};for(const L of E){const k=L.queryResults,B=L.wrappedTileID,F=z[B]=z[B]||{};for(const $ in k){const G=k[$],Z=F[$]=F[$]||{},K=O[$]=O[$]||[];for(const W of G)Z[W.featureIndex]||(Z[W.featureIndex]=!0,K.push(W))}}return O}(w);for(const E in T)T[E].forEach(O=>{const z=O.feature,L=z.layer;L&&L.type!=="background"&&L.type!=="sky"&&L.type!=="slot"&&(z.source=L.source,L["source-layer"]&&(z.sourceLayer=L["source-layer"]),z.state=z.id!==void 0?u.getFeatureState(L["source-layer"],z.id):{})});return T}function Nh(u,r){const o=u.getRenderableIds().map(m=>u.getTileByID(m)),h=[],p={};for(let m=0;m<o.length;m++){const g=o[m],x=g.tileID.canonical.key;p[x]||(p[x]=!0,g.querySourceFeatures(h,r))}return h}function mc(u,r){const o=u.tileID,h=r.tileID;return o.overscaledZ-h.overscaledZ||o.canonical.y-h.canonical.y||o.wrap-h.wrap||o.canonical.x-h.canonical.x}class wr{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,o=!1;for(const h in this.style._mergedLayers){const p=this.style._mergedLayers[h];if(p.type==="fill-extrusion")this.layers.push({layer:p,visible:r,visibilityChanged:o});else if(p.type==="model"){const m=this.style.getLayerSource(p);m&&m.type==="batched-model"&&this.layers.push({layer:p,visible:r,visibilityChanged:o})}}}onNewFrame(r){this.layersGotHidden=!1;for(const o of this.layers){const h=o.layer;let p=!1;h.type==="fill-extrusion"?p=!h.isHidden(r)&&h.paint.get("fill-extrusion-opacity")>0:h.type==="model"&&(p=!h.isHidden(r)&&h.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!p&&o.visible,o.visible=p}}updateZOffset(r,o){this.currentBuildingBuckets=[];for(const p of this.layers){const m=p.layer,g=this.style.getLayerSourceCache(m);let x=1;m.type==="fill-extrusion"&&(x=p.visible?m.paint.get("fill-extrusion-vertical-scale"):0);let b=g?g.getTile(o):null;if(!b&&g&&o.canonical.z>g.getSource().minzoom){let w=o.scaledTo(Math.min(g.getSource().maxzoom,o.overscaledZ-1));for(;w.overscaledZ>=g.getSource().minzoom&&(b=g.getTile(w),!b&&w.overscaledZ!==0);)w=w.scaledTo(w.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:b?b.getBucket(m):null,tileID:b?b.tileID:o,verticalScale:x})}r.hasAnyZOffset=!1;let h=!1;for(let p=0;p<r.symbolInstances.length;p++){const m=r.symbolInstances.get(p),g=m.zOffset,x=this._getHeightAtTileOffset(o,m.tileAnchorX,m.tileAnchorY);m.zOffset=x!==Number.NEGATIVE_INFINITY?x:g,h||g===m.zOffset||(h=!0),r.hasAnyZOffset||m.zOffset===0||(r.hasAnyZOffset=!0)}h&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,o,h,p){let m=o,g=h;if(r.canonical.z!==p.canonical.z){const x=p.canonical,b=1/(1<<r.canonical.z-x.z);m=(o+r.canonical.x*a.a4)*b-x.x*a.a4|0,g=(h+r.canonical.y*a.a4)*b-x.y*a.a4|0}return{tileX:m,tileY:g}}_getHeightAtTileOffset(r,o,h){let p,m;for(let g=0;g<this.layers.length;++g){if(this.layers[g].layer.type!=="fill-extrusion")continue;const{bucket:x,tileID:b,verticalScale:w}=this.currentBuildingBuckets[g];if(!x)continue;const{tileX:T,tileY:E}=this._mapCoordToOverlappingTile(r,o,h,b),O=x.getHeightAtTileCoord(T,E);O&&O.height!==void 0&&(O.hidden?p=O.height:m=Math.max(O.height*w,m||0))}if(m!==void 0)return m;for(let g=0;g<this.layers.length;++g){const x=this.layers[g];if(x.layer.type!=="model"||!x.visible)continue;const{bucket:b,tileID:w}=this.currentBuildingBuckets[g];if(!b)continue;const{tileX:T,tileY:E}=this._mapCoordToOverlappingTile(r,o,h,w),O=b.getHeightAtTileCoord(T,E);if(O&&!O.hidden)return O.height===void 0&&p!==void 0?Math.min(O.maxHeight,p)*O.verticalScale:O.height?O.height*O.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Vh(u,r){const o={};for(const h in u)h!=="ref"&&(o[h]=u[h]);return a.cG.forEach(h=>{h in r&&(o[h]=r[h])}),o}function Mo(u){u=u.slice();const r=Object.create(null);for(let o=0;o<u.length;o++)r[u[o].id]=u[o];for(let o=0;o<u.length;o++)"ref"in u[o]&&(u[o]=Vh(u[o],r[u[o].ref]));return u}const Jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function ya(u,r,o){o.push({command:Jt.addSource,args:[u,r[u]]})}function W3(u,r,o){r.push({command:Jt.removeSource,args:[u]}),o[u]=!0}function Uh(u,r,o,h){W3(u,o,h),ya(u,r,o)}function So(u,r,o){let h;for(h in u[o])if(u[o].hasOwnProperty(h)&&h!=="data"&&!a.d(u[o][h],r[o][h]))return!1;for(h in r[o])if(r[o].hasOwnProperty(h)&&h!=="data"&&!a.d(u[o][h],r[o][h]))return!1;return!0}function es(u,r,o,h,p,m){let g;for(g in r=r||{},u=u||{})u.hasOwnProperty(g)&&(a.d(u[g],r[g])||o.push({command:m,args:[h,g,r[g],p]}));for(g in r)r.hasOwnProperty(g)&&!u.hasOwnProperty(g)&&(a.d(u[g],r[g])||o.push({command:m,args:[h,g,r[g],p]}))}function Ul(u){return u.id}function En(u,r){return u[r.id]=r,u}class H3{constructor(r,o){this.reset(r,o)}reset(r,o){this.points=r||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=a.au(r,0,1);let o=1,h=this._distances[o];const p=r*this.paddedLength+this.padding;for(;h<p&&o<this._distances.length;)h=this._distances[++o];const m=o-1,g=this._distances[m],x=h-g,b=x>0?(p-g)/x:0;return this.points[m].mult(1-b).add(this.points[o].mult(b))}}class Eo{constructor(r,o,h){const p=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(r/h),this.yCellCount=Math.ceil(o/h);for(let g=0;g<this.xCellCount*this.yCellCount;g++)p.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=o,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,o,h,p,m){this._forEachCell(o,h,p,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(m)}insertCircle(r,o,h,p){this._forEachCell(o-p,h-p,o+p,h+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(o),this.circles.push(h),this.circles.push(p)}_insertBoxCell(r,o,h,p,m,g){this.boxCells[m].push(g)}_insertCircleCell(r,o,h,p,m,g){this.circleCells[m].push(g)}_query(r,o,h,p,m,g){if(h<0||r>this.width||p<0||o>this.height)return!m&&[];const x=[];if(r<=0&&o<=0&&this.width<=h&&this.height<=p){if(m)return!0;for(let b=0;b<this.boxKeys.length;b++)x.push({key:this.boxKeys[b],x1:this.bboxes[4*b],y1:this.bboxes[4*b+1],x2:this.bboxes[4*b+2],y2:this.bboxes[4*b+3]});for(let b=0;b<this.circleKeys.length;b++){const w=this.circles[3*b],T=this.circles[3*b+1],E=this.circles[3*b+2];x.push({key:this.circleKeys[b],x1:w-E,y1:T-E,x2:w+E,y2:T+E})}return g?x.filter(g):x}return this._forEachCell(r,o,h,p,this._queryCell,x,{hitTest:m,seenUids:{box:{},circle:{}}},g),m?x.length>0:x}_queryCircle(r,o,h,p,m){const g=r-h,x=r+h,b=o-h,w=o+h;if(x<0||g>this.width||w<0||b>this.height)return!p&&[];const T=[];return this._forEachCell(g,b,x,w,this._queryCellCircle,T,{hitTest:p,circle:{x:r,y:o,radius:h},seenUids:{box:{},circle:{}}},m),p?T.length>0:T}query(r,o,h,p,m){return this._query(r,o,h,p,!1,m)}hitTest(r,o,h,p,m){return this._query(r,o,h,p,!0,m)}hitTestCircle(r,o,h,p){return this._queryCircle(r,o,h,!0,p)}_queryCell(r,o,h,p,m,g,x,b){const w=x.seenUids,T=this.boxCells[m];if(T!==null){const O=this.bboxes;for(const z of T)if(!w.box[z]){w.box[z]=!0;const L=4*z;if(r<=O[L+2]&&o<=O[L+3]&&h>=O[L+0]&&p>=O[L+1]&&(!b||b(this.boxKeys[z]))){if(x.hitTest)return g.push(!0),!0;g.push({key:this.boxKeys[z],x1:O[L],y1:O[L+1],x2:O[L+2],y2:O[L+3]})}}}const E=this.circleCells[m];if(E!==null){const O=this.circles;for(const z of E)if(!w.circle[z]){w.circle[z]=!0;const L=3*z;if(this._circleAndRectCollide(O[L],O[L+1],O[L+2],r,o,h,p)&&(!b||b(this.circleKeys[z]))){if(x.hitTest)return g.push(!0),!0;{const k=O[L],B=O[L+1],F=O[L+2];g.push({key:this.circleKeys[z],x1:k-F,y1:B-F,x2:k+F,y2:B+F})}}}}}_queryCellCircle(r,o,h,p,m,g,x,b){const w=x.circle,T=x.seenUids,E=this.boxCells[m];if(E!==null){const z=this.bboxes;for(const L of E)if(!T.box[L]){T.box[L]=!0;const k=4*L;if(this._circleAndRectCollide(w.x,w.y,w.radius,z[k+0],z[k+1],z[k+2],z[k+3])&&(!b||b(this.boxKeys[L])))return g.push(!0),!0}}const O=this.circleCells[m];if(O!==null){const z=this.circles;for(const L of O)if(!T.circle[L]){T.circle[L]=!0;const k=3*L;if(this._circlesCollide(z[k],z[k+1],z[k+2],w.x,w.y,w.radius)&&(!b||b(this.circleKeys[L])))return g.push(!0),!0}}}_forEachCell(r,o,h,p,m,g,x,b){const w=this._convertToXCellCoord(r),T=this._convertToYCellCoord(o),E=this._convertToXCellCoord(h),O=this._convertToYCellCoord(p);for(let z=w;z<=E;z++)for(let L=T;L<=O;L++)if(m.call(this,r,o,h,p,this.xCellCount*L+z,g,x,b))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,o,h,p,m,g){const x=p-r,b=m-o,w=h+g;return w*w>x*x+b*b}_circleAndRectCollide(r,o,h,p,m,g,x){const b=(g-p)/2,w=Math.abs(r-(p+b));if(w>b+h)return!1;const T=(x-m)/2,E=Math.abs(o-(m+T));if(E>T+h)return!1;if(w<=b||E<=T)return!0;const O=w-b,z=E-T;return O*O+z*z<=h*h}}const or=100;class Zh{constructor(r,o,h=new Eo(r.width+200,r.height+200,25),p=new Eo(r.width+200,r.height+200,25)){this.transform=r,this.grid=h,this.ignoredGrid=p,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+or,this.screenBottomBoundary=r.height+or,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=o}placeCollisionBox(r,o,h,p,m,g,x,b){let w=h.projectedAnchorX,T=h.projectedAnchorY,E=h.projectedAnchorZ;const O=h.elevation,z=h.tileID,L=r.getProjection();if(O&&z){const[W,H,te]=L.upVector(z.canonical,h.tileAnchorX,h.tileAnchorY),re=L.upVectorScale(z.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;w+=W*O*re,T+=H*O*re,E+=te*O*re}const k=this.projectAndGetPerspectiveRatio(x,w,T,E,h.tileID,L.name==="globe"||!!O||this.transform.pitch>0,L),B=g*k.perspectiveRatio,F=(h.x1*o+p.x-h.padding)*B+k.point.x,$=(h.y1*o+p.y-h.padding)*B+k.point.y,G=(h.x2*o+p.x+h.padding)*B+k.point.x,Z=(h.y2*o+p.y+h.padding)*B+k.point.y,K=k.perspectiveRatio<=.55||k.occluded;return!this.isInsideGrid(F,$,G,Z)||!m&&this.grid.hitTest(F,$,G,Z,b)||K?{box:[],offscreen:!1,occluded:k.occluded}:{box:[F,$,G,Z],offscreen:this.isOffscreen(F,$,G,Z),occluded:!1}}placeCollisionCircles(r,o,h,p,m,g,x,b,w,T,E,O,z,L,k){const B=[],F=this.transform.elevation,$=r.getProjection(),G=F?F.getAtTileOffsetFunc(k,this.transform.center.lat,this.transform.worldSize,$):null,Z=new a.P(h.tileAnchorX,h.tileAnchorY);let{x:K,y:W,z:H}=$.projectTilePoint(Z.x,Z.y,k.canonical);if(G){const[Me,de,Ce]=G(Z);K+=Me,W+=de,H+=Ce}const te=$.name==="globe",re=this.projectAndGetPerspectiveRatio(x,K,W,H,k,te||!!F||this.transform.pitch>0,$),{perspectiveRatio:he}=re,ne=(E?g/he:g*he)/a.bP,J=nn(K,W,H,b),ge=re.signedDistanceFromCamera>0?so(ne,m,h.lineOffsetX*ne,h.lineOffsetY*ne,!1,J,Z,h,p,b,{},F&&!E?G:null,E&&!!F,$,k,E):null;let me=!1,oe=!1,Pe=!0;if(ge&&!re.occluded){const Me=.5*z*he+L,de=new a.P(-100,-100),Ce=new a.P(this.screenRightBoundary,this.screenBottomBoundary),se=new H3,{first:Se,last:Ie}=ge,Ue=Se.path.length;let $e=[];for(let ot=Ue-1;ot>=1;ot--)$e.push(Se.path[ot]);for(let ot=1;ot<Ie.path.length;ot++)$e.push(Ie.path[ot]);const Je=2.5*Me;w&&($e=$e.map(([ot,Ct,ct],Tt)=>(G&&!te&&(ct=G(Tt<Ue-1?Se.tilePath[Ue-1-Tt]:Ie.tilePath[Tt-Ue+2])[2]),nn(ot,Ct,ct,w))),$e.some(ot=>ot[3]<=0)&&($e=[]));let qe=[];if($e.length>0){let ot=1/0,Ct=-1/0,ct=1/0,Tt=-1/0;for(const kt of $e)ot=Math.min(ot,kt[0]),ct=Math.min(ct,kt[1]),Ct=Math.max(Ct,kt[0]),Tt=Math.max(Tt,kt[1]);Ct>=de.x&&ot<=Ce.x&&Tt>=de.y&&ct<=Ce.y&&(qe=[$e.map(kt=>new a.P(kt[0],kt[1]))],(ot<de.x||Ct>Ce.x||ct<de.y||Tt>Ce.y)&&(qe=a.cH(qe,de.x,de.y,Ce.x,Ce.y)))}for(const ot of qe){se.reset(ot,.25*Me);let Ct=0;Ct=se.length<=.5*Me?1:Math.ceil(se.paddedLength/Je)+1;for(let ct=0;ct<Ct;ct++){const Tt=ct/Math.max(Ct-1,1),kt=se.lerp(Tt),hi=kt.x+or,ai=kt.y+or;B.push(hi,ai,Me,0);const Bt=hi-Me,ni=ai-Me,Et=hi+Me,Ot=ai+Me;if(Pe=Pe&&this.isOffscreen(Bt,ni,Et,Ot),oe=oe||this.isInsideGrid(Bt,ni,Et,Ot),!o&&this.grid.hitTestCircle(hi,ai,Me,O)&&(me=!0,!T))return{circles:[],offscreen:!1,collisionDetected:me,occluded:!1}}}}return{circles:!T&&me||!oe?[]:B,offscreen:Pe,collisionDetected:me,occluded:re.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let h=1/0,p=1/0,m=-1/0,g=-1/0;for(const T of r){const E=new a.P(T.x+or,T.y+or);h=Math.min(h,E.x),p=Math.min(p,E.y),m=Math.max(m,E.x),g=Math.max(g,E.y),o.push(E)}const x=this.grid.query(h,p,m,g).concat(this.ignoredGrid.query(h,p,m,g)),b={},w={};for(const T of x){const E=T.key;if(b[E.bucketInstanceId]===void 0&&(b[E.bucketInstanceId]={}),b[E.bucketInstanceId][E.featureIndex])continue;const O=[new a.P(T.x1,T.y1),new a.P(T.x2,T.y1),new a.P(T.x2,T.y2),new a.P(T.x1,T.y2)];a.cI(o,O)&&(b[E.bucketInstanceId][E.featureIndex]=!0,w[E.bucketInstanceId]===void 0&&(w[E.bucketInstanceId]=[]),w[E.bucketInstanceId].push(E.featureIndex))}return w}insertCollisionBox(r,o,h,p,m){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:p,collisionGroupID:m},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,o,h,p,m){const g=o?this.ignoredGrid:this.grid,x={bucketInstanceId:h,featureIndex:p,collisionGroupID:m};for(let b=0;b<r.length;b+=4)g.insertCircle(x,r[b],r[b+1],r[b+2])}projectAndGetPerspectiveRatio(r,o,h,p,m,g,x){const b=[o,h,p,1];let w=!1;p||this.transform.pitch>0?(a.aB.transformMat4(b,b,r),this.fogState&&m&&x.name!=="globe"&&(w=function(O,z,L,k,B,F){const $=F.calculateFogTileMatrix(B),G=[z,L,k];return a.$.transformMat4(G,G,$),jt(O,a.$.length(G),F.pitch,F._fov)}(this.fogState,o,h,p,m.toUnwrapped(),this.transform)>.9)):X1(b,b,r);const T=b[3];return{point:new a.P((b[0]/T+1)/2*this.transform.width+or,(-b[1]/T+1)/2*this.transform.height+or),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(x)/T*.5,1.5),signedDistanceFromCamera:T,occluded:g&&b[2]>T||w}}isOffscreen(r,o,h,p){return h<or||r>=this.screenRightBoundary||p<or||o>this.screenBottomBoundary}isInsideGrid(r,o,h,p){return h>=0&&r<this.gridRightBoundary&&p>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const r=a.ae.identity([]);return a.ae.translate(r,r,[-100,-100,0]),r}}class X3{constructor(r,o,h,p){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?o:-o))):p&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class Io{constructor(r,o,h,p,m,g=!1){this.text=new X3(r?r.text:null,o,h,m),this.icon=new X3(r?r.icon:null,o,p,m),this.clipped=g}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zl{constructor(r,o,h,p=!1){this.text=r,this.icon=o,this.skipFade=h,this.clipped=p}}class $h{constructor(){this.invProjMatrix=a.ae.create(),this.viewportMatrix=a.ae.create(),this.circles=[]}}class _c{constructor(r,o,h,p,m){this.bucketInstanceId=r,this.featureIndex=o,this.sourceLayerIndex=h,this.bucketIndex=p,this.tileID=m}}class Y3{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const o=++this.maxGroupID;this.collisionGroups[r]={ID:o,predicate:h=>h.collisionGroupID===o}}return this.collisionGroups[r]}}function gc(u,r,o,h,p){const{horizontalAlign:m,verticalAlign:g}=a.bS(u),x=-(m-.5)*r,b=-(g-.5)*o,w=a.bR(u,h);return new a.P(x+w[0]*p,b+w[1]*p)}function $l(u,r,o,h,p){const m=new a.P(u,r);return o&&m._rotate(h?p:-p),m}class J3{constructor(r,o,h,p,m,g){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Zh(this.transform,m),this.buildingIndex=g,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new Y3(h),this.collisionCircleArrays={},this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,o,h,p){const m=h.getBucket(o),g=h.latestFeatureIndex;if(!m||!g||o.fqid!==m.layerIds[0])return;const x=m.layers[0].layout,b=h.collisionBoxArray,w=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),T=h.tileSize/a.a4,E=h.tileID.toUnwrapped();this.transform.setProjection(m.projection);const O=(z=h.tileID,L=m.getProjection(),k=this.transform,L.name===this.projection?k.calculateProjMatrix(z.toUnwrapped()):bs(k,L,z));var z,L,k;const B=x.get("text-pitch-alignment")==="map",F=x.get("text-rotation-alignment")==="map";o.compileFilter();const $=o.dynamicFilter(),G=o.dynamicFilterNeedsFeature(),Z=this.transform.calculatePixelsToTileUnitsMatrix(h),K=wl(O,h.tileID.canonical,B,F,this.transform,m.getProjection(),Z);let W=null;if(B){const re=Al(O,h.tileID.canonical,B,F,this.transform,m.getProjection(),Z);W=a.ae.multiply([],this.transform.labelPlaneMatrix,re)}let H=null;$&&h.latestFeatureIndex&&(H={unwrappedTileID:E,dynamicFilter:$,dynamicFilterNeedsFeature:G,featureIndex:h.latestFeatureIndex}),this.retainedQueryData[m.bucketInstanceId]=new _c(m.bucketInstanceId,g,m.sourceLayerIndex,m.index,h.tileID);const te={bucket:m,layout:x,posMatrix:O,textLabelPlaneMatrix:K,labelToScreenMatrix:W,clippingData:H,scale:w,textPixelRatio:T,holdingForFade:h.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:a.aE(m.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.aE(m.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(p)for(const re of m.sortKeyRanges){const{sortKey:he,symbolInstanceStart:ne,symbolInstanceEnd:J}=re;r.push({sortKey:he,symbolInstanceStart:ne,symbolInstanceEnd:J,parameters:te})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:te})}attemptAnchorPlacement(r,o,h,p,m,g,x,b,w,T,E,O,z,L,k,B,F,$){const{textOffset0:G,textOffset1:Z,crossTileID:K}=O,W=[G,Z],H=gc(r,h,p,W,m),te=this.collisionIndex.placeCollisionBox(L,m,o,$l(H.x,H.y,g,x,this.transform.angle),E,b,w,T.predicate);if(B){const re=L.getSymbolInstanceIconSize($,this.transform.zoom,O.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(L,re,B,$l(H.x,H.y,g,x,this.transform.angle),E,b,w,T.predicate).box.length===0)return}if(te.box.length>0){let re;return this.prevPlacement&&this.prevPlacement.variableOffsets[K]&&this.prevPlacement.placements[K]&&this.prevPlacement.placements[K].text&&(re=this.prevPlacement.variableOffsets[K].anchor),this.variableOffsets[K]={textOffset:W,width:h,height:p,anchor:r,textScale:m,prevAnchor:re},this.markUsedJustification(L,r,O,k),L.allowVerticalPlacement&&(this.markUsedOrientation(L,k,O),this.placedOrientations[K]=k),{shift:H,placedGlyphBoxes:te}}}placeLayerBucketPart(r,o,h,p){const{bucket:m,layout:g,posMatrix:x,textLabelPlaneMatrix:b,labelToScreenMatrix:w,clippingData:T,textPixelRatio:E,holdingForFade:O,collisionBoxArray:z,partiallyEvaluatedTextSize:L,partiallyEvaluatedIconSize:k,collisionGroup:B}=r.parameters,F=g.get("text-optional"),$=g.get("icon-optional"),G=g.get("text-allow-overlap"),Z=g.get("icon-allow-overlap"),K=g.get("text-rotation-alignment")==="map",W=g.get("text-pitch-alignment")==="map",H=g.get("symbol-z-order")==="viewport-y",te=g.get("symbol-z-elevate");this.transform.setProjection(m.projection);let re=G&&(Z||!m.hasIconData()||$),he=Z&&(G||!m.hasTextData()||F);!m.collisionArrays&&z&&m.deserializeCollisionBoxes(z),h&&p&&m.updateCollisionDebugBuffers(this.transform.zoom,z);const ne=(J,ge,me)=>{const{crossTileID:oe,numVerticalGlyphVertices:Pe}=J;if(T){const Et={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ot=null;if(T.dynamicFilterNeedsFeature){const bt=this.retainedQueryData[m.bucketInstanceId];Ot=T.featureIndex.loadFeature({featureIndex:J.featureIndex,bucketIndex:bt.bucketIndex,sourceLayerIndex:bt.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,T.dynamicFilter)(Et,Ot,this.retainedQueryData[m.bucketInstanceId].tileID.canonical,new a.P(J.tileAnchorX,J.tileAnchorY),this.transform.calculateDistanceTileData(T.unwrappedTileID)))return this.placements[oe]=new Zl(!1,!1,!1,!0),void o.add(oe)}if(o.has(oe))return;if(O)return void(this.placements[oe]=new Zl(!1,!1,!1));let Me=!1,de=!1,Ce=!0,se=!1,Se=!1,Ie=null,Ue={box:null,offscreen:null,occluded:null},$e={box:null,offscreen:null,occluded:null},Je=null,qe=null,ot=null,Ct=0,ct=0,Tt=0;me.textFeatureIndex?Ct=me.textFeatureIndex:J.useRuntimeCollisionCircles&&(Ct=J.featureIndex),me.verticalTextFeatureIndex&&(ct=me.verticalTextFeatureIndex);const kt=Et=>{Et.tileID=this.retainedQueryData[m.bucketInstanceId].tileID;const Ot=this.transform.elevation;Et.elevation=J.zOffset+(Ot?Ot.getAtTileOffset(Et.tileID,Et.tileAnchorX,Et.tileAnchorY):0)},hi=me.textBox;if(hi){kt(hi);const Et=bt=>{let $t=a.aF.horizontal;if(m.allowVerticalPlacement&&!bt&&this.prevPlacement){const zt=this.prevPlacement.placedOrientations[oe];zt&&(this.placedOrientations[oe]=zt,$t=zt,this.markUsedOrientation(m,$t,J))}return $t},Ot=(bt,$t)=>{if(m.allowVerticalPlacement&&Pe>0&&me.verticalTextBox){for(const zt of m.writingModes)if(zt===a.aF.vertical?(Ue=$t(),$e=Ue):Ue=bt(),Ue&&Ue.box&&Ue.box.length)break}else Ue=bt()};if(g.get("text-variable-anchor")){let bt=g.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[oe]){const dt=this.prevPlacement.variableOffsets[oe];bt.indexOf(dt.anchor)>0&&(bt=bt.filter(Ri=>Ri!==dt.anchor),bt.unshift(dt.anchor))}const $t=(dt,Ri,Li)=>{const lr=m.getSymbolInstanceTextSize(L,J,this.transform.zoom,ge),cr=(dt.x2-dt.x1)*lr+2*dt.padding,Ji=(dt.y2-dt.y1)*lr+2*dt.padding,ur=J.hasIconTextFit&&!Z?Ri:null;ur&&kt(ur);let Wi={box:[],offscreen:!1,occluded:!1};const Ki=G?2*bt.length:bt.length;for(let Le=0;Le<Ki;++Le){const Qe=this.attemptAnchorPlacement(bt[Le%bt.length],dt,cr,Ji,lr,K,W,E,x,B,Le>=bt.length,J,ge,m,Li,ur,L,k);if(Qe&&(Wi=Qe.placedGlyphBoxes,Wi&&Wi.box&&Wi.box.length)){Me=!0,Ie=Qe.shift;break}}return Wi};Ot(()=>$t(hi,me.iconBox,a.aF.horizontal),()=>{const dt=me.verticalTextBox;return dt&&kt(dt),m.allowVerticalPlacement&&!(Ue&&Ue.box&&Ue.box.length)&&Pe>0&&dt?$t(dt,me.verticalIconBox,a.aF.vertical):{box:null,offscreen:null,occluded:null}}),Ue&&(Me=Ue.box,Ce=Ue.offscreen,se=Ue.occluded);const zt=Et(!(!Ue||!Ue.box));if(!Me&&this.prevPlacement){const dt=this.prevPlacement.variableOffsets[oe];dt&&(this.variableOffsets[oe]=dt,this.markUsedJustification(m,dt.anchor,J,zt))}}else{const bt=($t,zt)=>{const dt=m.getSymbolInstanceTextSize(L,J,this.transform.zoom,ge),Ri=this.collisionIndex.placeCollisionBox(m,dt,$t,new a.P(0,0),G,E,x,B.predicate);return Ri&&Ri.box&&Ri.box.length&&(this.markUsedOrientation(m,zt,J),this.placedOrientations[oe]=zt),Ri};Ot(()=>bt(hi,a.aF.horizontal),()=>{const $t=me.verticalTextBox;return m.allowVerticalPlacement&&Pe>0&&$t?(kt($t),bt($t,a.aF.vertical)):{box:null,offscreen:null,occluded:null}}),Et(!!(Ue&&Ue.box&&Ue.box.length))}}if(Je=Ue,Me=Je&&Je.box&&Je.box.length>0,Ce=Je&&Je.offscreen,se=Je&&Je.occluded,J.useRuntimeCollisionCircles){const Et=m.text.placedSymbolArray.get(J.centerJustifiedTextSymbolIndex>=0?J.centerJustifiedTextSymbolIndex:J.verticalPlacedTextSymbolIndex),Ot=a.aG(m.textSizeData,L,Et),bt=g.get("text-padding");qe=this.collisionIndex.placeCollisionCircles(m,G,Et,m.lineVertexArray,m.glyphOffsetArray,Ot,x,b,w,h,W,B.predicate,J.collisionCircleDiameter*Ot/a.bP,bt,this.retainedQueryData[m.bucketInstanceId].tileID),Me=G||qe.circles.length>0&&!qe.collisionDetected,Ce=Ce&&qe.offscreen,se=qe.occluded}if(me.iconFeatureIndex&&(Tt=me.iconFeatureIndex),me.iconBox){const Et=Ot=>{kt(Ot);const bt=J.hasIconTextFit&&Ie?$l(Ie.x,Ie.y,K,W,this.transform.angle):new a.P(0,0),$t=m.getSymbolInstanceIconSize(k,this.transform.zoom,J.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(m,$t,Ot,bt,Z,E,x,B.predicate)};$e&&$e.box&&$e.box.length&&me.verticalIconBox?(ot=Et(me.verticalIconBox),de=ot.box.length>0):(ot=Et(me.iconBox),de=ot.box.length>0),Ce=Ce&&ot.offscreen,Se=ot.occluded}const ai=F||J.numHorizontalGlyphVertices===0&&Pe===0,Bt=$||J.numIconVertices===0;if(ai||Bt?Bt?ai||(de=de&&Me):Me=de&&Me:de=Me=de&&Me,Me&&Je&&Je.box&&this.collisionIndex.insertCollisionBox(Je.box,g.get("text-ignore-placement"),m.bucketInstanceId,$e&&$e.box&&ct?ct:Ct,B.ID),de&&ot&&this.collisionIndex.insertCollisionBox(ot.box,g.get("icon-ignore-placement"),m.bucketInstanceId,Tt,B.ID),qe&&(Me&&this.collisionIndex.insertCollisionCircles(qe.circles,g.get("text-ignore-placement"),m.bucketInstanceId,Ct,B.ID),h)){const Et=m.bucketInstanceId;let Ot=this.collisionCircleArrays[Et];Ot===void 0&&(Ot=this.collisionCircleArrays[Et]=new $h);for(let bt=0;bt<qe.circles.length;bt+=4)Ot.circles.push(qe.circles[bt+0]),Ot.circles.push(qe.circles[bt+1]),Ot.circles.push(qe.circles[bt+2]),Ot.circles.push(qe.collisionDetected?1:0)}const ni=m.projection.name!=="globe";re=re&&(ni||!se),he=he&&(ni||!Se),this.placements[oe]=new Zl(Me||re,de||he,Ce||m.justReloaded),o.add(oe)};if(te&&this.buildingIndex&&(this.buildingIndex.updateZOffset(m,this.retainedQueryData[m.bucketInstanceId].tileID),m.updateZOffset()),H){const J=m.getSortedSymbolIndexes(this.transform.angle);for(let ge=J.length-1;ge>=0;--ge){const me=J[ge];ne(m.symbolInstances.get(me),me,m.collisionArrays[me])}m.hasAnyZOffset&&a.w(`${m.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(m.hasAnyZOffset){const J=m.getSortedIndexesByZOffset();for(let ge=0;ge<J.length;++ge){const me=J[ge];ne(m.symbolInstances.get(me),me,m.collisionArrays[me])}}else for(let J=r.symbolInstanceStart;J<r.symbolInstanceEnd;J++)ne(m.symbolInstances.get(J),J,m.collisionArrays[J]);if(h&&m.bucketInstanceId in this.collisionCircleArrays){const J=this.collisionCircleArrays[m.bucketInstanceId];a.ae.invert(J.invProjMatrix,x),J.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1}markUsedJustification(r,o,h,p){const{leftJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:b,crossTileID:w}=h,T=a.cM(o),E=p===a.aF.vertical?b:T==="left"?m:T==="center"?g:T==="right"?x:-1;m>=0&&(r.text.placedSymbolArray.get(m).crossTileID=E>=0&&m!==E?0:w),g>=0&&(r.text.placedSymbolArray.get(g).crossTileID=E>=0&&g!==E?0:w),x>=0&&(r.text.placedSymbolArray.get(x).crossTileID=E>=0&&x!==E?0:w),b>=0&&(r.text.placedSymbolArray.get(b).crossTileID=E>=0&&b!==E?0:w)}markUsedOrientation(r,o,h){const p=o===a.aF.horizontal||o===a.aF.horizontalOnly?o:0,m=o===a.aF.vertical?o:0,{leftJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:x,rightJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:w}=h,T=r.text.placedSymbolArray;g>=0&&(T.get(g).placedOrientation=p),x>=0&&(T.get(x).placedOrientation=p),b>=0&&(T.get(b).placedOrientation=p),w>=0&&(T.get(w).placedOrientation=m)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let h=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const p=o?o.symbolFadeChange(r):1,m=o?o.opacities:{},g=o?o.variableOffsets:{},x=o?o.placedOrientations:{};for(const b in this.placements){const w=this.placements[b],T=m[b];T?(this.opacities[b]=new Io(T,p,w.text,w.icon,null,w.clipped),h=h||w.text!==T.text.placed||w.icon!==T.icon.placed):(this.opacities[b]=new Io(null,p,w.text,w.icon,w.skipFade,w.clipped),h=h||w.text||w.icon)}for(const b in m){const w=m[b];if(!this.opacities[b]){const T=new Io(w,p,!1,!1);T.isHidden()||(this.opacities[b]=T,h=h||w.text.placed||w.icon.placed)}}for(const b in g)this.variableOffsets[b]||!this.opacities[b]||this.opacities[b].isHidden()||(this.variableOffsets[b]=g[b]);for(const b in x)this.placedOrientations[b]||!this.opacities[b]||this.opacities[b].isHidden()||(this.placedOrientations[b]=x[b]);h?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:r)}updateLayerOpacities(r,o,h,p){const m=new Set;for(const g of o){const x=g.getBucket(r);x&&g.latestFeatureIndex&&r.fqid===x.layerIds[0]&&(this.updateBucketOpacities(x,m,g.collisionBoxArray,h,p,g.tileID,r.scope),x.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(x,g.tileID),x.updateZOffset()))}}updateBucketOpacities(r,o,h,p,m,g,x){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const b=r.layers[0].layout,w=!!r.layers[0].dynamicFilter(),T=new Io(null,0,!1,!1,!0),E=b.get("text-allow-overlap"),O=b.get("icon-allow-overlap"),z=b.get("text-variable-anchor"),L=b.get("text-rotation-alignment")==="map",k=b.get("text-pitch-alignment")==="map",B=new Io(null,0,E&&(O||!r.hasIconData()||b.get("icon-optional")),O&&(E||!r.hasTextData()||b.get("text-optional")),!0);!r.collisionArrays&&h&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(h);const F=(G,Z,K)=>{for(let W=0;W<Z/4;W++)G.opacityVertexArray.emplaceBack(K)};let $=0;m&&r.updateReplacement(g,m);for(let G=0;G<r.symbolInstances.length;G++){const Z=r.symbolInstances.get(G),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:W,crossTileID:H,numIconVertices:te,tileAnchorX:re,tileAnchorY:he}=Z,ne=o.has(H);let J=this.opacities[H];ne?J=T:J||(J=B,this.opacities[H]=J),o.add(H);const ge=K>0||W>0,me=te>0,oe=this.placedOrientations[H],Pe=oe===a.aF.vertical,Me=oe===a.aF.horizontal||oe===a.aF.horizontalOnly;!ge&&!me||J.isHidden()||$++;let de=!1;if((ge||me)&&m)for(const Ce of r.activeReplacements){if(a.cJ(Ce,p,a.cw.Symbol,x)||Ce.min.x>re||re>Ce.max.x||Ce.min.y>he||he>Ce.max.y)continue;const se=a.cK(re,he,g.canonical,Ce.footprintTileId.canonical);if(de=a.cL(se,Ce),de)break}if(ge){const Ce=de?ts:zr(J.text);F(r.text,K,Pe?ts:Ce),F(r.text,W,Me?ts:Ce);const se=J.text.isHidden(),{leftJustifiedTextSymbolIndex:Se,centerJustifiedTextSymbolIndex:Ie,rightJustifiedTextSymbolIndex:Ue,verticalPlacedTextSymbolIndex:$e}=Z,Je=r.text.placedSymbolArray,qe=se||Pe?1:0;Se>=0&&(Je.get(Se).hidden=qe),Ie>=0&&(Je.get(Ie).hidden=qe),Ue>=0&&(Je.get(Ue).hidden=qe),$e>=0&&(Je.get($e).hidden=se||Me?1:0);const ot=this.variableOffsets[H];ot&&this.markUsedJustification(r,ot.anchor,Z,oe);const Ct=this.placedOrientations[H];Ct&&(this.markUsedJustification(r,"left",Z,Ct),this.markUsedOrientation(r,Ct,Z))}if(me){const Ce=de?ts:zr(J.icon),{placedIconSymbolIndex:se,verticalPlacedIconSymbolIndex:Se}=Z,Ie=r.icon.placedSymbolArray,Ue=J.icon.isHidden()?1:0;se>=0&&(F(r.icon,te,Pe?ts:Ce),Ie.get(se).hidden=Ue),Se>=0&&(F(r.icon,Z.numVerticalIconVertices,Me?ts:Ce),Ie.get(Se).hidden=Ue)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Ce=r.collisionArrays[G];if(Ce){let se=new a.P(0,0),Se=!0;if(Ce.textBox||Ce.verticalTextBox){if(z){const Ue=this.variableOffsets[H];Ue?(se=gc(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textScale),L&&se._rotate(k?this.transform.angle:-this.transform.angle)):Se=!1}w&&(Se=!J.clipped),Ce.textBox&&gn(r.textCollisionBox.collisionVertexArray,J.text.placed,!Se||Pe,se.x,se.y),Ce.verticalTextBox&&gn(r.textCollisionBox.collisionVertexArray,J.text.placed,!Se||Me,se.x,se.y)}const Ie=Se&&!!(!Me&&Ce.verticalIconBox);Ce.iconBox&&gn(r.iconCollisionBox.collisionVertexArray,J.icon.placed,Ie,Z.hasIconTextFit?se.x:0,Z.hasIconTextFit?se.y:0),Ce.verticalIconBox&&gn(r.iconCollisionBox.collisionVertexArray,J.icon.placed,!Ie,Z.hasIconTextFit?se.x:0,Z.hasIconTextFit?se.y:0)}}}if(r.fullyClipped=$===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=G.invProjMatrix,r.placementViewportMatrix=G.viewportMatrix,r.collisionCircleArray=G.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,o){const h=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*h>r}setStale(){this.stale=!0}}function gn(u,r,o,h,p){u.emplaceBack(r?1:0,o?1:0,h||0,p||0),u.emplaceBack(r?1:0,o?1:0,h||0,p||0),u.emplaceBack(r?1:0,o?1:0,h||0,p||0),u.emplaceBack(r?1:0,o?1:0,h||0,p||0)}const Gl=Math.pow(2,25),K3=Math.pow(2,24),Q3=Math.pow(2,17),Po=Math.pow(2,16),Oo=Math.pow(2,9),eu=Math.pow(2,8),yc=Math.pow(2,1);function zr(u){if(u.opacity===0&&!u.placed)return 0;if(u.opacity===1&&u.placed)return 4294967295;const r=u.placed?1:0,o=Math.floor(127*u.opacity);return o*Gl+r*K3+o*Q3+r*Po+o*Oo+r*eu+o*yc+r}const ts=0;class je{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,o,h,p,m){const g=this._bucketParts;for(;this._currentTileIndex<r.length;)if(o.getBucketParts(g,p,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,g.sort((x,b)=>x.sortKey-b.sortKey));this._currentPartIndex<g.length;){const x=g[this._currentPartIndex];if(o.placeLayerBucketPart(x,this._seenCrossTileIDs,h,x.symbolInstanceStart===0),this._currentPartIndex++,m())return!0}return!1}}class tu{constructor(r,o,h,p,m,g,x,b,w){this.placement=new J3(r,m,g,x,b,w),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(r,o,h,p){const m=a.e.now(),g=()=>{const x=a.e.now()-m;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=o[r[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){const w=x,T=w.layout.get("symbol-z-elevate"),E=this._inProgressLayer=this._inProgressLayer||new je(w),O=a.am(x.source,x.scope);if(E.continuePlacement(T?p[O]:h[O],this.placement,this._showCollisionBoxes,x,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const zo=512/a.a4/2;class xc{constructor(r,o,h){this.tileID=r,this.bucketInstanceId=h,this.index=new a.cN(o.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const p=r.canonical.x*a.a4,m=r.canonical.y*a.a4;for(let g=0;g<o.length;g++){const{key:x,crossTileID:b,tileAnchorX:w,tileAnchorY:T}=o.get(g),E=Math.floor((p+w)*zo),O=Math.floor((m+T)*zo);this.index.add(E,O),this.keys.push(x),this.crossTileIDs.push(b)}this.index.finish()}findMatches(r,o,h){const p=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),m=zo/Math.pow(2,o.canonical.z-this.tileID.canonical.z),g=o.canonical.x*a.a4,x=o.canonical.y*a.a4;for(let b=0;b<r.length;b++){const w=r.get(b);if(w.crossTileID)continue;const{key:T,tileAnchorX:E,tileAnchorY:O}=w,z=Math.floor((g+E)*m),L=Math.floor((x+O)*m),k=this.index.range(z-p,L-p,z+p,L+p);for(const B of k){const F=this.crossTileIDs[B];if(this.keys[B]===T&&!h.has(F)){h.add(F),w.crossTileID=F;break}}}}}class iu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ql{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const o=Math.round((r-this.lng)/360);if(o!==0)for(const h in this.indexes){const p=this.indexes[h],m={};for(const g in p){const x=p[g];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+o),m[x.tileID.key]=x}this.indexes[h]=m}this.lng=r}addBucket(r,o,h){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const p=this.usedCrossTileIDs[r.overscaledZ];for(const m in this.indexes){const g=this.indexes[m];if(Number(m)>r.overscaledZ)for(const x in g){const b=g[x];b.tileID.isChildOf(r)&&b.findMatches(o.symbolInstances,r,p)}else{const x=g[r.scaledTo(Number(m)).key];x&&x.findMatches(o.symbolInstances,r,p)}}for(let m=0;m<o.symbolInstances.length;m++){const g=o.symbolInstances.get(m);g.crossTileID||(g.crossTileID=h.generate(),p.add(g.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new xc(r,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(r,o){for(const h of o.crossTileIDs)this.usedCrossTileIDs[r].delete(h)}removeStaleBuckets(r){let o=!1;for(const h in this.indexes){const p=this.indexes[h];for(const m in p)r[p[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,p[m]),delete p[m],o=!0)}return o}}class In{constructor(){this.layerIndexes={},this.crossTileIDs=new iu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,o,h,p){let m=this.layerIndexes[r.fqid];m===void 0&&(m=this.layerIndexes[r.fqid]=new ql);let g=!1;const x={};p.name!=="globe"&&m.handleWrapJump(h);for(const b of o){const w=b.getBucket(r);w&&r.fqid===w.layerIds[0]&&(w.bucketInstanceId||(w.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(b.tileID,w,this.crossTileIDs)&&(g=!0),x[w.bucketInstanceId]=!0)}return m.removeStaleBuckets(x)&&(g=!0),g}pruneUnusedLayers(r){const o={};r.forEach(h=>{o[h]=!0});for(const h in this.layerIndexes)o[h]||delete this.layerIndexes[h]}}const vc=new a.U({data:new a.W(a.N.colorTheme.data)}),Dr=(u,r)=>nt(u,r&&r.filter(o=>o.identifier!=="source.canvas")),Wl=a.ai(Jt,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),xa=a.ai(Jt,["setCenter","setZoom","setBearing","setPitch"]),ru={version:8,layers:[],sources:{}},nu={duration:300,delay:0};class Rr extends a.E{constructor(r,o={}){super(),this.map=r,this.scope=o.scope||"",this.globalId=null,this.fragments=[],this.importDepth=o.importDepth||0,this.importsCache=o.importsCache||new Map,this.resolvedImports=o.resolvedImports||new Set,this.transition=a.Q({},nu),this._buildingIndex=new wr(this),this.crossTileSymbolIndex=new In,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=o.styleChanges||new R1,this.dispatcher=o.dispatcher?o.dispatcher:new a.by(a.bz(),this),o.imageManager?this.imageManager=o.imageManager:(this.imageManager=new Vr,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=o.glyphManager?o.glyphManager:new a.cP(r._requestManager,o.localFontFamily?a.cQ.all:o.localIdeographFontFamily?a.cQ.ideographs:a.cQ.none,o.localFontFamily||o.localIdeographFontFamily),o.modelManager?this.modelManager=o.modelManager:(this.modelManager=new Hs(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=o.configOptions?o.configOptions:new Map,this._configDependentLayers=o.configDependentLayers?o.configDependentLayers:new Set,this._config=o.config,this._initialConfig=o.initialConfig,this.dispatcher.broadcast("setReferrer",a.cR());const h=this;this._rtlTextPluginCallback=Rr.registerForPluginStateChange(p=>{h.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(m,g)=>{if(a.cS(m),g&&g.every(x=>x))for(const x in h._sourceCaches){const b=h._sourceCaches[x],w=b.getSource().type;w!=="vector"&&w!=="geojson"||b.reload()}})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const m=this.getOwnSource(p.sourceId);if(m&&m.vectorLayerIds)for(const g in this._layers){const x=this._layers[g];x.source===m.id&&this._validateLayer(x)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(a.cT(r))return r;const o=a.cU(r);if(!o.startsWith("http"))try{return new URL(o,location.href).toString()}catch{return o}return o}return`json://${a.cV(JSON.stringify(r))}`}_diffStyle(r,o,h){this.globalId=this._getGlobalId(r);const p=(m,g)=>{try{g(null,this.setState(m,h))}catch(x){g(x,!1)}};if(typeof r=="string"){const m=this.map._requestManager.normalizeStyleURL(r),g=this.map._requestManager.transformRequest(m,a.R.Style);a.h(g,(x,b)=>{x?this.fire(new a.f(x)):b&&p(b,o)})}else typeof r=="object"&&p(r,o)}loadURL(r,o={}){this.fire(new a.g("dataloading",{dataType:"style"}));const h=typeof o.validate=="boolean"?o.validate:!a.cT(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,o.accessToken),this.resolvedImports.add(r);const p=this.importsCache.get(r);if(p)return this._load(p,h);const m=this.map._requestManager.transformRequest(r,a.R.Style);this._request=a.h(m,(g,x)=>{if(this._request=null,g)this.fire(new a.f(g));else if(x)return this.importsCache.set(r,x),this._load(x,h)})}loadJSON(r,o={}){this.fire(new a.g("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=a.e.frame(()=>{this._request=null,this._load(r,o.validate!==!1)})}loadEmpty(){this.fire(new a.g("dataloading",{dataType:"style"})),this._load(ru,!1)}_loadImports(r,o,h){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const p=[];for(const m of r){const g=this._createFragmentStyle(m),x=new Promise(T=>{g.once("style.import.load",T),g.once("error",T)}).then(()=>this.mergeAll());if(p.push(x),this.resolvedImports.has(m.url)){g.loadEmpty();continue}const b=m.data||this.importsCache.get(m.url);b?(g.loadJSON(b,{validate:o}),this._isInternalStyle(b)&&(g.globalId=null)):m.url?g.loadURL(m.url,{validate:o}):g.loadEmpty();const w={style:g,id:m.id,config:m.config};if(h){const T=this.fragments.findIndex(({id:E})=>E===h);this.fragments=this.fragments.slice(0,T).concat(w).concat(this.fragments.slice(T))}else this.fragments.push(w)}return Promise.allSettled(p)}getImportGlobalIds(r=this,o=new Set){for(const h of r.fragments)h.style.globalId&&o.add(h.style.globalId),this.getImportGlobalIds(h.style,o);return[...o.values()]}_createFragmentStyle(r){const o=this.scope?a.am(r.id,this.scope):r.id;let h;const p=this._initialConfig&&this._initialConfig[o];(r.config||p)&&(h=a.Q({},r.config,p));const m=new Rr(this.map,{scope:o,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:h,configOptions:this.options,configDependentLayers:this._configDependentLayers});return m.setEventedParent(this.map,{style:m}),m}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,o){const h=r.schema;if(this._isInternalStyle(r)){const g=a.Q({},ru,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(g,o)}if(this.updateConfig(this._config,h),o&&Dr(this,R(r)))return;this._loaded=!0,this.stylesheet=a.cW(r);const p=()=>{for(const w in r.sources)this.addSource(w,r.sources[w],{validate:!1,isInitialLoad:!0});r.sprite?this._loadSprite(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(r.glyphs,this.scope);const g=Mo(this.stylesheet.layers);if(this._order=g.map(w=>w.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const w=this.stylesheet.lights[0];this.light=new Gt(w.properties,w.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Gt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const w of g){const T=a.c$(w,this.scope,this._styleColorTheme.lut,this.options);T.configDependencies.size!==0&&this._configDependentLayers.add(T.fqid),T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize();const E=this.getOwnLayerSourceCache(T),O=!!this.directionalLight&&this.directionalLight.shadowsEnabled();E&&T.canCastShadows()&&O&&(E.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const x=this.stylesheet.terrain;x&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(x,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.g("data",{dataType:"style"}));const b=this.isRootStyle();r.imports?this._loadImports(r.imports,o).then(()=>{this._reloadImports(),this.fire(new a.g(b?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.g(b?"style.load":"style.import.load")))},m=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=m,m){const g=this._evaluateColorThemeData(m);this._loadColorTheme(g).then(()=>{p()}).catch(x=>{a.w(`Couldn't load color theme from the stylesheet: ${x}`),p()})}else this._styleColorTheme.lut=null,p()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,o,h,p,m,g,x,b;const w={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(T=>{if(T.stylesheet){if(T.light!=null&&(r=T.light),T.stylesheet.lights)for(const E of T.stylesheet.lights)E.type==="ambient"&&T.ambientLight!=null&&(o=T.ambientLight),E.type==="directional"&&T.directionalLight!=null&&(h=T.directionalLight);p=this._prioritizeTerrain(p,T.terrain,T.stylesheet.terrain),T.stylesheet.fog&&T.fog!=null&&(m=T.fog),T.stylesheet.camera!=null&&(b=T.stylesheet.camera),T.stylesheet.projection!=null&&(g=T.stylesheet.projection),T.stylesheet.transition!=null&&(x=T.stylesheet.transition),w[T.scope]=T._styleColorTheme}}),this.light=r,this.ambientLight=o,this.directionalLight=h,this.fog=m,this._styleColorThemeForScope=w,p===null?delete this.terrain:this.terrain=p,this.camera=b||{"camera-projection":"perspective"},this.projection=g||{name:"mercator"},this.transition=a.Q({},nu,x),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const o=h=>{for(const p of h.fragments)o(p.style);r(h)};o(this)}_prioritizeTerrain(r,o,h){const p=r&&r.drapeRenderMode===0;return h===null?o&&o.drapeRenderMode===0?o:p?r:null:o!=null&&(!r||p||o&&o.drapeRenderMode===1)?o:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(o=>{r=this._prioritizeTerrain(r,o.terrain,o.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(o=>{o.stylesheet.projection!=null&&(r=o.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},o={},h={};this.forEachFragmentStyle(p=>{for(const m in p._sourceCaches){const g=a.am(m,p.scope);r[g]=p._sourceCaches[m]}for(const m in p._otherSourceCaches){const g=a.am(m,p.scope);o[g]=p._otherSourceCaches[m]}for(const m in p._symbolSourceCaches){const g=a.am(m,p.scope);h[g]=p._symbolSourceCaches[m]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=o,this._mergedSymbolSourceCaches=h}mergeLayers(){const r={},o=[],h={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(g=>{for(const x of g._order){const b=g._layers[x];if(b.type==="slot"){const w=a.cX(x);if(r[w])continue;r[w]=[]}b.slot&&r[b.slot]?r[b.slot].push(b):o.push(b)}}),this._mergedOrder=[],this._clipLayerIndices=[];let p=0;const m=(g=[])=>{for(const x of g)if(x.type==="slot"){const b=a.cX(x.id);r[b]&&m(r[b]),this._mergedSlots.push(b)}else{const b=a.am(x.id,x.scope);this._mergedOrder.push(b),h[b]=x,x.is3D()&&(this._has3DLayers=!0),x.type==="circle"&&(this._hasCircleLayers=!0),x.type==="symbol"&&(this._hasSymbolLayers=!0),x.type==="clip"&&this._clipLayerIndices.push(p),p++}};m(o),this._mergedOrder.sort((g,x)=>{const b=h[g],w=h[x];return b.hasInitialOcclusionOpacityProperties?w.is3D()?1:0:b.is3D()&&w.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=h,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=a.Q({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(o,h,p){const m=a.Q({},h);for(const x of Object.keys(a.N.colorTheme))m[x]===void 0&&(m[x]=a.N.colorTheme[x].default);const g=new a.O(vc,o,new Map(p));return g.setTransitionOrValue(m,p),g.untransitioned().possiblyEvaluate(new a.Y(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const o=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((h,p)=>{const m="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void h();let g=r;g.startsWith(m)||(g=m+g);const x="mapbox-reserved-lut",b=new Image;b.src=g,b.onerror=()=>{this._styleColorTheme.lutLoading=!1,p(new Error("Failed to load image data"))},b.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==o)return void h();this._styleColorTheme.lutLoading=!1;const{width:w,height:T,data:E}=a.e.getImageData(b);if(T>32)return void p(new Error("The height of the image must be less than or equal to 32 pixels."));if(w!==T*T)return void p(new Error("The width of the image must be equal to the height squared."));this.getImage(x)&&this.removeImage(x),this.addImage(x,{data:new a.j({width:w,height:T},E),pixelRatio:1,sdf:!1,version:0});const O=this.imageManager.getImage(x,this.scope);O?(this._styleColorTheme.lut={image:O.data,data:r},h()):p(new Error("Missing LUT image."))}})}getLut(r){const o=this._styleColorThemeForScope[r];return o?o.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(o,h,p){let m,g,x;const b=a.e.devicePixelRatio>1?"@2x":"";let w=a.h(h.transformRequest(h.normalizeSpriteURL(o,b,".json"),a.R.SpriteJSON),(O,z)=>{w=null,x||(x=O,m=z,E())}),T=a.i(h.transformRequest(h.normalizeSpriteURL(o,b,".png"),a.R.SpriteImage),(O,z)=>{T=null,x||(x=O,g=z,E())});function E(){if(x)p(x);else if(m&&g){const O=a.e.getImageData(g),z={};for(const L in m){const{width:k,height:B,x:F,y:$,sdf:G,pixelRatio:Z,stretchX:K,stretchY:W,content:H}=m[L],te=new a.j({width:k,height:B});a.j.copy(O,te,{x:F,y:$},{x:0,y:0},{width:k,height:B},null),z[L]={data:te,pixelRatio:Z,sdf:G,stretchX:K,stretchY:W,content:H}}p(null,z)}}return{cancel(){w&&(w.cancel(),w=null),T&&(T.cancel(),T=null)}}}(r,this.map._requestManager,(o,h)=>{if(this._spriteRequest=null,o)this.fire(new a.f(o));else if(h)for(const p in h)this.imageManager.addImage(p,this.scope,h[p]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.g("data",{dataType:"style"}))})}_validateLayer(r){const o=this.getOwnSource(r.source);if(!o)return;const h=r.sourceLayer;h&&(o.type==="geojson"||o.vectorLayerIds&&o.vectorLayerIds.indexOf(h)===-1)&&this.fire(new a.f(new Error(`Source layer "${h}" does not exist on source "${o.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,o)=>{const h=this.fragments[o];return h&&h.style&&(r.data=h.style.serialize()),r})}_serializeSources(){const r={};for(const o in this._sourceCaches){const h=this._sourceCaches[o].getSource();r[h.id]||(r[h.id]=h.serialize())}return r}_serializeLayers(r){const o=[];for(const h of r){const p=this._layers[h];p&&p.type!=="custom"&&o.push(p.serialize())}return o}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const o=this.getOwnLayer(r);if(o)return o;this.fire(new a.f(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const o=this.getOwnSource(r);if(o)return o;this.fire(new a.f(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,o){const h=this.map.painter;if(h)for(let p=r.minzoom||0;p<(r.maxzoom||25.5);p++){const m=r.getProgramIds();if(m)for(const g of m){const x=r.getDefaultProgramParams(g,o.zoom,this._styleColorTheme.lut);x&&(h.style=this,this.fog&&(h._fogVisible=!0,x.overrideFog=!0,h.getOrCreateProgram(g,x)),h._fogVisible=!1,x.overrideFog=!1,h.getOrCreateProgram(g,x),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(x.overrideRtt=!0,h.getOrCreateProgram(g,x)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const o=this.calculateLightsBrightness();r.brightness=o||0,o!==this._brightness&&(this._brightness=o,this.dispatcher.broadcast("setBrightness",o));const h=this._changes.isDirty();let p=!1;if(this._changes.isDirty()){const g=this._changes.getLayerUpdatesByScope();for(const x in g){const{updatedIds:b,removedIds:w}=g[x];(b||w)&&(this._updateWorkerLayers(x,b,w),p=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this._changes.reset()}const m={};for(const g in this._mergedSourceCaches){const x=this._mergedSourceCaches[g];m[g]=x.used,x.used=!1,x.tileCoverLift=0}for(const g of this._mergedOrder){const x=this._mergedLayers[g];if(x.recalculate(r,this._availableImages),!x.isHidden(r.zoom)){const b=this.getLayerSourceCache(x);b&&(b.used=!0,b.tileCoverLift=Math.max(b.tileCoverLift,x.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(x,r)}):this.precompilePrograms(x,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&p&&this.mergeLayers();for(const g in m){const x=this._mergedSourceCaches[g];m[g]!==x.used&&x.getSource().fire(new a.g("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new a.g("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=this._changes.getUpdatedImages();if(r.length){for(const o in this._sourceCaches)this._sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],r);this._changes.resetUpdatedImages()}}_updateWorkerLayers(r,o,h){const p=this.getFragmentStyle(r);p&&this.dispatcher.broadcast("updateLayers",{layers:o?p._serializeLayers(o):[],scope:r,removedIds:h||[],options:p.options})}setState(r,o){if(this._checkLoaded(),Dr(this,R(r)))return!1;(r=a.cW(r)).layers=Mo(r.layers);const h=function(g,x){if(!g)return[{command:Jt.setStyle,args:[x]}];let b=[];try{if(!a.d(g.version,x.version))return[{command:Jt.setStyle,args:[x]}];if(a.d(g.center,x.center)||b.push({command:Jt.setCenter,args:[x.center]}),a.d(g.zoom,x.zoom)||b.push({command:Jt.setZoom,args:[x.zoom]}),a.d(g.bearing,x.bearing)||b.push({command:Jt.setBearing,args:[x.bearing]}),a.d(g.pitch,x.pitch)||b.push({command:Jt.setPitch,args:[x.pitch]}),a.d(g.sprite,x.sprite)||b.push({command:Jt.setSprite,args:[x.sprite]}),a.d(g.glyphs,x.glyphs)||b.push({command:Jt.setGlyphs,args:[x.glyphs]}),a.d(g.imports,x.imports)||function(z=[],L=[],k){L=L||[];const B=(z=z||[]).map(Ul),F=L.map(Ul),$=z.reduce(En,{}),G=L.reduce(En,{}),Z=B.slice();let K,W,H,te;for(K=0,W=0;K<B.length;K++)H=B[K],G.hasOwnProperty(H)?W++:(k.push({command:Jt.removeImport,args:[H]}),Z.splice(Z.indexOf(H,W),1));for(K=0,W=0;K<F.length;K++)H=F[F.length-1-K],Z[Z.length-1-K]!==H&&($.hasOwnProperty(H)?(k.push({command:Jt.removeImport,args:[H]}),Z.splice(Z.lastIndexOf(H,Z.length-W),1)):W++,te=Z[Z.length-K],k.push({command:Jt.addImport,args:[G[H],te]}),Z.splice(Z.length-K,0,H));for(const re of L){const he=$[re.id];he&&!a.d(he,re)&&k.push({command:Jt.updateImport,args:[re.id,re]})}}(g.imports,x.imports,b),a.d(g.transition,x.transition)||b.push({command:Jt.setTransition,args:[x.transition]}),a.d(g.light,x.light)||b.push({command:Jt.setLight,args:[x.light]}),a.d(g.fog,x.fog)||b.push({command:Jt.setFog,args:[x.fog]}),a.d(g.projection,x.projection)||b.push({command:Jt.setProjection,args:[x.projection]}),a.d(g.lights,x.lights)||b.push({command:Jt.setLights,args:[x.lights]}),a.d(g.camera,x.camera)||b.push({command:Jt.setCamera,args:[x.camera]}),!a.d(g["color-theme"],x["color-theme"]))return[{command:Jt.setStyle,args:[x]}];const w={},T=[];(function(z,L,k,B){let F;for(F in L=L||{},z=z||{})z.hasOwnProperty(F)&&(L.hasOwnProperty(F)||W3(F,k,B));for(F in L){if(!L.hasOwnProperty(F))continue;const $=L[F];z.hasOwnProperty(F)?a.d(z[F],$)||(z[F].type==="geojson"&&$.type==="geojson"&&So(z,L,F)?k.push({command:Jt.setGeoJSONSourceData,args:[F,$.data]}):Uh(F,L,k,B)):ya(F,L,k)}})(g.sources,x.sources,T,w);const E=[];g.layers&&g.layers.forEach(z=>{z.source&&w[z.source]?b.push({command:Jt.removeLayer,args:[z.id]}):E.push(z)});let O=g.terrain;O&&w[O.source]&&(b.push({command:Jt.setTerrain,args:[void 0]}),O=void 0),b=b.concat(T),a.d(O,x.terrain)||b.push({command:Jt.setTerrain,args:[x.terrain]}),function(z,L,k){L=L||[];const B=(z=z||[]).map(Ul),F=L.map(Ul),$=z.reduce(En,{}),G=L.reduce(En,{}),Z=B.slice(),K=Object.create(null);let W,H,te,re,he,ne,J;for(W=0,H=0;W<B.length;W++)te=B[W],G.hasOwnProperty(te)?H++:(k.push({command:Jt.removeLayer,args:[te]}),Z.splice(Z.indexOf(te,H),1));for(W=0,H=0;W<F.length;W++)te=F[F.length-1-W],Z[Z.length-1-W]!==te&&($.hasOwnProperty(te)?(k.push({command:Jt.removeLayer,args:[te]}),Z.splice(Z.lastIndexOf(te,Z.length-H),1)):H++,ne=Z[Z.length-W],k.push({command:Jt.addLayer,args:[G[te],ne]}),Z.splice(Z.length-W,0,te),K[te]=!0);for(W=0;W<F.length;W++)if(te=F[W],re=$[te],he=G[te],!K[te]&&!a.d(re,he))if(a.d(re.source,he.source)&&a.d(re["source-layer"],he["source-layer"])&&a.d(re.type,he.type)){for(J in es(re.layout,he.layout,k,te,null,Jt.setLayoutProperty),es(re.paint,he.paint,k,te,null,Jt.setPaintProperty),a.d(re.slot,he.slot)||k.push({command:Jt.setSlot,args:[te,he.slot]}),a.d(re.filter,he.filter)||k.push({command:Jt.setFilter,args:[te,he.filter]}),a.d(re.minzoom,he.minzoom)&&a.d(re.maxzoom,he.maxzoom)||k.push({command:Jt.setLayerZoomRange,args:[te,he.minzoom,he.maxzoom]}),re)re.hasOwnProperty(J)&&J!=="layout"&&J!=="paint"&&J!=="filter"&&J!=="metadata"&&J!=="minzoom"&&J!=="maxzoom"&&J!=="slot"&&(J.indexOf("paint.")===0?es(re[J],he[J],k,te,J.slice(6),Jt.setPaintProperty):a.d(re[J],he[J])||k.push({command:Jt.setLayerProperty,args:[te,J,he[J]]}));for(J in he)he.hasOwnProperty(J)&&!re.hasOwnProperty(J)&&J!=="layout"&&J!=="paint"&&J!=="filter"&&J!=="metadata"&&J!=="minzoom"&&J!=="maxzoom"&&J!=="slot"&&(J.indexOf("paint.")===0?es(re[J],he[J],k,te,J.slice(6),Jt.setPaintProperty):a.d(re[J],he[J])||k.push({command:Jt.setLayerProperty,args:[te,J,he[J]]}))}else k.push({command:Jt.removeLayer,args:[te]}),ne=Z[Z.lastIndexOf(te)+1],k.push({command:Jt.addLayer,args:[he,ne]})}(E,x.layers,b)}catch(w){console.warn("Unable to compute style diff:",w),b=[{command:Jt.setStyle,args:[x]}]}return b}(this.serialize(),r).filter(g=>!(g.command in xa));if(h.length===0)return!1;const p=h.filter(g=>!(g.command in Wl));if(p.length>0)throw new Error(`Unimplemented: ${p.map(g=>g.command).join(", ")}.`);const m=[];return h.forEach(g=>{m.push(this[g.command].apply(this,g.args))}),o&&Promise.all(m).then(o),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(r,o){return this.getImage(r)?this.fire(new a.f(new Error("An image with this name already exists."))):(this.imageManager.addImage(r,this.scope,o),this._afterImageUpdated(r),this)}updateImage(r,o){this.imageManager.updateImage(r,this.scope,o)}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._afterImageUpdated(r),this):this.fire(new a.f(new Error("No image with this name exists.")))}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(r),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.g("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(r,o,h={}){return this._checkLoaded(),this._validate(Oe,`models.${r}`,o,null,h)||(this.modelManager.addModel(r,o,this.scope),this._changes.setDirty()),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this):this.fire(new a.f(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,o,h={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(j,`sources.${r}`,o,null,h))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const p=Il(r,o,this.dispatcher,this);p.scope=this.scope,p.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(p.id),source:p.serialize(),sourceId:p.id}));const m=g=>{const x=(g?"symbol:":"other:")+p.id,b=a.am(x,this.scope),w=this._sourceCaches[x]=new a.bx(b,p,g);(g?this._symbolSourceCaches:this._otherSourceCaches)[p.id]=w,w.onAdd(this.map)};m(!1),o.type!=="vector"&&o.type!=="geojson"||m(!0),p.onAdd&&p.onAdd(this.map),h.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const o=this.getOwnSource(r);if(!o)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===r)return this.fire(new a.f(new Error(`Source "${r}" cannot be removed while layer "${p}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new a.f(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));const h=this.getOwnSourceCaches(r);for(const p of h){const m=a.cX(p.id);delete this._sourceCaches[m],this._changes.discardSourceCacheUpdate(p.id),p.fire(new a.g("data",{sourceDataType:"metadata",dataType:"source",sourceId:p.getSource().id})),p.setEventedParent(null),p.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),o.setEventedParent(null),o.onRemove&&o.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,o){this._checkLoaded(),this.getOwnSource(r).setData(o),this._changes.setDirty()}getOwnSource(r){const o=this.getOwnSourceCache(r);return o&&o.getSource()}getOwnSources(){const r=[];for(const o in this._otherSourceCaches){const h=this.getOwnSourceCache(o);h&&r.push(h.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const o in r){const h=r[o]._tiles;for(const p in h){const m=h[p];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const o=this._getTransitionParameters();for(const p of r){if(this._validate(ie,"lights",p))return;switch(p.type){case"ambient":if(this.ambientLight){const m=this.ambientLight;m.set(p),m.updateTransitions(o)}else this.ambientLight=new gs(p,k1||(k1=new a.U({color:new a.W(a.N.properties_light_ambient.color),intensity:new a.W(a.N.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const m=this.directionalLight;m.set(p),m.updateTransitions(o)}else this.directionalLight=new gs(p,B1||(B1=new a.U({direction:new a.a6(a.N.properties_light_directional.direction),color:new a.W(a.N.properties_light_directional.color),intensity:new a.W(a.N.properties_light_directional.intensity),"cast-shadows":new a.W(a.N.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.W(a.N.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const h=new a.Y(this.z||0,o);this.ambientLight&&this.ambientLight.recalculate(h),this.directionalLight&&this.directionalLight.recalculate(h),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,o=this.ambientLight;if(!r||!o)return;const h=E=>.2126*(E[0]<=.03928?E[0]/12.92:Math.pow((E[0]+.055)/1.055,2.4))+.7152*(E[1]<=.03928?E[1]/12.92:Math.pow((E[1]+.055)/1.055,2.4))+.0722*(E[2]<=.03928?E[2]/12.92:Math.pow((E[2]+.055)/1.055,2.4)),p=r.properties.get("color").toRenderColor(null).toArray01(),m=r.properties.get("intensity"),g=r.properties.get("direction"),x=1-a.ad(g.x,g.y,g.z)[2]/90,b=h(p)*m*x,w=o.properties.get("color").toRenderColor(null).toArray01(),T=o.properties.get("intensity");return(b+h(w)*T)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(!r)return this;if(a.cY(r)){const o=a.cZ(r),h=this.fragments.find(({id:m})=>m===o);if(!h)throw new Error(`Style import not found: ${r}`);const p=a.cX(r);return h.style.getFragmentStyle(p)}{const o=this.fragments.find(({id:h})=>h===r);if(!o)throw new Error(`Style import not found: ${r}`);return o.style}}getConfigProperty(r,o){const h=this.getFragmentStyle(r);if(!h)return null;const p=a.am(o,h.scope),m=h.options.get(p),g=m?m.value||m.default:null;return g?g.serialize():null}setConfigProperty(r,o,h){const p=this.getFragmentStyle(r);if(!p)return;const m=p.stylesheet.schema;if(!m||!m[o])return;const g=a.z(h);if(g.result!=="success")return void Dr(this,g.value);const x=g.value.expression,b=a.am(o,p.scope),w=p.options.get(b);if(!w)return;let T;const{minValue:E,maxValue:O,stepValue:z,type:L,values:k}=m[o],B=a.z(m[o].default);B.result==="success"&&(T=B.value.expression),T?(this.options.set(b,{...w,value:x,default:T,minValue:E,maxValue:O,stepValue:z,type:L,values:k}),this.updateConfigDependencies(o)):this.fire(new a.f(new Error(`No schema defined for the config option "${o}" in the "${r}" fragment.`)))}getConfig(r){const o=this.getFragmentStyle(r);if(!o)return null;const h=o.stylesheet.schema;if(!h)return null;const p={};for(const m in h){const g=a.am(m,o.scope),x=o.options.get(g),b=x?x.value||x.default:null;p[m]=b?b.serialize():null}return p}setConfig(r,o){const h=this.getFragmentStyle(r);h&&(h.updateConfig(o,h.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const o=this.getFragmentStyle(r);return o?o.stylesheet.schema:null}setSchema(r,o){const h=this.getFragmentStyle(r);h&&(h.stylesheet.schema=o,h.updateConfig(h._config,o),this.updateConfigDependencies())}updateConfig(r,o){if(this._config=r,r||o)if(o)for(const h in o){let p,m;const g=a.z(o[h].default);if(g.result==="success"&&(p=g.value.expression),r&&r[h]!==void 0){const O=a.z(r[h]);O.result==="success"&&(m=O.value.expression)}const{minValue:x,maxValue:b,stepValue:w,type:T,values:E}=o[h];if(p){const O=a.am(h,this.scope);this.options.set(O,{default:p,value:m,minValue:x,maxValue:b,stepValue:w,type:T,values:E})}else this.fire(new a.f(new Error(`No schema defined for config option "${h}".`)))}else this.fire(new a.f(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const o of this._configDependentLayers){const h=this.getLayer(o);if(h){if(r&&!h.configDependencies.has(r))continue;h.possiblyEvaluateVisibility(),this._updateLayer(h)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(o=>{if(o._styleColorTheme.colorTheme){const h=o._evaluateColorThemeData(o._styleColorTheme.colorTheme);(!o._styleColorTheme.lut&&h!==""||o._styleColorTheme.lut&&h!==o._styleColorTheme.lut.data)&&o.setColorTheme(o._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(r,o,h={}){this._checkLoaded();const p=r.id;if(this._layers[p])return void this.fire(new a.f(new Error(`Layer with id "${p}" already exists on this map`)));let m;if(r.type==="custom"){if(Dr(this,a.c_(r)))return;m=a.c$(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(p,r.source),r=a.cW(r),r=a.Q(r,{source:p})),this._validate(ve,`layers.${p}`,r,{arrayIndex:-1},h))return;m=a.c$(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(m),m.setEventedParent(this,{layer:{id:p}}),this._serializedLayers[m.id]=m.serialize()}m.configDependencies.size!==0&&this._configDependentLayers.add(m.fqid);let g=this._order.length;if(o){const T=this._order.indexOf(o);if(T===-1)return void this.fire(new a.f(new Error(`Layer with id "${o}" does not exist on this map.`)));m.slot===this._layers[o].slot?g=T:a.w(`Layer with id "${o}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(g,0,p),this._layerOrderChanged=!0,this._layers[p]=m;const x=this.getOwnLayerSourceCache(m),b=!!this.directionalLight&&this.directionalLight.shadowsEnabled();x&&m.canCastShadows()&&b&&(x.castsShadows=!0);const w=this._changes.getRemovedLayer(m);if(w&&m.source&&x&&m.type!=="custom"){this._changes.discardLayerRemoval(m);const T=a.am(m.source,m.scope);w.type!==m.type?this._changes.updateSourceCache(T,"clear"):(this._changes.updateSourceCache(T,"reload"),x.pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map),m.scope=this.scope,this.mergeLayers()}moveLayer(r,o){this._checkLoaded();const h=this._checkLayer(r);if(!h||r===o)return;const p=this._order.indexOf(r);this._order.splice(p,1);let m=this._order.length;if(o){const g=this._order.indexOf(o);if(g===-1)return void this.fire(new a.f(new Error(`Layer with id "${o}" does not exist on this map.`)));h.slot===this._layers[o].slot?m=g:a.w(`Layer with id "${o}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(m,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const o=this._checkLayer(r);if(!o)return;o.setEventedParent(null);const h=this._order.indexOf(r);this._order.splice(h,1),delete this._layers[r],delete this._serializedLayers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(o.fqid),this._changes.removeLayer(o);const p=this.getOwnLayerSourceCache(o);if(p&&p.castsShadows){let m=!1;for(const g in this._layers)if(this._layers[g].source===o.source&&this._layers[g].canCastShadows()){m=!0;break}p.castsShadows=m}o.onRemove&&o.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const o in this._layers)if(this._layers[o].type===r)return!0;return!1}setLayerZoomRange(r,o,h){this._checkLoaded();const p=this._checkLayer(r);p&&(p.minzoom===o&&p.maxzoom===h||(o!=null&&(p.minzoom=o),h!=null&&(p.maxzoom=h),this._updateLayer(p)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,o){this._checkLoaded();const h=this._checkLayer(r);h&&h.slot!==o&&(h.slot=o,this._updateLayer(h))}setFilter(r,o,h={}){this._checkLoaded();const p=this._checkLayer(r);if(p&&!a.d(p.filter,o))return o==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(ce,`layers.${p.id}.filter`,o,{layerType:p.type},h)||(p.filter=a.cW(o),this._updateLayer(p)))}getFilter(r){const o=this._checkLayer(r);if(o)return a.cW(o.filter)}setLayoutProperty(r,o,h,p={}){this._checkLoaded();const m=this._checkLayer(r);if(m&&!a.d(m.getLayoutProperty(o),h)){if(h!=null&&(!p||p.validate!==!1)&&Dr(m,ze.call(R,{key:`layers.${r}.layout.${o}`,layerType:m.type,objectKey:o,value:h,styleSpec:a.N,style:{glyphs:!0,sprite:!0}})))return;m.setLayoutProperty(o,h),m.configDependencies.size!==0&&this._configDependentLayers.add(m.fqid),this._updateLayer(m)}}getLayoutProperty(r,o){const h=this._checkLayer(r);if(h)return h.getLayoutProperty(o)}setPaintProperty(r,o,h,p={}){this._checkLoaded();const m=this._checkLayer(r);if(!m||a.d(m.getPaintProperty(o),h)||h!=null&&(!p||p.validate!==!1)&&Dr(m,ye.call(R,{key:`layers.${r}.paint.${o}`,layerType:m.type,objectKey:o,value:h,styleSpec:a.N})))return;const g=m.setPaintProperty(o,h);m.configDependencies.size!==0&&this._configDependentLayers.add(m.fqid),g&&this._updateLayer(m),this._changes.updatePaintProperties(m)}getPaintProperty(r,o){const h=this._checkLayer(r);if(h)return h.getPaintProperty(o)}setFeatureState(r,o){this._checkLoaded();const h=r.source,p=r.sourceLayer,m=this._checkSource(h);if(!m)return;const g=m.type;if(g==="geojson"&&p)return void this.fire(new a.f(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(g==="vector"&&!p)return void this.fire(new a.f(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new a.f(new Error("The feature id parameter must be provided.")));const x=this.getOwnSourceCaches(h);for(const b of x)b.setFeatureState(p,r.id,o)}removeFeatureState(r,o){this._checkLoaded();const h=r.source,p=this._checkSource(h);if(!p)return;const m=p.type,g=m==="vector"?r.sourceLayer:void 0;if(m==="vector"&&!g)return void this.fire(new a.f(new Error("The sourceLayer parameter must be provided for vector source types.")));if(o&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new a.f(new Error("A feature id is required to remove its specific state property.")));const x=this.getOwnSourceCaches(h);for(const b of x)b.removeFeatureState(g,r.id,o)}getFeatureState(r){this._checkLoaded();const o=r.source,h=r.sourceLayer,p=this._checkSource(o);if(p){if(p.type!=="vector"||h)return r.id===void 0&&this.fire(new a.f(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(o)[0].getFeatureState(h,r.id);this.fire(new a.f(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=a.Q({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return a.Q({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),o=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return a.d0({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:o,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateLayer(r){this._changes.updateLayer(r);const o=this.getLayerSourceCache(r),h=a.am(r.source,r.scope),p=this._changes.getUpdatedSourceCaches();r.source&&!p[h]&&o&&o.getSource().type!=="raster"&&(this._changes.updateSourceCache(h,"reload"),o.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const o=x=>this._mergedLayers[x].type==="fill-extrusion"||this._mergedLayers[x].type==="model",h=this.order,p={},m=[];for(let x=h.length-1;x>=0;x--){const b=h[x];if(o(b)){p[b]=x;for(const w of r){const T=w[b];if(T)for(const E of T)m.push(E)}}}m.sort((x,b)=>b.intersectionZ-x.intersectionZ);const g=[];for(let x=h.length-1;x>=0;x--){const b=h[x];if(o(b))for(let w=m.length-1;w>=0;w--){const T=m[w].feature;if(T.layer&&p[T.layer.id]<x)break;g.push(T),m.pop()}else for(const w of r){const T=w[b];if(T)for(const E of T)g.push(E.feature)}}return g}queryRenderedFeatures(r,o,h){o&&o.filter&&this._validate(ce,"queryRenderedFeatures.filter",o.filter,null,o),o.scope=this.scope,o.availableImages=this._availableImages,o.serializedLayers=this._serializedLayers;const p={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new a.f(new Error("parameters.layers must be an Array."))),[];for(const w of o.layers){const T=this._mergedLayers[w];if(!T)return this.fire(new a.f(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];p[T.source]=!0}}const m=[],g=o.serializedLayers||{},x=o&&o.layers?o.layers.some(w=>{const T=this.getLayer(w);return T&&T.is3D()}):this.has3DLayers(),b=Or.createFromScreenPoints(r,h);for(const w in this._mergedSourceCaches){const T=this._mergedSourceCaches[w].getSource();if(!T||T.scope!==o.scope)continue;const E=this._mergedSourceCaches[w].getSource().id;o.layers&&!p[E]||m.push(Sn(this._mergedSourceCaches[w],this._mergedLayers,g,b,o,h,x,!!this.map._showQueryGeometry))}return this.placement&&m.push(function(w,T,E,O,z,L,k){const B={},F=L.queryRenderedSymbols(O),$=[];for(const G of Object.keys(F).map(Number))$.push(k[G]);$.sort(mc);for(const G of $){const Z=G.featureIndex.lookupSymbolFeatures(F[G.bucketInstanceId],T,G.bucketIndex,G.sourceLayerIndex,z.filter,z.layers,z.availableImages,w);for(const K in Z){const W=B[K]=B[K]||[],H=Z[K];H.sort((te,re)=>{const he=G.featureSortOrder;if(he){const ne=he.indexOf(te.featureIndex);return he.indexOf(re.featureIndex)-ne}return re.featureIndex-te.featureIndex});for(const te of H)W.push(te)}}for(const G in B)B[G].forEach(Z=>{const K=Z.feature,W=E(w[G]);if(!W)return;const H=W.getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=H});return B}(this._mergedLayers,g,this.getLayerSourceCache.bind(this),b.screenGeometry,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(r,o){o&&o.filter&&this._validate(ce,"querySourceFeatures.filter",o.filter,null,o);const h=this.getOwnSourceCaches(r);let p=[];for(const m of h)p=p.concat(Nh(m,o));return p}addSourceType(r,o,h){return Rr.getSourceType(r)?h(new Error(`A source type called "${r}" already exists.`)):(Rr.setSourceType(r,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:o.workerSourceURL},h):h(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,o,h={}){this._checkLoaded();const p=this.light.getLight();let m=!1;for(const x in r)if(!a.d(r[x],p[x])){m=!0;break}if(!m)return;const g=this._getTransitionParameters();this.light.setLight(r,o,h),this.light.updateTransitions(g)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,o=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),o===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let h=r;const p=r.source==null;if(o===1){if(this.disableElevatedTerrain)return;if(typeof h.source=="object"){const x="terrain-dem-src";this.addSource(x,h.source),h=a.cW(h),h=a.Q(h,{source:x})}const m=a.Q({},h),g={};if(this.terrain&&p){m.source=this.terrain.get().source;const x=this.terrain?this.getFragmentStyle(this.terrain.scope):null;x&&(g.style=x.serialize())}if(this._validate(Q,"terrain",m,g))return}if(!this.terrain||this.terrain.scope!==this.scope&&!p||this.terrain&&o!==this.terrain.drapeRenderMode){if(!h)return;this._createTerrain(h,o),this.fire(new a.g("data",{dataType:"style"}))}else{const m=this.terrain,g=m.get();for(const x of Object.keys(a.N.terrain))!h.hasOwnProperty(x)&&a.N.terrain[x].default&&(h[x]=a.N.terrain[x].default);for(const x in r)if(!a.d(r[x],g[x])){m.set(r,this.options),this.stylesheet.terrain=r;const b=this._getTransitionParameters({duration:0});m.updateTransitions(b),this.fire(new a.g("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const o=this.fog=new mr(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=o.get();const h=this._getTransitionParameters({duration:0});o.updateTransitions(h)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const o=this.fog;if(!a.d(o.get(),r)){o.set(r,this.options),this.stylesheet.fog=o.get();const h=this._getTransitionParameters({duration:0});o.updateTransitions(h)}}else this._createFog(r);this._markersNeedUpdate=!0}setColorTheme(r){this._checkLoaded();const o=()=>{for(const p in this._layers)this._layers[p].lut=this._styleColorTheme.lut;for(const p in this._sourceCaches)this._sourceCaches[p].clearTiles()};if(this._styleColorTheme.colorTheme=r,!r)return this._styleColorTheme.lut=null,void o();const h=this._evaluateColorThemeData(r);this._loadColorTheme(h).then(()=>{this.fire(new a.g("colorthemeset")),o()}).catch(p=>{a.w(`Couldn't set color theme: ${p}`)})}_getTransitionParameters(r){return{now:a.e.now(),transition:a.Q(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],o=[];for(const h of this._mergedOrder)this.isLayerDraped(this._mergedLayers[h])?r.push(h):o.push(h);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...o)}_createTerrain(r,o){const h=this.terrain=new Zt(r,o,this.scope,this.options);o===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const p=this._getTransitionParameters({duration:0});h.updateTransitions(p)}_force3DLayerUpdate(){for(const r in this._layers){const o=this._layers[r];o.type==="fill-extrusion"&&this._updateLayer(o)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const o=this._layers[r];o.type==="symbol"&&this._updateLayer(o)}}_validate(r,o,h,p,m={}){if(m&&m.validate===!1)return!1;const g=a.Q({},this.serialize());return Dr(this,r.call(R,a.Q({key:o,style:g,value:h,styleSpec:a.N},p)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.d1.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(r){const o=this.getSourceCaches(r);for(const h of o)h.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const o=this.getSourceCaches(r);for(const h of o)h.resume(),h.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}updateSources(r){let o;this.directionalLight&&(o=ca(this.directionalLight));for(const h in this._mergedSourceCaches)this._mergedSourceCaches[h].update(r,void 0,void 0,o)}_generateCollisionBoxes(){for(const r in this._sourceCaches){const o=this._sourceCaches[r];o.resume(),o.reload()}}_updatePlacement(r,o,h,p,m,g,x=!1){let b=!1,w=!1;const T={},E={};for(const O of this._mergedOrder){const z=this._mergedLayers[O];if(z.type!=="symbol")continue;const L=a.am(z.source,z.scope);let k=T[L];if(!k){const F=this.getLayerSourceCache(z);if(!F)continue;const $=F.getRenderableIds(!0).map(G=>F.getTileByID(G));E[L]=$.slice(),k=T[L]=$.sort((G,Z)=>Z.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(Z.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(z,k,o.center.lng,o.projection);b=b||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),x=x||this._layerOrderChanged||p===0,this._layerOrderChanged&&this.fire(new a.g("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.e.now(),o.zoom))&&(this.pauseablePlacement=new tu(o,this._mergedOrder,x,h,p,m,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,T,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.e.now()),w=!0),b&&this.pauseablePlacement.placement.setStale()),w||b){this._buildingIndex.onNewFrame(o.zoom);for(let O=0;O<this._mergedOrder.length;O++){const z=this._mergedLayers[this._mergedOrder[O]];if(z.type!=="symbol")continue;const L=this.isLayerClipped(z)&&this._clipLayerIndices.some(k=>O<k);this.placement.updateLayerOpacities(z,T[a.am(z.source,z.scope)],O,L?g:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.e.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,o){this._checkLoaded();const h=this.stylesheet.imports=this.stylesheet.imports||[];if(h.findIndex(({id:m})=>m===r.id)!==-1)return void this.fire(new a.f(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!o)return h.push(r),this._loadImports([r],!0);const p=h.findIndex(({id:m})=>m===o);return p===-1&&this.fire(new a.f(new Error(`Import with id "${o}" does not exist on this map.`))),this.stylesheet.imports=h.slice(0,p).concat(r).concat(h.slice(p)),this._loadImports([r],!0,o)}updateImport(r,o){this._checkLoaded();const h=this.stylesheet.imports||[],p=this.getImportIndex(r);return p===-1?this:typeof o=="string"?(this.setImportUrl(r,o),this):(o.url&&o.url!==h[p].url&&this.setImportUrl(r,o.url),a.d(o.config,h[p].config)||this.setImportConfig(r,o.config),a.d(o.data,h[p].data)||this.setImportData(r,o.data),this)}moveImport(r,o){this._checkLoaded();let h=this.stylesheet.imports||[];const p=this.getImportIndex(r);if(p===-1)return this;const m=this.getImportIndex(o);if(m===-1)return this;const g=h[p],x=this.fragments[p];return h=h.filter(({id:b})=>b!==r),this.fragments=this.fragments.filter(({id:b})=>b!==r),this.stylesheet.imports=h.slice(0,m).concat(g).concat(h.slice(m)),this.fragments=this.fragments.slice(0,m).concat(x).concat(this.fragments.slice(m)),this.mergeLayers(),this}setImportUrl(r,o){this._checkLoaded();const h=this.stylesheet.imports||[],p=this.getImportIndex(r);if(p===-1)return this;h[p].url=o;const m=this.fragments[p];return m.style=this._createFragmentStyle(h[p]),m.style.on("style.import.load",()=>this.mergeAll()),m.style.loadURL(o),this}setImportData(r,o){this._checkLoaded();const h=this.getImportIndex(r),p=this.stylesheet.imports||[];return h===-1?this:o?(this.fragments[h].style.setState(o),this._reloadImports(),this):(delete p[h].data,this.setImportUrl(r,p[h].url))}setImportConfig(r,o){this._checkLoaded();const h=this.getImportIndex(r),p=this.stylesheet.imports||[];if(h===-1)return this;o?p[h].config=o:delete p[h].config;const m=this.fragments[h],g=m.style.stylesheet&&m.style.stylesheet.schema;return m.config=o,m.style.updateConfig(o,g),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const o=this.stylesheet.imports||[],h=this.getImportIndex(r);h!==-1&&(o.splice(h,1),this.fragments[h].style._remove(),this.fragments.splice(h,1),this._reloadImports())}getImportIndex(r){const o=(this.stylesheet.imports||[]).findIndex(h=>h.id===r);return o===-1&&this.fire(new a.f(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),o}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const o in this._mergedOtherSourceCaches){const h=this._mergedOtherSourceCaches[o];h&&r.push(h.getSource())}return r}getSource(r,o){const h=this.getSourceCache(r,o);return h&&h.getSource()}getLayerSource(r){const o=this.getLayerSourceCache(r);return o&&o.getSource()}getSourceCache(r,o){const h=a.am(r,o);return this._mergedOtherSourceCaches[h]}getLayerSourceCache(r){const o=a.am(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[o]:this._mergedOtherSourceCaches[o]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const o=[];return this._mergedOtherSourceCaches[r]&&o.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&o.push(this._mergedSymbolSourceCaches[r]),o}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const o in r){const h=r[o];h==="reload"?this.reloadSource(o):h==="clear"&&this.clearSource(o)}}updateLayers(r){const o=this._changes.getUpdatedPaintProperties();for(const h of o){const p=this.getLayer(h);p&&p.updateTransitions(r)}}getImages(r,o,h){this.imageManager.getImages(o.icons,o.scope,h),this._updateTilesForChangedImages();const p=m=>{m&&m.setDependencies(o.tileID.key,o.type,o.icons)};p(this._otherSourceCaches[o.source]),p(this._symbolSourceCaches[o.source])}getGlyphs(r,o,h){this.glyphManager.getGlyphs(o.stacks,o.scope,h)}getResource(r,o,h){return a.d2(o,h)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const o=[];return this._otherSourceCaches[r]&&o.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&o.push(this._symbolSourceCaches[r]),o}_isSourceCacheLoaded(r){const o=this.getOwnSourceCaches(r);return o.length===0?(this.fire(new a.f(new Error(`There is no source with ID '${r}'`))),!1):o.every(h=>h.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,o){if(this._clipLayerIndices.length===0&&r.type!=="fill-extrusion")return!1;const h=r.type==="fill-extrusion"&&r.sourceLayer==="building";let p=0;if(r.is3D()){if(h||o&&o.type==="batched-model")return!0;r.type==="model"&&(p=a.cw.Model)}else r.type==="symbol"&&(p=a.cw.Symbol);for(const m of this._clipLayerIndices){const g=this._mergedLayers[this._mergedOrder[m]];if(!g)continue;const x=[];for(const b of g.layout.get("clip-layer-types"))x.push(b==="model"?a.cw.Model:b==="symbol"?a.cw.Symbol:a.cw.FillExtrusion);for(const b of x)if(p&b)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function su(u,r){let o=!1,h=null;const p=()=>{h=null,o&&(u(),h=setTimeout(p,r),o=!1)};return()=>(o=!0,h||p(),h)}Rr.getSourceType=function(u){return El[u]},Rr.setSourceType=function(u,r){El[u]=r},Rr.registerForPluginStateChange=a.cO;class au{constructor(r){this._hashName=r&&encodeURIComponent(r),a.br(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=su(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const o=Cc(r);if(this._hashName){const h=this._hashName;let p=!1;const m=location.hash.slice(1).split("&").map(g=>{const x=g.split("=")[0];return x===h?(p=!0,`${x}=${o}`):g}).filter(g=>g);return p||m.push(`${h}=${o}`),`#${m.join("&")}`}return`#${o}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let o;return r.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(o=h)}),(o&&o[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const o=this._getCurrentHash();if(o.length>=3&&!o.some(h=>isNaN(h))){const h=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(o[3]||0):r.getBearing();return r.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:h,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Cc(u,r){const o=u.getCenter(),h=Math.round(100*u.getZoom())/100,p=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,p),g=Math.round(o.lng*m)/m,x=Math.round(o.lat*m)/m,b=u.getBearing(),w=u.getPitch();let T=r?`/${g}/${x}/${h}`:`${h}/${x}/${g}`;return(b||w)&&(T+="/"+Math.round(10*b)/10),w&&(T+=`/${Math.round(w)}`),T}const va={linearity:.3,easing:a.d3(0,0,.3,1)},Gh=a.Q({deceleration:2500,maxSpeed:1400},va),qh=a.Q({deceleration:20,maxSpeed:1400},va),Wh=a.Q({deceleration:1e3,maxSpeed:360},va),Hh=a.Q({deceleration:1e3,maxSpeed:90},va);class ou{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.e.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,o=a.e.now();for(;r.length>0&&o-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const o={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(o.pan.mag()){const m=Ss(o.pan.mag(),h,a.Q({},Gh,r||{}));p.offset=o.pan.mult(m.amount/o.pan.mag()),p.center=this._map.transform.center,Hl(p,m)}if(o.zoom){const m=Ss(o.zoom,h,qh);p.zoom=this._map.transform.zoom+m.amount,Hl(p,m)}if(o.bearing){const m=Ss(o.bearing,h,Wh);p.bearing=this._map.transform.bearing+a.au(m.amount,-179,179),Hl(p,m)}if(o.pitch){const m=Ss(o.pitch,h,Hh);p.pitch=this._map.transform.pitch+m.amount,Hl(p,m)}if(p.zoom||p.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;p.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),p.noMoveStart=!0,p}}function Hl(u,r){(!u.duration||u.duration<r.duration)&&(u.duration=r.duration,u.easing=r.easing)}function Ss(u,r,o){const{maxSpeed:h,linearity:p,deceleration:m}=o,g=a.au(u*p/(r/1e3),-h,h),x=Math.abs(g)/(m*p);return{easing:o.easing,duration:1e3*x,amount:g*(x/2)}}class Lr extends a.g{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,h,p={}){const m=Ai(o.getCanvasContainer(),h),g=o.unproject(m);super(r,a.Q({point:m,lngLat:g,originalEvent:h},p)),this._defaultPrevented=!1,this.target=o}}class Do extends a.g{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,h){const p=r==="touchend"?h.changedTouches:h.touches,m=Mi(o.getCanvasContainer(),p),g=m.map(b=>o.unproject(b)),x=m.reduce((b,w,T,E)=>b.add(w.div(E.length)),new a.P(0,0));super(r,{points:m,point:x,lngLats:g,lngLat:o.unproject(x),originalEvent:h}),this._defaultPrevented=!1}}class bc extends a.g{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o){super("wheel",{originalEvent:o}),this._defaultPrevented=!1}}class Xl{constructor(r,o){this._map=r,this._clickTolerance=o.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new bc(this._map,r))}mousedown(r,o){return this._mousedownPos=o,this._firePreventable(new Lr(r.type,this._map,r))}mouseup(r){this._map.fire(new Lr(r.type,this._map,r))}preclick(r){const o=a.Q({},r);o.type="preclick",this._map.fire(new Lr(o.type,this._map,o))}click(r,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Lr(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Lr(r.type,this._map,r))}mouseover(r){this._map.fire(new Lr(r.type,this._map,r))}mouseout(r){this._map.fire(new Lr(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Do(r.type,this._map,r))}touchmove(r){this._map.fire(new Do(r.type,this._map,r))}touchend(r){this._map.fire(new Do(r.type,this._map,r))}touchcancel(r){this._map.fire(new Do(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wc{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Lr(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Lr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Lr(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Es{constructor(r,o){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,o){this.isEnabled()&&r.shiftKey&&r.button===0&&(pr(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(r,o){if(!this._active)return;const h=o,p=this._startPos,m=this._lastPos;if(!p||!m||m.equals(h)||!this._box&&h.dist(p)<this._clickTolerance)return;this._lastPos=h,this._box||(this._box=It("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const g=Math.min(p.x,h.x),x=Math.max(p.x,h.x),b=Math.min(p.y,h.y),w=Math.max(p.y,h.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${g}px,${b}px)`,this._box.style.width=x-g+"px",this._box.style.height=w-b+"px")})}mouseupWindow(r,o){if(!this._active)return;const h=this._startPos,p=o;if(h&&r.button===0){if(this.reset(),dn(),h.x!==p.x||h.y!==p.y)return this._map.fire(new a.g("boxzoomend",{originalEvent:r})),{cameraAnimation:m=>m.fitScreenCoordinates(h,p,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Zn(),delete this._startPos,delete this._lastPos}_fireEvent(r,o){return this._map.fire(new a.g(r,{originalEvent:o}))}}function Ro(u,r){const o={};for(let h=0;h<u.length;h++)o[u[h].identifier]=r[h];return o}class lu{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,o,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),h.length===this.numTouches&&(this.centroid=function(p){const m=new a.P(0,0);for(const g of p)m._add(g);return m.div(p.length)}(o),this.touches=Ro(h,o)))}touchmove(r,o,h){if(this.aborted||!this.centroid)return;const p=Ro(h,o);for(const m in this.touches){const g=p[m];(!g||g.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(r,o,h){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class is{constructor(r){this.singleTap=new lu(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,o,h){this.singleTap.touchstart(r,o,h)}touchmove(r,o,h){this.singleTap.touchmove(r,o,h)}touchend(r,o,h){const p=this.singleTap.touchend(r,o,h);if(p){const m=r.timeStamp-this.lastTime<500,g=!this.lastTap||this.lastTap.dist(p)<30;if(m&&g||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Lo{constructor(){this._zoomIn=new is({numTouches:1,numTaps:2}),this._zoomOut=new is({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,o,h){this._zoomIn.touchstart(r,o,h),this._zoomOut.touchstart(r,o,h)}touchmove(r,o,h){this._zoomIn.touchmove(r,o,h),this._zoomOut.touchmove(r,o,h)}touchend(r,o,h){const p=this._zoomIn.touchend(r,o,h),m=this._zoomOut.touchend(r,o,h);return p?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:g.getZoom()+1,around:g.unproject(p)},{originalEvent:r})}):m?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:g.getZoom()-1,around:g.unproject(m)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Yl={0:1,2:2};class ko{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,o){return!1}_move(r,o){return{}}mousedown(r,o){if(this._lastPoint)return;const h=$n(r);this._correctButton(r,h)&&(this._lastPoint=o,this._eventButton=h)}mousemoveWindow(r,o){const h=this._lastPoint;if(h){if(r.preventDefault(),this._eventButton!=null&&function(p,m){const g=Yl[m];return p.buttons===void 0||(p.buttons&g)!==g}(r,this._eventButton))this.reset();else if(this._moved||!(o.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(h,o)}}mouseupWindow(r){this._lastPoint&&$n(r)===this._eventButton&&(this._moved&&dn(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bo extends ko{mousedown(r,o){super.mousedown(r,o),this._lastPoint&&(this._active=!0)}_correctButton(r,o){return o===0&&!r.ctrlKey}_move(r,o){return{around:o,panDelta:o.sub(r)}}}class Fo extends ko{_correctButton(r,o){return o===0&&r.ctrlKey||o===2}_move(r,o){const h=.8*(o.x-r.x);if(h)return this._active=!0,{bearingDelta:h}}contextmenu(r){r.preventDefault()}}class Jl extends ko{_correctButton(r,o){return o===0&&r.ctrlKey||o===2}_move(r,o){const h=-.5*(o.y-r.y);if(h)return this._active=!0,{pitchDelta:h}}contextmenu(r){r.preventDefault()}}class cu{constructor(r,o){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset(),a.br(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(r,o,h){return this._calculateTransform(r,o,h)}touchmove(r,o,h){if(this._active&&!(h.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(h.length===1&&!a.d4())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,o,h)}}touchend(r,o,h){this._calculateTransform(r,o,h),this._active&&h.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,o,h){h.length>0&&(this._active=!0);const p=Ro(h,o),m=new a.P(0,0),g=new a.P(0,0);let x=0;for(const w in p){const T=p[w],E=this._touches[w];E&&(m._add(T),g._add(T.sub(E)),x++,p[w]=T)}if(this._touches=p,x<this._minTouches||!g.mag())return;const b=g.div(x);return this._sum._add(b),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(x),panDelta:b}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=It("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class jo{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,o,h){return{}}touchstart(r,o,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([o[0],o[1]]))}touchmove(r,o,h){const p=this._firstTwoTouches;if(!p)return;r.preventDefault();const[m,g]=p,x=Is(h,o,m),b=Is(h,o,g);if(!x||!b)return;const w=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],w,r)}touchend(r,o,h){if(!this._firstTwoTouches)return;const[p,m]=this._firstTwoTouches,g=Is(h,o,p),x=Is(h,o,m);g&&x||(this._active&&dn(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Is(u,r,o){for(let h=0;h<u.length;h++)if(u[h].identifier===o)return r[h]}function Ca(u,r){return Math.log(u/r)/Math.LN2}class uu extends jo{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,o){const h=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Ca(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ca(this._distance,h),pinchAround:o}}}function Ac(u,r){return 180*u.angleWith(r)/Math.PI}class hu extends jo{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,o){const h=this._vector;if(this._vector=r[0].sub(r[1]),h&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ac(this._vector,h),pinchAround:o}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const o=25/(Math.PI*this._minDiameter)*360,h=this._startVector;if(!h)return!1;const p=Ac(r,h);return Math.abs(p)<o}}function rs(u){return Math.abs(u.y)>Math.abs(u.x)}class du extends jo{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,rs(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,o,h){const p=this._lastPoints;if(!p)return;const m=r[0].sub(p[0]),g=r[1].sub(p[1]);return this._map._cooperativeGestures&&!a.d4()&&h.touches.length<3||(this._valid=this.gestureBeginsVertically(m,g,h.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(m.y+g.y)/2*-.5})}gestureBeginsVertically(r,o,h){if(this._valid!==void 0)return this._valid;const p=r.mag()>=2,m=o.mag()>=2;if(!p&&!m)return;if(!p||!m)return this._firstMove==null&&(this._firstMove=h),h-this._firstMove<100&&void 0;const g=r.y>0==o.y>0;return rs(r)&&rs(o)&&g}}const Xh={panStep:100,bearingStep:15,pitchStep:10};class Yh{constructor(){const r=Xh;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let o=0,h=0,p=0,m=0,g=0;switch(r.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:r.shiftKey?h=-1:(r.preventDefault(),m=-1);break;case 39:r.shiftKey?h=1:(r.preventDefault(),m=1);break;case 38:r.shiftKey?p=1:(r.preventDefault(),g=-1);break;case 40:r.shiftKey?p=-1:(r.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(h=0,p=0),{cameraAnimation:x=>{const b=x.getZoom();x.easeTo({duration:300,easeId:"keyboardHandler",easing:Jh,zoom:o?Math.round(b)+o*(r.shiftKey?2:1):b,bearing:x.getBearing()+h*this._bearingStep,pitch:x.getPitch()+p*this._pitchStep,offset:[-m*this._panStep,-g*this._panStep],center:x.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jh(u){return u*(2-u)}const Kl=4.000244140625,Tc=1/450;class Mc{constructor(r,o){this._map=r,this._el=r.getCanvasContainer(),this._handler=o,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Tc,a.br(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||a.d4()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let o=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const h=a.e.now(),p=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,o!==0&&o%Kl==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=o,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(p*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),r.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=r,this._delta-=o,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=Ai(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:o,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const o=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Kl?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const E=o(),O=Math.pow(2,E),z=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):O;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(z*T))),this._type==="wheel"&&(this._startZoom=E,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:o(),p=this._startZoom,m=this._easing;let g,x=!1;if(this._type==="wheel"&&p&&m){const w=Math.min((a.e.now()-this._lastWheelEventTime)/200,1),T=m(w);g=a.a3(p,h,T),w<1?this._frameId||(this._frameId=!0):x=!0}else g=h,x=!0;this._active=!0,x&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let b=g-o();return b*this._lastDelta<0&&(b=0),{noInertia:!0,needsRenderFrame:!x,zoomDelta:b,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let o=a.d5;if(this._prevEase){const h=this._prevEase,p=(a.e.now()-h.start)/h.duration,m=h.easing(p+.01)-h.easing(p),g=.27/Math.sqrt(m*m+1e-4)*.01,x=Math.sqrt(.0729-g*g);o=a.d3(g,x,.25,1)}return this._prevEase={start:a.e.now(),duration:r,easing:o},o}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=It("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Sc{constructor(r,o){this._clickZoom=r,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class pu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,o){return r.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:h.getZoom()+(r.shiftKey?-1:1),around:h.unproject(o)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu{constructor(){this._tap=new is({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,o,h){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=o[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(r,o,h))}touchmove(r,o,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const p=o[0],m=p.y-this._swipePoint.y;return this._swipePoint=p,r.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(r,o,h)}touchend(r,o,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(r,o,h)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kh{constructor(r,o,h){this._el=r,this._mousePan=o,this._touchPan=h}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class No{constructor(r,o,h){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=o,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Vo{constructor(r,o,h,p){this._el=r,this._touchZoom=o,this._touchRotate=h,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Uo=u=>u.zoom||u.drag||u.pitch||u.rotate;class kr extends a.g{}class Ec{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,o){const h=a.$.sub([],o,r);this.radius=a.$.length(h[2]<0?a.$.div([],h,this.constants):[h[0],h[1],0])}projectRay(r){a.$.div(r,r,this.constants),a.$.normalize(r,r),a.$.mul(r,r,this.constants);const o=a.$.scale([],r,this.radius);if(o[2]>0){const h=a.$.scale([],[0,0,1],a.$.dot(o,[0,0,1])),p=a.$.scale([],a.$.normalize([],[o[0],o[1],0]),this.radius),m=a.$.add([],o,a.$.scale([],a.$.sub([],a.$.add([],p,h),o),2));o[0]=m[0],o[1]=m[1]}return o}}function Ps(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}class Ql{constructor(r,o){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ou(r),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ec,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(o),a.br(["handleEvent","handleWindowEvent"],this);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,m,g]of this._listeners){const x=p===document?this.handleWindowEvent:this.handleEvent;p.addEventListener(m,x,g)}}destroy(){for(const[r,o,h]of this._listeners){const p=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(o,p,h)}}_addDefaultHandlers(r){const o=this._map,h=o.getCanvasContainer();this._add("mapEvent",new Xl(o,r));const p=o.boxZoom=new Es(o,r);this._add("boxZoom",p);const m=new Lo,g=new pu;o.doubleClickZoom=new Sc(g,m),this._add("tapZoom",m),this._add("clickZoom",g);const x=new fu;this._add("tapDragZoom",x);const b=o.touchPitch=new du(o);this._add("touchPitch",b);const w=new Fo(r),T=new Jl(r);o.dragRotate=new No(r,w,T),this._add("mouseRotate",w,["mousePitch"]),this._add("mousePitch",T,["mouseRotate"]);const E=new Bo(r),O=new cu(o,r);o.dragPan=new Kh(h,E,O),this._add("mousePan",E),this._add("touchPan",O,["touchZoom","touchRotate"]);const z=new hu,L=new uu;o.touchZoomRotate=new Vo(h,L,z,x),this._add("touchRotate",z,["touchPan","touchZoom"]),this._add("touchZoom",L,["touchPan","touchRotate"]),this._add("blockableMapEvent",new wc(o));const k=o.scrollZoom=new Mc(o,this);this._add("scrollZoom",k,["mousePan"]);const B=o.keyboard=new Yh;this._add("keyboard",B);for(const F of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[F]&&o[F].enable(r[F])}_add(r,o,h){this._handlers.push({handlerName:r,handler:o,allowed:h}),this._handlersById[r]=o}stop(r){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Uo(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,o,h){for(const p in r)if(p!==h&&(!o||o.indexOf(p)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const o=[];for(const h of r)this._el.contains(h.target)&&o.push(h);return o}handleEvent(r,o){this._updatingCamera=!0;const h=r.type==="renderFrame",p=h?void 0:r,m={needsRenderFrame:!1},g={},x={},b=r.touches?this._getMapTouches(r.touches):void 0,w=b?Mi(this._el,b):h?void 0:Ai(this._el,r);for(const{handlerName:O,handler:z,allowed:L}of this._handlers){if(!z.isEnabled())continue;let k;this._blockedByActive(x,L,O)?z.reset():z[o||r.type]&&(k=z[o||r.type](r,w,b),this.mergeHandlerResult(m,g,k,O,p),k&&k.needsRenderFrame&&this._triggerRenderFrame()),(k||z.isActive())&&(x[O]=z)}const T={};for(const O in this._previousActiveHandlers)x[O]||(T[O]=p);this._previousActiveHandlers=x,(Object.keys(T).length||Ps(m))&&(this._changes.push([m,g,T]),this._triggerRenderFrame()),(Object.keys(x).length||Ps(m))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:E}=m;E&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],E(this._map))}mergeHandlerResult(r,o,h,p,m){if(!h)return;a.Q(r,h);const g={handlerName:p,originalEvent:h.originalEvent||m};h.zoomDelta!==void 0&&(o.zoom=g),h.panDelta!==void 0&&(o.drag=g),h.pitchDelta!==void 0&&(o.pitch=g),h.bearingDelta!==void 0&&(o.rotate=g)}_applyChanges(){const r={},o={},h={};for(const[p,m,g]of this._changes)p.panDelta&&(r.panDelta=(r.panDelta||new a.P(0,0))._add(p.panDelta)),p.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(r.around=p.around),p.aroundCoord!==void 0&&(r.aroundCoord=p.aroundCoord),p.pinchAround!==void 0&&(r.pinchAround=p.pinchAround),p.noInertia&&(r.noInertia=p.noInertia),a.Q(o,m),a.Q(h,g);this._updateMapTransform(r,o,h),this._changes=[]}_updateMapTransform(r,o,h){const p=this._map,m=p.transform,g=$=>[$.x,$.y,$.z];if(($=>{const G=this._eventsInProgress.drag;return G&&!this._handlersById[G.handlerName].isActive()})()&&!Ps(r)){const $=m.zoom;m.cameraElevationReference="sea",this._originalZoom!=null&&m._orthographicProjectionAtLowPitch&&m.projection.name!=="globe"&&m.pitch===0?(m.cameraElevationReference="ground",m.zoom=this._originalZoom):(m.recenterOnTerrain(),m.cameraElevationReference="ground"),$!==m.zoom&&this._map._update(!0)}if(m._isCameraConstrained&&p._stop(!0),!Ps(r))return void this._fireEvents(o,h,!0);let{panDelta:x,zoomDelta:b,bearingDelta:w,pitchDelta:T,around:E,aroundCoord:O,pinchAround:z}=r;m._isCameraConstrained&&(b>0&&(b=0),m._isCameraConstrained=!1),z!==void 0&&(E=z),(b||($=>o[$]&&!this._eventsInProgress[$])("drag"))&&E&&(this._dragOrigin=g(m.pointCoordinate3D(E)),this._originalZoom=m.zoom,this._trackingEllipsoid.setup(m._camera.position,this._dragOrigin)),m.cameraElevationReference="sea",p._stop(!0),E=E||p.transform.centerPoint,w&&(m.bearing+=w),T&&(m.pitch+=T),m._updateCameraState();const L=[0,0,0];if(x)if(m.projection.name==="mercator"){const $=this._trackingEllipsoid.projectRay(m.screenPointToMercatorRay(E).dir),G=this._trackingEllipsoid.projectRay(m.screenPointToMercatorRay(E.sub(x)).dir);L[0]=G[0]-$[0],L[1]=G[1]-$[1]}else{const $=m.pointCoordinate(E);if(m.projection.name==="globe"){x=x.rotate(-m.angle);const G=m._pixelsPerMercatorPixel/m.worldSize;L[0]=-x.x*a.d6(a.az($.y))*G,L[1]=-x.y*a.d6(m.center.lat)*G}else{const G=m.pointCoordinate(E.sub(x));$&&G&&(L[0]=G.x-$.x,L[1]=G.y-$.y)}}const k=m.zoom,B=[0,0,0];if(b){const $=g(O||m.pointCoordinate3D(E)),G={dir:a.$.normalize([],a.$.sub([],$,m._camera.position))};if(G.dir[2]<0){const Z=m.zoomDeltaToMovement($,b);a.$.scale(B,G.dir,Z)}}const F=a.$.add(L,L,B);m._translateCameraConstrained(F),b&&Math.abs(m.zoom-k)>1e-4&&m.recenterOnTerrain(),m.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(o,h,!0)}_fireEvents(r,o,h){const p=Uo(this._eventsInProgress),m=Uo(r),g={};for(const T in r){const{originalEvent:E}=r[T];this._eventsInProgress[T]||(g[`${T}start`]=E),this._eventsInProgress[T]=r[T]}!p&&m&&this._fireEvent("movestart",m.originalEvent);for(const T in g)this._fireEvent(T,g[T]);m&&this._fireEvent("move",m.originalEvent);for(const T in r){const{originalEvent:E}=r[T];this._fireEvent(T,E)}const x={};let b;for(const T in this._eventsInProgress){const{handlerName:E,originalEvent:O}=this._eventsInProgress[T];this._handlersById[E].isActive()||(delete this._eventsInProgress[T],b=o[E]||O,x[`${T}end`]=b)}for(const T in x)this._fireEvent(T,x[T]);const w=Uo(this._eventsInProgress);if(h&&(p||m)&&!w){this._updatingCamera=!0;const T=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),E=O=>O!==0&&-this._bearingSnap<O&&O<this._bearingSnap;T?(E(T.bearing||this._map.getBearing())&&(T.bearing=0),this._map.easeTo(T,{originalEvent:b})):(this._map.fire(new a.g("moveend",{originalEvent:b})),E(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,o){this._map.fire(new a.g(r,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new kr("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const e1="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ic extends a.E{constructor(r,o){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=o.bearingSnap,this._respectPrefersReducedMotion=o.respectPrefersReducedMotion!==!1,a.br(["_renderFrameCallback"],this)}getCenter(){return new a.aJ(this.transform.center.lng,this.transform.center.lat)}setCenter(r,o){return this.jumpTo({center:r},o)}panBy(r,o,h){return r=a.P.convert(r).mult(-1),this.panTo(this.transform.center,a.Q({offset:r},o),h)}panTo(r,o,h){return this.easeTo(a.Q({center:r},o),h)}getZoom(){return this.transform.zoom}setZoom(r,o){return this.jumpTo({zoom:r},o),this}zoomTo(r,o,h){return this.easeTo(a.Q({zoom:r},o),h)}zoomIn(r,o){return this.zoomTo(this.getZoom()+1,r,o),this}zoomOut(r,o){return this.zoomTo(this.getZoom()-1,r,o),this}getBearing(){return this.transform.bearing}setBearing(r,o){return this.jumpTo({bearing:r},o),this}getPadding(){return this.transform.padding}setPadding(r,o){return this.jumpTo({padding:r},o),this}rotateTo(r,o,h){return this.easeTo(a.Q({bearing:r},o),h)}resetNorth(r,o){return this.rotateTo(0,a.Q({duration:1e3},r),o),this}resetNorthPitch(r,o){return this.easeTo(a.Q({bearing:0,pitch:0,duration:1e3},r),o),this}snapToNorth(r,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,o):this}getPitch(){return this.transform.pitch}setPitch(r,o){return this.jumpTo({pitch:r},o),this}cameraForBounds(r,o){r=a.aj.convert(r);const h=o&&o.bearing||0,p=o&&o.pitch||0,m=r.getNorthWest(),g=r.getSouthEast();return this._cameraForBounds(this.transform,m,g,h,p,o)}_extendPadding(r){const o={top:0,right:0,bottom:0,left:0};return r==null?a.Q({},o,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:a.Q({},o,r)}_extendCameraOptions(r){return(r=a.Q({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,o){const h=o.max[0]-o.min[0],p=o.max[1]-o.min[1];return h/p>r.aspect?h/(2*Math.tan(.5*r.fovX)*r.aspect):p/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,o,h,p,m,g){const x=r.clone(),b=this._extendCameraOptions(g);x.bearing=p,x.pitch=m;const w=a.aJ.convert(o),T=a.aJ.convert(h),E=.5*(w.lat+T.lat),O=.5*(w.lng+T.lng),z=a.d7(E,O),L=a.$.normalize([],z),k=a.$.normalize([],a.$.cross([],L,[0,1,0])),B=a.$.cross([],k,L),F=[k[0],k[1],k[2],0,B[0],B[1],B[2],0,L[0],L[1],L[2],0,0,0,0,1],$=[z,a.d7(w.lat,w.lng),a.d7(T.lat,w.lng),a.d7(T.lat,T.lng),a.d7(w.lat,T.lng),a.d7(E,w.lng),a.d7(E,T.lng),a.d7(w.lat,O),a.d7(T.lat,O)];let G=a.b8.fromPoints($.map(se=>[a.$.dot(k,se),a.$.dot(B,se),a.$.dot(L,se)]));const Z=a.$.transformMat4([],G.center,F);a.$.squaredLength(Z)===0&&a.$.set(Z,0,0,1),a.$.normalize(Z,Z),a.$.scale(Z,Z,a.cF),x.center=a.d8(Z);const K=x.getWorldToCameraMatrix(),W=a.ae.invert(new Float64Array(16),K);G=a.b8.applyTransform(G,a.ae.multiply([],K,F));const H=this._extendAABB(G,x,b,p);if(!H)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");G=H,a.$.transformMat4(Z,Z,K);const te=.5*(G.max[2]-G.min[2]),re=this._minimumAABBFrustumDistance(x,G),he=a.$.scale([],[0,0,1],te),ne=a.$.add(he,Z,he),J=re+(x.pitch===0?0:a.$.distance(Z,ne)),ge=x.globeCenterInViewSpace,me=a.$.sub([],Z,[ge[0],ge[1],ge[2]]);a.$.normalize(me,me),a.$.scale(me,me,J);const oe=a.$.add([],Z,me);a.$.transformMat4(oe,oe,W);const Pe=a.da/a.cF,Me=a.$.length(oe),de=a.ay(Math.max(Me*Pe-a.da,Number.EPSILON),0),Ce=Math.min(x.zoomFromMercatorZAdjusted(de),b.maxZoom);return Ce>.5*(a.b3+a.aV)?(x.setProjection({name:"mercator"}),x.zoom=Ce,this._cameraForBounds(x,o,h,p,m,g)):{center:x.center,zoom:Ce,bearing:p,pitch:m}}_extendAABB(r,o,h,p){const m=.5*((h.padding.left||0)+(h.padding.right||0)),g=.5*((h.padding.top||0)+(h.padding.bottom||0)),x=g,b=m,w=m,T=g,E=o.width-(b+w),O=o.height-(x+T),z=a.$.sub([],r.max,r.min),L=Math.min(E/z[0],O/z[1]),k=Math.min(o.scaleZoom(o.scale*L),h.maxZoom);if(isNaN(k))return null;const B=o.scale/o.zoomScale(k),F=new a.b8([r.min[0]-b*B,r.min[1]-T*B,r.min[2]],[r.max[0]+w*B,r.max[1]+x*B,r.max[2]]),$=(typeof h.offset.x=="number"&&typeof h.offset.y=="number"?new a.P(h.offset.x,h.offset.y):a.P.convert(h.offset)).rotate(-a.ac(p));return F.center[0]-=$.x*B,F.center[1]+=$.y*B,F}queryTerrainElevation(r,o){const h=this.transform.elevation;return h?(o=a.Q({},{exaggerated:!0},o),h.getAtPoint(a._.fromLngLat(r),null,o.exaggerated)):null}_cameraForBounds(r,o,h,p,m,g){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,o,h,p,m,g);const x=r.clone(),b=this._extendCameraOptions(g);x.bearing=p,x.pitch=m;const w=a.aJ.convert(o),T=a.aJ.convert(h),E=new a.aJ(w.lng,T.lat),O=new a.aJ(T.lng,w.lat),z=x.project(w),L=x.project(T),k=this.queryTerrainElevation(w),B=this.queryTerrainElevation(T),F=this.queryTerrainElevation(E),$=this.queryTerrainElevation(O),G=[[z.x,z.y,Math.min(k||0,B||0,F||0,$||0)],[L.x,L.y,Math.max(k||0,B||0,F||0,$||0)]];let Z=a.b8.fromPoints(G);const K=x.getWorldToCameraMatrix(),W=a.ae.invert(new Float64Array(16),K);Z=a.b8.applyTransform(Z,K);const H=this._extendAABB(Z,x,b,p);if(!H)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Z=H;const te=.5*a.$.sub([],Z.max,Z.min)[2],re=this._minimumAABBFrustumDistance(x,Z),he=[0,0,1,0];a.aB.transformMat4(he,he,K),a.aB.normalize(he,he);const ne=a.$.scale([],he,re+te),J=a.$.add([],Z.center,ne);a.$.transformMat4(Z.center,Z.center,W),a.$.transformMat4(J,J,W);const ge=[Z.center[0],Z.center[1],J[2]*x.pixelsPerMeter];a.$.scale(ge,ge,1/x.worldSize);const me=a.d9(ge[0]),oe=a.az(ge[1]),Pe=Math.min(x._zoomFromMercatorZ(ge[2]),b.maxZoom),Me=new a.aJ(me,oe);return x.mercatorFromTransition&&Pe<.5*(a.b3+a.aV)?(x.setProjection({name:"globe"}),x.zoom=Pe,this._cameraForBounds(x,o,h,p,m,g)):{center:Me,zoom:Pe,bearing:p,pitch:m}}fitBounds(r,o,h){const p=this.cameraForBounds(r,o);return this._fitInternal(p,o,h)}fitScreenCoordinates(r,o,h,p,m){const g=a.P.convert(r),x=a.P.convert(o),b=new a.P(Math.min(g.x,x.x),Math.min(g.y,x.y)),w=new a.P(Math.max(g.x,x.x),Math.max(g.y,x.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(g,x))return this;const T=this.transform.pointLocation3D(b),E=this.transform.pointLocation3D(w),O=this.transform.pointLocation3D(new a.P(b.x,w.y)),z=this.transform.pointLocation3D(new a.P(w.x,b.y)),L=[Math.min(T.lng,E.lng,O.lng,z.lng),Math.min(T.lat,E.lat,O.lat,z.lat)],k=[Math.max(T.lng,E.lng,O.lng,z.lng),Math.max(T.lat,E.lat,O.lat,z.lat)],B=p&&p.pitch?p.pitch:this.getPitch(),F=this._cameraForBounds(this.transform,L,k,h,B,p);return this._fitInternal(F,p,m)}_fitInternal(r,o,h){return r?(o=a.Q(r,o)).linear?this.easeTo(o,h):this.flyTo(o,h):this}jumpTo(r,o){this.stop();const h=r.preloadOnly?this.transform.clone():this.transform;let p=!1,m=!1,g=!1;if("zoom"in r&&h.zoom!==+r.zoom&&(p=!0,h.zoom=+r.zoom),r.center!==void 0&&(h.center=a.aJ.convert(r.center)),"bearing"in r&&h.bearing!==+r.bearing&&(m=!0,h.bearing=+r.bearing),"pitch"in r&&h.pitch!==+r.pitch&&(g=!0,h.pitch=+r.pitch),r.padding!=null){const x=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;h.isPaddingEqual(x)||(h.padding=x)}return r.preloadOnly?(this._preloadTiles(h),this):(this.fire(new a.g("movestart",o)).fire(new a.g("move",o)),p&&this.fire(new a.g("zoomstart",o)).fire(new a.g("zoom",o)).fire(new a.g("zoomend",o)),m&&this.fire(new a.g("rotatestart",o)).fire(new a.g("rotate",o)).fire(new a.g("rotateend",o)),g&&this.fire(new a.g("pitchstart",o)).fire(new a.g("pitch",o)).fire(new a.g("pitchend",o)),this.fire(new a.g("moveend",o)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(e1),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,o){const h=this.transform;if(!h.projection.supportsFreeCamera)return a.w(e1),this;this.stop();const p=h.zoom,m=h.pitch,g=h.bearing;h.setFreeCameraOptions(r);const x=p!==h.zoom,b=m!==h.pitch,w=g!==h.bearing;return this.fire(new a.g("movestart",o)).fire(new a.g("move",o)),x&&this.fire(new a.g("zoomstart",o)).fire(new a.g("zoom",o)).fire(new a.g("zoomend",o)),w&&this.fire(new a.g("rotatestart",o)).fire(new a.g("rotate",o)).fire(new a.g("rotateend",o)),b&&this.fire(new a.g("pitchstart",o)).fire(new a.g("pitch",o)).fire(new a.g("pitchend",o)),this.fire(new a.g("moveend",o)),this}easeTo(r,o){this._stop(!1,r.easeId),((r=a.Q({offset:[0,0],duration:500,easing:a.d5},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const h=this.transform,p=this.getZoom(),m=this.getBearing(),g=this.getPitch(),x=this.getPadding(),b="zoom"in r?+r.zoom:p,w="bearing"in r?this._normalizeBearing(r.bearing,m):m,T="pitch"in r?+r.pitch:g,E=this._extendPadding(r.padding),O=a.P.convert(r.offset);let z,L,k;if(h.projection.name==="globe"){const re=a._.fromLngLat(h.center),he=O.rotate(-h.angle);re.x+=he.x/h.worldSize,re.y+=he.y/h.worldSize;const ne=re.toLngLat(),J=a.aJ.convert(r.center||ne);this._normalizeCenter(J),z=h.centerPoint.add(he),L=new a.P(re.x,re.y).mult(h.worldSize),k=new a.P(a.ak(J.lng),a.al(J.lat)).mult(h.worldSize).sub(L)}else{z=h.centerPoint.add(O);const re=h.pointLocation(z),he=a.aJ.convert(r.center||re);this._normalizeCenter(he),L=h.project(re),k=h.project(he).sub(L)}const B=h.zoomScale(b-p);let F,$;r.around&&(F=a.aJ.convert(r.around),$=h.locationPoint(F));const G=this._zooming||b!==p,Z=this._rotating||m!==w,K=this._pitching||T!==g,W=!h.isPaddingEqual(E),H=re=>he=>{if(G&&(re.zoom=a.a3(p,b,he)),Z&&(re.bearing=a.a3(m,w,he)),K&&(re.pitch=a.a3(g,T,he)),W&&(re.interpolatePadding(x,E,he),z=re.centerPoint.add(O)),F)re.setLocationAtPoint(F,$);else{const ne=re.zoomScale(re.zoom-p),J=b>p?Math.min(2,B):Math.max(.5,B),ge=Math.pow(J,1-he),me=re.unproject(L.add(k.mult(he*ge)).mult(ne));re.setLocationAtPoint(re.renderWorldCopies?me.wrap():me,z)}return r.preloadOnly||this._fireMoveEvents(o),re};if(r.preloadOnly){const re=this._emulate(H,r.duration,h);return this._preloadTiles(re),this}const te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=G,this._rotating=Z,this._pitching=K,this._padding=W,this._easeId=r.easeId,this._prepareEase(o,r.noMoveStart,te),this._ease(H(h),re=>{h.cameraElevationReference==="sea"&&h.recenterOnTerrain(),this._afterEase(o,re)},r),this}_prepareEase(r,o,h={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),o||h.moving||this.fire(new a.g("movestart",r)),this._zooming&&!h.zooming&&this.fire(new a.g("zoomstart",r)),this._rotating&&!h.rotating&&this.fire(new a.g("rotatestart",r)),this._pitching&&!h.pitching&&this.fire(new a.g("pitchstart",r))}_fireMoveEvents(r){this.fire(new a.g("move",r)),this._zooming&&this.fire(new a.g("zoom",r)),this._rotating&&this.fire(new a.g("rotate",r)),this._pitching&&this.fire(new a.g("pitch",r))}_afterEase(r,o){if(this._easeId&&o&&this._easeId===o)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const h=this._zooming,p=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new a.g("zoomend",r)),p&&this.fire(new a.g("rotateend",r)),m&&this.fire(new a.g("pitchend",r)),this.fire(new a.g("moveend",r))}flyTo(r,o){if(this._prefersReducedMotion(r)){const Ce=a.ai(r,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(Ce,o)}this.stop(),r=a.Q({offset:[0,0],speed:1.2,curve:1.42,easing:a.d5},r);const h=this.transform,p=this.getZoom(),m=this.getBearing(),g=this.getPitch(),x=this.getPadding(),b="zoom"in r?a.au(+r.zoom,h.minZoom,h.maxZoom):p,w="bearing"in r?this._normalizeBearing(r.bearing,m):m,T="pitch"in r?+r.pitch:g,E=this._extendPadding(r.padding),O=h.zoomScale(b-p),z=a.P.convert(r.offset);let L=h.centerPoint.add(z);const k=h.pointLocation(L),B=a.aJ.convert(r.center||k);this._normalizeCenter(B);const F=h.project(k),$=h.project(B).sub(F);let G=r.curve;const Z=Math.max(h.width,h.height),K=Z/O,W=$.mag();if("minZoom"in r){const Ce=a.au(Math.min(r.minZoom,p,b),h.minZoom,h.maxZoom),se=Z/h.zoomScale(Ce-p);G=Math.sqrt(se/W*2)}const H=G*G;function te(Ce){const se=(K*K-Z*Z+(Ce?-1:1)*H*H*W*W)/(2*(Ce?K:Z)*H*W);return Math.log(Math.sqrt(se*se+1)-se)}function re(Ce){return(Math.exp(Ce)-Math.exp(-Ce))/2}function he(Ce){return(Math.exp(Ce)+Math.exp(-Ce))/2}const ne=te(0);let J=function(Ce){return he(ne)/he(ne+G*Ce)},ge=function(Ce){return Z*((he(ne)*(re(se=ne+G*Ce)/he(se))-re(ne))/H)/W;var se},me=(te(1)-ne)/G;if(Math.abs(W)<1e-6||!isFinite(me)){if(Math.abs(Z-K)<1e-6)return this.easeTo(r,o);const Ce=K<Z?-1:1;me=Math.abs(Math.log(K/Z))/G,ge=function(){return 0},J=function(se){return Math.exp(Ce*G*se)}}r.duration="duration"in r?+r.duration:1e3*me/("screenSpeed"in r?+r.screenSpeed/G:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const oe=m!==w,Pe=T!==g,Me=!h.isPaddingEqual(E),de=Ce=>se=>{const Se=se*me,Ie=1/J(Se);Ce.zoom=se===1?b:p+Ce.scaleZoom(Ie),oe&&(Ce.bearing=a.a3(m,w,se)),Pe&&(Ce.pitch=a.a3(g,T,se)),Me&&(Ce.interpolatePadding(x,E,se),L=Ce.centerPoint.add(z));const Ue=se===1?B:Ce.unproject(F.add($.mult(ge(Se))).mult(Ie));return Ce.setLocationAtPoint(Ce.renderWorldCopies?Ue.wrap():Ue,L),Ce._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(o),Ce};if(r.preloadOnly){const Ce=this._emulate(de,r.duration,h);return this._preloadTiles(Ce),this}return this._zooming=!0,this._rotating=oe,this._pitching=Pe,this._padding=Me,this._prepareEase(o,!1),this._ease(de(h),()=>this._afterEase(o),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const h=this._onEaseEnd;this._onEaseEnd=void 0,h.call(this,o)}if(!r){const h=this.handlers;h&&h.stop(!1)}return this}_ease(r,o,h){h.animate===!1||h.duration===0?(r(1),o()):(this._easeStart=a.e.now(),this._easeOptions=h,this._onEaseFrame=r,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((a.e.now()-this._easeStart)/this._easeOptions.duration,1),o=this._onEaseFrame;o&&o(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,o){r=a.av(r,-180,180);const h=Math.abs(r-o);return Math.abs(r-360-o)<h&&(r-=360),Math.abs(r+360-o)<h&&(r+=360),r}_normalizeCenter(r){const o=this.transform;if(o.maxBounds||o.projection.name!=="globe"&&!o.renderWorldCopies)return;const h=r.lng-o.center.lng;r.lng+=h>180?-360:h<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&a.e.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,o,h){const p=Math.ceil(15*o/1e3),m=[],g=r(h.clone());for(let x=0;x<=p;x++){const b=g(x/p);m.push(b.clone())}return m}_preloadTiles(r,o){}}class Zo{constructor(r={}){this.options=r,a.br(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const o=this.options&&this.options.compact,h=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=It("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",h);const p=It("span","mapboxgl-ctrl-icon",this._compactButton);return p.setAttribute("aria-hidden","true"),p.setAttribute("title",h),this._innerContainer=It("div","mapboxgl-ctrl-attrib-inner",this._container),o&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.db.ACCESS_TOKEN}];if(r){const h=o.reduce((p,m,g)=>(m.value&&(p+=`${m.key}=${m.value}${g<o.length-1?"&":""}`),p),"?");r.href=`${a.db.FEEDBACK_URL}/${h}#${Cc(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const o=this._map.style._mergedSourceCaches;for(const p in o){const m=o[p];if(m.used){const g=m.getSource();g.attribution&&r.indexOf(g.attribution)<0&&r.push(g.attribution)}}r.sort((p,m)=>p.length-m.length),r=r.filter((p,m)=>{for(let g=m+1;g<r.length;g++)if(r[g].indexOf(p)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const h=r.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,r.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class t1{constructor(){a.br(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=It("div","mapboxgl-ctrl");const o=It("a","mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://www.mapbox.com/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const o in r){const h=r[o].getSource();if(h.hasOwnProperty("mapbox_logo")&&!h.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const o=r[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("mapboxgl-compact"):o.classList.remove("mapboxgl-compact")}}}class i1{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const o=++this._id;return this._queue.push({callback:r,id:o,cancelled:!1}),o}remove(r){const o=this._currentlyRunning,h=o?this._queue.concat(o):this._queue;for(const p of h)if(p.id===r)return void(p.cancelled=!0)}run(r=0){const o=this._currentlyRunning=this._queue;this._queue=[];for(const h of o)if(!h.cancelled&&(h.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function $o(u,r,o){if(u=new a.aJ(u.lng,u.lat),r){const h=new a.aJ(u.lng-360,u.lat),p=new a.aJ(u.lng+360,u.lat),m=360*Math.ceil(Math.abs(u.lng-o.center.lng)/360),g=o.locationPoint(u).distSqr(r),x=r.x<0||r.y<0||r.x>o.width||r.y>o.height;o.locationPoint(h).distSqr(r)<g&&(x||Math.abs(h.lng-o.center.lng)<m)?u=h:o.locationPoint(p).distSqr(r)<g&&(x||Math.abs(p.lng-o.center.lng)<m)&&(u=p)}for(;Math.abs(u.lng-o.center.lng)>180;){const h=o.locationPoint(u);if(h.x>=0&&h.y>=0&&h.x<=o.width&&h.y<=o.height)break;u.lng>o.center.lng?u.lng-=360:u.lng+=360}return u}const r1={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class n1 extends a.E{constructor(r,o){if(super(),(r instanceof HTMLElement||o)&&(r=a.Q({element:r},o)),a.br(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=r&&r.occludedOpacity||.2,r&&r.element)this._element=r.element,this._offset=a.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=It("div");const m=41,g=27,x=_i("svg",{display:"block",height:m*this._scale+"px",width:g*this._scale+"px",viewBox:`0 0 ${g} ${m}`},this._element),b=_i("radialGradient",{id:"shadowGradient"},_i("defs",{},x));_i("stop",{offset:"10%","stop-opacity":.4},b),_i("stop",{offset:"100%","stop-opacity":.05},b),_i("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},x),_i("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},x),_i("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},x),_i("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},x),this._offset=a.P.convert(r&&r.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()});const h=this._element.classList;for(const m in r1)h.remove(`mapboxgl-marker-anchor-${m}`);h.add(`mapboxgl-marker-anchor-${this._anchor}`);const p=r&&r.className?r.className.trim().split(/\s+/):[];h.add(...p),this._popup=null}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=a.aJ.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const o=r.code,h=r.charCode||r.keyCode;o!=="Space"&&o!=="Enter"&&h!==32&&h!==13||this.togglePopup()}_onMapClick(r){const o=r.originalEvent.target,h=this._element;this._popup&&(o===h||h.contains(o))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,o=this._pos;if(!r||!o)return!1;const h=r.unproject(o),p=r.getFreeCameraOptions();if(!p.position)return!1;const m=p.position.toLngLat();return m.distanceTo(h)<.9*m.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const o=this._pos;if(!o||o.x<0||o.x>r.transform.width||o.y<0||o.y>r.transform.height)return void this._clearFadeTimer();const h=r.unproject(o);let p;r._showingGlobe()&&a.dc(r.transform,this._lngLat)?p=0:(p=1-r._queryFogOpacity(h),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(p*=this._occludedOpacity)),this._element.style.opacity=`${p}`,this._element.style.pointerEvents=p>0?"auto":"none",this._popup&&this._popup._setOpacity(p),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const o=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${r1[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${o.x}px,${o.y}px)
        `}_calculateXYTransform(){const r=this._pos,o=this._map,h=this.getPitchAlignment();if(!o||!r||h!=="map")return"";if(!o._showingGlobe()){const b=o.getPitch();return b?`rotateX(${b}deg)`:""}const p=a.b1(a.dd(o.transform,this._lngLat)),m=r.sub(a.de(o.transform)),g=Math.abs(m.x)+Math.abs(m.y);if(g===0)return"";const x=p/g;return`rotateX(${-m.y*x}deg) rotateY(${m.x*x}deg)`}_calculateZTransform(){const r=this._pos,o=this._map;if(!o||!r)return"";let h=0;const p=this.getRotationAlignment();if(p==="map")if(o._showingGlobe()){const m=o.project(new a.aJ(this._lngLat.lng,this._lngLat.lat+.001)),g=o.project(new a.aJ(this._lngLat.lng,this._lngLat.lat-.001)).sub(m);h=a.b1(Math.atan2(g.y,g.x))-90}else h=-o.getBearing();else if(p==="horizon"){const m=a.a0(4,6,o.getZoom()),g=a.de(o.transform);g.y+=m*o.transform.height;const x=r.sub(g),b=a.b1(Math.atan2(x.y,x.x));h=(b>90?b-270:b+90)*(1-m)}return h+=this._rotation,h?`rotateZ(${h}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const o=this._map;o&&(o.transform.renderWorldCopies&&(this._lngLat=$o(this._lngLat,this._pos,o.transform)),this._pos=o.project(this._lngLat),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),o._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(o._showingGlobe()||o.getTerrain()||o.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=a.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const o=this._map;if(!o)return;const h=this._pointerdownPos,p=this._positionDelta;if(h&&p){if(!this._isDragging){const m=this._clickTolerance||o._clickTolerance;if(r.point.dist(h)<m)return;this._isDragging=!0}this._pos=r.point.sub(p),this._lngLat=o.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.g("dragstart"))),this.fire(new a.g("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.g("dragend")),this._state="inactive"}_addDragHandler(r){const o=this._map,h=this._pos;o&&h&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(h),this._pointerdownPos=r.point,this._state="pending",o.on("mousemove",this._onMove),o.on("touchmove",this._onMove),o.once("mouseup",this._onUp),o.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const o=this._map;return o&&(r?(o.on("mousedown",this._addDragHandler),o.on("touchstart",this._addDragHandler)):(o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ba={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Qh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function mu(u=new a.P(0,0),r="bottom"){if(typeof u=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(u,2)));switch(r){case"top":return new a.P(0,u);case"top-left":return new a.P(o,o);case"top-right":return new a.P(-o,o);case"bottom":return new a.P(0,-u);case"bottom-left":return new a.P(o,-o);case"bottom-right":return new a.P(-o,-o);case"left":return new a.P(u,0);case"right":return new a.P(-u,0)}return new a.P(0,0)}return u instanceof a.P||Array.isArray(u)?a.P.convert(u):a.P.convert(u[r]||[0,0])}class e2{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const o=a.bb((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-o)+this._end*o}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,o,h){this._start=this.getValue(o),this._end=r,this._startTime=o,this._endTime=o+h}}const t2={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class i2{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}const r2={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Pc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Oc{constructor(r,o,h=!1){this._clickTolerance=10,this.element=o,this.mouseRotate=new Fo({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,h&&(this.mousePitch=new Jl({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),a.br(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener("mousedown",this.mousedown),o.addEventListener("touchstart",this.touchstart,{passive:!1}),o.addEventListener("touchmove",this.touchmove),o.addEventListener("touchend",this.touchend),o.addEventListener("touchcancel",this.reset)}down(r,o){this.mouseRotate.mousedown(r,o),this.mousePitch&&this.mousePitch.mousedown(r,o),pr()}move(r,o){const h=this.map,p=this.mouseRotate.mousemoveWindow(r,o),m=p&&p.bearingDelta;if(m&&h.setBearing(h.getBearing()+m),this.mousePitch){const g=this.mousePitch.mousemoveWindow(r,o),x=g&&g.pitchDelta;x&&h.setPitch(h.getPitch()+x)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart,{passive:!1}),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Zn(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(a.Q({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),Ai(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,Ai(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Mi(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Mi(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const _u={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},wa={maxWidth:100,unit:"metric"},gu={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:a.dw,supported:mi,setRTLTextPlugin:a.dy,getRTLTextPluginStatus:a.dz,Map:class extends Ic{constructor(u){a.df.mark(a.dg.create);const r=u;if((u=a.Q({},r2,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(u.antialias&&a.dh(window)&&(u.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new oo(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies),u),this._repaint=!!u.repaint,this._interactive=u.interactive,this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=u.crossSourceCollisions,this._collectResourceTiming=u.collectResourceTiming,this._language=this._parseLanguage(u.language),this._worldview=u.worldview,this._renderTaskQueue=new i1,this._domRenderTaskQueue=new i1,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.di(),this._locale=a.Q({},t2,u.locale),this._clickTolerance=u.clickTolerance,this._cooperativeGestures=u.cooperativeGestures,this._performanceMetricsCollection=u.performanceMetricsCollection,this._tessellationStep=u.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=u.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new e2(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new a.dj(u.transformRequest,u.accessToken,u.testMode),this._silenceAuthErrors=!!u.testMode,this._contextCreateOptions=u.contextCreateOptions?{...u.contextCreateOptions}:{},typeof u.container=="string"){const o=document.getElementById(u.container);if(!o)throw new Error(`Container '${u.container.toString()}' not found.`);this._container=o}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),u.maxBounds&&this.setMaxBounds(u.maxBounds),a.br(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new i2),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Ql(this,u),this._localFontFamily=u.localFontFamily,this._localIdeographFontFamily=u.localIdeographFontFamily,(u.style||!u.testMode)&&this.setStyle(u.style||a.db.DEFAULT_STYLE,{config:u.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),u.projection&&this.setProjection(u.projection),u.hash&&(this._hash=new au(typeof u.hash=="string"&&u.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch});const o=u.bounds;o&&(this.resize(),this.fitBounds(o,a.Q({},u.fitBoundsOptions,{duration:0})))}this.resize(),u.attributionControl&&this.addControl(new Zo({customAttribution:u.customAttribution})),this._logoControl=new t1,this.addControl(this._logoControl,u.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new a.g(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new a.g(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(u,r){if(r===void 0&&(r=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.f(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=u.onAdd(this);this._controls.push(u);const h=this._controlPositions[r];return r.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this}removeControl(u){if(!u||!u.onRemove)return this.fire(new a.f(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(u);return r>-1&&this._controls.splice(r,1),u.onRemove(this),this}hasControl(u){return this._controls.indexOf(u)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(u){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new a.g("movestart",u)).fire(new a.g("move",u)),this.fire(new a.g("resize",u)),r&&this.fire(new a.g("moveend",u)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(u){return this.transform.setMaxBounds(a.aj.convert(u)),this._update()}setMinZoom(u){if((u=u??-2)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u?this.setZoom(u):this.fire(new a.g("zoomstart")).fire(new a.g("zoom")).fire(new a.g("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(u){if((u=u??22)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u?this.setZoom(u):this.fire(new a.g("zoomstart")).fire(new a.g("zoom")).fire(new a.g("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(u){if((u=u??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u?this.setPitch(u):this.fire(new a.g("pitchstart")).fire(new a.g("pitch")).fire(new a.g("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(u){if((u=u??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u?this.setPitch(u):this.fire(new a.g("pitchstart")).fire(new a.g("pitch")).fire(new a.g("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(u){return this.transform.renderWorldCopies=u,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(u){return u==="auto"?navigator.language:Array.isArray(u)?u.length===0?void 0:u.map(r=>r==="auto"?navigator.language:r):u}setLanguage(u){const r=this._parseLanguage(u);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const o of this._controls)o._setLanguage&&o._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(u){return this.style&&u!==this._worldview?(this._worldview=u,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(u){return this._lazyInitEmptyStyle(),u?typeof u=="string"&&(u={name:u}):u=null,this._useExplicitProjection=!!u,this._prioritizeAndUpdateProjection(u,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const u=this.transform,r=u.projection.name;let o;r==="globe"&&u.zoom>=a.aV?(u.setMercatorFromTransition(),o=!0):r==="mercator"&&u.zoom<a.aV&&(u.setProjection({name:"globe"}),o=!0),o&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(u,r){return this._updateProjection(u||r||{name:"mercator"})}_updateProjection(u){let r;return r=u.name==="globe"&&this.transform.zoom>=a.aV?this.transform.setMercatorFromTransition():this.transform.setProjection(u),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(u){return this.transform.locationPoint3D(a.aJ.convert(u))}unproject(u){return this.transform.pointLocation3D(a.P.convert(u))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(u,r,o){if(u==="mouseenter"||u==="mouseover"){let h=!1;const p=g=>{const x=r.filter(w=>this.getLayer(w)),b=x.length?this.queryRenderedFeatures(g.point,{layers:x}):[];b.length?h||(h=!0,o.call(this,new Lr(u,this,g.originalEvent,{features:b}))):h=!1},m=()=>{h=!1};return{layers:new Set(r),listener:o,delegates:{mousemove:p,mouseout:m}}}if(u==="mouseleave"||u==="mouseout"){let h=!1;const p=g=>{const x=r.filter(b=>this.getLayer(b));(x.length?this.queryRenderedFeatures(g.point,{layers:x}):[]).length?h=!0:h&&(h=!1,o.call(this,new Lr(u,this,g.originalEvent)))},m=g=>{h&&(h=!1,o.call(this,new Lr(u,this,g.originalEvent)))};return{layers:new Set(r),listener:o,delegates:{mousemove:p,mouseout:m}}}{const h=p=>{const m=r.filter(x=>this.getLayer(x)),g=m.length?this.queryRenderedFeatures(p.point,{layers:m}):[];g.length&&(p.features=g,o.call(this,p),delete p.features)};return{layers:new Set(r),listener:o,delegates:{[u]:h}}}}on(u,r,o){if(typeof r=="function"||o===void 0)return super.on(u,r);if(Array.isArray(r)||(r=[r]),r){for(const p of r)if(!this._isValidId(p))return this}const h=this._createDelegatedListener(u,r,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(h);for(const p in h.delegates)this.on(p,h.delegates[p]);return this}once(u,r,o){if(typeof r=="function"||o===void 0)return super.once(u,r);if(Array.isArray(r)||(r=[r]),r){for(const p of r)if(!this._isValidId(p))return this}const h=this._createDelegatedListener(u,r,o);for(const p in h.delegates)this.once(p,h.delegates[p]);return this}off(u,r,o){if(typeof r=="function"||o===void 0)return super.off(u,r);const h=new Set(Array.isArray(r)?r:[r]);for(const g of h)if(!this._isValidId(g))return this;const p=(g,x)=>{if(g.size!==x.size)return!1;for(const b of g)if(!x.has(b))return!1;return!0},m=this._delegatedListeners?this._delegatedListeners[u]:void 0;return m&&(g=>{for(let x=0;x<g.length;x++){const b=g[x];if(b.listener===o&&p(b.layers,h)){for(const w in b.delegates)this.off(w,b.delegates[w]);return g.splice(x,1),this}}})(m),this}queryRenderedFeatures(u,r){if(!this.style)return[];if(r!==void 0||u===void 0||u instanceof a.P||Array.isArray(u)||(r=u,u=void 0),u=u||[[0,0],[this.transform.width,this.transform.height]],(r=r||{}).layers&&Array.isArray(r.layers)){for(const o of r.layers)if(!this._isValidId(o))return[]}return this.style.queryRenderedFeatures(u,r,this.transform)}querySourceFeatures(u,r){return this._isValidId(u)?this.style.querySourceFeatures(u,r):[]}isPointOnSurface(u){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&a.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(u))}setStyle(u,r){return r=a.Q({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&u&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(u,(o,h)=>{o?(a.w(`Unable to perform style diff: ${String(o.message||o.error||o)}. Rebuilding the style from scratch.`),this._updateStyle(u,r)):h&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(u,r))}_getUIString(u){const r=this._locale[u];if(r==null)throw new Error(`Missing UI string '${u}'`);return r}_updateStyle(u,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),u){const o=a.Q({},r);r&&r.config&&(o.initialConfig=r.config,delete o.config),this.style=new Rr(this,o).load(u),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Rr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(u){return u==null?(this.fire(new a.f(new Error("IDs can't be empty."))),!1):!a.cY(u)||(this.fire(new a.f(new Error(`IDs can't contain special symbols: "${u}".`))),!1)}addSource(u,r){return this._isValidId(u)?(this._lazyInitEmptyStyle(),this.style.addSource(u,r),this._update(!0)):this}isSourceLoaded(u){return!!this._isValidId(u)&&!!this.style&&this.style._isSourceCacheLoaded(u)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(u,r,o){this._lazyInitEmptyStyle(),this.style.addSourceType(u,r,o)}removeSource(u){return this._isValidId(u)?(this.style.removeSource(u),this._updateTerrain(),this._update(!0)):this}getSource(u){return this._isValidId(u)?this.style.getOwnSource(u):null}addImage(u,r,{pixelRatio:o=1,sdf:h=!1,stretchX:p,stretchY:m,content:g}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:x,height:b,data:w}=a.e.getImageData(r);this.style.addImage(u,{data:new a.j({width:x,height:b},w),pixelRatio:o,stretchX:p,stretchY:m,content:g,sdf:h,version:0})}else if(r.width===void 0||r.height===void 0)this.fire(new a.f(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:x,height:b}=r,w=r;this.style.addImage(u,{data:new a.j({width:x,height:b},new Uint8Array(w.data)),pixelRatio:o,stretchX:p,stretchY:m,content:g,sdf:h,version:0,userImage:w}),w.onAdd&&w.onAdd(this,u)}}updateImage(u,r){this._lazyInitEmptyStyle();const o=this.style.getImage(u);if(!o)return void this.fire(new a.f(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?a.e.getImageData(r):r,{width:p,height:m,data:g}=h;if(p===void 0||m===void 0)return void this.fire(new a.f(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==o.data.width||m!==o.data.height)return void this.fire(new a.f(new Error(`The width and height of the updated image (${p}, ${m})
                must be that same as the previous version of the image
                (${o.data.width}, ${o.data.height})`)));const x=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);o.data.replace(g,x),this.style.updateImage(u,o)}hasImage(u){return u?!!this.style&&!!this.style.getImage(u):(this.fire(new a.f(new Error("Missing required image id"))),!1)}removeImage(u){this.style.removeImage(u)}loadImage(u,r){a.i(this._requestManager.transformRequest(u,a.R.Image),(o,h)=>{r(o,h instanceof HTMLImageElement?a.e.getImageData(h):h)})}listImages(){return this.style.listImages()}addModel(u,r){this._lazyInitEmptyStyle(),this.style.addModel(u,r)}hasModel(u){return u?this.style.hasModel(u):(this.fire(new a.f(new Error("Missing required model id"))),!1)}removeModel(u){this.style.removeModel(u)}listModels(){return this.style.listModels()}addLayer(u,r){return this._isValidId(u.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(u,r),this._update(!0)):this}getSlot(u){const r=this.getLayer(u);return r&&r.slot||null}setSlot(u,r){return this.style.setSlot(u,r),this.style.mergeLayers(),this._update(!0)}addImport(u,r){return this.style.addImport(u,r),this}updateImport(u,r){return typeof r!="string"&&r.id!==u?(this.removeImport(u),this.addImport(r)):(this.style.updateImport(u,r),this._update(!0))}removeImport(u){return this.style.removeImport(u),this}moveImport(u,r){return this.style.moveImport(u,r),this._update(!0)}moveLayer(u,r){return this._isValidId(u)?(this.style.moveLayer(u,r),this._update(!0)):this}removeLayer(u){return this._isValidId(u)?(this.style.removeLayer(u),this._update(!0)):this}getLayer(u){if(!this._isValidId(u))return null;const r=this.style.getOwnLayer(u);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(u,r,o){return this._isValidId(u)?(this.style.setLayerZoomRange(u,r,o),this._update(!0)):this}setFilter(u,r,o={}){return this._isValidId(u)?(this.style.setFilter(u,r,o),this._update(!0)):this}getFilter(u){return this._isValidId(u)?this.style.getFilter(u):null}setPaintProperty(u,r,o,h={}){return this._isValidId(u)?(this.style.setPaintProperty(u,r,o,h),this._update(!0)):this}getPaintProperty(u,r){return this._isValidId(u)?this.style.getPaintProperty(u,r):null}setLayoutProperty(u,r,o,h={}){return this._isValidId(u)?(this.style.setLayoutProperty(u,r,o,h),this._update(!0)):this}getLayoutProperty(u,r){return this._isValidId(u)?this.style.getLayoutProperty(u,r):null}getSchema(u){return this.style.getSchema(u)}setSchema(u,r){return this.style.setSchema(u,r),this._update(!0)}getConfig(u){return this.style.getConfig(u)}setConfig(u,r){return this.style.setConfig(u,r),this._update(!0)}getConfigProperty(u,r){return this.style.getConfigProperty(u,r)}setConfigProperty(u,r,o){return this.style.setConfigProperty(u,r,o),this._update(!0)}setLights(u){if(this._lazyInitEmptyStyle(),u&&u.length===1&&u[0].type==="flat"){const r=u[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(u),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const u=this.style.getLights()||[];return u.length===0&&u.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),u}setLight(u,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:u}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(u){return this._lazyInitEmptyStyle(),!u&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(u),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(u){return this._lazyInitEmptyStyle(),this.style.setFog(u),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(u){return this._lazyInitEmptyStyle(),this.style.setColorTheme(u),this._update(!0)}setCamera(u){return this.style.setCamera(u),this._triggerCameraUpdate(u)}_triggerCameraUpdate(u){return this._update(this.transform.setOrthographicProjectionAtLowPitch(u["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(u){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.aJ.convert(u),this.transform):0}setFeatureState(u,r){return this._isValidId(u.source)?(this.style.setFeatureState(u,r),this._update()):this}removeFeatureState(u,r){return this._isValidId(u.source)?(this.style.removeFeatureState(u,r),this._update()):this}getFeatureState(u){return this._isValidId(u.source)?this.style.getFeatureState(u):null}_updateContainerDimensions(){if(!this._container)return;const u=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let o,h,p,m=this._container;for(;m&&(!h||!p);){const g=window.getComputedStyle(m).transform;g&&g!=="none"&&(o=g.match(/matrix.*\((.+)\)/)[1].split(", "),o[0]&&o[0]!=="0"&&o[0]!=="1"&&(h=o[0]),o[3]&&o[3]!=="0"&&o[3]!=="1"&&(p=o[3])),m=m.parentElement}this._containerWidth=h?Math.abs(u/h):u,this._containerHeight=p?Math.abs(r/p):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=It("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=It("div","mapboxgl-canvas-container",u);this._canvas=It("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const o=this._controlContainer=It("div","mapboxgl-control-container",u),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(p=>{h[p]=It("div",`mapboxgl-ctrl-${p}`,o)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(u,r){const o=a.e.devicePixelRatio||1;this._canvas.width=o*Math.ceil(u),this._canvas.height=o*Math.ceil(r),this._canvas.style.width=`${u}px`,this._canvas.style.height=`${r}px`}_addMarker(u){this._markers.push(u)}_removeMarker(u){const r=this._markers.indexOf(u);r!==-1&&this._markers.splice(r,1)}_addPopup(u){this._popups.push(u)}_removePopup(u){const r=this._popups.indexOf(u);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const u=a.Q({},mi.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",u);r?(a.dk(r,!0),this.painter=new fc(r,this._contextCreateOptions,this.transform,this._tp),this.on("data",o=>{o.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.dl.testSupport(r)):this.fire(new a.f(new Error("Failed to initialize WebGL")))}_contextLost(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.g("webglcontextlost",{originalEvent:u}))}_contextRestored(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.g("webglcontextrestored",{originalEvent:u}))}_onMapScroll(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(u){return this._update(),this._renderTaskQueue.add(u)}_cancelRenderFrame(u){this._renderTaskQueue.remove(u)}_requestDomTask(u){!this.loaded()||this.loaded()&&!this.isMoving()?u():this._domRenderTaskQueue.add(u)}_render(u){let r;this.fire(new a.g("renderstart")),++this._frameId;const o=this.painter.context.extTimerQuery,h=a.e.now(),p=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=p.createQuery(),p.beginQuery(o.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(u),this._domRenderTaskQueue.run(u),this._removed)return;this._updateProjectionTransition();const m=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const w=this.transform.zoom,T=this.transform.pitch,E=a.e.now(),O=new a.Y(w,{now:E,fadeDuration:m,pitch:T,transition:this.style.transition});this.style.update(O)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let g=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),g=this._updateAverageElevation(h),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):g=this._updateAverageElevation(h);const x=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,m,this._crossSourceCollisions,this.painter.replacementSource);if(x&&(this._placementDirty=x.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:m,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.g("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.df.mark(a.dg.load),this.fire(new a.g("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const w=a.e.now()-h;p.endQuery(o.TIME_ELAPSED_EXT),setTimeout(()=>{const T=p.getQueryParameter(r,p.QUERY_RESULT)/1e6;p.deleteQuery(r),this.fire(new a.g("gpu-timing-frame",{cpuTime:w,gpuTime:T}))},50)}if(this.listens("gpu-timing-layer")){const w=this.painter.collectGpuTimers();setTimeout(()=>{const T=this.painter.queryGpuTimers(w);this.fire(new a.g("gpu-timing-layer",{layerTimes:T}))},50)}if(this.listens("gpu-timing-deferred-render")){const w=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const T=this.painter.queryGpuTimeDeferredRender(w);this.fire(new a.g("gpu-timing-deferred-render",{gpuTime:T}))},50)}const b=this._sourcesDirty||this._styleDirty||this._placementDirty||g;if(b||this._repaint)this.triggerRepaint();else{const w=this.idle();if(w&&(g=this._updateAverageElevation(h,!0)),g)this.triggerRepaint();else if(this._triggerFrame(!1),w&&(this.fire(new a.g("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const T=this._calculateSpeedIndex();this.fire(new a.g("speedindexcompleted",{speedIndex:T})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||b||(this._fullyLoaded=!0,a.df.mark(a.dg.fullLoad),this._performanceMetricsCollection&&a.dm(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(u){for(const r of this._markers)u&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!u||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(u,r=!1){const o=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&o(0);const h=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(h||(r||u-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(u)){const p=this.transform.averageElevation;let m=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(m)?m=0:this._averageElevationLastSampledAt=u;const g=Math.abs(p-m);if(g>1){if(this._isInitialLoad||h)return this._averageElevation.jumpTo(m),o(m);this._averageElevation.easeTo(m,u,300)}else if(g>1e-4)return this._averageElevation.jumpTo(m),o(m)}return!!this._averageElevation.isEasing(u)&&o(this._averageElevation.getValue(u))}_authenticate(){a.dn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,u=>{if(u&&(u.message===a.dp||u.status===401)){const r=this.painter.context.gl;a.dk(r,!1),this._logoControl instanceof t1&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.f(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.dq(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&a.dr(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const u=this._isDragging();this.painter.updateTerrain(this.style,u)}_calculateSpeedIndex(){const u=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const o=this.painter.context.gl,h=o.createFramebuffer();function p(m){o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,m,0);const g=new Uint8Array(o.drawingBufferWidth*o.drawingBufferHeight*4);return o.readPixels(0,0,o.drawingBufferWidth,o.drawingBufferHeight,o.RGBA,o.UNSIGNED_BYTE,g),g}return o.bindFramebuffer(o.FRAMEBUFFER,h),this._canvasPixelComparison(p(u),r.canvasCopies.map(p),r.timeStamps)}_canvasPixelComparison(u,r,o){let h=o[1]-o[0];const p=u.length/4;for(let m=0;m<r.length;m++){const g=r[m];let x=0;for(let b=0;b<g.length;b+=4)g[b]===u[b]&&g[b+1]===u[b+1]&&g[b+2]===u[b+2]&&g[b+3]===u[b+3]&&(x+=1);h+=(o[m+2]-o[m+1])*(1-x/p)}return h}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u&&u.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.ds(this.painter.context.gl),a.dt.remove(),a.du.remove(),this._removed=!0,this.fire(new a.g("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(u){this._renderNextFrame=this._renderNextFrame||u,this.style&&!this._frame&&(this._frame=a.e.frame(r=>{const o=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,o&&this._render(r)}))}_preloadTiles(u){const r=this.style?this.style.getSourceCaches():[];return a.dv(r,(o,h)=>o._preloadTiles(u,h),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(u){this._trackResize&&this.resize({originalEvent:u})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(u){this._showParseStatus!==u&&(this._showParseStatus=u,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(u){this._showTerrainWireframe!==u&&(this._showTerrainWireframe=u,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(u){this._showLayers2DWireframe!==u&&(this._showLayers2DWireframe=u,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(u){this._showLayers3DWireframe!==u&&(this._showLayers3DWireframe=u,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(u){this._speedIndexTiming!==u&&(this._speedIndexTiming=u,this._update())}get showPadding(){return!!this._showPadding}set showPadding(u){this._showPadding!==u&&(this._showPadding=u,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,this._tp.refreshUI(),u?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(u){this._repaint!==u&&(this._repaint=u,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(u){this._vertices=u,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(u){this._showTileAABBs!==u&&(this._showTileAABBs=u,this._tp.refreshUI(),u&&this._update())}_setCacheLimits(u,r){a.dx(u,r)}get version(){return a.dw}},NavigationControl:class{constructor(u={}){this.options=a.Q({},Pc,u),this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(a.br(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),It("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),It("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.br(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const o=this._map;o&&(this.options.visualizePitch?o.resetNorthPitch({},{originalEvent:r}):o.resetNorth({},{originalEvent:r}))}),this._compassIcon=It("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const u=this._map;if(!u)return;const r=u.getZoom(),o=r===u.getMaxZoom(),h=r===u.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const u=this._map;if(!u)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(u.transform.pitch*(Math.PI/180)),.5)}) rotateX(${u.transform.pitch}deg) rotateZ(${u.transform.angle*(180/Math.PI)}deg)`:`rotate(${u.transform.angle*(180/Math.PI)}deg)`;u._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),u.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&u.on("pitch",this._rotateCompassArrow),u.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Oc(u,this._compass,this.options.visualizePitch)),this._container}onRemove(){const u=this._map;u&&(this._container.remove(),this.options.showZoom&&u.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&u.off("pitch",this._rotateCompassArrow),u.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(u,r){const o=It("button",u,this._container);return o.type="button",o.addEventListener("click",r),o}_setButtonTitle(u,r){if(!this._map)return;const o=this._map._getUIString(`NavigationControl.${r}`);u.setAttribute("aria-label",o),u.firstElementChild&&u.firstElementChild.setAttribute("title",o)}},GeolocateControl:class extends a.E{constructor(u={}){super();const r=navigator.geolocation;this.options=a.Q({geolocation:r},_u,u),a.br(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=su(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(u){return this._map=u,this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(u){const r=(o=!!this.options.geolocation)=>{this._supportsGeolocation=o,u(o)};this._supportsGeolocation!==void 0?u(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(o=>r(o.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(u){const r=this._map.getMaxBounds(),o=u.coords;return!!r&&(o.longitude<r.getWest()||o.longitude>r.getEast()||o.latitude<r.getSouth()||o.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(u){if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new a.g("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(u),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(u),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.g("geolocate",u)),this._finish()}}_updateCamera(u){const r=new a.aJ(u.coords.longitude,u.coords.latitude),o=u.coords.accuracy,h=this._map.getBearing(),p=a.Q({bearing:h},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(o),p,{geolocateSource:!0})}_updateMarker(u){if(u){const r=new a.aJ(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=u.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const u=this._map.transform,r=a.ay(1,u._center.lat)*u.worldSize,o=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${o}px`,this._circleElement.style.height=`${o}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(u){if(this._map){if(this.options.trackUserLocation)if(u.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(u.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.g("error",u)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(u){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=It("button","mapboxgl-ctrl-geolocate",this._container),It("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",u===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=It("div","mapboxgl-user-location"),this._dotElement.appendChild(It("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(It("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new n1({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=It("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new n1({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.g("trackuserlocationend")))})}}_onDeviceOrientation(u){this._userLocationDotMarker&&(u.webkitCompassHeading?this._heading=u.webkitCompassHeading:u.absolute===!0&&(this._heading=-1*u.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.g("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.g("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.g("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let u;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(u={maximumAge:6e5,timeout:0},this._noTimeout=!0):(u=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,u),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const u=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&u()}).catch(console.error):u()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Zo,ScaleControl:class{constructor(u={}){this.options=a.Q({},wa,u),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.br(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const u=this.options.maxWidth||100,r=this._map,o=r._containerHeight/2,h=r._containerWidth/2-u/2,p=r.unproject([h,o]),m=r.unproject([h+u,o]),g=p.distanceTo(m);if(this.options.unit==="imperial"){const x=3.2808*g;x>5280?this._setScale(u,x/5280,"mile"):this._setScale(u,x,"foot")}else this.options.unit==="nautical"?this._setScale(u,g/1852,"nautical-mile"):g>=1e3?this._setScale(u,g/1e3,"kilometer"):this._setScale(u,g,"meter")}_setScale(u,r,o){this._map._requestDomTask(()=>{const h=function(m){const g=Math.pow(10,`${Math.floor(m)}`.length-1);let x=m/g;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(b){const w=Math.pow(10,Math.ceil(-Math.log(b)/Math.LN10));return Math.round(b*w)/w}(x),g*x}(r),p=h/r;this._container.innerHTML=this._isNumberFormatSupported&&o!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:o}).format(h):`${h}&nbsp;${gu[o]}`,this._container.style.width=u*p+"px"})}onAdd(u){return this._map=u,this._language=u.getLanguage(),this._container=It("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(u){this._language=u,this._update()}setUnit(u){this.options.unit=u,this._update()}},FullscreenControl:class{constructor(u={}){this._fullscreen=!1,u&&u.container&&(u.container instanceof HTMLElement?this._container=u.container:a.w("Full screen control 'container' must be a DOM element.")),a.br(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=It("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const u=this._fullscreenButton=It("button","mapboxgl-ctrl-fullscreen",this._controlContainer);It("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden","true"),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",u)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(u){super(),this.options=a.Q(Object.create(ba),u),a.br(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(u&&u.className?u.className.trim().split(/\s+/):[])}addTo(u){return this._map&&this.remove(),this._map=u,this.options.closeOnClick&&u.on("preclick",this._onClose),this.options.closeOnMove&&u.on("move",this._onClose),u.on("remove",this.remove),this._update(),u._addPopup(this),this._focusFirstElement(),this._trackPointer?(u.on("mousemove",this._onMouseEvent),u.on("mouseup",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")):u.on("move",this._update),this.fire(new a.g("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const u=this._map;return u&&(u.off("move",this._update),u.off("move",this._onClose),u.off("preclick",this._onClose),u.off("click",this._onClose),u.off("remove",this.remove),u.off("mousemove",this._onMouseEvent),u.off("mouseup",this._onMouseEvent),u.off("drag",this._onMouseEvent),u._canvasContainer&&u._canvasContainer.classList.remove("mapboxgl-track-pointer"),u._removePopup(this),this._map=void 0),this.fire(new a.g("close")),this}getLngLat(){return this._lngLat}setLngLat(u){this._lngLat=a.aJ.convert(u),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const u=this._map;return u&&(u.off("move",this._update),u.on("mousemove",this._onMouseEvent),u.on("drag",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(u){return this.setDOMContent(document.createTextNode(u))}setHTML(u){const r=document.createDocumentFragment(),o=document.createElement("body");let h;for(o.innerHTML=u;h=o.firstChild,h;)r.appendChild(h);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(u){return this.options.maxWidth=u,this._update(),this}setDOMContent(u){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=It("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(u),this.options.closeButton){const o=this._closeButton=It("button","mapboxgl-popup-close-button",r);o.type="button",o.setAttribute("aria-label","Close popup"),o.setAttribute("aria-hidden","true"),o.innerHTML="&#215;",o.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(u){return this._classList.add(u),this._updateClassList(),this}removeClassName(u){return this._classList.delete(u),this._updateClassList(),this}setOffset(u){return this.options.offset=u,this._update(),this}toggleClassName(u){let r;return this._classList.delete(u)?r=!1:(this._classList.add(u),r=!0),this._updateClassList(),r}_onMouseEvent(u){this._update(u.point)}_getAnchor(u){if(this.options.anchor)return this.options.anchor;const r=this._map,o=this._container,h=this._pos;if(!r||!o||!h)return"bottom";const p=o.offsetWidth,m=o.offsetHeight,g=h.x<p/2,x=h.x>r.transform.width-p/2;if(h.y+u<m)return g?"top-left":x?"top-right":"top";if(h.y>r.transform.height-m){if(g)return"bottom-left";if(x)return"bottom-right"}return g?"left":x?"right":"bottom"}_updateClassList(){const u=this._container;if(!u)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),u.className=r.join(" ")}_update(u){const r=this._map,o=this._content;if(!r||!this._lngLat&&!this._trackPointer||!o)return;let h=this._container;if(h||(h=this._container=It("div","mapboxgl-popup",r.getContainer()),this._tip=It("div","mapboxgl-popup-tip",h),h.appendChild(o)),this.options.maxWidth&&h.style.maxWidth!==this.options.maxWidth&&(h.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=$o(this._lngLat,this._pos,r.transform)),!this._trackPointer||u){const p=this._pos=this._trackPointer&&u instanceof a.P?u:r.project(this._lngLat),m=mu(this.options.offset),g=this._anchor=this._getAnchor(m.y),x=mu(this.options.offset,g),b=p.add(x).round();r._requestDomTask(()=>{this._container&&g&&(this._container.style.transform=`${r1[g]} translate(${b.x}px,${b.y}px)`)})}if(!this._marker&&r._showingGlobe()){const p=a.dc(r.transform,this._lngLat)?0:1;this._setOpacity(p)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const u=this._container.querySelector(Qh);u&&u.focus()}_onClose(){this.remove()}_setOpacity(u){this._container&&(this._container.style.opacity=`${u}`),this._content&&(this._content.style.pointerEvents=u?"auto":"none")}},Marker:n1,Style:Rr,LngLat:a.aJ,LngLatBounds:a.aj,Point:a.P,MercatorCoordinate:a._,FreeCameraOptions:E3,Evented:a.E,config:a.db,prewarm:a.dA,clearPrewarmedResources:a.dB,get accessToken(){return a.db.ACCESS_TOKEN},set accessToken(u){a.db.ACCESS_TOKEN=u},get baseApiUrl(){return a.db.API_URL},set baseApiUrl(u){a.db.API_URL=u},get workerCount(){return a.dC.workerCount},set workerCount(u){a.dC.workerCount=u},get maxParallelImageRequests(){return a.db.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){a.db.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage(u){a.dD(u)},get workerUrl(){return a.dE.workerUrl},set workerUrl(u){a.dE.workerUrl=u},get workerClass(){return a.dE.workerClass},set workerClass(u){a.dE.workerClass=u},get workerParams(){return a.dE.workerParams},set workerParams(u){a.dE.workerParams=u},get dracoUrl(){return a.dF()},set dracoUrl(u){a.dG(u)},get meshoptUrl(){return a.dH()},set meshoptUrl(u){a.dI(u)},setNow:a.e.setNow,restoreNow:a.e.restoreNow}});var Ut=Qt;return Ut})})(m4);var a8=m4.exports;const Mh=U7(a8),o8=()=>X0("/pow/web3b/unSignweb/node/nodeOverview"),l8=()=>X0("/pow/web3b/unSignweb/epoch"),c8=()=>X0("/pow/web3b/unSignweb/node/distribution");Mh.accessToken="pk.eyJ1IjoibXE4OTEwMDQiLCJhIjoiY2xnNXdkcjByMDVtNzNrbnE0cjlqd2xucCJ9.R1IE-B4Sjl8yhtQmlrrgQQ";const u8=()=>{const Xe=hn.useRef(null),{data:wt=[]}=q0(c8);hn.useEffect(()=>{var Xt;const Qt=wt.map(Ut=>({id:Ut.iso,coordinates:[Number(Ut.longitude),Number(Ut.latitude)],address:Ut.country,node:`${Ut.count}`}));Qt.length&&((Xt=Xe.current)==null||Xt.setCenter(Qt[0].coordinates)),Dt(Qt)},[wt,Xe]),hn.useEffect(()=>(Xe.current=new Mh.Map({container:"mapboxgl-container",style:"mapbox://styles/mapbox/dark-v11",zoom:1.9,minZoom:1,maxZoom:16,scrollZoom:!1}),()=>{Xe.current&&Xe.current.remove()}),[]);const Dt=Qt=>{Qt.forEach(Xt=>{const Ut=Number(Xt.node),a=document.createElement("div"),mi=document.createElement("div");a.setAttribute("class",`flex items-center justify-center rounded-full bg-[rgba(49,185,152,0.24)] ${Ut<10?"h-11 w-11":Ut>=10&&Ut<20?"h-16 w-16":Ut>=20&&Ut<100?"h-20 w-20":"h-28 w-28"}`),a.addEventListener("click",()=>{console.log("click")}),mi.setAttribute("class",`rounded-full bg-[#5DE8C4] ${Ut<10?"h-3 w-3 shadow-[0_0_0_8px_rgba(49,185,152,0.55)]":Ut>=10&&Ut<20?"h-[1.125rem] w-[1.125rem] shadow-[0_0_0_12px_rgba(49,185,152,0.55)]":Ut>=20&&Ut<100?"h-[1.375rem] w-[1.375rem] shadow-[0_0_0_15px_rgba(49,185,152,0.55)]":"h-8 w-8 shadow-[0_0_0_20px_rgba(49,185,152,0.55)]"}`),a.appendChild(mi),Xe.current&&new Mh.Marker({element:a,offset:[0,0]}).setLngLat(Xt.coordinates).setPopup(new Mh.Popup({anchor:"bottom",className:"mapboxgl-global-popup",closeButton:!1,offset:24}).setHTML(`<div class='flex'><div class='min-w-22 px-4 py-1.5 border-r-2 border-solid border-[#6C6C6C]'><p class='text-sm leading-none pb-2'>${Xt.address}</p><p class='text-xs text-[rgba(255,255,255,0.3)] leading-none'>Address</p></div><div class='min-w-22 px-4 py-1.5'><p class='text-sm leading-none  pb-2'>${Xt.node}</p><p class='text-xs text-[rgba(255,255,255,0.3)] leading-none'>Nodes</p></div></div>`)).addTo(Xe.current)})},at=()=>{Xe.current&&Xe.current.zoomIn({duration:1e3})},Ge=()=>{Xe.current&&Xe.current.zoomOut({duration:1e3})};return S.jsxs("div",{className:"relative h-full w-full",children:[S.jsx("div",{className:"absolute right-16 top-5 z-10 flex h-7 w-7 cursor-pointer select-none items-center justify-center rounded-md bg-white",onClick:at,children:S.jsx("img",{src:`${OSS_URL}/images/home/search_add.svg`})}),S.jsx("div",{className:"absolute right-5 top-5 z-10 flex h-7 w-7 cursor-pointer select-none items-center justify-center rounded-md bg-white",onClick:Ge,children:S.jsx("img",{src:`${OSS_URL}/images/home/search_reduce.svg`})}),S.jsx("div",{id:"mapboxgl-container",className:"relative h-full w-full"})]})},f8=()=>{const{t:Xe}=Z7(),{context:wt}=$7(),{operate:Dt}=wt||{},{decimals:at}=G7(Dt.splBalanceEmitter)??{},{data:{totalNodes:Ge,totalPower:Qt,totalPowStake:Xt=0,totalPosStake:Ut=0}={totalNodes:null,totalPower:null}}=q0(o8),{data:{totalReleaseRewards:a,currentEpochRewards:mi,nextEpochRewards:bi,currentEpoch:st,currentEpochDay:It,currentSysTime:_i,nextEpochStartLongTime:Pi}={totalReleaseRewards:null,currentEpochRewards:null,nextEpochRewards:null,currentEpoch:null,currentEpochDay:null,currentSysTime:0,nextEpochStartLongTime:0}}=q0(l8),Sr=hn.useMemo(()=>st?[1,21,31,41,51,61,71,81,91].includes(st)?st+"st":[2,22,32,42,52,62,72,82,92].includes(st)?st+"nd":[3,23,33,43,53,63,73,83,93].includes(st)?st+"rd":st+"th":"--",[st]),Kr=[{id:3,name:Xe("home.total_nodes"),value:Ge??"--",unit:""},{id:4,name:Xe("home.total_flops"),value:Qt??"--",unit:"T"},{id:5,name:Xe("home.total_tvl"),value:q7(Number(Th(Xt+Ut,at))),unit:"$JVSC"}];return S.jsxs("div",{className:"relative",children:[S.jsxs("div",{className:"banner-wrap relative flex h-[55rem] flex-col",children:[S.jsxs("div",{className:"banner relative",children:[S.jsx(W7,{className:"banner-left-animation absolute z-0 block object-contain"}),S.jsxs("div",{className:"slogan relative z-10 w-fit font-Inter font-bold text-white",children:[S.jsx("p",{className:"explore",children:"OMNI PLATFORM"}),S.jsxs("p",{children:["FOR ",S.jsx("span",{className:"text-primary",children:"AI"})]})]}),S.jsx("div",{className:"statics absolute z-30 flex h-32 gap-x-14 rounded-xl bg-[#c9c9c933] px-6 font-Urbanist",children:Kr.map((pr,Zn)=>S.jsxs("div",{className:"statics-item-wrap flex items-center gap-x-14",children:[S.jsxs("div",{className:"statics-item flex h-full flex-col justify-center gap-5",children:[S.jsx("p",{className:"text-2xl text-primary",children:pr.name}),S.jsxs("p",{className:"flex items-end text-4xl font-bold",children:[S.jsx("span",{className:"statics-value",children:pr.value}),pr.unit&&S.jsx("span",{className:"ml-2 text-2xl font-normal",children:pr.unit})]})]}),Zn!==2&&S.jsx("div",{className:"line h-14 w-px bg-[#4e4e4e]"})]},pr.id))})]}),S.jsx("img",{className:"home_ring absolute right-0 select-none",src:`${OSS_URL}/images/home/banner_bg.gif`,alt:""})]}),S.jsxs("div",{className:"layout_card mx-auto mb-28",children:[S.jsx("div",{className:"card_title flex aspect-[112/25] items-center bg-contain pl-6 font-Urbanist font-bold",style:{backgroundImage:`url(${OSS_URL}/images/home/card_title_bg.svg) `},children:Xe("home.title_node")}),S.jsx("div",{className:"card_content earth_content aspect-[141/66]",children:S.jsx(u8,{})})]}),S.jsxs("div",{className:"layout_card mx-auto mb-28 font-Urbanist",children:[S.jsx("div",{className:"card_title flex aspect-[112/25] items-center bg-contain pl-6 font-Urbanist font-bold",style:{backgroundImage:`url(${OSS_URL}/images/home/card_title_bg.svg) `},children:Xe("home.tokennomics")}),S.jsxs("div",{className:"content_token mini-content_token flex aspect-[141/17] items-center",children:[S.jsxs("div",{className:"token-item flex flex-1 flex-col pl-[3%]",children:[S.jsx("span",{className:"token-item-title mb-5 text-lg text-[#B1B1B1]",children:"Total Supply"}),S.jsxs("div",{children:[S.jsx("span",{className:"token-item-value mr-2 text-4xl font-bold text-white",children:"100M"}),S.jsx("span",{className:"token-item-unit text-lg text-[#B1B1B1]",children:"JVSC"})]})]}),S.jsxs("div",{className:"token-item flex flex-1 flex-col border-s border-[#1f1f1f] pl-[3%]",children:[S.jsx("span",{className:"token-item-title mb-5 text-lg text-[#B1B1B1]",children:"PoW"}),S.jsxs("div",{children:[S.jsx("span",{className:"token-item-value mr-2 text-4xl font-bold text-white",children:"90"}),S.jsx("span",{className:"token-item-unit text-lg text-[#B1B1B1]",children:"%"})]})]}),S.jsxs("div",{className:"token-item flex flex-1 flex-col border-s border-[#1f1f1f] pl-[3%]",children:[S.jsx("span",{className:"token-item-title mb-5 text-lg text-[#B1B1B1]",children:"PoS"}),S.jsxs("div",{children:[S.jsx("span",{className:"token-item-value mr-2 text-4xl font-bold text-white",children:"10"}),S.jsx("span",{className:"token-item-unit text-lg text-[#B1B1B1]",children:"%"})]})]})]})]}),S.jsxs("div",{className:"layout_card mx-auto mb-28 font-Urbanist",children:[S.jsx("div",{className:"card_title flex aspect-[112/25] items-center bg-contain pl-6 font-Urbanist font-bold",style:{backgroundImage:`url(${OSS_URL}/images/home/card_title_bg.svg) `},children:Xe("home.what_is_jvs_token")}),S.jsxs("div",{className:"card_content content_token flex aspect-[141/57]",children:[S.jsx("img",{className:"h-full",src:`${OSS_URL}/images/home/token.svg`,alt:"token"}),S.jsxs("div",{className:"token_desc_wrap flex flex-1 flex-col items-center justify-center pe-12 ps-20",children:[S.jsxs("div",{className:"token_title flex items-center",children:[S.jsx("span",{className:"font-black",children:Xe("home.JVS_token")}),S.jsx("img",{className:"block object-contain",src:`${OSS_URL}/images/home/JVS_logo.png`})]}),S.jsxs("p",{className:"token_desc text-[#b1b1b1]",children:[S.jsx("span",{children:Xe("home.jvs_token_desc1")}),S.jsx("span",{className:"font-bold text-white",children:Xe("home.jvs_token_desc2")}),S.jsx("span",{children:Xe("home.jvs_token_desc3")})]})]})]})]}),S.jsxs("div",{className:"layout_card mx-auto mb-28 font-Urbanist",children:[S.jsx("div",{className:"card_title flex aspect-[112/25] items-center bg-contain pl-6 font-Urbanist font-bold",style:{backgroundImage:`url(${OSS_URL}/images/home/card_title_bg.svg) `},children:Xe("home.how_it_works")}),S.jsx("img",{className:"w-full",src:`${OSS_URL}/images/home/works.svg`,alt:""})]}),S.jsxs("div",{className:"layout_card mx-auto mb-28 font-Urbanist",children:[S.jsx("div",{className:"card_title flex aspect-[112/25] items-center bg-contain pl-6 font-Urbanist font-bold",style:{backgroundImage:`url(${OSS_URL}/images/home/card_title_bg.svg) `},children:Xe("home.title_reward")}),S.jsxs("div",{className:"card_content content_reward flex aspect-[141/45] items-center overflow-hidden pe-[13%] ps-[3%]",children:[S.jsxs("div",{className:"mr-auto flex flex-col",children:[S.jsxs("div",{className:"reward-wrap grid grid-cols-2 gap-x-20 gap-y-12",children:[S.jsxs("div",{className:"reward-item",children:[S.jsx("p",{className:"reward-title mb-2.5 text-lg font-normal leading-8 text-[#B1B1B1]",children:Xe("home.total_released_rewards")}),S.jsxs("div",{className:"flex items-end gap-1.5",children:[S.jsx("p",{className:"reward-value text-4xl font-bold",children:a?Th(a,at):"--"}),S.jsx("span",{className:"text-lg text-[#B1B1B1]",children:"JVSC"})]})]}),S.jsxs("div",{className:"reward-item",children:[S.jsx("p",{className:"reward-title mb-2.5 text-lg font-normal leading-8 text-[#B1B1B1]",children:Xe("home.current_epoch_reward")}),S.jsxs("div",{className:"flex items-end gap-1.5",children:[S.jsx("p",{className:"reward-value text-4xl font-bold",children:mi?Th(mi,at):"--"}),S.jsx("span",{className:"text-lg text-[#B1B1B1]",children:"JVSC"})]})]}),S.jsxs("div",{className:"reward-item",children:[S.jsx("p",{className:"reward-title mb-2.5 text-lg font-normal leading-8 text-[#B1B1B1]",children:Xe("home.current_epoch")}),S.jsx("div",{className:"flex items-end gap-1.5",children:S.jsxs("p",{className:"reward-value text-4xl font-bold",children:[It??"--"," ",Xe("home.days")]})})]}),S.jsxs("div",{className:"reward-item",children:[S.jsx("p",{className:"reward-title mb-2.5 text-lg font-normal leading-8 text-[#B1B1B1]",children:Xe("home.next_epoch_reward")}),S.jsxs("div",{className:"flex items-end gap-1.5",children:[S.jsx("p",{className:"reward-value text-4xl font-bold",children:bi?Th(bi,at):"--"}),S.jsx("span",{className:"text-lg text-[#B1B1B1]",children:"JVSC"})]})]})]}),S.jsxs("p",{className:"doc-pc mt-10 flex gap-1.5 text-base leading-5 text-[#A6A6A6]",children:[Xe("home.learn_more"),S.jsx("span",{className:"cursor-pointer text-[#E9E9E9]",onClick:()=>window.open(`${WHITE_PAPER_URL}`),children:"Rewards Docs"}),S.jsx("i",{className:"i-ri:arrow-right-up-line text-sm leading-none"})]})]}),S.jsx("div",{className:"ball-wrap aspect-[321/419] h-[90%] translate-y-[7%] bg-contain bg-no-repeat",style:{backgroundImage:`url(${OSS_URL}/images/home/reward.svg) `},children:S.jsxs("div",{className:"aspect-square w-full",children:[S.jsxs("div",{className:"flex h-[50%] w-full flex-col items-center justify-center",children:[S.jsx("p",{className:"text-center text-lg leading-8 text-[#B1B1B1]",children:Xe("home.epoch")}),S.jsx("p",{className:"epoch text-center text-4xl font-bold",children:Sr})]}),S.jsxs("div",{className:"flex h-[50%] w-full flex-col items-center justify-center",children:[S.jsx("p",{className:"-mt-[15%] mb-2.5 flex items-center justify-center gap-1.5 text-lg text-[#B1B1B1]",children:Xe("home.next")}),S.jsx(s8,{duration:Math.round(Pi*100-_i*100)/100,className:"cut-down"})]})]})}),S.jsxs("p",{className:"doc-mini mt-10 text-xs leading-5 text-[#A6A6A6]",children:[Xe("home.learn_more"),S.jsx("span",{className:"mx-1.5 cursor-pointer text-[#E9E9E9]",onClick:()=>window.open(`${WHITE_PAPER_URL}`),children:"Rewards Docs"}),S.jsx("i",{className:"i-ri:arrow-right-up-line text-sm leading-none"})]})]})]})]})};export{f8 as default};
